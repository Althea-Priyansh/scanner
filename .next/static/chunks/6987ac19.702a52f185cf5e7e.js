"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[538],{7900:function(e,t,r){var n,i=r(3454),o=self||window||{},a=o.Dynamsoft||{};(n=a).DWT||(n.DWT={}),n.DWT.LTS||(n.DWT.LTS={}),n.Lib||(n.Lib={}),n.Lib.UI||(n.Lib.UI={}),n.Lib.html5||(n.Lib.html5={}),o.Dynamsoft=n,function(e){if(!e.WeakSet){e.WeakSet=a;var t=Date.now()%1e9;function a(e){this.name="__st"+(1e9*Math.random()>>>0)+t+++"__",e&&e.forEach&&e.forEach(this.add,this)}var r=a.prototype;r.add=function(e){var t=this.name;return e[t]||Object.defineProperty(e,t,{value:!0,writable:!0}),this},r.delete=function(e){return!!e[this.name]&&(e[this.name]=void 0,!0)},r.has=function(e){return!!e[this.name]}}if(!e.WeakMap){var n=Object.prototype.hasOwnProperty,i=Object.defineProperty&&function(){try{return 1===Object.defineProperty({},"x",{value:1}).x}catch(e){}}(),o=function(e,t,r){i?Object.defineProperty(e,t,{configurable:!0,writable:!0,value:r}):e[t]=r};function s(e){return Object(e)===e}e.WeakMap=function(){function e(){if(void 0===this)throw new TypeError("Constructor WeakMap requires 'new'");if(o(this,"_id",function(e){return e+"_"+r()+"."+r()}("_WeakMap")),arguments.length>0)throw new TypeError("WeakMap iterable is not supported")}function t(e,t){if(!s(e)||!n.call(e,"_id"))throw new TypeError(t+" method called on incompatible receiver "+typeof e)}function r(){return Math.random().toString().substring(2)}return o(e.prototype,"delete",(function(e){if(t(this,"delete"),!s(e))return!1;var r=e[this._id];return!(!r||r[0]!==e)&&(delete e[this._id],!0)})),o(e.prototype,"get",(function(e){if(t(this,"get"),s(e)){var r=e[this._id];return r&&r[0]===e?r[1]:void 0}})),o(e.prototype,"has",(function(e){if(t(this,"has"),!s(e))return!1;var r=e[this._id];return!(!r||r[0]!==e)})),o(e.prototype,"set",(function(e,r){if(t(this,"set"),!s(e))throw new TypeError("Invalid value used as weak map key");var n=e[this._id];return n&&n[0]===e?(n[1]=r,this):(o(e,this._id,[e,r]),this)})),o(e,"_polyfill",!0),e}()}}("undefined"!==typeof o?o:"undefined"!==typeof self?self:"undefined"!==typeof window?window:"undefined"!==typeof global?global:void 0),a.Lib.jsinited||(a.Lib.jsinited=1,function(e){if("object"===typeof exports)module.exports=e();else if("function"===typeof define&&define.amd)define(e);else{var t;try{t=window}catch(s){t=self}t.SparkMD5=e()}}((function(e){var t=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];function r(e,t){var r=e[0],n=e[1],i=e[2],o=e[3];n=((n+=((i=((i+=((o=((o+=((r=((r+=(n&i|~n&o)+t[0]-680876936|0)<<7|r>>>25)+n|0)&n|~r&i)+t[1]-389564586|0)<<12|o>>>20)+r|0)&r|~o&n)+t[2]+606105819|0)<<17|i>>>15)+o|0)&o|~i&r)+t[3]-1044525330|0)<<22|n>>>10)+i|0,n=((n+=((i=((i+=((o=((o+=((r=((r+=(n&i|~n&o)+t[4]-176418897|0)<<7|r>>>25)+n|0)&n|~r&i)+t[5]+1200080426|0)<<12|o>>>20)+r|0)&r|~o&n)+t[6]-1473231341|0)<<17|i>>>15)+o|0)&o|~i&r)+t[7]-45705983|0)<<22|n>>>10)+i|0,n=((n+=((i=((i+=((o=((o+=((r=((r+=(n&i|~n&o)+t[8]+1770035416|0)<<7|r>>>25)+n|0)&n|~r&i)+t[9]-1958414417|0)<<12|o>>>20)+r|0)&r|~o&n)+t[10]-42063|0)<<17|i>>>15)+o|0)&o|~i&r)+t[11]-1990404162|0)<<22|n>>>10)+i|0,n=((n+=((i=((i+=((o=((o+=((r=((r+=(n&i|~n&o)+t[12]+1804603682|0)<<7|r>>>25)+n|0)&n|~r&i)+t[13]-40341101|0)<<12|o>>>20)+r|0)&r|~o&n)+t[14]-1502002290|0)<<17|i>>>15)+o|0)&o|~i&r)+t[15]+1236535329|0)<<22|n>>>10)+i|0,n=((n+=((i=((i+=((o=((o+=((r=((r+=(n&o|i&~o)+t[1]-165796510|0)<<5|r>>>27)+n|0)&i|n&~i)+t[6]-1069501632|0)<<9|o>>>23)+r|0)&n|r&~n)+t[11]+643717713|0)<<14|i>>>18)+o|0)&r|o&~r)+t[0]-373897302|0)<<20|n>>>12)+i|0,n=((n+=((i=((i+=((o=((o+=((r=((r+=(n&o|i&~o)+t[5]-701558691|0)<<5|r>>>27)+n|0)&i|n&~i)+t[10]+38016083|0)<<9|o>>>23)+r|0)&n|r&~n)+t[15]-660478335|0)<<14|i>>>18)+o|0)&r|o&~r)+t[4]-405537848|0)<<20|n>>>12)+i|0,n=((n+=((i=((i+=((o=((o+=((r=((r+=(n&o|i&~o)+t[9]+568446438|0)<<5|r>>>27)+n|0)&i|n&~i)+t[14]-1019803690|0)<<9|o>>>23)+r|0)&n|r&~n)+t[3]-187363961|0)<<14|i>>>18)+o|0)&r|o&~r)+t[8]+1163531501|0)<<20|n>>>12)+i|0,n=((n+=((i=((i+=((o=((o+=((r=((r+=(n&o|i&~o)+t[13]-1444681467|0)<<5|r>>>27)+n|0)&i|n&~i)+t[2]-51403784|0)<<9|o>>>23)+r|0)&n|r&~n)+t[7]+1735328473|0)<<14|i>>>18)+o|0)&r|o&~r)+t[12]-1926607734|0)<<20|n>>>12)+i|0,n=((n+=((i=((i+=((o=((o+=((r=((r+=(n^i^o)+t[5]-378558|0)<<4|r>>>28)+n|0)^n^i)+t[8]-2022574463|0)<<11|o>>>21)+r|0)^r^n)+t[11]+1839030562|0)<<16|i>>>16)+o|0)^o^r)+t[14]-35309556|0)<<23|n>>>9)+i|0,n=((n+=((i=((i+=((o=((o+=((r=((r+=(n^i^o)+t[1]-1530992060|0)<<4|r>>>28)+n|0)^n^i)+t[4]+1272893353|0)<<11|o>>>21)+r|0)^r^n)+t[7]-155497632|0)<<16|i>>>16)+o|0)^o^r)+t[10]-1094730640|0)<<23|n>>>9)+i|0,n=((n+=((i=((i+=((o=((o+=((r=((r+=(n^i^o)+t[13]+681279174|0)<<4|r>>>28)+n|0)^n^i)+t[0]-358537222|0)<<11|o>>>21)+r|0)^r^n)+t[3]-722521979|0)<<16|i>>>16)+o|0)^o^r)+t[6]+76029189|0)<<23|n>>>9)+i|0,n=((n+=((i=((i+=((o=((o+=((r=((r+=(n^i^o)+t[9]-640364487|0)<<4|r>>>28)+n|0)^n^i)+t[12]-421815835|0)<<11|o>>>21)+r|0)^r^n)+t[15]+530742520|0)<<16|i>>>16)+o|0)^o^r)+t[2]-995338651|0)<<23|n>>>9)+i|0,n=((n+=((o=((o+=(n^((r=((r+=(i^(n|~o))+t[0]-198630844|0)<<6|r>>>26)+n|0)|~i))+t[7]+1126891415|0)<<10|o>>>22)+r|0)^((i=((i+=(r^(o|~n))+t[14]-1416354905|0)<<15|i>>>17)+o|0)|~r))+t[5]-57434055|0)<<21|n>>>11)+i|0,n=((n+=((o=((o+=(n^((r=((r+=(i^(n|~o))+t[12]+1700485571|0)<<6|r>>>26)+n|0)|~i))+t[3]-1894986606|0)<<10|o>>>22)+r|0)^((i=((i+=(r^(o|~n))+t[10]-1051523|0)<<15|i>>>17)+o|0)|~r))+t[1]-2054922799|0)<<21|n>>>11)+i|0,n=((n+=((o=((o+=(n^((r=((r+=(i^(n|~o))+t[8]+1873313359|0)<<6|r>>>26)+n|0)|~i))+t[15]-30611744|0)<<10|o>>>22)+r|0)^((i=((i+=(r^(o|~n))+t[6]-1560198380|0)<<15|i>>>17)+o|0)|~r))+t[13]+1309151649|0)<<21|n>>>11)+i|0,n=((n+=((o=((o+=(n^((r=((r+=(i^(n|~o))+t[4]-145523070|0)<<6|r>>>26)+n|0)|~i))+t[11]-1120210379|0)<<10|o>>>22)+r|0)^((i=((i+=(r^(o|~n))+t[2]+718787259|0)<<15|i>>>17)+o|0)|~r))+t[9]-343485551|0)<<21|n>>>11)+i|0,e[0]=r+e[0]|0,e[1]=n+e[1]|0,e[2]=i+e[2]|0,e[3]=o+e[3]|0}function n(e){var t,r=[];for(t=0;t<64;t+=4)r[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return r}function i(e){var t,r=[];for(t=0;t<64;t+=4)r[t>>2]=e[t]+(e[t+1]<<8)+(e[t+2]<<16)+(e[t+3]<<24);return r}function o(e){var t,i,o,a,s,u,c=e.length,l=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=c;t+=64)r(l,n(e.substring(t-64,t)));for(i=(e=e.substring(t-64)).length,o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],t=0;t<i;t+=1)o[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(o[t>>2]|=128<<(t%4<<3),t>55)for(r(l,o),t=0;t<16;t+=1)o[t]=0;return a=(a=8*c).toString(16).match(/(.*?)(.{0,8})$/),s=parseInt(a[2],16),u=parseInt(a[1],16)||0,o[14]=s,o[15]=u,r(l,o),l}function a(e){var r,n="";for(r=0;r<4;r+=1)n+=t[e>>8*r+4&15]+t[e>>8*r&15];return n}function s(e){var t;for(t=0;t<e.length;t+=1)e[t]=a(e[t]);return e.join("")}function u(e){return/[\u0080-\uFFFF]/.test(e)&&(e=unescape(encodeURIComponent(e))),e}function c(e){var t,r=[],n=e.length;for(t=0;t<n-1;t+=2)r.push(parseInt(e.substr(t,2),16));return String.fromCharCode.apply(String,r)}function l(){this.reset()}return"5d41402abc4b2a76b9719d911017c592"!==s(o("hello"))&&function(e,t){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r},"undefined"===typeof ArrayBuffer||ArrayBuffer.prototype.slice||function(){function t(e,t){return(e=0|e||0)<0?Math.max(e+t,0):Math.min(e,t)}ArrayBuffer.prototype.slice=function(r,n){var i,o,a,s,u=this.byteLength,c=t(r,u),l=u;return n!==e&&(l=t(n,u)),c>l?new ArrayBuffer(0):(i=l-c,o=new ArrayBuffer(i),a=new Uint8Array(o),s=new Uint8Array(this,c,i),a.set(s),o)}}(),l.prototype.append=function(e){return this.appendBinary(u(e)),this},l.prototype.appendBinary=function(e){this._buff+=e,this._length+=e.length;var t,i=this._buff.length;for(t=64;t<=i;t+=64)r(this._hash,n(this._buff.substring(t-64,t)));return this._buff=this._buff.substring(t-64),this},l.prototype.end=function(e){var t,r,n=this._buff,i=n.length,o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<i;t+=1)o[t>>2]|=n.charCodeAt(t)<<(t%4<<3);return this._finish(o,i),r=s(this._hash),e&&(r=c(r)),this.reset(),r},l.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},l.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash.slice()}},l.prototype.setState=function(e){return this._buff=e.buff,this._length=e.length,this._hash=e.hash,this},l.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},l.prototype._finish=function(e,t){var n,i,o,a=t;if(e[a>>2]|=128<<(a%4<<3),a>55)for(r(this._hash,e),a=0;a<16;a+=1)e[a]=0;n=(n=8*this._length).toString(16).match(/(.*?)(.{0,8})$/),i=parseInt(n[2],16),o=parseInt(n[1],16)||0,e[14]=i,e[15]=o,r(this._hash,e)},l.hash=function(e,t){return l.hashBinary(u(e),t)},l.hashBinary=function(e,t){var r=s(o(e));return t?c(r):r},l.ArrayBuffer=function(){this.reset()},l.ArrayBuffer.prototype.append=function(e){var t,n=function(e,t,r){var n=new Uint8Array(e.byteLength+t.byteLength);return n.set(new Uint8Array(e)),n.set(new Uint8Array(t),e.byteLength),r?n:n.buffer}(this._buff.buffer,e,!0),o=n.length;for(this._length+=e.byteLength,t=64;t<=o;t+=64)r(this._hash,i(n.subarray(t-64,t)));return this._buff=t-64<o?new Uint8Array(n.buffer.slice(t-64)):new Uint8Array(0),this},l.ArrayBuffer.prototype.end=function(e){var t,r,n=this._buff,i=n.length,o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<i;t+=1)o[t>>2]|=n[t]<<(t%4<<3);return this._finish(o,i),r=s(this._hash),e&&(r=c(r)),this.reset(),r},l.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},l.ArrayBuffer.prototype.getState=function(){var e,t=l.prototype.getState.call(this);return t.buff=(e=t.buff,String.fromCharCode.apply(null,new Uint8Array(e))),t},l.ArrayBuffer.prototype.setState=function(e){return e.buff=function(e,t){var r,n=e.length,i=new ArrayBuffer(n),o=new Uint8Array(i);for(r=0;r<n;r+=1)o[r]=e.charCodeAt(r);return t?o:i}(e.buff,!0),l.prototype.setState.call(this,e)},l.ArrayBuffer.prototype.destroy=l.prototype.destroy,l.ArrayBuffer.prototype._finish=l.prototype._finish,l.ArrayBuffer.hash=function(e,t){var n=s(function(e){var t,n,o,a,s,u,c=e.length,l=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=c;t+=64)r(l,i(e.subarray(t-64,t)));for(n=(e=t-64<c?e.subarray(t-64):new Uint8Array(0)).length,o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],t=0;t<n;t+=1)o[t>>2]|=e[t]<<(t%4<<3);if(o[t>>2]|=128<<(t%4<<3),t>55)for(r(l,o),t=0;t<16;t+=1)o[t]=0;return a=(a=8*c).toString(16).match(/(.*?)(.{0,8})$/),s=parseInt(a[2],16),u=parseInt(a[1],16)||0,o[14]=s,o[15]=u,r(l,o),l}(new Uint8Array(e)));return t?c(n):n},l})),function(){function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(t){var r=function(t,r){if("object"!==e(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,"string");if("object"!==e(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===e(r)?r:String(r)}function n(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,r(i.key),i)}}function s(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var u="undefined"!=typeof o?o:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function c(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var l={exports:{}},d={exports:{}};!function(e){function t(r){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(r)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports}(d);var f=d.exports;!function(e){var t=f.default;function r(){e.exports=r=function(){return n},e.exports.__esModule=!0,e.exports.default=e.exports;var n={},i=Object.prototype,o=i.hasOwnProperty,a=Object.defineProperty||function(e,t,r){e[t]=r.value},s="function"==typeof Symbol?Symbol:{},u=s.iterator||"@@iterator",c=s.asyncIterator||"@@asyncIterator",l=s.toStringTag||"@@toStringTag";function d(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{d({},"")}catch(O){d=function(e,t,r){return e[t]=r}}function f(e,t,r,n){var i=t&&t.prototype instanceof p?t:p,o=Object.create(i.prototype),s=new D(n||[]);return a(o,"_invoke",{value:C(e,r,s)}),o}function h(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(O){return{type:"throw",arg:O}}}n.wrap=f;var g={};function p(){}function _(){}function m(){}var v={};d(v,u,(function(){return this}));var y=Object.getPrototypeOf,S=y&&y(y(P([])));S&&S!==i&&o.call(S,u)&&(v=S);var T=m.prototype=p.prototype=Object.create(v);function I(e){["next","throw","return"].forEach((function(t){d(e,t,(function(e){return this._invoke(t,e)}))}))}function b(e,r){function n(i,a,s,u){var c=h(e[i],e,a);if("throw"!==c.type){var l=c.arg,d=l.value;return d&&"object"==t(d)&&o.call(d,"__await")?r.resolve(d.__await).then((function(e){n("next",e,s,u)}),(function(e){n("throw",e,s,u)})):r.resolve(d).then((function(e){l.value=e,s(l)}),(function(e){return n("throw",e,s,u)}))}u(c.arg)}var i;a(this,"_invoke",{value:function(e,t){function o(){return new r((function(r,i){n(e,t,r,i)}))}return i=i?i.then(o,o):o()}})}function C(e,t,r){var n="suspendedStart";return function(i,o){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw o;return R()}for(r.method=i,r.arg=o;;){var a=r.delegate;if(a){var s=w(a,r);if(s){if(s===g)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var u=h(e,t,r);if("normal"===u.type){if(n=r.done?"completed":"suspendedYield",u.arg===g)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n="completed",r.method="throw",r.arg=u.arg)}}}function w(e,t){var r=t.method,n=e.iterator[r];if(void 0===n)return t.delegate=null,"throw"===r&&e.iterator.return&&(t.method="return",t.arg=void 0,w(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var i=h(n,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,g;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,g):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,g)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function A(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function D(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function P(e){if(e){var t=e[u];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,n=function t(){for(;++r<e.length;)if(o.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return n.next=n}}return{next:R}}function R(){return{value:void 0,done:!0}}return _.prototype=m,a(T,"constructor",{value:m,configurable:!0}),a(m,"constructor",{value:_,configurable:!0}),_.displayName=d(m,l,"GeneratorFunction"),n.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===_||"GeneratorFunction"===(t.displayName||t.name))},n.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,d(e,l,"GeneratorFunction")),e.prototype=Object.create(T),e},n.awrap=function(e){return{__await:e}},I(b.prototype),d(b.prototype,c,(function(){return this})),n.AsyncIterator=b,n.async=function(e,t,r,i,o){void 0===o&&(o=Promise);var a=new b(f(e,t,r,i),o);return n.isGeneratorFunction(t)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},I(T),d(T,l,"Generator"),d(T,u,(function(){return this})),d(T,"toString",(function(){return"[object Generator]"})),n.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},n.values=P,D.prototype={constructor:D,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(A),!e)for(var t in this)"t"===t.charAt(0)&&o.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(r,n){return a.type="throw",a.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=o.call(i,"catchLoc"),u=o.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&o.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),A(r),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;A(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:P(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),g}},n}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports}(l);var h=(0,l.exports)(),g=h;try{regeneratorRuntime=h}catch($J){"object"==typeof o?o.regeneratorRuntime=h:Function("r","regeneratorRuntime = r")(h)}var p,_,m=c(g);function v(e){var t=e?new Date(e):new Date,r="yyyy-MM-dd HH:mm:ss.SSSZ",n={"M+":t.getUTCMonth()+1,"d+":t.getUTCDate(),"H+":t.getUTCHours(),"h+":t.getUTCHours()%12||12,"m+":t.getUTCMinutes(),"s+":t.getUTCSeconds(),"q+":Math.floor((t.getUTCMonth()+3)/3),"S+":t.getUTCMilliseconds()};for(var i in/(y+)/.test(r)&&(r=r.replace(RegExp.$1,(t.getUTCFullYear()+"").substr(4-RegExp.$1.length))),n)new RegExp("("+i+")").test(r)&&(r=r.replace(RegExp.$1,1==RegExp.$1.length?n[i]:("000"+n[i]).substr(("000"+n[i]).length-RegExp.$1.length)));return r}function y(e){return e===_}function S(e){return e!==_}function T(e){return null===e}p="object"===("undefined"==typeof window?"undefined":e(window))?window:{};var I={"[object Function]":"function","[object AsyncFunction]":"function","[object String]":"string","[object Object]":"object","[object Boolean]":"boolean","[object Number]":"number","[object Array]":"array"};function b(e){return T(e)||y(e)?String(e):I[{}.toString.call(e)]||"object"}function C(e){return"function"===b(e)}function w(e){return"string"===b(e)}function E(e){return"object"===b(e)}function A(e){return"boolean"===b(e)}function D(e){return"number"===b(e)}function P(e){return Array.isArray?Array.isArray(e):"array"===b(e)}function R(t){if(null==t)return[];if(P(t))return t;var r=e(t.length),n=e(t);if("number"!==r||t.alert||"string"===n||"function"===n&&(!("item"in t)||"number"!==r))return[t];for(var i=[],o=0,a=t.length;o<a;o++)i[o]=t[o];return i}var x,k,F={debug:!1,showConsoleError:!1};function O(){return x}function W(e){x=e}function N(e,t,r,n){if(F.debug&&k&&C(k.log)){var i=v((new Date).getTime()),o=R(arguments);k.log(["[",i,"] ",o].join(""))}}function M(e,t,r,n){if((F.debug||F.showConsoleError)&&k&&C(k.error)){var i=v((new Date).getTime()),o=R(arguments);k.error(["[",i,"] ",o].join(""))}}function L(e,t,r,n){if(F.debug&&k&&C(k.warn)){var i=v((new Date).getTime()),o=R(arguments);k.warn(["[",i,"] ",o].join(""))}}function B(e,t,r,n){if(F.debug&&k&&C(k.info)){var i=v((new Date).getTime()),o=R(arguments);k.info(["[",i,"] ",o].join(""))}}p&&S(p.console)&&(C((k=p.console).log)&&C(k.error)?x={log:N,error:M,info:B,warn:L,debug:function(e,t,r,n){if(F.debug&&k&&C(k.debug)){var i=v((new Date).getTime()),o=R(arguments);k.debug(["[",i,"] ",o].join(""))}}}:(k=!1,x=!1));var U={queue:[],doNextStarted:!1,timer:null,pushToDo:function(e,t,r){U.queue.push({obj:e,method:t,args:r})},doNext:function(){if(U.doNextStarted)if(0!=U.queue.length){var e=U.queue[0],t=e.obj,r=e.method,n=e.args;if(U.queue.splice(0,1),t&&C(t[r])){var i=!1;if(n.length>2){var o=n[n.length-2],a=n[n.length-1];C(o)&&C(a)&&(n[n.length-2]=function(){try{o.apply(t,arguments)}catch(QG){}U.timer=setTimeout(U.doNext,0)},n[n.length-1]=function(){try{a.apply(t,arguments)}catch(QG){}U.timer=setTimeout(U.doNext,0)},i=!0)}try{t[r].apply(t,n)}catch(l){}i||(U.timer=setTimeout(U.doNext,0))}else if(null===t&&C(r)){try{r.apply(null,n)}catch(d){}U.timer=setTimeout(U.doNext,0)}else N("not invoke a function: "+r),U.timer=setTimeout(U.doNext,0)}else U.stop();else U.stop()},start:function(){U.doNextStarted||(U.doNextStarted=!0,U.timer=setTimeout(U.doNext,0))},stop:function(){clearTimeout(U.timer),U.timer=null,U.doNextStarted=!1,U.queue=[]}},V=!0,G=!1;function j(e,t,r){if(e){var n,i,o,a=0,s=e.length;if(r=r||null,y(s)||C(e))for(o=Object.keys(e);a<o.length&&(n=o[a],t.call(r,e[n],n,e)!==G);a++);else for(i=e[0];a<s&&t.call(r,i,a,e)!==G;i=e[++a]);}return e}var H={fire:function(e){var t,r=this;r.exec=r.exec||{},e=e.toLowerCase(),t=Array.prototype.slice.call(arguments,1),j(r.exec[e]||[],(function(e){var n=e.f,i=e.c||r;try{n.apply(i,t)}catch(QG){N(QG)}}))},on:function(e,t,r){var n=this;n.exec=n.exec||{},e=e.toLowerCase(),n.exec[e]=n.exec[e]||[],n.exec[e].push({f:t,c:r})},off:function(e,t,r){var n=this.exec;if(n)if(e)if(e=e.toLowerCase(),t)for(var i=n[e]||[],o=i.length-1;o>=0;o--)i[o]===t&&i.splice(o,1);else n[e]=null;else this.exec=null}};function z(e){return null!=e&&e==e.window}function K(e){e&&/\S/.test(e)&&(p.execScript?p.execScript(e):function(e){p.eval.call(p,e)}(e))}var J,Y,Q,X,q,Z="",$=navigator,ee=!0;if("userAgentData"in $){var te=$.userAgentData,re=[];te.platform&&""!=te.platform&&("brands"in te&&Array.isArray(te.brands)&&te.brands.length>0?re=te.brands:"uaList"in te&&Array.isArray(te.uaList)&&te.uaList.length>0&&(re=te.uaList),re.length>0&&(ee=!1,Q=te.platform.toLowerCase(),Y=function(e,t,r){var n,i,o,a,s,u,c,l,d,f=!1,h=!1,g=!1,p=e.mobile,_=!1,m=Z,v=navigator.maxTouchPoints||0;for(i=t.length,n=0;n<i;n++){var y=t[n].brand.toLowerCase();if(y.indexOf("chrome")>=0){g=!0,m=t[n].version;break}if(y.indexOf("edge")>=0){f=!0,m=t[n].version;break}if(y.indexOf("opera")>=0){h=!0,m=t[n].version;break}}return g||f||h||(g=!0,m="100"),o=/windows/g.test(r),a=/mac/g.test(r),s=/linux/g.test(r),u=/android/g.test(r),c=/harmony/g.test(r),l=/(chromeos|chrome\sos)/g.test(r),d=/iphone/g.test(r),o||u||s||d||(_=/macintel/g.test(r)&&v>1),(u||c||d||_)&&(p=!0),{bUseUserAgent:!1,bWin:o,bMac:a,bLinux:s,bAndroid:u,bHarmonyOS:c,bChromeOS:l,bIE:!1,bEdge:f,bUC:!1,bPlaybook:!1,bBlackBerry:!1,bHuaWeiBrowser:!1,bOpera:h,bFirefox:!1,bChrome:g,bJSDom:!1,biPhone:d,biPad:_,bPad:u&&!e.mobile,bSafari:!1,bMobile:p,strBrowserVersion:m,bHTML5Edition:!0,IEVersion:0,IEMode:0}}(te,re,Q)))}ee&&(X||(X=$.userAgent.toLowerCase()),q||(q=$.platform.toLowerCase()),Y=function(e,t){var r,n=e.toLowerCase(),i=t.toLowerCase(),o=/harmonyos/g.test(n);"linux"==i&&n.indexOf("windows nt")>=0&&(i="harmonyos",o=!0);var a=!o&&/cros/.test(n),s=!o&&/android/g.test(n)||/android/g.test(i),u=/iphone/g.test(n)||/iphone/g.test(i),c=/macintosh/.test(n),l=navigator.maxTouchPoints||0,d=/ipad/g.test(n)||(c||"macintel"==i)&&l>1,f=/ucweb|ucbrowser/g.test(n),h=!f&&/nexus/g.test(n)&&/version\/[\d.]+.*safari\//g.test(n),g=/playbook/g.test(n),_=/hp-tablet/g.test(n),m=/blackberry|bb10/g.test(n),v=/symbian/g.test(n),y=/windows phone/g.test(n),S=/mobile/g.test(n),T=/arm64|aarch64/g.test(n),I=/mips64/g.test(n),b=/huaweibrowser/g.test(n),C=/jsdom/g.test(n),w=g||d||_,E=!w&&!a&&(u||h||m||v||y||s||o||S),A=!E&&!w&&!a,D=A&&/win32|win64|windows/.test(i),P=D&&/win64|x64/.test(n),R=A&&/mac68k|macppc|macintosh|macintel/.test(n),x=A&&/linux/.test(i),k="win64"==i||/wow64|x86_64|win64|x64/.test(n)||T||I,F=/wow64/g.test(n),O=G,W=/opera|opr/g.test(n),N=/360se/g.test(n),M=/maxthon/g.test(n),L=/tencenttraveler|qqbrowser/g.test(n),B=/the world/g.test(n),U=/metasr/g.test(n),j=/avant/g.test(n),H=/firefox|fxios/g.test(n),z=/gecko/g.test(n),K=!(H||b)&&/edge\/|edga\/|edgios\/|edg\//g.test(n),J=!(m||g||f||W||K||b||C)&&/chrome|crios/g.test(n),Y=!1,Q=Z,X=0,q=0,$=Z;if(D&&!K&&!H&&!J){var ee=n.indexOf("msie "),te=n.indexOf("trident"),re=n.indexOf("rv:");Y=-1!=ee||-1!=te||-1!=re}if(!(R||u||d||D||m||g||h)||f||W||K||Y||H||(r=n.match(/version\/([\d.]+).*safari\//))&&(m||g||h||(O=V,J=G),$=r[1]),K){var ne=n.indexOf("edge/");ne>-1?ne+=5:(ne=n.indexOf("edg/"))>-1?ne+=4:(ne=n.indexOf("edga/"))>-1?ne+=5:(ne=n.indexOf("edgios/"))>-1&&(ne+=7),ne>-1&&(r=($=n.slice(ne)).indexOf(" "))>-1&&($=$.slice(0,r))}else if(H)if((r=n.indexOf("firefox/"))>-1){var ie=(r=n.slice(r+8)).indexOf(" ");ie>-1&&(r=r.slice(0,ie)),$=r,(ie=r.indexOf("."))>-1&&(r=$.slice(0,ie))}else(u||d)&&(r=n.indexOf("fxios/"))>-1&&($=r=(r=n.slice(r+6)).slice(0,r.indexOf(" ")));else if(Y){var oe=n.indexOf("msie "),ae=n.indexOf("trident"),se=n.indexOf("rv:");-1!=oe?Q=r=(r=n.slice(oe+5)).slice(0,r.indexOf(";")):-1!=se?Q=r=(r=(r=n.slice(se+3)).slice(0,r.indexOf(";"))).slice(0,r.indexOf(")")):-1!=ae&&(Q=r=(r=n.slice(ae+7)).slice(0,r.indexOf(";"))),$=r}else if(O)(r=$.indexOf("."))>-1&&(r=$.slice(0,r));else if(f)(r=n.indexOf("ucweb"))>-1?$=n.slice(r+5):(r=n.indexOf("ucbrowser/"))>-1&&(r=($=n.slice(r+10)).indexOf(" "))>-1&&($=$.slice(0,r));else if(W)(r=n.indexOf("version/"))>-1?$=n.slice(r+8):(r=n.indexOf("opr/"))>-1&&($=n.slice(r+4));else if(v)(r=n.indexOf("browserng/"))>-1&&($=n.slice(r+10));else if(y)(r=n.indexOf("iemobile/"))>-1&&($=n.slice(r+9));else if(J){var ue=n.indexOf("chrome/");ue>-1?(r=($=n.slice(ue+7)).indexOf(" "))>-1&&($=$.slice(0,r)):(ue=n.indexOf("crios/"))>-1&&(r=($=n.slice(ue+6)).indexOf(" "))>-1&&($=$.slice(0,r)),(r=$.indexOf("."))>-1&&(r=$.slice(0,r))}else if(b){var ce=n.indexOf("huaweibrowser");ce>-1&&(r=($=n.slice(ce+14)).indexOf(" "))>-1&&($=$.slice(0,r))}else if(C){var le=n.indexOf("jsdom");le>-1&&(r=($=n.slice(le+6)).indexOf(" "))>-1&&($=$.slice(0,r))}if(K||Y){var de=window.document;de&&de.documentMode?X=de.documentMode:(X=5,de.compatMode&&"CSS1Compat"==de.compatMode&&(X=7)),Y&&(q=parseInt($))}(R||x)&&(k=!0,R&&(r=n.match(/mac os x (\d+)(_|\.)(\d+)/))&&r.length>3&&(10==r[1]&&r[3]<14||r[1]<10)&&(k=!1)),D||R||x||T||I||(E=!0);var fe=!0;if(Y)if(""===Q||parseInt(Q)>=10){var he=p.Dynamsoft;he&&he.DWT&&he.DWT.IfUseActiveXForIE10Plus&&(fe=G)}else fe=G;return{bUseUserAgent:!0,bWin:D,bMac:R,bLinux:x,bMobile:E,bPad:w,bChromeOS:a,bHarmonyOS:o,bArm64:T,bMips64:I,bEmbed:T||I,bAndroid:s,biPhone:u,biPad:d,bWin64:P,bWOW64:F,bOSx64:k,bIE:Y,bEdge:K,bChrome:J,bFirefox:H,bSafari:O,bOpera:W,bNexus:h,bUC:f,b360SE:N,bMaxthon:M,bTencentTraveler:L,bTheWorld:B,bMetaSr:U,bAvant:j,bHuaWeiBrowser:b,bJSDom:C,bGecko:z,bHTML5Edition:fe,strBrowserVersion:$,IEVersion:q,IEMode:X}}(X,q));var ne=null===(J=null===document||void 0===document?void 0:document.location)||void 0===J?void 0:J.protocol;function ie(e){return Y.bGecko&&"mousewheel"===e?"DOMMouseScroll":e}function oe(e,t,r){var n=ie(t);e&&e.addEventListener(n,r,!1)}function ae(e,t,r){var n=ie(t);e&&e.removeEventListener(n,r,!1)}function se(e){var t=e||p.event;t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation(),t.returnValue=!1,t.cancelBubble=!0}function ue(e,t){var r=p.document.createEvent("HTMLEvents");r.initEvent(e,V,V),t.dispatchEvent&&t.dispatchEvent(r)}ne||(ne="https:"),Y.protocol=ne,Y.bSSL="https:"===ne,Y.bFileSystem="https:"!==ne&&"http:"!==ne;var ce,le,de,fe,he=p.document,ge=[],pe=ge.push,_e=ge.slice,me=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ve=function(){le()};function ye(e,t,r,n){var i,o,a,s=t&&t.ownerDocument,u=t?t.nodeType:9;if(r=r||[],"string"!=typeof e||!e||1!==u&&9!==u&&11!==u)return r;if(!n&&((t?t.ownerDocument||t:he)!==de&&le(t),t=t||de,11!==u&&(a=me.exec(e))))if(i=a[1]){if(9===u){if(!(o=t.getElementById(i)))return r;if(o.id===i)return r.push(o),r}else if(s&&(o=s.getElementById(i))&&fe(t,o)&&o.id===i)return r.push(o),r}else{if(a[2])return pe.apply(r,t.getElementsByTagName(e)),r;if((i=a[3])&&t.getElementsByClassName)return pe.apply(r,t.getElementsByClassName(i)),r}return r}pe.apply(_e.call(he.childNodes),he.childNodes),le=ye.setDocument=function(e){var t,r=e?e.ownerDocument||e:he;return r!==de&&9===r.nodeType&&r.documentElement?(he!==(de=r)&&(t=de.defaultView)&&t.top!==t&&(t.addEventListener?t.addEventListener("unload",ve,!1):t.attachEvent&&t.attachEvent("onunload",ve)),fe=function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},de):de},ye.contains=function(e,t){return(e.ownerDocument||e)!==de&&le(e),fe(e,t)},ye.error=function(e){throw new Error("Syntax error: "+e)},ce=ye.getText=function(e){var t,r="",n=0,i=e.nodeType;if(i){if(1===i||9===i||11===i){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)r+=ce(e)}else if(3===i||4===i)return e.nodeValue}else for(;t=e[n++];)r+=ce(t);return r},le();var Se={encodeChars:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",decodeChars:[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1]},Te={UTF16ToUTF8:function(e){for(var t,r,n=[],i=e.length,o=0;o<i;o++){var a=e.charCodeAt(o);if(a>0&&a<=127)n.push(e.charAt(o));else if(a>=128&&a<=2047)t=192|a>>6&31,r=128|63&a,n.push(String.fromCharCode(t),String.fromCharCode(r));else if(a>=2048&&a<=65535){t=224|a>>12&15,r=128|a>>6&63;var s=128|63&a;n.push(String.fromCharCode(t),String.fromCharCode(r),String.fromCharCode(s))}}return n.join("")},UTF8ToUTF16:function(e){var t,r,n,i,o=[],a=e.length;for(t=0;t<a;t++)(r=e.charCodeAt(t))>>7&255?6==(r>>5&255)?(i=(31&r)<<6|63&(n=e.charCodeAt(++t)),o.push(String.fromCharCode(i))):14==(r>>4&255)&&(i=(255&(r<<4|(n=e.charCodeAt(++t))>>2&15))<<8|(3&n)<<6|63&e.charCodeAt(++t),o.push(String.fromCharCode(i))):o.push(e.charAt(t));return o.join("")},encode:function(e){for(var t,r,n,i=this.UTF16ToUTF8(e),o=[],a=0,s=i.length;a<s;){if(t=255&i.charCodeAt(a++),a==s){o.push(Se.encodeChars.charAt(t>>2)),o.push(Se.encodeChars.charAt((3&t)<<4)),o.push("==");break}if(r=i.charCodeAt(a++),a==s){o.push(Se.encodeChars.charAt(t>>2)),o.push(Se.encodeChars.charAt((3&t)<<4|(240&r)>>4)),o.push(Se.encodeChars.charAt((15&r)<<2)),o.push("=");break}n=i.charCodeAt(a++),o.push(Se.encodeChars.charAt(t>>2)),o.push(Se.encodeChars.charAt((3&t)<<4|(240&r)>>4)),o.push(Se.encodeChars.charAt((15&r)<<2|(192&n)>>6)),o.push(Se.encodeChars.charAt(63&n))}return o.join("")},encodeArray:function(e){for(var t,r,n,i=[],o=0,a=e.length;o<a;){if(t=255&e[o++],o==a){i.push(Se.encodeChars.charAt(t>>2)),i.push(Se.encodeChars.charAt((3&t)<<4)),i.push("==");break}if(r=255&e[o++],o==a){i.push(Se.encodeChars.charAt(t>>2)),i.push(Se.encodeChars.charAt((3&t)<<4|(240&r)>>4)),i.push(Se.encodeChars.charAt((15&r)<<2)),i.push("=");break}n=255&e[o++],i.push(Se.encodeChars.charAt(t>>2)),i.push(Se.encodeChars.charAt((3&t)<<4|(240&r)>>4)),i.push(Se.encodeChars.charAt((15&r)<<2|(192&n)>>6)),i.push(Se.encodeChars.charAt(63&n))}return i.join("")},decode:function(e,t){for(var r,n,i,o,a=this,s=[],u=0,c=e.length;u<c;){do{r=Se.decodeChars[255&e.charCodeAt(u++)]}while(u<c&&-1==r);if(-1==r)break;do{n=Se.decodeChars[255&e.charCodeAt(u++)]}while(u<c&&-1==n);if(-1==n)break;t?s.push(r<<2|(48&n)>>4):s.push(String.fromCharCode(r<<2|(48&n)>>4));do{if(61==(i=255&e.charCodeAt(u++)))return t?s:a.UTF8ToUTF16(s.join(""));i=Se.decodeChars[i]}while(u<c&&-1==i);if(-1==i)break;t?s.push((15&n)<<4|(60&i)>>2):s.push(String.fromCharCode((15&n)<<4|(60&i)>>2));do{if(61==(o=255&e.charCodeAt(u++)))return t?s:a.UTF8ToUTF16(s.join(""));o=Se.decodeChars[o]}while(u<c&&-1==o);if(-1==o)break;t?s.push((3&i)<<6|o):s.push(String.fromCharCode((3&i)<<6|o))}return t?s:a.UTF8ToUTF16(s.join(""))}},Ie={fromUTF16:function(e){for(var t,r=[],n=0,i=e.length;n<i;)(t=e.charCodeAt(n))>=1&&t<=127?r.push(e.charAt(n)):t>2047?(r.push(String.fromCharCode(224|t>>12&15)),r.push(String.fromCharCode(128|t>>6&63)),r.push(String.fromCharCode(128|63&t))):(r.push(String.fromCharCode(192|t>>6&31)),r.push(String.fromCharCode(128|63&t))),n++;return r.join("")},toUTF16:function(e){for(var t,r,n,i=[],o=0,a=e.length;o<a;)switch((t=e.charCodeAt(o++))>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:i.push(e.charAt(o-1));break;case 12:case 13:r=e.charCodeAt(o++),i.push(String.fromCharCode((31&t)<<6|63&r));break;case 14:r=e.charCodeAt(o++),n=e.charCodeAt(o++),i.push(String.fromCharCode((15&t)<<12|(63&r)<<6|63&n))}return i.join("")}},be="undefined"!=typeof self?self:global,Ce=be.btoa?function(e){return be.btoa(e)}:function(e){for(var t,r,n=String(e),i=0,o=Se.encodeChars,a="";n.charAt(0|i)||(o="=",i%1);a+=o.charAt(63&t>>8-i%1*8)){if((r=n.charCodeAt(i+=3/4))>255)throw new Error("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");t=t<<8|r}return a},we=be.atob?function(e){return be.atob(e)}:function(e){var t=String(e).replace(/[=]+$/,"");if(t.length%4==1)throw new Error("'atob' failed: The string to be decoded is not correctly encoded.");for(var r,n,i=0,o=0,a="";n=t.charAt(o++);~n&&(r=i%4?64*r+n:n,i++%4)?a+=String.fromCharCode(255&r>>(-2*i&6)):0)n=Se.encodeChars.indexOf(n);return a};function Ee(t){if(null==t||"object"!=e(t))return t;var r,n,i;if(t instanceof Date)return(r=new Date).setTime(t.getTime()),r;if(t instanceof Array){for(r=[],i=t.length,n=0;n<i;n++)r[n]=Ee(t[n]);return r}if(t instanceof Object){for(n in r={},t)t.hasOwnProperty(n)&&(r[n]=Ee(t[n]));return r}return 0}function Ae(e){return Math.random().toString(16).substring(2,2+e)}function De(e){var t=[Ae(8),"-",Ae(4),"-",Ae(4),"-",Ae(4),"-",Ae(8)];return e&&t.unshift(e),t.join("")}var Pe=Date.now||function(){return+new Date},Re=function(){return""+Pe()};function xe(){for(var e,t=Pe()%1e4,r=[],n=0;n<5;n++)e=Math.floor(10*Math.random()),0!=n||0!=e?r.push(e):n=-1;return t<10?r.push("000"):t<100?r.push("00"):t<1e3&&r.push("0"),r.push(t),r.join("")}function ke(e,t){var r;for(r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e}var Fe=!1;"wakeLock"in navigator&&(Fe=!0);var Oe=null;function We(){Fe&&(null==Oe?function(){!function(e,t,r,n){new(r||(r=Promise))((function(i,o){function a(e){try{u(n.next(e))}catch(QG){o(QG)}}function s(e){try{u(n.throw(e))}catch(QG){o(QG)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))}(this,void 0,void 0,m.mark((function e(){return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.wakeLock.request("screen");case 3:Oe=e.sent,e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),Oe=null;case 9:case"end":return e.stop()}}),e,null,[[0,6]])})))}():Oe.release().then((function(){Oe=null})))}function Ne(){return Oe}var Me=Array.prototype;function Le(e,t,r){return Me.filter.call(e,t,r||this)}function Be(e,t){return Me.indexOf.call(t,e)}function Ue(e){var t,r,n=[],i=e.length;for(t=0;t<i;t++){for(r=t+1;r<i;r++)e[t]===e[r]&&(r=++t);n.push(e[t])}return n}var Ve=/^(\/?)([\s\S]+\/(?!$)|\/)?((?:\.{1,2}$|[\s\S]+?)?(\.[^.\/]*)?)$/;function Ge(e,t){var r,n=[];for(r=0;r<e.length;r++){var i=e[r];i&&"."!==i&&(".."===i?n.length&&".."!==n[n.length-1]?n.pop():t&&n.push(".."):n.push(i))}return n}function je(e){var t="/"===e.charAt(0),r="/"===e.slice(-1);return(e=Ge(Le(e.split("/"),(function(e){return!!e})),!t).join("/"))||t||(e="."),e&&r&&(e+="/"),(t?"/":"")+e}var He=function(){function e(){t(this,e)}return s(e,[{key:"resolve",value:function(){var e,t,r="",n=arguments,i=!1;for(e=n.length-1;e>=0&&!i;e--)w(t=n[e])&&t&&(r=t+"/"+r,i="/"===t.charAt(0));return(i?"/":"")+Ge(Le(r.split("/"),(function(e){return!!e})),!i).join("/")||"."}},{key:"join",value:function(){return je(Le(R(arguments),(function(e){return e&&w(e)})).join("/"))}},{key:"relative",value:function(e,t){e=je(e),t=je(t);var r,n,i=Le(e.split("/"),(function(e){return!!e})),o=[],a=Le(t.split("/"),(function(e){return!!e})),s=Math.min(i.length,a.length);for(r=0;r<s&&i[r]===a[r];r++);for(n=r;r<i.length;)o.push(".."),r++;return(o=o.concat(a.slice(n))).join("/")}},{key:"basename",value:function(e,t){var r;return r=(e.match(Ve)||[])[3]||"",t&&r&&r.slice(-1*t.length)===t&&(r=r.slice(0,-1*t.length)),r}},{key:"dirname",value:function(e){var t=e.match(Ve)||[],r=t[1]||"",n=t[2]||"";return r||n?(n&&(n=n.substring(0,n.length-1)),r+n):"."}},{key:"extname",value:function(e){return(e.match(Ve)||[])[4]||""}}]),e}(),ze={}.hasOwnProperty;function Ke(e){if(!e||"object"!==b(e)||e.nodeType||e.window==e)return G;var t,r;try{if((r=e.constructor)&&!ze(e,"constructor")&&!ze(r.prototype,"isPrototypeOf"))return G}catch(QG){return G}for(t in e);return y(t)||ze(e,t)}var Je="object"===("undefined"==typeof HTMLElement?"undefined":e(HTMLElement));function Ye(t){return Je?t instanceof HTMLElement:t&&"object"===e(t)&&(1===t.nodeType||9===t.nodeType)&&"string"==typeof t.nodeName}function Qe(e){var t=e;if(Ye(e))for(;!t&&t!=document.body;)t=t.parentNode;else t=0;return!!t}function Xe(e,t){return 0===e.lastIndexOf(t,0)}function qe(e,t){var r=e.length-t.length;return r>=0&&e.indexOf(t,r)===r}function Ze(e){return null==e?Z:String.prototype.trim.call(e)}function $e(e){var t;if(e)for(t in e)if(!y(t))return!1;return!0}function et(e){return w(e)?e.replace(/[^\x20-\x7E]/g,""):e}function tt(e,t,r){return e.replace(new RegExp(t,"gi"),r)}function rt(e){return e.charAt(0).toUpperCase()+e.substr(1)}var nt="none",it={getOffset:function(e,t,r){var n,i;e=e||p.event;for(var o,a,s=r||e.target,u=0,c=0,l=0,d=0,f=!1,h=p.document;s&&!isNaN(s.offsetLeft)&&!isNaN(s.offsetTop);)a=s.scrollLeft,o=s.scrollTop,"BODY"===s.tagName?f?(a=0,o=0):(a|=null===(n=h.documentElement)||void 0===n?void 0:n.scrollLeft,o|=null===(i=h.documentElement)||void 0===i?void 0:i.scrollTop):"fixed"===s.style.position&&(f=!0),u+=s.offsetLeft-a,c+=s.offsetTop-o,s=s.offsetParent;return t&&(l=t.Left,d=t.Top),{x:u=e.clientX-u-l,y:c=e.clientY-c-d}},getElDimensions:function(e,t){var r,n;return e?(r=e.style.display,e.style.display="",n=t?{offsetTop:e.offsetTop,offsetLeft:e.offsetLeft,offsetWidth:e.offsetWidth,offsetHeight:e.offsetHeight}:{clientTop:e.clientTop,clientLeft:e.clientLeft,clientWidth:e.clientWidth?e.clientWidth:parseInt(e.style.width)?parseInt(e.style.width):0,clientHeight:e.clientHeight?e.clientHeight:parseInt(e.style.height)?parseInt(e.style.height):0},e.style.display=r,n):{offsetTop:0,offsetLeft:0,offsetWidth:0,offsetHeight:0}}};function ot(e){return document.getElementById(e)}function at(e){var t=w(e)?ot(e):e;t&&(t.length>0&&(t=t[0]),t.style.display=nt)}function st(e){var t=w(e)?ot(e):e;t&&(t.length>0&&(t=t[0]),t.style.display=Z)}function ut(e){var t=w(e)?ot(e):e;t&&(t.length>0&&(t=t[0]),t.style.display===nt?t.style.display=Z:t.style.display=nt)}function ct(e){if(e)for(;e.firstChild;)e.removeChild(e.firstChild)}function lt(e){return encodeURIComponent(String(e))}function dt(e){return decodeURIComponent(e.replace(/\+/g," "))}var ft=!0,ht=document,gt=ht&&ht.documentElement,pt=ht.getElementsByTagName("head")[0]||gt,_t=ht.createElement("script").readyState?function(e,t){var r=e.onreadystatechange;e.onreadystatechange=function(){var n=e.readyState;"loaded"===n||"complete"===n?(e.onreadystatechange=null,r&&r(),t.call(this,{type:"load",path:[e]})):"loading"===n||t.call(this,{type:"error",path:[e]})}}:function(e,t){e.addEventListener("load",t,G),e.addEventListener("error",t,G)};function mt(e,t,r){return vt(e,t,!1,r)}function vt(e,t,r,n){var i,o,a=n;if(C(a)||(a=function(){}),w(e)&&e!=Z)return i=ht.createElement("script"),o=["",e].join(Z),i.src=o,t&&(i.async=ft),i.charset="utf-8",_t(i,a),r?pt.appendChild(i):pt.insertBefore(i,pt.firstChild),i;a()}function yt(e,t,r){return St(e,t,!1,r)}function St(e,t,r,n){var i=n;if(C(i)||(i=function(){}),Y.bJSDom)i("ok");else if(P(e)){var o=e.length,a=function(e){e&&"load"==e.type?o--:(e&&"error"==e.type&&M(["Failed to load resource: ",e.target.src,"."].join("")),i()),o<=0&&i("ok")};o<=0?i("ok"):j(e,(function(e){vt(e,t,r,a)}))}else i()}function Tt(e,t){return It(e,!1,t)}function It(e,t,r){var n,i=r;if(C(i)||(i=!1),w(e)&&e!=Z){if(!Y.bJSDom)return(n=ht.createElement("link")).href=e,n.rel="stylesheet",n.async=ft,i&&_t(n,i),t?pt.appendChild(n):pt.insertBefore(n,pt.firstChild),n;i&&i()}else i&&i()}function bt(e,t){return Ct(e,!1,t)}function Ct(e,t,r){if(Y.bJSDom)r&&r("ok");else if(P(e)){var n=e.length,i=function(e){e&&"load"==e.type&&n--,e&&"load"!=e.type&&(e&&"error"==e.type&&M(["Failed to load resource: ",e.target.href,"."].join("")),r()),n<=0&&r("ok")};j(e,(function(e){It(e,t,i)}))}else r&&r()}function wt(e){var t,r;if(!Y.bJSDom){var n=document;if(n&&w(r=e.body)&&r!=Z){(t=n.createElement("script")).charset="utf-8",Y.bIE?t.text=r:t.appendChild(n.createTextNode(r)),e.language?t.language=e.language:t.language="javascript",e.type?t.type=e.type:t.type="text/javascript";var i=n&&n.documentElement,o=n.getElementsByTagName("head")[0]||i;o.insertBefore(t,o.firstChild)}}}function Et(e){wt({body:e})}function At(e){wt({body:e,language:"vbscript",type:"text/vbscript"})}var Dt,Pt,Rt=function(){function e(){t(this,e),this.nil=void 0,this.bNode=!1,this.noop=function(){},this.mix=ke,this.clone=Ee,this.keys=Object.keys,this.now=Re,this.getFormatedNow=v,this.getRandom=xe,this.guid=De,this.get=ot,this.show=st,this.hide=at,this.toggle=ut,this.empty=ct,this.stringify=p.JSON.stringify,this.parse=p.JSON.parse,this.isDef=S,this.isUndef=y,this.isUndefined=y,this.isNull=T,this.isNaN=isNaN,this.isFunction=C,this.isString=w,this.isObject=E,this.isBoolean=A,this.isNumber=D,this.isArray=P,this.type=b,this.isPlainObject=Ke,this.isDOM=Ye,this.isDOMInBody=Qe,this.each=j,this.getLogger=O,this.setLogger=W,this.log=N,this.error=M,this.warn=L,this.info=B,this.filter=Le,this.indexOf=Be,this.uniq=Ue,this.startsWith=Xe,this.endsWith=qe,this.replaceAll=tt,this.upperCaseFirst=rt,this.removeNonPrintableChar=et,this.trim=Ze,this.makeArray=R,this.isEmptyObject=$e,this.Path=new He,this.DOM=it,this.isWindow=z,this.globalEval=K,this.obj={customEvent:H},this.addEventListener=oe,this.removeEventListener=ae,this.stopPropagation=se,this.fireEvent=ue,this.base64=Te,this.utf8=Ie,this.btoa=Ce,this.atob=we,this.asyncQueue=U,this.sizzle=ye,this.toggleWakeLock=We,this.getWakeLock=Ne,this.urlEncode=lt,this.urlDecode=dt,this.scriptOnload=_t,this.addAllCss=Ct,this.getAllCss=bt,this.addCss=It,this.getCss=Tt,this.addScripts=St,this.getScripts=yt,this.addScript=vt,this.getScript=mt,this.addJS=Et,this.addVBS=At}return s(e,[{key:"debug",get:function(){return F.debug},set:function(e){F.debug=e}},{key:"showConsoleError",get:function(){return F.debug},set:function(e){F.showConsoleError=e}}]),e}(),xt=new Rt,kt=20230515,Ft=!!("object"==("undefined"==typeof global?"undefined":e(global))&&global.process&&global.process.release&&global.process.release.name&&"undefined"==typeof HTMLCanvasElement),Ot=Ft?global:self||{},Wt=Ot.Dynamsoft;function Nt(e){return Math.floor(e)}function Mt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Wt?Wt.Lib||(Wt.Lib={}):(Wt={Lib:{},DWT:{}},Ot&&(Ot.Dynamsoft=Wt)),Dt=xt.mix(Wt.Lib,xt),(Pt=Wt).DWT||(Pt.DWT={}),Pt.DWT.LTS||(Pt.DWT.LTS={}),Pt.Lib.UI||(Pt.Lib.UI={}),Pt.Lib.html5||(Pt.Lib.html5={});var Lt={exports:{}},Bt=function(e){return e&&e.Math===Math&&e},Ut=Bt("object"==typeof o&&o)||Bt("object"==typeof window&&window)||Bt("object"==typeof self&&self)||Bt("object"==typeof u&&u)||Bt("object"==typeof u&&u)||function(){return this}()||Function("return this")(),Vt=function(e){try{return!!e()}catch(Qb){return!0}},Gt=!Vt((function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")})),jt=Gt,Ht=Function.prototype,zt=Ht.apply,Kt=Ht.call,Jt="object"==typeof Reflect&&Reflect.apply||(jt?Kt.bind(zt):function(){return Kt.apply(zt,arguments)}),Yt=Gt,Qt=Function.prototype,Xt=Qt.call,qt=Yt&&Qt.bind.bind(Xt,Xt),Zt=Yt?qt:function(e){return function(){return Xt.apply(e,arguments)}},$t=Zt,er=$t({}.toString),tr=$t("".slice),rr=function(e){return tr(er(e),8,-1)},nr=rr,ir=Zt,or=function(e){if("Function"===nr(e))return ir(e)},ar="object"==typeof document&&document.all,sr=void 0===ar&&void 0!==ar?function(e){return"function"==typeof e||e===ar}:function(e){return"function"==typeof e},ur={},cr=!Vt((function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]})),lr=Gt,dr=Function.prototype.call,fr=lr?dr.bind(dr):function(){return dr.apply(dr,arguments)},hr={},gr={}.propertyIsEnumerable,pr=Object.getOwnPropertyDescriptor,_r=pr&&!gr.call({1:2},1);hr.f=_r?function(e){var t=pr(this,e);return!!t&&t.enumerable}:gr;var mr,vr,yr=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},Sr=Vt,Tr=rr,Ir=Object,br=Zt("".split),Cr=Sr((function(){return!Ir("z").propertyIsEnumerable(0)}))?function(e){return"String"===Tr(e)?br(e,""):Ir(e)}:Ir,wr=function(e){return null===e||void 0===e},Er=wr,Ar=TypeError,Dr=function(e){if(Er(e))throw new Ar("Can't call method on "+e);return e},Pr=Cr,Rr=Dr,xr=function(e){return Pr(Rr(e))},kr=sr,Fr=function(e){return"object"==typeof e?null!==e:kr(e)},Or={},Wr=Or,Nr=Ut,Mr=sr,Lr=function(e){return Mr(e)?e:void 0},Br=function(e,t){return arguments.length<2?Lr(Wr[e])||Lr(Nr[e]):Wr[e]&&Wr[e][t]||Nr[e]&&Nr[e][t]},Ur=Zt({}.isPrototypeOf),Vr="undefined"!=typeof navigator&&String(navigator.userAgent)||"",Gr=Ut,jr=Vr,Hr=Gr.process,zr=Gr.Deno,Kr=Hr&&Hr.versions||zr&&zr.version,Jr=Kr&&Kr.v8;Jr&&(vr=(mr=Jr.split("."))[0]>0&&mr[0]<4?1:+(mr[0]+mr[1])),!vr&&jr&&(!(mr=jr.match(/Edge\/(\d+)/))||mr[1]>=74)&&(mr=jr.match(/Chrome\/(\d+)/))&&(vr=+mr[1]);var Yr=vr,Qr=Yr,Xr=Vt,qr=Ut.String,Zr=!!Object.getOwnPropertySymbols&&!Xr((function(){var e=Symbol("symbol detection");return!qr(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&Qr&&Qr<41})),$r=Zr&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,en=Br,tn=sr,rn=Ur,nn=Object,on=$r?function(e){return"symbol"==typeof e}:function(e){var t=en("Symbol");return tn(t)&&rn(t.prototype,nn(e))},an=String,sn=function(e){try{return an(e)}catch(Qb){return"Object"}},un=sr,cn=sn,ln=TypeError,dn=function(e){if(un(e))return e;throw new ln(cn(e)+" is not a function")},fn=dn,hn=wr,gn=function(e,t){var r=e[t];return hn(r)?void 0:fn(r)},pn=fr,_n=sr,mn=Fr,vn=TypeError,yn={exports:{}},Sn=Ut,Tn=Object.defineProperty,In=Ut,bn="__core-js_shared__",Cn=yn.exports=In[bn]||function(e,t){try{Tn(Sn,e,{value:t,configurable:!0,writable:!0})}catch(Qb){Sn[e]=t}return t}(bn,{});(Cn.versions||(Cn.versions=[])).push({version:"3.37.0",mode:"pure",copyright:"\xa9 2014-2024 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.37.0/LICENSE",source:"https://github.com/zloirock/core-js"});var wn=yn.exports,En=wn,An=function(e,t){return En[e]||(En[e]=t||{})},Dn=Dr,Pn=Object,Rn=function(e){return Pn(Dn(e))},xn=Rn,kn=Zt({}.hasOwnProperty),Fn=Object.hasOwn||function(e,t){return kn(xn(e),t)},On=Zt,Wn=0,Nn=Math.random(),Mn=On(1..toString),Ln=function(e){return"Symbol("+(void 0===e?"":e)+")_"+Mn(++Wn+Nn,36)},Bn=An,Un=Fn,Vn=Ln,Gn=Zr,jn=$r,Hn=Ut.Symbol,zn=Bn("wks"),Kn=jn?Hn.for||Hn:Hn&&Hn.withoutSetter||Vn,Jn=function(e){return Un(zn,e)||(zn[e]=Gn&&Un(Hn,e)?Hn[e]:Kn("Symbol."+e)),zn[e]},Yn=fr,Qn=Fr,Xn=on,qn=gn,Zn=TypeError,$n=Jn("toPrimitive"),ei=function(e,t){if(!Qn(e)||Xn(e))return e;var r,n=qn(e,$n);if(n){if(void 0===t&&(t="default"),r=Yn(n,e,t),!Qn(r)||Xn(r))return r;throw new Zn("Can't convert object to primitive value")}return void 0===t&&(t="number"),function(e,t){var r,n;if("string"===t&&_n(r=e.toString)&&!mn(n=pn(r,e)))return n;if(_n(r=e.valueOf)&&!mn(n=pn(r,e)))return n;if("string"!==t&&_n(r=e.toString)&&!mn(n=pn(r,e)))return n;throw new vn("Can't convert object to primitive value")}(e,t)},ti=on,ri=function(e){var t=ei(e,"string");return ti(t)?t:t+""},ni=Fr,ii=Ut.document,oi=ni(ii)&&ni(ii.createElement),ai=function(e){return oi?ii.createElement(e):{}},si=ai,ui=!cr&&!Vt((function(){return 7!==Object.defineProperty(si("div"),"a",{get:function(){return 7}}).a})),ci=cr,li=fr,di=hr,fi=yr,hi=xr,gi=ri,pi=Fn,_i=ui,mi=Object.getOwnPropertyDescriptor;ur.f=ci?mi:function(e,t){if(e=hi(e),t=gi(t),_i)try{return mi(e,t)}catch(Qb){}if(pi(e,t))return fi(!li(di.f,e,t),e[t])};var vi=Vt,yi=sr,Si=/#|\.prototype\./,Ti=function(e,t){var r=bi[Ii(e)];return r===wi||r!==Ci&&(yi(t)?vi(t):!!t)},Ii=Ti.normalize=function(e){return String(e).replace(Si,".").toLowerCase()},bi=Ti.data={},Ci=Ti.NATIVE="N",wi=Ti.POLYFILL="P",Ei=Ti,Ai=dn,Di=Gt,Pi=or(or.bind),Ri=function(e,t){return Ai(e),void 0===t?e:Di?Pi(e,t):function(){return e.apply(t,arguments)}},xi={},ki=cr&&Vt((function(){return 42!==Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype})),Fi=Fr,Oi=String,Wi=TypeError,Ni=function(e){if(Fi(e))return e;throw new Wi(Oi(e)+" is not an object")},Mi=cr,Li=ui,Bi=ki,Ui=Ni,Vi=ri,Gi=TypeError,ji=Object.defineProperty,Hi=Object.getOwnPropertyDescriptor,zi="enumerable",Ki="configurable",Ji="writable";xi.f=Mi?Bi?function(e,t,r){if(Ui(e),t=Vi(t),Ui(r),"function"==typeof e&&"prototype"===t&&"value"in r&&Ji in r&&!r[Ji]){var n=Hi(e,t);n&&n[Ji]&&(e[t]=r.value,r={configurable:Ki in r?r[Ki]:n[Ki],enumerable:zi in r?r[zi]:n[zi],writable:!1})}return ji(e,t,r)}:ji:function(e,t,r){if(Ui(e),t=Vi(t),Ui(r),Li)try{return ji(e,t,r)}catch(Qb){}if("get"in r||"set"in r)throw new Gi("Accessors not supported");return"value"in r&&(e[t]=r.value),e};var Yi=xi,Qi=yr,Xi=cr?function(e,t,r){return Yi.f(e,t,Qi(1,r))}:function(e,t,r){return e[t]=r,e},qi=Ut,Zi=Jt,$i=or,eo=sr,to=ur.f,ro=Ei,no=Or,io=Ri,oo=Xi,ao=Fn,so=function(e){var t=function(r,n,i){if(this instanceof t){switch(arguments.length){case 0:return new e;case 1:return new e(r);case 2:return new e(r,n)}return new e(r,n,i)}return Zi(e,this,arguments)};return t.prototype=e.prototype,t},uo=function(e,t){var r,n,i,o,a,s,u,c,l,d=e.target,f=e.global,h=e.stat,g=e.proto,p=f?qi:h?qi[d]:qi[d]&&qi[d].prototype,_=f?no:no[d]||oo(no,d,{})[d],m=_.prototype;for(o in t)n=!(r=ro(f?o:d+(h?".":"#")+o,e.forced))&&p&&ao(p,o),s=_[o],n&&(u=e.dontCallGetSet?(l=to(p,o))&&l.value:p[o]),a=n&&u?u:t[o],(r||g||typeof s!=typeof a)&&(c=e.bind&&n?io(a,qi):e.wrap&&n?so(a):g&&eo(a)?$i(a):a,(e.sham||a&&a.sham||s&&s.sham)&&oo(c,"sham",!0),oo(_,o,c),g&&(ao(no,i=d+"Prototype")||oo(no,i,{}),oo(no[i],o,a),e.real&&m&&(r||!m[o])&&oo(m,o,a)))},co=uo,lo=cr,fo=xi.f;co({target:"Object",stat:!0,forced:Object.defineProperty!==fo,sham:!lo},{defineProperty:fo});var ho=Or.Object,go=Lt.exports=function(e,t,r){return ho.defineProperty(e,t,r)};ho.defineProperty.sham&&(go.sham=!0);var po=Lt.exports,_o=po,mo=c(_o),vo=rr,yo=Array.isArray||function(e){return"Array"===vo(e)},So=Math.ceil,To=Math.floor,Io=Math.trunc||function(e){var t=+e;return(t>0?To:So)(t)},bo=function(e){var t=+e;return t!=t||0===t?0:Io(t)},Co=bo,wo=Math.min,Eo=function(e){var t=Co(e);return t>0?wo(t,9007199254740991):0},Ao=Eo,Do=function(e){return Ao(e.length)},Po=TypeError,Ro=function(e){if(e>9007199254740991)throw Po("Maximum allowed index exceeded");return e},xo=cr,ko=xi,Fo=yr,Oo=function(e,t,r){xo?ko.f(e,t,Fo(0,r)):e[t]=r},Wo={};Wo[Jn("toStringTag")]="z";var No="[object z]"===String(Wo),Mo=No,Lo=sr,Bo=rr,Uo=Jn("toStringTag"),Vo=Object,Go="Arguments"===Bo(function(){return arguments}()),jo=Mo?Bo:function(e){var t,r,n;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(r=function(e,t){try{return e[t]}catch(Qb){}}(t=Vo(e),Uo))?r:Go?Bo(t):"Object"===(n=Bo(t))&&Lo(t.callee)?"Arguments":n},Ho=sr,zo=wn,Ko=Zt(Function.toString);Ho(zo.inspectSource)||(zo.inspectSource=function(e){return Ko(e)});var Jo=zo.inspectSource,Yo=Zt,Qo=Vt,Xo=sr,qo=jo,Zo=Jo,$o=function(){},ea=Br("Reflect","construct"),ta=/^\s*(?:class|function)\b/,ra=Yo(ta.exec),na=!ta.test($o),ia=function(e){if(!Xo(e))return!1;try{return ea($o,[],e),!0}catch(Qb){return!1}},oa=function(e){if(!Xo(e))return!1;switch(qo(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return na||!!ra(ta,Zo(e))}catch(Qb){return!0}};oa.sham=!0;var aa=!ea||Qo((function(){var e;return ia(ia.call)||!ia(Object)||!ia((function(){e=!0}))||e}))?oa:ia,sa=yo,ua=aa,ca=Fr,la=Jn("species"),da=Array,fa=function(e,t){return new(function(e){var t;return sa(e)&&(t=e.constructor,(ua(t)&&(t===da||sa(t.prototype))||ca(t)&&null===(t=t[la]))&&(t=void 0)),void 0===t?da:t}(e))(0===t?0:t)},ha=Vt,ga=Yr,pa=Jn("species"),_a=function(e){return ga>=51||!ha((function(){var t=[];return(t.constructor={})[pa]=function(){return{foo:1}},1!==t[e](Boolean).foo}))},ma=uo,va=Vt,ya=yo,Sa=Fr,Ta=Rn,Ia=Do,ba=Ro,Ca=Oo,wa=fa,Ea=_a,Aa=Yr,Da=Jn("isConcatSpreadable"),Pa=Aa>=51||!va((function(){var e=[];return e[Da]=!1,e.concat()[0]!==e})),Ra=function(e){if(!Sa(e))return!1;var t=e[Da];return void 0!==t?!!t:ya(e)};ma({target:"Array",proto:!0,arity:1,forced:!Pa||!Ea("concat")},{concat:function(e){var t,r,n,i,o,a=Ta(this),s=wa(a,0),u=0;for(t=-1,n=arguments.length;t<n;t++)if(Ra(o=-1===t?a:arguments[t]))for(i=Ia(o),ba(u+i),r=0;r<i;r++,u++)r in o&&Ca(s,u,o[r]);else ba(u+1),Ca(s,u++,o);return s.length=u,s}});var xa=jo,ka=String,Fa=function(e){if("Symbol"===xa(e))throw new TypeError("Cannot convert a Symbol value to a string");return ka(e)},Oa={},Wa=bo,Na=Math.max,Ma=Math.min,La=function(e,t){var r=Wa(e);return r<0?Na(r+t,0):Ma(r,t)},Ba=xr,Ua=La,Va=Do,Ga=function(e){return function(t,r,n){var i=Ba(t),o=Va(i);if(0===o)return!e&&-1;var a,s=Ua(n,o);if(e&&r!=r){for(;o>s;)if((a=i[s++])!=a)return!0}else for(;o>s;s++)if((e||s in i)&&i[s]===r)return e||s||0;return!e&&-1}},ja={includes:Ga(!0),indexOf:Ga(!1)},Ha={},za=Fn,Ka=xr,Ja=ja.indexOf,Ya=Ha,Qa=Zt([].push),Xa=function(e,t){var r,n=Ka(e),i=0,o=[];for(r in n)!za(Ya,r)&&za(n,r)&&Qa(o,r);for(;t.length>i;)za(n,r=t[i++])&&(~Ja(o,r)||Qa(o,r));return o},qa=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Za=Xa,$a=qa,es=Object.keys||function(e){return Za(e,$a)},ts=cr,rs=ki,ns=xi,is=Ni,os=xr,as=es;Oa.f=ts&&!rs?Object.defineProperties:function(e,t){is(e);for(var r,n=os(t),i=as(t),o=i.length,a=0;o>a;)ns.f(e,r=i[a++],n[r]);return e};var ss,us=Br("document","documentElement"),cs=Ln,ls=An("keys"),ds=function(e){return ls[e]||(ls[e]=cs(e))},fs=Ni,hs=Oa,gs=qa,ps=Ha,_s=us,ms=ai,vs="prototype",ys="script",Ss=ds("IE_PROTO"),Ts=function(){},Is=function(e){return"<"+ys+">"+e+"</"+ys+">"},bs=function(e){e.write(Is("")),e.close();var t=e.parentWindow.Object;return e=null,t},Cs=function(){try{ss=new ActiveXObject("htmlfile")}catch(Qb){}var e,t,r;Cs="undefined"!=typeof document?document.domain&&ss?bs(ss):(t=ms("iframe"),r="java"+ys+":",t.style.display="none",_s.appendChild(t),t.src=String(r),(e=t.contentWindow.document).open(),e.write(Is("document.F=Object")),e.close(),e.F):bs(ss);for(var n=gs.length;n--;)delete Cs[vs][gs[n]];return Cs()};ps[Ss]=!0;var ws=Object.create||function(e,t){var r;return null!==e?(Ts[vs]=fs(e),r=new Ts,Ts[vs]=null,r[Ss]=e):r=Cs(),void 0===t?r:hs.f(r,t)},Es={},As=Xa,Ds=qa.concat("length","prototype");Es.f=Object.getOwnPropertyNames||function(e){return As(e,Ds)};var Ps={},Rs=Zt([].slice),xs=rr,ks=xr,Fs=Es.f,Os=Rs,Ws="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];Ps.f=function(e){return Ws&&"Window"===xs(e)?function(e){try{return Fs(e)}catch(Qb){return Os(Ws)}}(e):Fs(ks(e))};var Ns={};Ns.f=Object.getOwnPropertySymbols;var Ms=Xi,Ls=function(e,t,r,n){return n&&n.enumerable?e[t]=r:Ms(e,t,r),e},Bs=xi,Us=function(e,t,r){return Bs.f(e,t,r)},Vs={},Gs=Jn;Vs.f=Gs;var js,Hs,zs,Ks=Or,Js=Fn,Ys=Vs,Qs=xi.f,Xs=function(e){var t=Ks.Symbol||(Ks.Symbol={});Js(t,e)||Qs(t,e,{value:Ys.f(e)})},qs=fr,Zs=Br,$s=Jn,eu=Ls,tu=function(){var e=Zs("Symbol"),t=e&&e.prototype,r=t&&t.valueOf,n=$s("toPrimitive");t&&!t[n]&&eu(t,n,(function(e){return qs(r,this)}),{arity:1})},ru=jo,nu=No?{}.toString:function(){return"[object "+ru(this)+"]"},iu=No,ou=xi.f,au=Xi,su=Fn,uu=nu,cu=Jn("toStringTag"),lu=function(e,t,r,n){var i=r?e:e&&e.prototype;i&&(su(i,cu)||ou(i,cu,{configurable:!0,value:t}),n&&!iu&&au(i,"toString",uu))},du=sr,fu=Ut.WeakMap,hu=du(fu)&&/native code/.test(String(fu)),gu=Ut,pu=Fr,_u=Xi,mu=Fn,vu=wn,yu=ds,Su=Ha,Tu="Object already initialized",Iu=gu.TypeError,bu=gu.WeakMap;if(hu||vu.state){var Cu=vu.state||(vu.state=new bu);Cu.get=Cu.get,Cu.has=Cu.has,Cu.set=Cu.set,js=function(e,t){if(Cu.has(e))throw new Iu(Tu);return t.facade=e,Cu.set(e,t),t},Hs=function(e){return Cu.get(e)||{}},zs=function(e){return Cu.has(e)}}else{var wu=yu("state");Su[wu]=!0,js=function(e,t){if(mu(e,wu))throw new Iu(Tu);return t.facade=e,_u(e,wu,t),t},Hs=function(e){return mu(e,wu)?e[wu]:{}},zs=function(e){return mu(e,wu)}}var Eu={set:js,get:Hs,has:zs,enforce:function(e){return zs(e)?Hs(e):js(e,{})},getterFor:function(e){return function(t){var r;if(!pu(t)||(r=Hs(t)).type!==e)throw new Iu("Incompatible receiver, "+e+" required");return r}}},Au=Ri,Du=Cr,Pu=Rn,Ru=Do,xu=fa,ku=Zt([].push),Fu=function(e){var t=1===e,r=2===e,n=3===e,i=4===e,o=6===e,a=7===e,s=5===e||o;return function(u,c,l,d){for(var f,h,g=Pu(u),p=Du(g),_=Ru(p),m=Au(c,l),v=0,y=d||xu,S=t?y(u,_):r||a?y(u,0):void 0;_>v;v++)if((s||v in p)&&(h=m(f=p[v],v,g),e))if(t)S[v]=h;else if(h)switch(e){case 3:return!0;case 5:return f;case 6:return v;case 2:ku(S,f)}else switch(e){case 4:return!1;case 7:ku(S,f)}return o?-1:n||i?i:S}},Ou={forEach:Fu(0),map:Fu(1),filter:Fu(2),some:Fu(3),every:Fu(4),find:Fu(5),findIndex:Fu(6),filterReject:Fu(7)},Wu=uo,Nu=Ut,Mu=fr,Lu=Zt,Bu=cr,Uu=Zr,Vu=Vt,Gu=Fn,ju=Ur,Hu=Ni,zu=xr,Ku=ri,Ju=Fa,Yu=yr,Qu=ws,Xu=es,qu=Es,Zu=Ps,$u=Ns,ec=ur,tc=xi,rc=Oa,nc=hr,ic=Ls,oc=Us,ac=An,sc=Ha,uc=Ln,cc=Jn,lc=Vs,dc=Xs,fc=tu,hc=lu,gc=Eu,pc=Ou.forEach,_c=ds("hidden"),mc="Symbol",vc="prototype",yc=gc.set,Sc=gc.getterFor(mc),Tc=Object[vc],Ic=Nu.Symbol,bc=Ic&&Ic[vc],Cc=Nu.RangeError,wc=Nu.TypeError,Ec=Nu.QObject,Ac=ec.f,Dc=tc.f,Pc=Zu.f,Rc=nc.f,xc=Lu([].push),kc=ac("symbols"),Fc=ac("op-symbols"),Oc=ac("wks"),Wc=!Ec||!Ec[vc]||!Ec[vc].findChild,Nc=function(e,t,r){var n=Ac(Tc,t);n&&delete Tc[t],Dc(e,t,r),n&&e!==Tc&&Dc(Tc,t,n)},Mc=Bu&&Vu((function(){return 7!==Qu(Dc({},"a",{get:function(){return Dc(this,"a",{value:7}).a}})).a}))?Nc:Dc,Lc=function(e,t){var r=kc[e]=Qu(bc);return yc(r,{type:mc,tag:e,description:t}),Bu||(r.description=t),r},Bc=function(e,t,r){e===Tc&&Bc(Fc,t,r),Hu(e);var n=Ku(t);return Hu(r),Gu(kc,n)?(r.enumerable?(Gu(e,_c)&&e[_c][n]&&(e[_c][n]=!1),r=Qu(r,{enumerable:Yu(0,!1)})):(Gu(e,_c)||Dc(e,_c,Yu(1,Qu(null))),e[_c][n]=!0),Mc(e,n,r)):Dc(e,n,r)},Uc=function(e,t){Hu(e);var r=zu(t),n=Xu(r).concat(Hc(r));return pc(n,(function(t){Bu&&!Mu(Vc,r,t)||Bc(e,t,r[t])})),e},Vc=function(e){var t=Ku(e),r=Mu(Rc,this,t);return!(this===Tc&&Gu(kc,t)&&!Gu(Fc,t))&&(!(r||!Gu(this,t)||!Gu(kc,t)||Gu(this,_c)&&this[_c][t])||r)},Gc=function(e,t){var r=zu(e),n=Ku(t);if(r!==Tc||!Gu(kc,n)||Gu(Fc,n)){var i=Ac(r,n);return!i||!Gu(kc,n)||Gu(r,_c)&&r[_c][n]||(i.enumerable=!0),i}},jc=function(e){var t=Pc(zu(e)),r=[];return pc(t,(function(e){Gu(kc,e)||Gu(sc,e)||xc(r,e)})),r},Hc=function(e){var t=e===Tc,r=Pc(t?Fc:zu(e)),n=[];return pc(r,(function(e){!Gu(kc,e)||t&&!Gu(Tc,e)||xc(n,kc[e])})),n};Uu||(Ic=function(){if(ju(bc,this))throw new wc("Symbol is not a constructor");var e=arguments.length&&void 0!==arguments[0]?Ju(arguments[0]):void 0,t=uc(e),r=function(e){var n=void 0===this?Nu:this;n===Tc&&Mu(r,Fc,e),Gu(n,_c)&&Gu(n[_c],t)&&(n[_c][t]=!1);var i=Yu(1,e);try{Mc(n,t,i)}catch(Qb){if(!(Qb instanceof Cc))throw Qb;Nc(n,t,i)}};return Bu&&Wc&&Mc(Tc,t,{configurable:!0,set:r}),Lc(t,e)},ic(bc=Ic[vc],"toString",(function(){return Sc(this).tag})),ic(Ic,"withoutSetter",(function(e){return Lc(uc(e),e)})),nc.f=Vc,tc.f=Bc,rc.f=Uc,ec.f=Gc,qu.f=Zu.f=jc,$u.f=Hc,lc.f=function(e){return Lc(cc(e),e)},Bu&&oc(bc,"description",{configurable:!0,get:function(){return Sc(this).description}})),Wu({global:!0,constructor:!0,wrap:!0,forced:!Uu,sham:!Uu},{Symbol:Ic}),pc(Xu(Oc),(function(e){dc(e)})),Wu({target:mc,stat:!0,forced:!Uu},{useSetter:function(){Wc=!0},useSimple:function(){Wc=!1}}),Wu({target:"Object",stat:!0,forced:!Uu,sham:!Bu},{create:function(e,t){return void 0===t?Qu(e):Uc(Qu(e),t)},defineProperty:Bc,defineProperties:Uc,getOwnPropertyDescriptor:Gc}),Wu({target:"Object",stat:!0,forced:!Uu},{getOwnPropertyNames:jc}),fc(),hc(Ic,mc),sc[_c]=!0;var zc=Zr&&!!Symbol.for&&!!Symbol.keyFor,Kc=uo,Jc=Br,Yc=Fn,Qc=Fa,Xc=An,qc=zc,Zc=Xc("string-to-symbol-registry"),$c=Xc("symbol-to-string-registry");Kc({target:"Symbol",stat:!0,forced:!qc},{for:function(e){var t=Qc(e);if(Yc(Zc,t))return Zc[t];var r=Jc("Symbol")(t);return Zc[t]=r,$c[r]=t,r}});var el=uo,tl=Fn,rl=on,nl=sn,il=zc,ol=An("symbol-to-string-registry");el({target:"Symbol",stat:!0,forced:!il},{keyFor:function(e){if(!rl(e))throw new TypeError(nl(e)+" is not a symbol");if(tl(ol,e))return ol[e]}});var al=yo,sl=sr,ul=rr,cl=Fa,ll=Zt([].push),dl=uo,fl=Br,hl=Jt,gl=fr,pl=Zt,_l=Vt,ml=sr,vl=on,yl=Rs,Sl=Zr,Tl=String,Il=fl("JSON","stringify"),bl=pl(/./.exec),Cl=pl("".charAt),wl=pl("".charCodeAt),El=pl("".replace),Al=pl(1..toString),Dl=/[\uD800-\uDFFF]/g,Pl=/^[\uD800-\uDBFF]$/,Rl=/^[\uDC00-\uDFFF]$/,xl=!Sl||_l((function(){var e=fl("Symbol")("stringify detection");return"[null]"!==Il([e])||"{}"!==Il({a:e})||"{}"!==Il(Object(e))})),kl=_l((function(){return'"\\udf06\\ud834"'!==Il("\udf06\ud834")||'"\\udead"'!==Il("\udead")})),Fl=function(e,t){var r=yl(arguments),n=function(e){if(sl(e))return e;if(al(e)){for(var t=e.length,r=[],n=0;n<t;n++){var i=e[n];"string"==typeof i?ll(r,i):"number"!=typeof i&&"Number"!==ul(i)&&"String"!==ul(i)||ll(r,cl(i))}var o=r.length,a=!0;return function(e,t){if(a)return a=!1,t;if(al(this))return t;for(var n=0;n<o;n++)if(r[n]===e)return t}}}(t);if(ml(n)||void 0!==e&&!vl(e))return r[1]=function(e,t){if(ml(n)&&(t=gl(n,this,Tl(e),t)),!vl(t))return t},hl(Il,null,r)},Ol=function(e,t,r){var n=Cl(r,t-1),i=Cl(r,t+1);return bl(Pl,e)&&!bl(Rl,i)||bl(Rl,e)&&!bl(Pl,n)?"\\u"+Al(wl(e,0),16):e};Il&&dl({target:"JSON",stat:!0,arity:3,forced:xl||kl},{stringify:function(e,t,r){var n=yl(arguments),i=hl(xl?Fl:Il,null,n);return kl&&"string"==typeof i?El(i,Dl,Ol):i}});var Wl=Ns,Nl=Rn;uo({target:"Object",stat:!0,forced:!Zr||Vt((function(){Wl.f(1)}))},{getOwnPropertySymbols:function(e){var t=Wl.f;return t?t(Nl(e)):[]}}),Xs("asyncIterator"),Xs("hasInstance"),Xs("isConcatSpreadable"),Xs("iterator"),Xs("match"),Xs("matchAll"),Xs("replace"),Xs("search"),Xs("species"),Xs("split");var Ml=tu;Xs("toPrimitive"),Ml();var Ll=Br,Bl=lu;Xs("toStringTag"),Bl(Ll("Symbol"),"Symbol"),Xs("unscopables"),lu(Ut.JSON,"JSON",!0);var Ul,Vl,Gl,jl=Or.Symbol,Hl={},zl=cr,Kl=Fn,Jl=Function.prototype,Yl=zl&&Object.getOwnPropertyDescriptor,Ql=Kl(Jl,"name"),Xl={EXISTS:Ql,PROPER:Ql&&"something"===function(){}.name,CONFIGURABLE:Ql&&(!zl||zl&&Yl(Jl,"name").configurable)},ql=!Vt((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype})),Zl=Fn,$l=sr,ed=Rn,td=ql,rd=ds("IE_PROTO"),nd=Object,id=nd.prototype,od=td?nd.getPrototypeOf:function(e){var t=ed(e);if(Zl(t,rd))return t[rd];var r=t.constructor;return $l(r)&&t instanceof r?r.prototype:t instanceof nd?id:null},ad=Vt,sd=sr,ud=Fr,cd=ws,ld=od,dd=Ls,fd=Jn("iterator"),hd=!1;[].keys&&("next"in(Gl=[].keys())?(Vl=ld(ld(Gl)))!==Object.prototype&&(Ul=Vl):hd=!0);var gd=!ud(Ul)||ad((function(){var e={};return Ul[fd].call(e)!==e}));sd((Ul=gd?{}:cd(Ul))[fd])||dd(Ul,fd,(function(){return this}));var pd={IteratorPrototype:Ul,BUGGY_SAFARI_ITERATORS:hd},_d=pd.IteratorPrototype,md=ws,vd=yr,yd=lu,Sd=Hl,Td=function(){return this},Id=function(e,t,r,n){var i=t+" Iterator";return e.prototype=md(_d,{next:vd(+!n,r)}),yd(e,i,!1,!0),Sd[i]=Td,e},bd=Zt,Cd=dn,wd=Fr,Ed=String,Ad=TypeError,Dd=Fr,Pd=Dr,Rd=function(e){if(function(e){return wd(e)||null===e}(e))return e;throw new Ad("Can't set "+Ed(e)+" as a prototype")},xd=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,r={};try{(e=function(e,t,r){try{return bd(Cd(Object.getOwnPropertyDescriptor(e,t)[r]))}catch(Qb){}}(Object.prototype,"__proto__","set"))(r,[]),t=r instanceof Array}catch(Qb){}return function(r,n){return Pd(r),Rd(n),Dd(r)?(t?e(r,n):r.__proto__=n,r):r}}():void 0),kd=uo,Fd=fr,Od=Id,Wd=od,Nd=lu,Md=Ls,Ld=Hl,Bd=Xl.PROPER,Ud=pd.BUGGY_SAFARI_ITERATORS,Vd=Jn("iterator"),Gd="keys",jd="values",Hd="entries",zd=function(){return this},Kd=function(e,t,r,n,i,o,a){Od(r,t,n);var s,u,c,l=function(e){if(e===i&&p)return p;if(!Ud&&e&&e in h)return h[e];switch(e){case Gd:case jd:case Hd:return function(){return new r(this,e)}}return function(){return new r(this)}},d=t+" Iterator",f=!1,h=e.prototype,g=h[Vd]||h["@@iterator"]||i&&h[i],p=!Ud&&g||l(i),_="Array"===t&&h.entries||g;if(_&&(s=Wd(_.call(new e)))!==Object.prototype&&s.next&&(Nd(s,d,!0,!0),Ld[d]=zd),Bd&&i===jd&&g&&g.name!==jd&&(f=!0,p=function(){return Fd(g,this)}),i)if(u={values:l(jd),keys:o?p:l(Gd),entries:l(Hd)},a)for(c in u)(Ud||f||!(c in h))&&Md(h,c,u[c]);else kd({target:t,proto:!0,forced:Ud||f},u);return a&&h[Vd]!==p&&Md(h,Vd,p,{name:i}),Ld[t]=p,u},Jd=function(e,t){return{value:e,done:t}},Yd=xr,Qd=Hl,Xd=Eu;xi.f;var qd=Kd,Zd=Jd,$d="Array Iterator",ef=Xd.set,tf=Xd.getterFor($d);qd(Array,"Array",(function(e,t){ef(this,{type:$d,target:Yd(e),index:0,kind:t})}),(function(){var e=tf(this),t=e.target,r=e.index++;if(!t||r>=t.length)return e.target=void 0,Zd(void 0,!0);switch(e.kind){case"keys":return Zd(r,!1);case"values":return Zd(t[r],!1)}return Zd([r,t[r]],!1)}),"values"),Qd.Arguments=Qd.Array;var rf=Ut,nf=lu,of=Hl;for(var af in{CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0})nf(rf[af],af),of[af]=of.Array;var sf=jl,uf=Jn,cf=xi.f,lf=uf("metadata"),df=Function.prototype;void 0===df[lf]&&cf(df,lf,{value:null}),Xs("asyncDispose"),Xs("dispose"),Xs("metadata");var ff=sf,hf=Zt,gf=Br("Symbol"),pf=gf.keyFor,_f=hf(gf.prototype.valueOf),mf=gf.isRegisteredSymbol||function(e){try{return void 0!==pf(_f(e))}catch(Qb){return!1}};uo({target:"Symbol",stat:!0},{isRegisteredSymbol:mf});for(var vf=An,yf=Br,Sf=Zt,Tf=on,If=Jn,bf=yf("Symbol"),Cf=bf.isWellKnownSymbol,wf=yf("Object","getOwnPropertyNames"),Ef=Sf(bf.prototype.valueOf),Af=vf("wks"),Df=0,Pf=wf(bf),Rf=Pf.length;Df<Rf;Df++)try{var xf=Pf[Df];Tf(bf[xf])&&If(xf)}catch(Qb){}var kf=function(e){if(Cf&&Cf(e))return!0;try{for(var t=Ef(e),r=0,n=wf(Af),i=n.length;r<i;r++)if(Af[n[r]]==t)return!0}catch(Qb){}return!1};uo({target:"Symbol",stat:!0,forced:!0},{isWellKnownSymbol:kf}),Xs("customMatcher"),Xs("observable"),uo({target:"Symbol",stat:!0,name:"isRegisteredSymbol"},{isRegistered:mf}),uo({target:"Symbol",stat:!0,name:"isWellKnownSymbol",forced:!0},{isWellKnown:kf}),Xs("matcher"),Xs("metadataKey"),Xs("patternMatch"),Xs("replaceAll");var Ff=ff,Of=c(Ff),Wf=Zt,Nf=bo,Mf=Fa,Lf=Dr,Bf=Wf("".charAt),Uf=Wf("".charCodeAt),Vf=Wf("".slice),Gf=function(e){return function(t,r){var n,i,o=Mf(Lf(t)),a=Nf(r),s=o.length;return a<0||a>=s?e?"":void 0:(n=Uf(o,a))<55296||n>56319||a+1===s||(i=Uf(o,a+1))<56320||i>57343?e?Bf(o,a):n:e?Vf(o,a,a+2):i-56320+(n-55296<<10)+65536}},jf={codeAt:Gf(!1),charAt:Gf(!0)},Hf=jf.charAt,zf=Fa,Kf=Eu,Jf=Kd,Yf=Jd,Qf="String Iterator",Xf=Kf.set,qf=Kf.getterFor(Qf);Jf(String,"String",(function(e){Xf(this,{type:Qf,string:zf(e),index:0})}),(function(){var e,t=qf(this),r=t.string,n=t.index;return n>=r.length?Yf(void 0,!0):(e=Hf(r,n),t.index+=e.length,Yf(e,!1))}));var Zf=Vs.f("iterator"),$f=c(Zf);function eh(e){return eh="function"==typeof Of&&"symbol"==typeof $f?function(e){return typeof e}:function(e){return e&&"function"==typeof Of&&e.constructor===Of&&e!==Of.prototype?"symbol":typeof e},eh(e)}var th=c(Vs.f("toPrimitive"));function rh(e){var t=function(e,t){if("object"!==eh(e)||null===e)return e;var r=e[th];if(void 0!==r){var n=r.call(e,"string");if("object"!==eh(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===eh(t)?t:String(t)}function nh(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),mo(e,rh(n.key),n)}}function ih(e,t,r){return t&&nh(e.prototype,t),r&&nh(e,r),mo(e,"prototype",{writable:!1}),e}var oh="\t\n\v\f\r \xa0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff",ah=Dr,sh=Fa,uh=oh,ch=Zt("".replace),lh=RegExp("^["+uh+"]+"),dh=RegExp("(^|[^"+uh+"])["+uh+"]+$"),fh=function(e){return function(t){var r=sh(ah(t));return 1&e&&(r=ch(r,lh,"")),2&e&&(r=ch(r,dh,"$1")),r}},hh={start:fh(1),end:fh(2),trim:fh(3)},gh=Xl.PROPER,ph=Vt,_h=oh,mh=hh.trim;uo({target:"String",proto:!0,forced:function(e){return ph((function(){return!!_h[e]()||"\u200b\x85\u180e"!=="\u200b\x85\u180e"[e]()||gh&&_h[e].name!==e}))}("trim")},{trim:function(){return mh(this)}});var vh=Ut,yh=Or,Sh=function(e,t){var r=yh[e+"Prototype"],n=r&&r[t];if(n)return n;var i=vh[e],o=i&&i.prototype;return o&&o[t]},Th=Sh("String","trim"),Ih=Ur,bh=Th,Ch=String.prototype,wh=c((function(e){var t=e.trim;return"string"==typeof e||e===Ch||Ih(Ch,e)&&t===Ch.trim?bh:t})),Eh=Vt,Ah=function(e,t){var r=[][e];return!!r&&Eh((function(){r.call(null,t||function(){return 1},1)}))},Dh=uo,Ph=ja.indexOf,Rh=Ah,xh=or([].indexOf),kh=!!xh&&1/xh([1],1,-0)<0;Dh({target:"Array",proto:!0,forced:kh||!Rh("indexOf")},{indexOf:function(e){var t=arguments.length>1?arguments[1]:void 0;return kh?xh(this,e,t)||0:Ph(this,e,t)}});var Fh=Sh("Array","indexOf"),Oh=Ur,Wh=Fh,Nh=Array.prototype,Mh=c((function(e){var t=e.indexOf;return e===Nh||Oh(Nh,e)&&t===Nh.indexOf?Wh:t})),Lh=Sh("Array","keys"),Bh=jo,Uh=Fn,Vh=Ur,Gh=Lh,jh=Array.prototype,Hh={DOMTokenList:!0,NodeList:!0},zh=c((function(e){var t=e.keys;return e===jh||Vh(jh,e)&&t===jh.keys||Uh(Hh,Bh(e))?Gh:t})),Kh=uo,Jh=yo,Yh=aa,Qh=Fr,Xh=La,qh=Do,Zh=xr,$h=Oo,eg=Jn,tg=Rs,rg=_a("slice"),ng=eg("species"),ig=Array,og=Math.max;Kh({target:"Array",proto:!0,forced:!rg},{slice:function(e,t){var r,n,i,o=Zh(this),a=qh(o),s=Xh(e,a),u=Xh(void 0===t?a:t,a);if(Jh(o)&&(r=o.constructor,(Yh(r)&&(r===ig||Jh(r.prototype))||Qh(r)&&null===(r=r[ng]))&&(r=void 0),r===ig||void 0===r))return tg(o,s,u);for(n=new(void 0===r?ig:r)(og(u-s,0)),i=0;s<u;s++,i++)s in o&&$h(n,i,o[s]);return n.length=i,n}});var ag=Sh("Array","slice"),sg=Ur,ug=ag,cg=Array.prototype,lg=function(e){var t=e.slice;return e===cg||sg(cg,e)&&t===cg.slice?ug:t},dg=c(lg),fg=Ut,hg=Vt,gg=Zt,pg=Fa,_g=hh.trim,mg=oh,vg=fg.parseInt,yg=fg.Symbol,Sg=yg&&yg.iterator,Tg=/^[+-]?0x/i,Ig=gg(Tg.exec),bg=8!==vg(mg+"08")||22!==vg(mg+"0x16")||Sg&&!hg((function(){vg(Object(Sg))}))?function(e,t){var r=_g(pg(e));return vg(r,t>>>0||(Ig(Tg,r)?16:10))}:vg;uo({global:!0,forced:parseInt!==bg},{parseInt:bg});var Cg=c(Or.parseInt);uo({target:"Array",stat:!0},{isArray:yo});var wg=Or.Array.isArray,Eg=c(wg),Ag="function"==typeof Bun&&Bun&&"string"==typeof Bun.version,Dg=TypeError,Pg=function(e,t){if(e<t)throw new Dg("Not enough arguments");return e},Rg=Ut,xg=Jt,kg=sr,Fg=Ag,Og=Vr,Wg=Rs,Ng=Pg,Mg=Rg.Function,Lg=/MSIE .\./.test(Og)||Fg&&function(){var e=Rg.Bun.version.split(".");return e.length<3||"0"===e[0]&&(e[1]<3||"3"===e[1]&&"0"===e[2])}(),Bg=function(e,t){var r=t?2:1;return Lg?function(n,i){var o=Ng(arguments.length,1)>r,a=kg(n)?n:Mg(n),s=o?Wg(arguments,r):[],u=o?function(){xg(a,this,s)}:a;return t?e(u,i):e(u)}:e},Ug=uo,Vg=Ut,Gg=Bg(Vg.setInterval,!0);Ug({global:!0,bind:!0,forced:Vg.setInterval!==Gg},{setInterval:Gg});var jg=uo,Hg=Ut,zg=Bg(Hg.setTimeout,!0);jg({global:!0,bind:!0,forced:Hg.setTimeout!==zg},{setTimeout:zg});var Kg=c(Or.setTimeout),Jg=cr,Yg=yo,Qg=TypeError,Xg=Object.getOwnPropertyDescriptor,qg=Jg&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(Qb){return Qb instanceof TypeError}}(),Zg=sn,$g=TypeError,ep=uo,tp=Rn,rp=La,np=bo,ip=Do,op=qg?function(e,t){if(Yg(e)&&!Xg(e,"length").writable)throw new Qg("Cannot set read only .length");return e.length=t}:function(e,t){return e.length=t},ap=Ro,sp=fa,up=Oo,cp=function(e,t){if(!delete e[t])throw new $g("Cannot delete property "+Zg(t)+" of "+Zg(e))},lp=_a("splice"),dp=Math.max,fp=Math.min;ep({target:"Array",proto:!0,forced:!lp},{splice:function(e,t){var r,n,i,o,a,s,u=tp(this),c=ip(u),l=rp(e,c),d=arguments.length;for(0===d?r=n=0:1===d?(r=0,n=c-l):(r=d-2,n=fp(dp(np(t),0),c-l)),ap(c+r-n),i=sp(u,n),o=0;o<n;o++)(a=l+o)in u&&up(i,o,u[a]);if(i.length=n,r<n){for(o=l;o<c-n;o++)s=o+r,(a=o+n)in u?u[s]=u[a]:cp(u,s);for(o=c;o>c-n+r;o--)cp(u,o-1)}else if(r>n)for(o=c-n;o>l;o--)s=o+r-1,(a=o+n-1)in u?u[s]=u[a]:cp(u,s);for(o=0;o<r;o++)u[o+l]=arguments[o+2];return op(u,c-n+r),i}});var hp=Sh("Array","splice"),gp=Ur,pp=hp,_p=Array.prototype,mp=c((function(e){var t=e.splice;return e===_p||gp(_p,e)&&t===_p.splice?pp:t})),vp=Br,yp=Es,Sp=Ns,Tp=Ni,Ip=Zt([].concat),bp=vp("Reflect","ownKeys")||function(e){var t=yp.f(Tp(e)),r=Sp.f;return r?Ip(t,r(e)):t},Cp=Fn,wp=bp,Ep=ur,Ap=xi,Dp=Fr,Pp=Xi,Rp=Error,xp=Zt("".replace),kp=String(new Rp("zxcasd").stack),Fp=/\n\s*at [^:]*:[^\n]*/,Op=Fp.test(kp),Wp=yr,Np=!Vt((function(){var e=new Error("a");return!("stack"in e)||(Object.defineProperty(e,"stack",Wp(1,7)),7!==e.stack)})),Mp=Xi,Lp=Np,Bp=Error.captureStackTrace,Up=Hl,Vp=Jn("iterator"),Gp=Array.prototype,jp=function(e){return void 0!==e&&(Up.Array===e||Gp[Vp]===e)},Hp=jo,zp=gn,Kp=wr,Jp=Hl,Yp=Jn("iterator"),Qp=function(e){if(!Kp(e))return zp(e,Yp)||zp(e,"@@iterator")||Jp[Hp(e)]},Xp=fr,qp=dn,Zp=Ni,$p=sn,e_=Qp,t_=TypeError,r_=function(e,t){var r=arguments.length<2?e_(e):t;if(qp(r))return Zp(Xp(r,e));throw new t_($p(e)+" is not iterable")},n_=fr,i_=Ni,o_=gn,a_=function(e,t,r){var n,i;i_(e);try{if(!(n=o_(e,"return"))){if("throw"===t)throw r;return r}n=n_(n,e)}catch(Qb){i=!0,n=Qb}if("throw"===t)throw r;if(i)throw n;return i_(n),r},s_=Ri,u_=fr,c_=Ni,l_=sn,d_=jp,f_=Do,h_=Ur,g_=r_,p_=Qp,__=a_,m_=TypeError,v_=function(e,t){this.stopped=e,this.result=t},y_=v_.prototype,S_=function(e,t,r){var n,i,o,a,s,u,c,l=r&&r.that,d=!(!r||!r.AS_ENTRIES),f=!(!r||!r.IS_RECORD),h=!(!r||!r.IS_ITERATOR),g=!(!r||!r.INTERRUPTED),p=s_(t,l),_=function(e){return n&&__(n,"normal",e),new v_(!0,e)},m=function(e){return d?(c_(e),g?p(e[0],e[1],_):p(e[0],e[1])):g?p(e,_):p(e)};if(f)n=e.iterator;else if(h)n=e;else{if(!(i=p_(e)))throw new m_(l_(e)+" is not iterable");if(d_(i)){for(o=0,a=f_(e);a>o;o++)if((s=m(e[o]))&&h_(y_,s))return s;return new v_(!1)}n=g_(e,i)}for(u=f?e.next:n.next;!(c=u_(u,n)).done;){try{s=m(c.value)}catch(Qb){__(n,"throw",Qb)}if("object"==typeof s&&s&&h_(y_,s))return s}return new v_(!1)},T_=Fa,I_=uo,b_=Ur,C_=od,w_=xd,E_=ws,A_=Xi,D_=yr,P_=function(e,t,r,n){Lp&&(Bp?Bp(e,t):Mp(e,"stack",function(e,t){if(Op&&"string"==typeof e&&!Rp.prepareStackTrace)for(;t--;)e=xp(e,Fp,"");return e}(r,n)))},R_=S_,x_=Jn("toStringTag"),k_=Error,F_=[].push,O_=function(e,t){var r,n=b_(W_,this);w_?r=w_(new k_,n?C_(this):W_):(r=n?this:E_(W_),A_(r,x_,"Error")),void 0!==t&&A_(r,"message",function(e,t){return void 0===e?arguments.length<2?"":t:T_(e)}(t)),P_(r,O_,r.stack,1),arguments.length>2&&function(e,t){Dp(t)&&"cause"in t&&Pp(e,"cause",t.cause)}(r,arguments[2]);var i=[];return R_(e,F_,{that:i}),A_(r,"errors",i),r};w_?w_(O_,k_):function(e,t,r){for(var n=wp(t),i=Ap.f,o=Ep.f,a=0;a<n.length;a++){var s=n[a];Cp(e,s)||r&&Cp(r,s)||i(e,s,o(t,s))}}(O_,k_,{name:!0});var W_=O_.prototype=E_(k_.prototype,{constructor:D_(1,O_),message:D_(1,""),name:D_(1,"AggregateError")});I_({global:!0,constructor:!0,arity:2},{AggregateError:O_});var N_,M_,L_,B_,U_="process"===rr(Ut.process),V_=Br,G_=Us,j_=cr,H_=Jn("species"),z_=function(e){var t=V_(e);j_&&t&&!t[H_]&&G_(t,H_,{configurable:!0,get:function(){return this}})},K_=Ur,J_=TypeError,Y_=function(e,t){if(K_(t,e))return e;throw new J_("Incorrect invocation")},Q_=aa,X_=sn,q_=TypeError,Z_=function(e){if(Q_(e))return e;throw new q_(X_(e)+" is not a constructor")},$_=Ni,em=Z_,tm=wr,rm=Jn("species"),nm=function(e,t){var r,n=$_(e).constructor;return void 0===n||tm(r=$_(n)[rm])?t:em(r)},im=/(?:ipad|iphone|ipod).*applewebkit/i.test(Vr),om=Ut,am=Jt,sm=Ri,um=sr,cm=Fn,lm=Vt,dm=us,fm=Rs,hm=ai,gm=Pg,pm=im,_m=U_,mm=om.setImmediate,vm=om.clearImmediate,ym=om.process,Sm=om.Dispatch,Tm=om.Function,Im=om.MessageChannel,bm=om.String,Cm=0,wm={},Em="onreadystatechange";lm((function(){N_=om.location}));var Am=function(e){if(cm(wm,e)){var t=wm[e];delete wm[e],t()}},Dm=function(e){return function(){Am(e)}},Pm=function(e){Am(e.data)},Rm=function(e){om.postMessage(bm(e),N_.protocol+"//"+N_.host)};mm&&vm||(mm=function(e){gm(arguments.length,1);var t=um(e)?e:Tm(e),r=fm(arguments,1);return wm[++Cm]=function(){am(t,void 0,r)},M_(Cm),Cm},vm=function(e){delete wm[e]},_m?M_=function(e){ym.nextTick(Dm(e))}:Sm&&Sm.now?M_=function(e){Sm.now(Dm(e))}:Im&&!pm?(B_=(L_=new Im).port2,L_.port1.onmessage=Pm,M_=sm(B_.postMessage,B_)):om.addEventListener&&um(om.postMessage)&&!om.importScripts&&N_&&"file:"!==N_.protocol&&!lm(Rm)?(M_=Rm,om.addEventListener("message",Pm,!1)):M_=Em in hm("script")?function(e){dm.appendChild(hm("script"))[Em]=function(){dm.removeChild(this),Am(e)}}:function(e){setTimeout(Dm(e),0)});var xm={set:mm,clear:vm},km=Ut,Fm=cr,Om=Object.getOwnPropertyDescriptor,Wm=function(e){if(!Fm)return km[e];var t=Om(km,e);return t&&t.value},Nm=function(){this.head=null,this.tail=null};Nm.prototype={add:function(e){var t={item:e,next:null},r=this.tail;r?r.next=t:this.head=t,this.tail=t},get:function(){var e=this.head;if(e)return null===(this.head=e.next)&&(this.tail=null),e.item}};var Mm,Lm,Bm,Um,Vm,Gm=Nm,jm=/ipad|iphone|ipod/i.test(Vr)&&"undefined"!=typeof Pebble,Hm=/web0s(?!.*chrome)/i.test(Vr),zm=Ut,Km=Wm,Jm=Ri,Ym=xm.set,Qm=Gm,Xm=im,qm=jm,Zm=Hm,$m=U_,ev=zm.MutationObserver||zm.WebKitMutationObserver,tv=zm.document,rv=zm.process,nv=zm.Promise,iv=Km("queueMicrotask");if(!iv){var ov=new Qm,av=function(){var e,t;for($m&&(e=rv.domain)&&e.exit();t=ov.get();)try{t()}catch(Qb){throw ov.head&&Mm(),Qb}e&&e.enter()};Xm||$m||Zm||!ev||!tv?!qm&&nv&&nv.resolve?((Um=nv.resolve(void 0)).constructor=nv,Vm=Jm(Um.then,Um),Mm=function(){Vm(av)}):$m?Mm=function(){rv.nextTick(av)}:(Ym=Jm(Ym,zm),Mm=function(){Ym(av)}):(Lm=!0,Bm=tv.createTextNode(""),new ev(av).observe(Bm,{characterData:!0}),Mm=function(){Bm.data=Lm=!Lm}),iv=function(e){ov.head||Mm(),ov.add(e)}}var sv=iv,uv=function(e){try{return{error:!1,value:e()}}catch(Qb){return{error:!0,value:Qb}}},cv=Ut.Promise,lv="object"==typeof Deno&&Deno&&"object"==typeof Deno.version,dv=!lv&&!U_&&"object"==typeof window&&"object"==typeof document,fv=Ut,hv=cv,gv=sr,pv=Ei,_v=Jo,mv=Jn,vv=dv,yv=lv,Sv=Yr,Tv=hv&&hv.prototype,Iv=mv("species"),bv=!1,Cv=gv(fv.PromiseRejectionEvent),wv=pv("Promise",(function(){var e=_v(hv),t=e!==String(hv);if(!t&&66===Sv)return!0;if(!Tv.catch||!Tv.finally)return!0;if(!Sv||Sv<51||!/native code/.test(e)){var r=new hv((function(e){e(1)})),n=function(e){e((function(){}),(function(){}))};if((r.constructor={})[Iv]=n,!(bv=r.then((function(){}))instanceof n))return!0}return!t&&(vv||yv)&&!Cv})),Ev={CONSTRUCTOR:wv,REJECTION_EVENT:Cv,SUBCLASSING:bv},Av={},Dv=dn,Pv=TypeError,Rv=function(e){var t,r;this.promise=new e((function(e,n){if(void 0!==t||void 0!==r)throw new Pv("Bad Promise constructor");t=e,r=n})),this.resolve=Dv(t),this.reject=Dv(r)};Av.f=function(e){return new Rv(e)};var xv,kv,Fv=uo,Ov=U_,Wv=Ut,Nv=fr,Mv=Ls,Lv=lu,Bv=z_,Uv=dn,Vv=sr,Gv=Fr,jv=Y_,Hv=nm,zv=xm.set,Kv=sv,Jv=uv,Yv=Gm,Qv=Eu,Xv=cv,qv=Av,Zv="Promise",$v=Ev.CONSTRUCTOR,ey=Ev.REJECTION_EVENT,ty=Qv.getterFor(Zv),ry=Qv.set,ny=Xv&&Xv.prototype,iy=Xv,oy=ny,ay=Wv.TypeError,sy=Wv.document,uy=Wv.process,cy=qv.f,ly=cy,dy=!!(sy&&sy.createEvent&&Wv.dispatchEvent),fy="unhandledrejection",hy=function(e){var t;return!(!Gv(e)||!Vv(t=e.then))&&t},gy=function(e,t){var r,n,i,o=t.value,a=1===t.state,s=a?e.ok:e.fail,u=e.resolve,c=e.reject,l=e.domain;try{s?(a||(2===t.rejection&&yy(t),t.rejection=1),!0===s?r=o:(l&&l.enter(),r=s(o),l&&(l.exit(),i=!0)),r===e.promise?c(new ay("Promise-chain cycle")):(n=hy(r))?Nv(n,r,u,c):u(r)):c(o)}catch(Qb){l&&!i&&l.exit(),c(Qb)}},py=function(e,t){e.notified||(e.notified=!0,Kv((function(){for(var r,n=e.reactions;r=n.get();)gy(r,e);e.notified=!1,t&&!e.rejection&&my(e)})))},_y=function(e,t,r){var n,i;dy?((n=sy.createEvent("Event")).promise=t,n.reason=r,n.initEvent(e,!1,!0),Wv.dispatchEvent(n)):n={promise:t,reason:r},!ey&&(i=Wv["on"+e])&&i(n)},my=function(e){Nv(zv,Wv,(function(){var t,r=e.facade,n=e.value;if(vy(e)&&(t=Jv((function(){Ov?uy.emit("unhandledRejection",n,r):_y(fy,r,n)})),e.rejection=Ov||vy(e)?2:1,t.error))throw t.value}))},vy=function(e){return 1!==e.rejection&&!e.parent},yy=function(e){Nv(zv,Wv,(function(){var t=e.facade;Ov?uy.emit("rejectionHandled",t):_y("rejectionhandled",t,e.value)}))},Sy=function(e,t,r){return function(n){e(t,n,r)}},Ty=function(e,t,r){e.done||(e.done=!0,r&&(e=r),e.value=t,e.state=2,py(e,!0))},Iy=function(e,t,r){if(!e.done){e.done=!0,r&&(e=r);try{if(e.facade===t)throw new ay("Promise can't be resolved itself");var n=hy(t);n?Kv((function(){var r={done:!1};try{Nv(n,t,Sy(Iy,r,e),Sy(Ty,r,e))}catch(Qb){Ty(r,Qb,e)}})):(e.value=t,e.state=1,py(e,!1))}catch(Qb){Ty({done:!1},Qb,e)}}};$v&&(oy=(iy=function(e){jv(this,oy),Uv(e),Nv(xv,this);var t=ty(this);try{e(Sy(Iy,t),Sy(Ty,t))}catch(Qb){Ty(t,Qb)}}).prototype,(xv=function(e){ry(this,{type:Zv,done:!1,notified:!1,parent:!1,reactions:new Yv,rejection:!1,state:0,value:void 0})}).prototype=Mv(oy,"then",(function(e,t){var r=ty(this),n=cy(Hv(this,iy));return r.parent=!0,n.ok=!Vv(e)||e,n.fail=Vv(t)&&t,n.domain=Ov?uy.domain:void 0,0===r.state?r.reactions.add(n):Kv((function(){gy(n,r)})),n.promise})),kv=function(){var e=new xv,t=ty(e);this.promise=e,this.resolve=Sy(Iy,t),this.reject=Sy(Ty,t)},qv.f=cy=function(e){return e===iy||void 0===e?new kv(e):ly(e)}),Fv({global:!0,constructor:!0,wrap:!0,forced:$v},{Promise:iy}),Lv(iy,Zv,!1,!0),Bv(Zv);var by=Jn("iterator"),Cy=!1;try{var wy=0,Ey={next:function(){return{done:!!wy++}},return:function(){Cy=!0}};Ey[by]=function(){return this},Array.from(Ey,(function(){throw 2}))}catch(Qb){}var Ay=function(e,t){try{if(!t&&!Cy)return!1}catch(Qb){return!1}var r=!1;try{var n={};n[by]=function(){return{next:function(){return{done:r=!0}}}},e(n)}catch(Qb){}return r},Dy=cv,Py=Ev.CONSTRUCTOR||!Ay((function(e){Dy.all(e).then(void 0,(function(){}))})),Ry=fr,xy=dn,ky=Av,Fy=uv,Oy=S_;uo({target:"Promise",stat:!0,forced:Py},{all:function(e){var t=this,r=ky.f(t),n=r.resolve,i=r.reject,o=Fy((function(){var r=xy(t.resolve),o=[],a=0,s=1;Oy(e,(function(e){var u=a++,c=!1;s++,Ry(r,t,e).then((function(e){c||(c=!0,o[u]=e,--s||n(o))}),i)})),--s||n(o)}));return o.error&&i(o.value),r.promise}});var Wy=uo,Ny=Ev.CONSTRUCTOR;cv&&cv.prototype,Wy({target:"Promise",proto:!0,forced:Ny,real:!0},{catch:function(e){return this.then(void 0,e)}});var My=fr,Ly=dn,By=Av,Uy=uv,Vy=S_;uo({target:"Promise",stat:!0,forced:Py},{race:function(e){var t=this,r=By.f(t),n=r.reject,i=Uy((function(){var i=Ly(t.resolve);Vy(e,(function(e){My(i,t,e).then(r.resolve,n)}))}));return i.error&&n(i.value),r.promise}});var Gy=Av;uo({target:"Promise",stat:!0,forced:Ev.CONSTRUCTOR},{reject:function(e){var t=Gy.f(this);return(0,t.reject)(e),t.promise}});var jy=Ni,Hy=Fr,zy=Av,Ky=function(e,t){if(jy(e),Hy(t)&&t.constructor===e)return t;var r=zy.f(e);return(0,r.resolve)(t),r.promise},Jy=uo,Yy=cv,Qy=Ev.CONSTRUCTOR,Xy=Ky,qy=Br("Promise"),Zy=!Qy;Jy({target:"Promise",stat:!0,forced:!0},{resolve:function(e){return Xy(Zy&&this===qy?Yy:this,e)}});var $y=fr,eS=dn,tS=Av,rS=uv,nS=S_;uo({target:"Promise",stat:!0,forced:Py},{allSettled:function(e){var t=this,r=tS.f(t),n=r.resolve,i=r.reject,o=rS((function(){var r=eS(t.resolve),i=[],o=0,a=1;nS(e,(function(e){var s=o++,u=!1;a++,$y(r,t,e).then((function(e){u||(u=!0,i[s]={status:"fulfilled",value:e},--a||n(i))}),(function(e){u||(u=!0,i[s]={status:"rejected",reason:e},--a||n(i))}))})),--a||n(i)}));return o.error&&i(o.value),r.promise}});var iS=fr,oS=dn,aS=Br,sS=Av,uS=uv,cS=S_,lS="No one promise resolved";uo({target:"Promise",stat:!0,forced:Py},{any:function(e){var t=this,r=aS("AggregateError"),n=sS.f(t),i=n.resolve,o=n.reject,a=uS((function(){var n=oS(t.resolve),a=[],s=0,u=1,c=!1;cS(e,(function(e){var l=s++,d=!1;u++,iS(n,t,e).then((function(e){d||c||(c=!0,i(e))}),(function(e){d||c||(d=!0,a[l]=e,--u||o(new r(a,lS)))}))})),--u||o(new r(a,lS))}));return a.error&&o(a.value),n.promise}});var dS=Av;uo({target:"Promise",stat:!0},{withResolvers:function(){var e=dS.f(this);return{promise:e.promise,resolve:e.resolve,reject:e.reject}}});var fS=uo,hS=cv,gS=Vt,pS=Br,_S=sr,mS=nm,vS=Ky,yS=hS&&hS.prototype;fS({target:"Promise",proto:!0,real:!0,forced:!!hS&&gS((function(){yS.finally.call({then:function(){}},(function(){}))}))},{finally:function(e){var t=mS(this,pS("Promise")),r=_S(e);return this.then(r?function(r){return vS(t,e()).then((function(){return r}))}:e,r?function(r){return vS(t,e()).then((function(){throw r}))}:e)}});var SS=Or.Promise,TS=c(SS),IS=Fr,bS=rr,CS=Jn("match"),wS=TypeError,ES=function(e){if(function(e){var t;return IS(e)&&(void 0!==(t=e[CS])?!!t:"RegExp"===bS(e))}(e))throw new wS("The method doesn't accept regular expressions");return e},AS=Jn("match"),DS=function(e){var t=/./;try{"/./"[e](t)}catch(r){try{return t[AS]=!1,"/./"[e](t)}catch(n){}}return!1},PS=uo,RS=or;ur.f;var xS=Eo,kS=Fa,FS=ES,OS=Dr,WS=DS,NS=RS("".slice),MS=Math.min;PS({target:"String",proto:!0,forced:!WS("endsWith")},{endsWith:function(e){var t=kS(OS(this));FS(e);var r=arguments.length>1?arguments[1]:void 0,n=t.length,i=void 0===r?n:MS(xS(r),n),o=kS(e);return NS(t,i-o.length,i)===o}});var LS=Sh("String","endsWith"),BS=Ur,US=LS,VS=String.prototype,GS=c((function(e){var t=e.endsWith;return"string"==typeof e||e===VS||BS(VS,e)&&t===VS.endsWith?US:t})),jS=Zt,HS=dn,zS=Fr,KS=Fn,JS=Rs,YS=Gt,QS=Function,XS=jS([].concat),qS=jS([].join),ZS={},$S=YS?QS.bind:function(e){var t=HS(this),r=t.prototype,n=JS(arguments,1),i=function(){var r=XS(n,JS(arguments));return this instanceof i?function(e,t,r){if(!KS(ZS,t)){for(var n=[],i=0;i<t;i++)n[i]="a["+i+"]";ZS[t]=QS("C,a","return new C("+qS(n,",")+")")}return ZS[t](e,r)}(t,r.length,r):t.apply(e,r)};return zS(r)&&(i.prototype=r),i},eT=$S;uo({target:"Function",proto:!0,forced:Function.bind!==eT},{bind:eT});var tT=Sh("Function","bind"),rT=Ur,nT=tT,iT=Function.prototype,oT=function(e){var t=e.bind;return e===iT||rT(iT,e)&&t===iT.bind?nT:t},aT=c(oT),sT=Ut,uT=Vt,cT=Fa,lT=hh.trim,dT=oh,fT=Zt("".charAt),hT=sT.parseFloat,gT=sT.Symbol,pT=gT&&gT.iterator,_T=1/hT(dT+"-0")!=-1/0||pT&&!uT((function(){hT(Object(pT))}))?function(e){var t=lT(cT(e)),r=hT(t);return 0===r&&"-"===fT(t,0)?-0:r}:hT;uo({global:!0,forced:parseFloat!==_T},{parseFloat:_T});var mT=c(Or.parseFloat),vT=uo,yT=or;ur.f;var ST=Eo,TT=Fa,IT=ES,bT=Dr,CT=DS,wT=yT("".slice),ET=Math.min;vT({target:"String",proto:!0,forced:!CT("startsWith")},{startsWith:function(e){var t=TT(bT(this));IT(e);var r=ST(ET(arguments.length>1?arguments[1]:void 0,t.length)),n=TT(e);return wT(t,r,r+n.length)===n}});var AT,DT=Sh("String","startsWith"),PT=Ur,RT=DT,xT=String.prototype,kT=c((function(e){var t=e.startsWith;return"string"==typeof e||e===xT||PT(xT,e)&&t===xT.startsWith?RT:t}));function FT(e){var t,r,n="0x";if(/^(rgb|RGB)/.test(e)){var i=e.replace(/[^\d,.]/g,"").split(",");for(r=0;r<3;++r)1==(t=Number(i[r]).toString(16)).length&&(t="0"+t),n+=t;4==i.length?(1==(t=Math.round(255*Number(i[r])).toString(16)).length&&(t="0"+t),n+=t):n+="ff"}else if("transparent"==e)n+="00000000";else if(/^#[0-9a-fA-f]{6}$/.test(e))n+=e.replace(/#/,"")+"ff";else if(/^#[0-9a-fA-f]{3}$/.test(e)){for(r=0;r<3;++r)n+=e[r]+e[r];n+="ff"}else n="-1";return Number(n)}function OT(e){if(e>4294967295||e<0)return null;var t;if(Y.bHTML5Edition)t="rgba("+Math.floor(e/16777216)+","+Math.floor(e/65536)%256+","+Math.floor(e/256)%256+","+e%256/255+")";else if(e%256==0)t="transparent";else{for(t=Math.floor(e/256).toString(16);6!=t.length;)t="0"+t;t="#"+t}return t}function WT(e){var t,r=(e=e||window.event).wheelDelta,n=e.detail;return r&&(t=r/120),n&&(t=-(n%3==0?n/3:n)),t}wh(String.prototype)||(String.prototype.trim=function(){return this.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,Z)}),AT={registedClass:[],registedObjs:[]};var NT={LEFT:0,MIDDLE:1,RIGHT:2};function MT(e){var t=e||window.event;return null==t.which?t.button<2?NT.LEFT:4==t.button?NT.MIDDLE:NT.RIGHT:t.which<2?NT.LEFT:2==t.which?NT.MIDDLE:NT.RIGHT}var LT,BT,UT=/[\-#$\^*()+\[\]{}|\\,.?\s]/g,VT={"&amp;":"&","&gt;":">","&lt;":"<","&#x60;":"`","&#x2F;":"/","&quot;":'"',"&#x27;":"'"},GT={};function jT(e){return e.replace(/\\u([a-f\d]{4})/gi,(function(e,t){return String.fromCharCode(Cg(t,16))}))}function HT(e){return(e+"").replace(function(){if(LT)return LT;var e=Z;return xt.each(VT,(function(t){e+=t+"|"})),e=dg(e).call(e,0,-1),LT=new RegExp(e,"g")}(),(function(e){return GT[e]}))}function zT(e){return e.replace(UT,"\\$&")}function KT(e){return e.replace(function(){if(BT)return BT;var e=Z;return xt.each(GT,(function(t){e+=t+"|"})),e+="&#(\\d{1,5});",BT=new RegExp(e,"g")}(),(function(e,t){return VT[e]||String.fromCharCode(+t)}))}xt.each(VT,(function(e,t){GT[e]=t}));var JT,YT=void 0,QT=function(e){return"function"==typeof e},XT=function(e){return Eg?Eg(e):e instanceof Array},qT=function(e){return!1===e||e===YT||null===e},ZT="undefined",$T=("undefined"==typeof TypeError?"undefined":eh(TypeError))===ZT?Error:TypeError;if(("undefined"==typeof i?"undefined":eh(i))!==ZT&&i.nextTick)JT=i.nextTick;else if(("undefined"==typeof MessageChannel?"undefined":eh(MessageChannel))!==ZT){var eI=new MessageChannel,tI=[];eI.port1.onmessage=function(){tI.length&&tI.shift()()},JT=function(e){tI.push(e),eI.port2.postMessage(0)}}else JT=function(e){Kg(e,0)};function rI(e){JT((function(){throw e}))}function nI(e){return this.then(e,YT)}function iI(e){return this.then(YT,e)}function oI(e,t){return this.then((function(t){return QT(e)?e.apply(null,XT(t)?t:[t]):cI.onlyFuncs?t:e}),t||YT)}function aI(e){function t(){e()}return this.then(t,t),this}function sI(e){return this.then((function(t){return QT(e)?e.apply(null,XT(t)?mp(t).call(t,0,0,void 0)&&t:[void 0,t]):cI.onlyFuncs?t:e}),(function(t){return e(t)}))}function uI(e){return this.then(YT,e?function(t){throw e(t),t}:rI)}var cI=function(){function e(t){Mt(this,e),this.alwaysAsyncFn=null,this.status=0,this.pendings=[],this.promise={then:function(t,r){var n=new e;return this.pendings.push([function(r){try{qT(t)?n.resolve(r):n.resolve(QT(t)?t(r):e.onlyFuncs?r:t)}catch(QG){n.reject(QG)}},function(t){if((qT(r)||!QT(r)&&e.onlyFuncs)&&n.reject(t),r)try{n.resolve(QT(r)?r(t):r)}catch(QG){n.reject(QG)}}]),0!==this.status&&this.alwaysAsyncFn(this.execCallbacks),n.promise},success:nI,error:iI,otherwise:iI,apply:oI,spread:oI,ensure:aI,nodify:sI,rethrow:uI,isPending:function(){return 0===this.status},getStatus:function(){return this.status}},this.alwaysAsyncFn=(YT!==t?t:e.alwaysAsync)?JT:function(e){e()},this.promise.toSource=this.promise.toString=this.promise.valueOf=function(){return void 0===this.value?this:this.value}}return ih(e,[{key:"resolve",value:function(e){var t,r=!1;function n(e){return function(t){return r?void 0:(r=!0,e(t))}}if(this.status)return this;try{var i=!(!(t=e)||!eh(t).match(/function|object/))&&e.then;if(QT(i)){if(e===this.promise)throw new $T("Promise can't resolve itself");return i.call(e,n(this.resolve),n(this.reject)),this}}catch(QG){return n(this.reject)(QG),this}return this.alwaysAsyncFn((function(){this.value=e,this.status=1,this.execCallbacks()})),this}},{key:"reject",value:function(e){return this.status||this.alwaysAsyncFn((function(){try{throw e}catch(QG){this.value=QG}this.status=-1,this.execCallbacks()})),this}},{key:"execCallbacks",value:function(){if(0!==this.status){var e,t=this.pendings,r=0,n=t.length,i=~this.status?0:1;for(this.pendings=[];r<n;r++)(e=t[r][i])&&e(this.value)}}}]),e}();cI.deferred=cI,cI.defer=cI,cI.nextTick=JT,cI.alwaysAsync=!0,cI.onlyFuncs=!0,cI.resolve=function(e){return new cI(!0).resolve(e).promise},cI.resolved=cI.resolve,cI.fulfilled=cI.resolve,cI.reject=function(e){return new cI(!0).reject(e).promise},cI.rejected=cI.reject;var lI,dI,fI,hI=window;function gI(e){return null==(e=e||window.event).which?e.which=e.button<2?1:4==e.button?2:3:e.which=e.which<2?1:2==e.which?2:3,e}function pI(e,t){return e.currentStyle?e.currentStyle[t]:window.getComputedStyle?document.defaultView.getComputedStyle(e,null)[t]:null}function _I(e){var t=eh(e);return null==e||"object"!==t&&"function"!==t}function mI(e,t,r,n){t=t||"&",r=r||"=",xt.isUndefined(n)&&(n=V);var i=[];return xt.each(e,(function(e,o){var a=xt.urlEncode(o);_I(e)?(i.push(a),xt.isDef(e)&&i.push(r,xt.urlEncode(e+Z)),i.push(t)):xt.isArray(e)&&e.length&&xt.each(e,(function(e){_I(e)&&(i.push(a,n?xt.urlEncode("[]"):Z),xt.isDef(e)&&i.push(r,xt.urlEncode(e+Z)),i.push(t))}))})),i.pop(),i.join(Z)}function vI(e,t,r){if(!xt.isString(e)||!(e=wh(xt).call(xt,e)))return{};t=t||"&",r=r||"=";for(var n,i,o,a={},s=xt.urlDecode,u=e.split(t),c=0,l=u.length;c<l;++c){if(-1===(n=Mh(xt).call(xt,r,u[c])))i=s(u[c]),o=void 0;else{i=s(u[c].substring(0,n)),o=u[c].substring(n+1);try{o=s(o)}catch(QG){xt.error("decodeURIComponent error : "+o),xt.error(QG)}GS(xt).call(xt,i,"[]")&&(i=i.substring(0,i.length-2))}i in a?xt.isArray(a[i])?a[i].push(o):a[i]=[a[i],o]:a[i]=o}return a}hI&&xt.isFunction(hI.__zone_symbol__Promise)&&(dI=hI.__zone_symbol__Promise),lI=self&&TS||hI&&TS?TS:cI,dI||(dI=lI),xt.each({"&amp;":"&","&gt;":">","&lt;":"<","&#x60;":"`","&#x2F;":"/","&quot;":'"',"&#x27;":"'"},(function(e,t){}));var yI="ds-dwt-loaderBar",SI="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+PHN2ZyB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB2ZXJzaW9uPSIxLjAiIHdpZHRoPSIxMDBweCIgaGVpZ2h0PSIxMDBweCIgdmlld0JveD0iMCAwIDEyOCAxMjgiIHhtbDpzcGFjZT0icHJlc2VydmUiPjxnPjxjaXJjbGUgY3g9IjE2IiBjeT0iNjQiIHI9IjE2IiBmaWxsPSIjZmU4ZTE0Ii8+PGNpcmNsZSBjeD0iMTYiIGN5PSI2NCIgcj0iMTQuMzQ0IiBmaWxsPSIjZmU4ZTE0IiB0cmFuc2Zvcm09InJvdGF0ZSg0NSA2NCA2NCkiLz48Y2lyY2xlIGN4PSIxNiIgY3k9IjY0IiByPSIxMi41MzEiIGZpbGw9IiNmZThlMTQiIHRyYW5zZm9ybT0icm90YXRlKDkwIDY0IDY0KSIvPjxjaXJjbGUgY3g9IjE2IiBjeT0iNjQiIHI9IjEwLjc1IiBmaWxsPSIjZmU4ZTE0IiB0cmFuc2Zvcm09InJvdGF0ZSgxMzUgNjQgNjQpIi8+PGNpcmNsZSBjeD0iMTYiIGN5PSI2NCIgcj0iMTAuMDYzIiBmaWxsPSIjZmU4ZTE0IiB0cmFuc2Zvcm09InJvdGF0ZSgxODAgNjQgNjQpIi8+PGNpcmNsZSBjeD0iMTYiIGN5PSI2NCIgcj0iOC4wNjMiIGZpbGw9IiNmZThlMTQiIHRyYW5zZm9ybT0icm90YXRlKDIyNSA2NCA2NCkiLz48Y2lyY2xlIGN4PSIxNiIgY3k9IjY0IiByPSI2LjQzOCIgZmlsbD0iI2ZlOGUxNCIgdHJhbnNmb3JtPSJyb3RhdGUoMjcwIDY0IDY0KSIvPjxjaXJjbGUgY3g9IjE2IiBjeT0iNjQiIHI9IjUuMzc1IiBmaWxsPSIjZmU4ZTE0IiB0cmFuc2Zvcm09InJvdGF0ZSgzMTUgNjQgNjQpIi8+PGFuaW1hdGVUcmFuc2Zvcm0gYXR0cmlidXRlTmFtZT0idHJhbnNmb3JtIiB0eXBlPSJyb3RhdGUiIHZhbHVlcz0iNDUgNjQgNjQ7OTAgNjQgNjQ7MTM1IDY0IDY0OzE4MCA2NCA2NDsyMjUgNjQgNjQ7MjcwIDY0IDY0OzMxNSA2NCA2NDswIDY0IDY0IiBjYWxjTW9kZT0iZGlzY3JldGUiIGR1cj0iNzIwbXMiIHJlcGVhdENvdW50PSJpbmRlZmluaXRlIj48L2FuaW1hdGVUcmFuc2Zvcm0+PC9nPjwvc3ZnPg==";function TI(e){var t,r,n,i="",o="230px",a="240px",s="",u="";return e&&(e.background&&(i=";background:"+e.background),e.width&&(o=e.width),e.height&&(a=e.height),e.imageSource&&(t=e.imageSource)),t||(t=SI),n=Cg(o)/2,xt.isNumber(n)&&n>0&&(u=";width:"+n+"px"),r=Cg(a)/2,xt.isNumber(r)&&r>0&&(s=";height:"+r+"px"),['<div align="center" ','class="',yI,'" ','style="margin:0 auto;max-width:',o,";max-height:",a,";line-height:",a,i,'"><img style="user-select:none',s,u,';max-width:230px;max-height:240px;vertical-align:middle" src="',t,'" draggable="false" /></div>'].join("")}var II,bI=window,CI=document,wI=5e5;function EI(e,t){for(var r=0;r<e.length;++r)if(e[r]==t)return V;return G}function AI(e){var t=CI.createEvent("MouseEvents");return null==t||t.initMouseEvent(e.type,e.bubbles,e.cancelable,bI,e.detail,e.screenX,e.screenY,e.clientX,e.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,e.button,e.relatedTarget),t}function DI(e){var t;null===(t=CI.body)||void 0===t||t.dispatchEvent(AI(e))}function PI(e,t){if(II){var r=II.style;r.backgroundColor=["rgba(",t,",",t,",",t,",",e,")"].join(""),r.filter=["alpha(opacity=",100*e,")"].join(""),r.opacity=r.MozOpacity=e}}var RI,xI,kI={pendingDialogStack:[],pendingDialogTopmostStack:[],opacity:.1,grayHex:128,_updateStacking:function(e){var t,r;0!=(t=this.pendingDialogStack).length?(1!=e&&function(e,t){II===fI?function(e,t){if(II=CI.createElement("div")){var r=II.style;r.position="fixed",r.display="block",r.left=r.top=r.margin=r.padding=0,PI(e,t),r.zIndex=wI,r.width=r.height="100%",Y.bIE&&Y.IEVersion<10&&(II.innerHTML='<iframe src="javascript:\'\'" style="background:none;margin:0px auto;border:0;width:100%;height:100%;position:relative;z-index:9999;"></iframe>'),CI.createEvent&&xt.addEventListener(II,"click",DI)}}(e,t):PI(e,t),CI.body&&!CI.body.contains(II)&&CI.body.appendChild(II)}(kI.opacity,kI.grayHex),r=wI,xt.each(t,(function(e){r++,e._dlgInfo.mask&&(e._dlgInfo.mask.style.zIndex=r++),e.style.zIndex=r}))):II!==fI&&(xt.removeEventListener(II,"click",DI),CI&&CI.body&&CI.body.removeChild(II),II=fI)},pushDialog:function(e,t){var r,n,i=this;if(e.getBoundingClientRect(),(n=e.bTopmost?i.pendingDialogTopmostStack:i.pendingDialogStack).length>=1e3)xt.error("Too many modal dialogs.");else{if((r=CI.createElement("div")).style.zIndex="10000",r.className="dynamsoft-backdrop",1==t?(r.style.left=0,r.style.top=0,r.style.position="absolute"):(r.style.left=0,r.style.top=0,r.style.width="100%",r.style.height="100%",r.style.position="fixed"),CI.createEvent&&xt.addEventListener(r,"click",(function(t){if(e.dispatchEvent){var r=AI(t);e.dispatchEvent(r)}})),e.parentNode.insertBefore(r,e.nextSibling),e._dlgInfo.mask=r,e.bTopmost){var o=501e3;e._dlgInfo.mask&&(e._dlgInfo.mask.style.zIndex=o),e.style.zIndex=o+1}n.push(e),i._updateStacking(t)}},removeDialog:function(e){var t,r,n,i=this;n=e.bTopmost?i.pendingDialogTopmostStack:i.pendingDialogStack,-1!=(t=xt.isArray(n)?Mh(xt).call(xt,e,n):-1)&&(mp(n).call(n,t,1),(r=e._dlgInfo.mask).parentNode&&r.parentNode.removeChild(r),e._dlgInfo.mask=null,i._updateStacking())}};function FI(e,t){var r,n,i=this,o=!0,a=1==t?"absolute":"fixed",s="50%",u="50%",c="",l="",d=null;if(i._dlgInfo&&i._dlgInfo.styleConfig){var f=i._dlgInfo.styleConfig;xt.isString(f.style)?(r=f.style,o=!1):(xt.isString(f.position)&&(a=f.position,o=!1),(xt.isString(f.left)||xt.isNumber(f.left))&&(u=f.left,o=!1),(xt.isString(f.top)||xt.isNumber(f.top))&&(s=f.top,o=!1),(xt.isString(f.width)||xt.isNumber(f.width))&&(c=f.width,o=!1),(xt.isString(f.height)||xt.isNumber(f.height))&&(l=f.height,o=!1),xt.isString(f.transform)&&(d=f.transform,o=!1))}i.open?xt.error("showDialog called on open dialog."):(i.open=V,i.removeAttribute("closed"),i.setAttribute("open","open"),r?i.setAttribute("style",r):(o?n=Y.bIE&&"fixed"==a?["display:block;position:fixed;top:35%;margin:0 auto;left:0;right:0"]:["display:block;position:",a,";left:50%;top:50%;transform:translate(-50%,-50%)"]:(n=["display:block;position:",a,";left:",u,";top:",s,";width:",c,";height:",l],d&&(n.push(";transform:"),n.push(d))),"DIALOG"==i.tagName?n.push(";margin:0;border-radius:6px;box-shadow:2px 2px 0 0 rgba(0,0,0,.05);-webkit-box-sizing:border-box;box-sizing:border-box;"):n.push(";border:0;margin:0;-webkit-box-sizing:border-box;box-sizing:border-box;"),i.setAttribute("style",n.join(""))),function(e){var t;return bI.getComputedStyle?t=bI.getComputedStyle(e):e.currentStyle&&(t=e.currentStyle),t&&"absolute"!=t.position||"auto"!=e.style.top&&""!=e.style.top||"auto"!=e.style.bottom&&""!=e.style.bottom?G:!function(e){for(var t=0;t<CI.styleSheets.length;++t){var r=CI.styleSheets[t],n=void 0,i=void 0,o=void 0,a=void 0;try{n=r.cssRules,i=CI.querySelectorAll}catch(QG){}if(n&&i)for(var s=0;s<n.length;++s){o=n[s],a=G;try{a=i(o.selectorText)}catch(QG){}if(a&&EI(a,e)){var u=o.style.getPropertyValue("top"),c=o.style.getPropertyValue("bottom");if(u&&"auto"!=u||c&&"auto"!=c)return V}}}return G}(e)}(i)&&function(e){var t,r,n,i;i=((null===(t=CI.body)||void 0===t?void 0:t.scrollTop)||(null===(r=CI.documentElement)||void 0===r?void 0:r.scrollTop)||0)+((bI.innerHeight?bI.innerHeight:null===(n=CI.documentElement)||void 0===n?void 0:n.clientHeight)-e.offsetHeight)/2,e.style.top=i+"px",e._dlgInfo.isTopOverridden=V}(i),e&&(i._dlgInfo.modal=V,kI.pushDialog(i,t)))}function OI(e){var t=this;return t.open||xt.error("closeDialog called on closed dialog."),t.open=G,t.removeAttribute("open"),t.setAttribute("closed","closed"),t.style.display="none",void 0!==e&&(t.returnValue=e),t._dlgInfo.isTopOverridden&&(t.style.top="auto"),t._dlgInfo.modal&&kI.removeDialog(t),t.returnValue}function WI(e){xt.isNumber(e.opacity)?kI.opacity=e.opacity:kI.opacity=.1,xt.isNumber(e.grayHex)?kI.grayHex=e.grayHex:kI.grayHex=128}function NI(e){var t,r,n,i,o;if(!xI.dlgMask){var a,s,u,c,l=!1;if(e&&(c={},e.style?c.style=e.style:((xt.isString(e.top)||xt.isNumber(e.top))&&(c.top=e.top),(xt.isString(e.left)||xt.isNumber(e.left))&&(c.left=e.left),xt.isString(e.position)&&(c.position=e.position)),e.confined&&(document.getElementsByClassName("dwt-viewer-imageEditor-fullScreen")[0]||(l=e.confined)),(xt.isString(e.width)||xt.isNumber(e.width))&&(r=e.width),(xt.isString(e.height)||xt.isNumber(e.height))&&(n=e.height),xt.isString(e.background)&&(i=e.background),xt.isString(e.imageSource)&&(o=e.imageSource),WI(e),l&&e.wrapperEl&&(s=e.wrapperEl,xt.isString(s)&&(s=CI.getElementById(s)))),!o){var d;if(window&&window.Dynamsoft){var f=window.Dynamsoft.DWT;f&&f.CustomizableDisplayInfo&&(d=f.CustomizableDisplayInfo)}d?(Y.bIE&&xt.isString(d.loaderBarSourceIE)&&""!=d.loaderBarSourceIE&&(o=d.loaderBarSourceIE),!o&&xt.isString(d.loaderBarSource)&&""!=d.loaderBarSource&&(o=d.loaderBarSource)):o=SI}s&&(u=s.getBoundingClientRect(),s.style.position="relative"),(a=CI.createElement("div"))&&(a.className="dynamsoft-dialog-wrap",a.innerHTML=TI({width:r,height:n,backgroundColor:i,imageSource:o}),s?(s.appendChild(a),a.style.position="absolute",a.style.top="50%",a.style.left="50%",a.style.transform="translate(-50%, -50%)"):null===(t=CI.body)||void 0===t||t.appendChild(a),l&&u&&(window.onresize?xI.preOnresize=window.onresize:xI.preOnresize=!1,window.onscroll?xI.preOnscroll=window.onscroll:xI.preOnscroll=!1),xI.dlgMask=a,RI.setup(a,l),c&&(a._dlgInfo.styleConfig=c),s&&(a._dlgInfo.wrapperEl=s),a.showModal())}}function MI(){var e,t=xI.dlgMask;t&&(t.close(),t._dlgInfo&&t._dlgInfo.wrapperEl?(t._dlgInfo.wrapperEl.removeChild(t),t._dlgInfo.wrapperEl=null):null===(e=CI.body)||void 0===e||e.removeChild(t),xI.dlgMask=!1),xI.preOnresize?window.onresize=xI.preOnresize:window.onresize=null,xI.preOnresize=!1,xI.preOnscroll?window.onscroll=xI.preOnscroll:window.onscroll=null,xI.preOnscroll=!1}RI={setup:function(e,t){e.show=aT(FI).call(FI,e,G,t),e.showModal=aT(FI).call(FI,e,V,t),e.close=aT(OI).call(OI,e),e._dlgInfo={}}},xI={dlgMask:!1,preOnresize:!1,preOnscroll:!1};var LI,BI,UI=function(){function e(t){Mt(this,e);var r=t.createElement("div"),n=t.createElement("div");n.style&&(this.div=n,this.container=r,this.docElem=t.documentElement,n.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",this.leadingWhitespace=3===n.firstChild.nodeType,this.tbody=!n.getElementsByTagName("tbody").length,this.htmlSerialize=!!n.getElementsByTagName("link").length,n.style.cssText="float:left;opacity:.5",this.opacity="0.5"===n.style.opacity,this.cssFloat=!!n.style.cssFloat,n.style.backgroundClip="content-box",n.cloneNode(!0).style.backgroundClip="",this.clearCloneStyle="content-box"===n.style.backgroundClip,(r=document.createElement("div")).style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute",n.innerHTML="",r.appendChild(n),this.boxSizing=""===n.style.boxSizing||""===n.style.MozBoxSizing||""===n.style.WebkitBoxSizing)}return ih(e,[{key:"reliableHiddenOffsets",value:function(){return null==this.pixelPositionVal&&this.computeStyleTests(),this.reliableHiddenOffsetsVal}},{key:"boxSizingReliable",value:function(){return null==this.pixelPositionVal&&this.computeStyleTests(),this.boxSizingReliableVal}},{key:"pixelMarginRight",value:function(){return null==this.pixelPositionVal&&this.computeStyleTests(),this.pixelMarginRightVal}},{key:"pixelPosition",value:function(){return null==this.pixelPositionVal&&this.computeStyleTests(),this.pixelPositionVal}},{key:"reliableMarginRight",value:function(){return null==this.pixelPositionVal&&this.computeStyleTests(),this.reliableMarginRightVal}},{key:"reliableMarginLeft",value:function(){return null==this.pixelPositionVal&&this.computeStyleTests(),this.reliableMarginLeftVal}},{key:"computeStyleTests",value:function(){var e,t,r=this.div;this.docElem&&this.docElem.appendChild(this.container),r.style.cssText="-webkit-box-sizing:border-box;box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%",this.pixelPositionVal=this.boxSizingReliableVal=this.reliableMarginLeftVal=!1,this.pixelMarginRightVal=this.reliableMarginRightVal=!0,window.getComputedStyle&&(t=window.getComputedStyle(r),this.pixelPositionVal="1%"!==(t||{}).top,this.reliableMarginLeftVal="2px"===(t||{}).marginLeft,this.boxSizingReliableVal="4px"===(t||{width:"4px"}).width,r.style.marginRight="50%",this.pixelMarginRightVal="4px"===(t||{marginRight:"4px"}).marginRight,(e=r.appendChild(document.createElement("div"))).style.cssText=r.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",e.style.marginRight=e.style.width="0",r.style.width="1px",this.reliableMarginRightVal=!mT((window.getComputedStyle(e)||{}).marginRight),r&&r.removeChild(e)),r.style.display="none",this.reliableHiddenOffsetsVal=0===r.getClientRects().length,this.reliableHiddenOffsetsVal&&(r.style.display="",r.innerHTML="<table><tr><td></td><td>t</td></tr></table>",r.childNodes[0].style.borderCollapse="separate",(e=r.getElementsByTagName("td"))[0].style.cssText="margin:0;border:0;padding:0;display:none",this.reliableHiddenOffsetsVal=0===e[0].offsetHeight,this.reliableHiddenOffsetsVal&&(e[0].style.display="",e[1].style.display="none",this.reliableHiddenOffsetsVal=0===e[0].offsetHeight)),this.docElem&&this.docElem.removeChild(this.container)}}]),e}(),VI=new UI(document),GI=VI.docElem,jI=xt.sizzle,HI=/^margin/,zI=/^(top|right|bottom|left)$/,KI=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,JI=new RegExp("^("+KI+")(?!px)[a-z%]+$","i"),YI=new RegExp("^("+KI+")(.*)$","i");window.getComputedStyle?(LI=function(e){var t,r;return(r=(t=xt.isFunction(e.getEL)?e.getEL():e).ownerDocument.defaultView)&&r.opener||(r=window),r.getComputedStyle(t)},BI=function(e,t,r){var n,i,o,a,s=e.style;return""!==(a=(r=r||LI(e))?r.getPropertyValue(t)||r[t]:void 0)&&void 0!==a||jI.contains(e.ownerDocument,e)||(a=yb(e,t)),r&&!VI.pixelMarginRight()&&JI.test(a)&&HI.test(t)&&(n=s.width,i=s.minWidth,o=s.maxWidth,s.minWidth=s.maxWidth=s.width=a,a=r.width,s.width=n,s.minWidth=i,s.maxWidth=o),void 0===a?a:a+""}):GI&&GI.currentStyle&&(LI=function(e){return e.currentStyle},BI=function(e,t,r){var n,i,o,a,s=e.style;return null==(a=(r=r||LI(e))?r[t]:void 0)&&s&&s[t]&&(a=s[t]),JI.test(a)&&!zI.test(t)&&(n=s.left,(o=(i=e.runtimeStyle)&&i.left)&&(i.left=e.currentStyle.left),s.left="fontSize"===t?"1em":a,a=s.pixelLeft+"px",s.left=n,o&&(i.left=o)),void 0===a?a:a+""||"auto"});var QI,XI=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:-]+)[^>]*)\/>/gi,qI=/<([\w:-]+)/,ZI=/^\s+/,$I=/<|&#?\w+;/,eb=/<tbody/i,tb=/^-ms-/,rb=/-([\da-z])/gi,nb=/^(none|table(?!-c[ea]).+)/,ib=/^<([\w-]+)\s*\/?>(?:<\/\1>|)$/,ob={position:"absolute",visibility:"hidden",display:"block"},ab={letterSpacing:"0",fontWeight:"400"},sb=["Top","Right","Bottom","Left"],ub={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:VI.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},cb=["Webkit","O","Moz","ms"],lb="abbr|article|aside|audio|bdi|canvas|data|datalist|details|dialog|figcaption|figure|footer|header|hgroup|main|mark|meter|nav|output|picture|progress|section|summary|template|time|video",db=document.createElement("div");QI=db.style,VI.cssFloat=!!db.style.cssFloat;var fb=function(e,t){return t.toUpperCase()},hb={cssHooks:{},htmlPrefilter:function(e){return e.replace(XI,"<$1></$2>")},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},merge:function(e,t){for(var r=+t.length,n=0,i=e.length;n<r;)e[i++]=t[n++];if(r!=r)for(;void 0!==t[n];)e[i++]=t[n++];return e.length=i,e},camelCase:function(e){return e.replace(tb,"ms-").replace(rb,fb)},cssProps:{},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0}},gb=["flo","at"].join("");function pb(e){if(e in QI)return e;for(var t=e.charAt(0).toUpperCase()+dg(e).call(e,1),r=cb.length;r--;)if((e=cb[r]+t)in QI)return e}function _b(e,t,r,n,i){for(var o=r===(n?"border":"content")?4:"width"===t?1:0,a=0;o<4;o+=2)"margin"===r&&(a+=Sb(e,r+sb[o],!0,i)),n?("content"===r&&(a-=Sb(e,"padding"+sb[o],!0,i)),"margin"!==r&&(a-=Sb(e,"border"+sb[o]+"Width",!0,i))):(a+=Sb(e,"padding"+sb[o],!0,i),"padding"!==r&&(a+=Sb(e,"border"+sb[o]+"Width",!0,i)));return a}function mb(e,t,r){var n=!0,i="width"===t?e.offsetWidth:e.offsetHeight,o=LI(e),a=VI.boxSizing&&"border-box"===Sb(e,"boxSizing",!1,o);if(i<=0||null==i){if(((i=BI(e,t,o))<0||null==i)&&(i=e.style[t]),JI.test(i))return i;n=a&&(VI.boxSizingReliable()||i===e.style[t]),i=mT(i)||0}return i+_b(e,t,r||(a?"border":"content"),n,o)}function vb(e){return new RegExp("^(?:([+-])=|)("+KI+")([a-z%]*)$","i").exec(e)}function yb(e,t,r,n){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var i,o,a,s=hb.camelCase(t),u=e.style;if(t=hb.cssProps[s]||(hb.cssProps[s]=pb(s)||s),a=hb.cssHooks[t]||hb.cssHooks[s],void 0===r)return a&&"get"in a&&void 0!==(i=a.get(e,!1,n))?i:u[t]+"";"string"===(o=eh(r))&&(i=vb(r))&&i[1]&&(r=function(e,t,r,n){var i,o=1,a=20,s=function(){return Sb(e,t,"")},u=s(),c=r&&r[3]||(hb.cssNumber[t]?"":"px"),l=(hb.cssNumber[t]||"px"!==c&&+u)&&vb(Sb(e,t));if(l&&l[3]!==c){c=c||l[3],r=r||[],l=+u||1;do{yb(e,t,(l/=o=o||".5")+c)}while(o!==(o=s()/u)&&1!==o&&--a)}return r&&(l=+l||+u||0,i=r[1]?l+(r[1]+1)*r[2]:+r[2]),i}(e,t,i),o="number"),null!=r&&r==r&&("number"===o&&(r+=i&&i[3]||(hb.cssNumber[s]?"":"px")),VI.clearCloneStyle||""!==r||0!==Mh(t).call(t,"background")||(u[t]="inherit"),a&&"set"in a&&void 0===(r=a.set(e,r,n))||(u[t]=r))}}function Sb(e,t,r,n){var i,o,a,s=hb.camelCase(t);return t=hb.cssProps[s]||(hb.cssProps[s]=pb(s)||s),(a=hb.cssHooks[t]||hb.cssHooks[s])&&"get"in a&&(o=a.get(e,!0,r)),void 0===o&&(o=BI(e,t,n)),"normal"===o&&t in ab&&(o=ab[t]),""===r||r?(i=mT(o),!0===r||isFinite(i)?i||0:o):o}function Tb(e,t){if(!e||"string"!=typeof e)return[];"boolean"==typeof t&&(t=!1),t=t||document;var r=ib.exec(e);return r?[t.createElement(r[1])]:(r=function(e,t){for(var r,n,i,o,a,s,u=e.length,c=function(e){var t=lb.split("|"),r=e.createDocumentFragment();if(r.createElement)for(;t.length;)r.createElement(t.pop());return r}(t),l=[],d=0;d<u;d++)if((n=e[d])||0===n)if("object"===xt.type(n))hb.merge(l,n.nodeType?[n]:n);else if($I.test(n)){if(i=i||c.appendChild(t.createElement("div"))){for(o=(qI.exec(n)||["",""])[1].toLowerCase(),s=ub[o]||ub._default,i.innerHTML=s[1]+hb.htmlPrefilter(n)+s[2],r=s[0];r--;)i=i.lastChild;if(!VI.leadingWhitespace&&ZI.test(n)){var f=ZI.exec(n);f&&f.length>0&&l.push(t.createTextNode(f[0]))}if(!VI.tbody&&(r=(n="table"!==o||eb.test(n)?"<table>"!==s[1]||eb.test(n)?0:i:i.firstChild)&&n.childNodes.length,n))for(;r--;)hb.nodeName(a=n.childNodes[r],"tbody")&&!a.childNodes.length&&n.removeChild(a);for(hb.merge(l,i.childNodes),i.textContent="";i.firstChild;)i.removeChild(i.firstChild);i=c.lastChild}}else l.push(t.createTextNode(n));for(i&&c&&c.removeChild(i),d=0;n=l[d++];)"SCRIPT"!==n.tagName&&(jI.contains(n.ownerDocument,n),c.appendChild(n));return i=null,c}([e],t),hb.merge([],r.childNodes))}hb.cssProps[gb]=VI.cssFloat?"cssFloat":"styleFloat",xt.each(["height","width"],(function(e,t){hb.cssHooks[e]={get:function(t,r,n){if(r)return nb.test(Sb(t,"display"))&&0===t.offsetWidth?function(e,t,r,n){var i,o={};return xt.each(t,(function(r,n){o[n]=e.style[n],e.style[n]=t[n]})),i=r.apply(e,[]),xt.each(t,(function(t,r){e.style[r]=o[r]})),i}(t,ob,(function(){return mb(t,e,n)})):mb(t,e,n)},set:function(t,r,n){var i=n&&LI(t);return function(e,t,r){var n=YI.exec(t);return n?Math.max(0,Cg(n[1])-(r||0))+(n[2]||"px"):t}(0,r,n?_b(t,e,n,VI.boxSizing&&"border-box"===Sb(t,"boxSizing",!1,i),i):0)}}}));var Ib,bb=Array.prototype,Cb=dg(bb),wb=" ",Eb=Y.bIE&&Y.IEMode<10,Ab=/[\n\t\r\.]/g,Db=function(){function e(t,r,n){Mt(this,e),this.isNodeList=!0,this.length=0;var i=this;return!t||xt.isString(t)?i:xt.isArray(t)||t.isNodeList?(Array.prototype.push.apply(i,xt.makeArray(t)),i):(i[0]=t,i.length=1,i)}return ih(e,[{key:"item",value:function(t){return xt.isNumber(t)?t>=this.length?null:new e(this[t]):new e(t)}},{key:"slice",value:function(){return new e(Cb.apply(this,arguments))}},{key:"getDOMNodes",value:function(){return Cb.call(this)}},{key:"each",value:function(t,r){var n=this;return xt.each(n,(function(i,o){return i=new e(i),t.call(r||i,i,o,n)})),n}},{key:"getEL",value:function(){return this.length>0?this[0]:void 0}},{key:"all",value:function(t){return this.length>0?kb(t,this):new e}},{key:"one",value:function(e){var t=this.all(e);return t.length?dg(t).call(t,0,1):t}},{key:"attr",value:function(e,t){var r=this.getEL();if(r){if(xt.isUndefined(t))return"readonly"===e?r.readOnly?"readonly":"":("style"!==e&&Eb?r=r[e]:(r=r.attributes[e])&&(r=r.value),r);"class"==e?r.className=t:r[e]=t}}},{key:"addClass",value:function(e){var t=this.getEL();t&&function(e,t){var r,n,i,o,a=e.className,s=t.length;if(a){for(r=Rb(a),n=a,i=0;i<s;i++)o=xb(t[i]),Mh(r).call(r,wb+o+wb)<0&&(n+=wb+o);n=wh(xt).call(xt,n)}else n=t.join(" ");e.className=n}(t,e.split(wb))}},{key:"removeClass",value:function(e){var t=this.getEL();t&&function(e,t){var r,n,i,o=e.className,a=t.length;if(o&&a){for(r=Rb(o),n=0;n<a;n++)for(i=wb+xb(t[n])+wb;Mh(r).call(r,i)>=0;)r=r.replace(i,wb);e.className=wh(xt).call(xt,r)}}(t,e.split(wb))}},{key:"hasClass",value:function(e){var t=this.getEL();if(t)return function(e,t){var r,n,i,o=e.className,a=t.length;if(o&&a){for(r=Rb(o),n=0;n<a;n++)if(i=wb+xb(t[n])+wb,Mh(r).call(r,i)<0)return G;return V}return G}(t,e.split(wb))}},{key:"parent",value:function(){var t=this.getEL();return t&&(t=t.parentNode),new e(t)}},{key:"remove",value:function(){var e=this.getEL();e&&e.parentNode&&e.parentNode.removeChild(e)}},{key:"offset",value:function(){var e=this.getEL();return xt.DOM.getElDimensions(e,V)}},{key:"before",value:function(e){var t=this.getEL(),r=[e];t&&(Pb(e)&&(r=Tb(e)),xt.each(r,(function(e){t.insertBefore(e,t.childNodes[0])})))}},{key:"append",value:function(e){var t=this.getEL(),r=[e];t&&(Pb(e)&&(r=Tb(e)),xt.each(r,(function(e){t.appendChild(e)})))}},{key:"html",value:function(e){var t=this.getEL();if(t){if(xt.isUndefined(e))return function(e){var t=e.innerHTML;if(!document.all)return t;return(t=t.replace(/(\s+\w+)\s*=\s*([^<>"\s]+)(?=[^<>]*\/>)/gi,'$1="$2"').replace(/"'([^'"]*)'"/gi,'"$1"')).replace(/<(\/?)(\w+)([^>]*)>/g,(function(e,t,r,n){return t?"</"+r.toLowerCase()+">":("<"+r.toLowerCase()+n+">").replace(/=(("[^"]*?")|('[^']*?')|([\w\-\.]+))([\s>])/g,(function(e,t,r,n,i,o,a,s){return i?'="'+i+'"'+o:e}))})).replace(/<\/?([^>]+)>/g,(function(e){return e}))}(t);t.innerHTML="",xt.each(Tb(e),(function(e){t.appendChild(e)}))}}},{key:"style",value:function(e,t){var r=this.getEL();if(r)return yb(r,e,t)}},{key:"css",value:function(e){xt.each(this,(function(t){xt.each(e,(function(e,r){yb(t,r,e)}))}))}}]),e}();function Pb(e){return xt.isString(e)&&(e=wh(xt).call(xt,e))&&e.length>=3&&kT(xt).call(xt,e,"<")&&GS(xt).call(xt,e,">")}function Rb(e){return(wb+e+wb).replace(Ab,wb)}function xb(e){return e.replace(Ab,"")}function kb(e,t){var r=t;return r&&r.isNodeList&&(r=r.getEL()),xt.isString(e)?(Pb(e)&&xt.error("Err 4002."),new Db(xt.sizzle(e,r))):e.isNodeList?e:new Db(e)}function Fb(e,t){var r=kb(e,t);return r.length?dg(r).call(r,0,1):r}function Ob(e){return e instanceof Db}(Ib=self||{}).Map||(Ib.Map=function(){this.keys=[],this.data={},this.set=function(e,t){var r;null==this.data[e]&&-1==Mh(r=zh(this)).call(r,e)&&zh(this).push(e),this.data[e]=t},this.get=function(e){return this.data[e]}});var Wb=new(ih((function e(){Mt(this,e),this.__ver=20230516,this.Events=AT,this.EnumMouseButton=NT,this.detectButton=MT,this.getWheelDelta=WT,this.fromUnicode=jT,this.escapeHtml=HT,this.escapeRegExp=zT,this.unEscapeHtml=KT,this.param=mI,this.unparam=vI,this.colorStrToInt=FT,this.IntToColorStr=OT,this.currentStyle=pI,this.parseHTML=Tb,this.css=Sb,this.style=yb,this.support=VI,this.all=kb,this.one=Fb,this.isNodeList=Ob,this.Promise=lI,this.nativePromise=dI,this.loaderBarClassName=yI,this.loaderBarSource=SI,this.createShowMaskContent=TI,this.switchEvent=gI,this.setBackOpacity=WI,this.showMask=NI,this.hideMask=MI,this.dialog=RI,this.mask=xI}))),Nb={getHex:function(e){var t=Number(e).toString(16).toUpperCase();return 1==t.length&&(t=["0",t].join("")),t},getColor:function(e){var t,r,n;return n=e>>16,r=(65280&e)>>8,t=255&e,["#",Nb.getHex(n),Nb.getHex(r),Nb.getHex(t)].join("")},RGB2BGR:function(e){return(255&e)<<16|65280&e|e>>16}};function Mb(e,t,n){return(t=r(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Nb.BGR2RGB=Nb.RGB2BGR;var Lb=!1,Bb=!0,Ub=/[#\/\?@]/g,Vb=/[#\?]/g,Gb={scheme:1,userInfo:2,hostname:3,port:4,path:5},jb=new RegExp("^(?:([\\w\\d+.-]+):)?(?://(?:([^/?#@]*)@)?([\\w\\d\\-\\u0100-\\uffff.+%]*|\\[[^\\]]+\\])(?::([0-9]+))?)?(.+)?$");function Hb(e,t){return xt.isString(e)&&xt.isString(t)?e.toLowerCase()===t.toLowerCase():e===t}function zb(e,t){return encodeURI(e).replace(t,(function(e){return"%"+function(e){return 1===e.length?"0"+e:e}(e.charCodeAt(0).toString(16))}))}var Kb,Jb=function(){function e(r){if(t(this,e),Mb(this,"scheme",""),Mb(this,"userInfo",""),Mb(this,"hostname",""),Mb(this,"port",""),Mb(this,"path",""),r instanceof e)return xt.clone(r);e.getComponents(r,this)}return s(e,[{key:"clone",value:function(){var t=new e,r=this;return xt.each(Gb,(function(e,n){t[n]=r[n]})),t}},{key:"getScheme",value:function(){return this.scheme}},{key:"setScheme",value:function(e){return this.scheme=e,this}},{key:"getHostname",value:function(){return this.hostname}},{key:"setHostname",value:function(e){return this.hostname=e,this}},{key:"setUserInfo",value:function(e){return this.userInfo=e,this}},{key:"getUserInfo",value:function(){return this.userInfo}},{key:"setPort",value:function(e){return this.port=e,this}},{key:"getPort",value:function(){return this.port}},{key:"setPath",value:function(e){return this.path=e,this}},{key:"getPath",value:function(){return this.path}},{key:"isSameOriginAs",value:function(e){var t=this;return Hb(t.hostname,e.hostname)&&Hb(t.scheme,e.scheme)&&Hb(t.port,e.port)}},{key:"toString",value:function(e){var t,r,n,i,o,a=[],s=this;return(t=s.scheme)&&(a.push(zb(t,Ub)),a.push(":")),(r=s.hostname)&&(a.push("//"),(o=s.userInfo)&&(a.push(zb(o,Ub)),a.push("@")),a.push(encodeURIComponent(r)),(i=s.port)&&(a.push(":"),a.push(i))),(n=s.path)&&(r&&!xt.startsWith(n,"/")&&(n="/"+n),a.push(zb(n,Vb))),a.join("")}}],[{key:"getComponents",value:function(e,t){var r=(e=e||Z).match(jb)||[],n=t||{};return xt.each(Gb,(function(e,t){n[t]=r[e]})),n}}])}(),Yb=xt.each,Qb=xt.error,Xb=xt.isFunction,qb=xt.isString,Zb=Y.bIE&&Y.IEVersion<=9,$b=Y.bIE&&Y.IEVersion<=10,eC=window,tC=new Jb(location.href),rC=tC&&/^(?:about|app|app\-storage|.+\-extension|file|widget)$/.test(tC.getScheme()),nC=function(){try{return new eC.XMLHttpRequest}catch(QG){}},iC=function(){try{var e=Lb;return Yb(["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.3.0","Msxml3.XMLHTTP"],(function(t){try{if(!e)return e=new eC.ActiveXObject(t),Lb}catch(QG){Qb("new xhr error: "+QG.message)}})),e}catch(QG){}},oC=!(rC||!eC.XMLHttpRequest)&&"withCredentials"in(nC()||[]),aC=eC.ActiveXObject?function(e){return Zb?iC():!rC&&nC()||iC()}:nC,sC=/^(?:GET|HEAD)$/,uC=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,cC={xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":"*/*"},lC=Kb;$b&&(lC=xt.noop);var dC=function(){function e(){t(this,e),Mb(this,"url",!1),Mb(this,"onSuccess",!1),Mb(this,"onError",!1),Mb(this,"onComplete",!1),Mb(this,"method","GET"),Mb(this,"async",!0),Mb(this,"xhrFields",!1),Mb(this,"mimeType",!1),Mb(this,"username",!1),Mb(this,"password",!1),Mb(this,"data",!1),Mb(this,"dataType","text"),Mb(this,"headers",!1),Mb(this,"contentType","application/x-www-form-urlencoded; charset=UTF-8"),Mb(this,"beforeSend",!1),Mb(this,"afterSend",!1),Mb(this,"timeout",0),Mb(this,"cache",!0),Mb(this,"crossDomain",!1),Mb(this,"retry",0)}return s(e,[{key:"setRequestHeader",value:function(e,t){this.headers[e]=t}},{key:"getAllResponseHeaders",value:function(){return 2===this.state?this.responseHeadersString:null}},{key:"getNativeXhr",value:function(){return this.nativeXhr}},{key:"getResponseHeader",value:function(e){var t,r;if(e=e.toLowerCase(),2===this.state){if(!(r=this.responseHeaders))for(r=this.responseHeaders={};t=uC.exec(this.responseHeadersString);)r[t[1].toLowerCase()]=t[2];t=r[e]}return void 0===t?null:t}},{key:"overrideMimeType",value:function(e){return this.state||(this.mimeType=e),this}},{key:"abort",value:function(e){return this.state=3,this.status=0,this.statusText=null!=e?e:"abort",this.nativeXhr&&this.nativeXhr.abort(),this._callback(),this}},{key:"_ioReady",value:function(e,t){var r=!1,n=this;if(2!==this.state&&3!==this.state){1===this.state&&(this.state=2),this.readyState=4,e>=200&&e<300||304===e?304===e?(t="not modified",r=!0):(t="success",r=!0):e<0&&(e=0);try{e>=200&&this.handleResponseData()}catch(QG){Qb(QG,"error"),t=QG.message||"parser error"}return(e<200||!r)&&this.retry>0?(this.retry=this.retry-1,void setTimeout((function(){n.sendInternal()}),200)):(this.status=e,this.statusText=t,this._callback(r),r)}}},{key:"_callback",value:function(e){var t=this,r=this.timeoutTimer;r&&(clearTimeout(r),this.timeoutTimer=0),Yb([e?this.onSuccess:this.onError,this.onComplete],(function(e){Xb(e)&&e.apply(t.context,[t.responseData,t.statusText,t])})),this.responseData=null}},{key:"handleResponseData",value:function(){var e,t=this.dataType,r=this.nativeXhr;if("blob"===t||"arraybuffer"===t)if(Zb){var n,i,o;if("responseBody"in r)n=r.responseBody,i=eC.dsVbsBinGetLength(n),e=new eC.VBArray(eC.dsVbsBinGetBytes(n,0,i)).toArray();else for(e=[],i=(n=r.responseText).length,o=0;o<i;++o)e.push(255&n.charCodeAt(o));n=null}else e=eC.Blob?r.response:"responseBody"in r?r.responseBody:r.responseText;else if("json"==t)e=r.responseType&&"json"==r.responseType.toLowerCase()?r.response:r.responseText?xt.parse(r.responseText):xt.parse(r.response);else if("user-defined"===t)e=void 0!==r.response?r.response:r.responseText;else{this.responseText=e=r.responseText||"";try{var a=r.responseXML;a&&a.documentElement&&(this.responseXML=a)}catch(QG){}}this.responseData=e}},{key:"sendInternal",value:function(e){var t,r,n,i,o,a,s,u,c,l,d,f=this;if(r=(t=this._setup(e)).method,qb(r)&&(r=r.toUpperCase()),o=t.contentType,n=t.url,i=t.dataType,u=t.mimeType,qb(n)&&(this.nativeXhr=a=aC(t.crossDomain),a)){try{if(this.state=1,t.username?a.open(r,n,t.async,t.username,t.password):a.open(r,n,t.async),(t.async||Y.bIE)&&i&&"user-defined"!=i&&"responseType"in a)try{a.responseType=i}catch(QG){}}catch(_){return void(this.state<2?(Qb(_,"error"),this._ioReady(-1,"open error: "+(xt.isNumber(_.number)?"("+_.number+")":"")+(_.message||""))):Qb(_))}"withCredentials"in(s=t.xhrFields||{})&&(oC||delete s.withCredentials),Yb(s,(function(e,t){try{a[t]=e}catch(QG){Qb(QG)}})),u&&a.overrideMimeType&&a.overrideMimeType(u),!1===(c=t.headers||{})["X-Requested-With"]&&delete c["X-Requested-With"],"setRequestHeader"in a&&(o&&a.setRequestHeader("Content-Type",t.contentType),a.setRequestHeader("Accept",i&&cC[i]?cC[i]+("*"===i?"":", */*; q=0.01"):cC["*"]),Yb(c,(function(e,t){a.setRequestHeader(t,e)}))),"GET"!=r||t.cache||(a.setRequestHeader("If-Modified-Since","0"),a.setRequestHeader("Cache-Control","no-cache")),d=(l=!sC.test(t.method))&&t.data||null,l&&Zb&&(d=t.data),t.async&&t.timeout>0&&(t.timeout<300&&(t.timeout=300),this.timeoutTimer=setTimeout((function(){f.abort("timeout")}),t.timeout));try{if(this.state=1,Xb(this.beforeSend)&&!1===this.beforeSend(a,f))return void this.abort("cancel");a.send(d),d=null,t.data=null,Xb(this.afterSend)&&this.afterSend(f)}catch(QG){this.state<2?(Qb(QG,"error"),this._ioReady(-1,"send error: "+(QG.message||""))):Qb(QG)}if(!t.async||4===a.readyState)return f._xhrCallback();a.onreadystatechange=function(){f._xhrCallback()}}}},{key:"_xhrCallback",value:function(e,t){var r,n=this.nativeXhr;try{if(4===n.readyState||t)if(n.onreadystatechange=lC,t)4!==n.readyState&&n.abort();else{this.responseHeadersString=n.getAllResponseHeaders();var i,o=n.status;try{i=n.statusText}catch(QG){Qb("xhr statusText error: "),Qb(QG),i=""}r=this._ioReady(o,i)}}catch(QG){Qb(QG,"error"),n.onreadystatechange=lC,t||this._ioReady(-1,QG.message||"process error")}return r}},{key:"_setup",value:function(t){var r,n,i,o,a;if(t){for(n in this.context=t.context,delete t.context,t instanceof e&&(t=t.config),this.config=t,o=t.url,xt.startsWith(o,"//")&&(t.url=o="http:"+o),(xt.startsWith(o,"http://")||xt.startsWith(o,"https://"))&&(a=new Jb(o)),r=t.dataType?t.dataType.toLowerCase():"text",t.dataType=r,t.method?t.method=t.method.toUpperCase():t.method="GET",a&&!("crossDomain"in t)&&(t.crossDomain=!a.isSameOriginAs(tC)),i=t.headers)i[n]===Kb&&delete i[n];xt.mix(this,t)}return this.state=1,this}},{key:"dispose",value:function(){this.responseHeaders=null,this.responseHeadersString=null,this.responseData=null,this.responseText=null,this.responseXML=null,this.context=null,this.config=null,this.onSuccess=null,this.onError=null,this.onComplete=null,this.xhrFields=null,this.data=null,this.headers=null,this.beforeSend=null,this.afterSend=null}}])}();function fC(e){if(e&&qb(e.url)){var t=new dC;return e.async?(e.async=!0,t.sendInternal(e),t):(e.async=!1,t.sendInternal(e))}xt.log("the url is error.")}var hC,gC,pC={ErrStr_Service_NOT_INSTALLED:"Please make sure the Dynamsoft Service has been installed.",ErrStr_BROWSER_NOT_SUPPORT:"Error: This browser is currently not supported.",ErrStr_CreateID_ContainerIdDuplicated:"Error: Duplicate ContainerId detected while creating a Dynamic Web TWAIN object.",ErrStr_CreateID_WebTwainIdDuplicated:"Error: Duplicate WebTwainId detected while creating a Dynamic Web TWAIN object.",ErrStr_CreateID_NotContainer:"Error: The ID of the target DIV for the new DWT object is invalid.",ErrStr_CreateID_ContainerIdInvalid:"Error: The ContainerId cannot be empty string while creating a Dynamic Web TWAIN object.",ErrStr_CreateID_WebTwainIdInvalid:"Error: The WebTwainId cannot be empty string while creating a Dynamic Web TWAIN object."},_C="Checking WebTwain version ...",mC="18",vC="5",yC="0312",SC="5",TC="0",IC="".concat(mC,",").concat(vC,",").concat("0",",").concat(yC),bC="".concat(mC,",").concat(SC,",").concat(TC,",").concat("0312"),CC=parseInt(mC),wC=parseInt(vC),EC=parseInt("0"),AC=[CC,wC,EC,yC],DC=[CC,wC,EC,yC],PC=[CC,wC,EC,yC],RC=[1,8,5,yC],xC=[1,8,5,yC],kC=[1,8,5,yC];function FC(){if(Y.bWin);else{if(Y.bMac)return DC;if(Y.bLinux)return PC}return AC}function OC(){if(Y.bWin);else{if(Y.bMac)return xC;if(Y.bLinux)return kC}return RC}function WC(){return"dcp/dwasm2_"+NC()}function NC(){return FC().join("")}function MC(){var e=Wt.DWT.ServiceInstallerLocation;return xt.isString(e)&&e.length>0?("/"!=e[e.length-1]&&(e+="/"),e):(e=Wt.DWT.ResourcesPath,xt.isString(e)&&e.length>0?"/"!=e[e.length-1]&&(e+="/"):e="Resources/",e+"dist/")}!function(e){e.enumUnknown=-1,e.enumChrome=1,e.enumFirefox=2,e.enumEdge=3,e.enumSafari=4,e.enumIE=5,e.enumOpera=6,e.enumHuaWeiBrowser=7}(hC||(hC={})),function(e){e.enumUnknown=-1,e.enumWindow=0,e.enumMac=1,e.enumLinux=2,e.enumEmbed=3,e.enumChromeOS=4,e.enumHarmonyOS=5,e.enumAndroid=6,e.enumiOS=7}(gC||(gC={}));var LC,BC={getDSPath:function(e){var t=MC(),r=e;return r||(r=Y.bWin?".msi":Y.bMac?".pkg":Wt.navInfo.bArm64?"-arm64.deb":Wt.navInfo.bMips64?"-mips64el.deb":Wt.navInfo.bAndroid?".apk":Y.bLinux||Y.bChromeOS||Y.bHarmonyOS?".deb":".msi"),[t,"DynamsoftServiceSetup",r].join("")},getLinuxHTML5DebPath:function(){return BC.getDSPath(".deb")},getLinuxHTML5RpmPath:function(){return BC.getDSPath(".rpm")},getEnumPlatform:function(){return Y.bAndroid?gC.enumAndroid:Y.bMac?gC.enumMac:Y.bChromeOS?gC.enumChromeOS:Y.bHarmonyOS?gC.enumHarmonyOS:Wt.navInfo.bEmbed?gC.enumEmbed:Y.bLinux?gC.enumLinux:Y.biPhone||Y.biPad?gC.enumiOS:gC.enumWindow},getEnumBrowser:function(){return Y.bEdge?hC.enumEdge:Y.bChrome?hC.enumChrome:Y.bFirefox?hC.enumFirefox:Y.bIE?hC.enumIE:Y.bSafari?hC.enumSafari:Y.bHuaWeiBrowser?hC.enumHuaWeiBrowser:Y.bOpera?hC.enumOpera:hC.enumUnknown}};!function(e){e.NONE=0,e.TRACE=1,e.DEBUG=2,e.INFO=4,e.WARN=8,e.ERROR=16}(LC||(LC={}));var UC=xt.getLogger(),VC=s((function e(){t(this,e)}),null,[{key:"LogLevel",get:function(){return this._logLevel},set:function(e){this._logLevel=e}},{key:"LogFunc",set:function(e){this._logFunc=e}},{key:"all",value:function(e,t){if((this._logLevel&e)==e)if(this._logFunc)this._logFunc(t,e);else switch(e){case LC.DEBUG:UC.debug(t);break;case LC.ERROR:UC.error(t);break;case LC.INFO:UC.info(t);break;case LC.WARN:UC.warn(t);break;case LC.TRACE:UC.trace(t)}}},{key:"trace",value:function(e){this.all(LC.TRACE,e)}},{key:"debug",value:function(e){this.all(LC.DEBUG,e)}},{key:"info",value:function(e){this.all(LC.INFO,e)}},{key:"warn",value:function(e){this.all(LC.WARN,e)}},{key:"error",value:function(e){this.all(LC.ERROR,e)}}]);function GC(e){var t;window.console&&(e instanceof Error||xt.isString(e)?(t=e,Wt.navInfoSync.bIE&&(t=xt.stringify(e))):t=xt.stringify(e),window.console.error(t))}Mb(VC,"_logLevel",LC.ERROR),Mb(VC,"_logFunc",void 0);var jC,HC="127.0.0.1";Y.bIE&&Y.bSSL?HC="localhost":Y.bAndroid&&(HC="local.dynamsoft.com"),jC="0"==TC.toLowerCase()?"Dynamic Web TWAIN "+[mC,SC].join("."):"Dynamic Web TWAIN "+[mC,SC,TC].join(".");var zC={JSVersion:bC,ServerVersionInfo:IC,ServerLinuxVersionInfo:IC,ServerMacVersionInfo:IC,ServerAndroidVersionInfo:IC,ActiveXVersion:"18,0,0,1025",ActiveXPdfVersion:"11.5.2.0312",PdfVersion:"11.5.2.0312",PdfLinuxVersion:"11.5.2.0312",PdfMacVersion:"11.5.2.0312"},KC={ProductName:jC,Containers:void 0,ContainerMap:{},WebTwainIdMap:{},RemoteScanIdMap:{},Trial:!1,ResourcesPath:"Resources",Debug:!1,IfUpdateService:!1,AutoLoad:!0,ReConnectToService:!0,OnWebTwainReady:!1,OnWebTwainError:function(e){GC(e)},OnWebTwainNotFound:!1,OnWebTwainOldPluginNotAllowed:!1,OnWebTwainNeedUpgrade:!1,OnWebTwainNeedUpgradeWebJavascript:!1,OnWebTwainInitMessage:!1,ViewerJSIntegerited:!0,ActiveXInstallWithCAB:!1,IfUseActiveXForIE10Plus:!1,IfUseEmbeddedDownloadNoticeForActiveX:!1,IfCheckDCP:!1,IfDisableDefaultSettings:!1,OnWebTwainWillInit:!1,IfAddMD5InUploadHeader:!1,IfAlwaysFocusOnPopupWindow:!0,IfConfineMaskWithinTheViewer:!1,fetchOptions:{mode:"cors",credentials:"same-origin"},HideTrialMessage:!1,CheckCertExpired:!0,ConnectWithSocket:!1,SSLPort:18623,Port:18622,showLoadingMsgDialog:!0,licenseServer:void 0,sessionPassword:void 0,organizationID:void 0,handshakeCode:void 0,UseDefaultViewer:!0,Host:HC,DeviceFriendlyName:"",LocalHosts:["127.0.0.1","localhost","local.dynamsoftwebtwain.com","local.dynamsoft.com"],IfCheckCORS:!1,IfCheckCert:!0};function JC(){var e=Wt.DWT.Host;return xt.isString(e)&&""!=e||(Wt.DWT.Host=e=HC),e}function YC(){var e=300,t=Wt.DWT.RemoteScanConfig;return t&&xt.isNumber(t.sessionTimeout)&&t.sessionTimeout>0&&(e=t.sessionTimeout),e}var QC={URL:"",UpdateDaysBeforeExpired:30},XC=!0,qC=!1,ZC=Y.bHTML5Edition,$C=0,ew=qC;Y.bIE&&(""===($C=Y.IEVersion)||$C>=10?Wt.DWT.IfUseActiveXForIE10Plus?(ZC=qC,ew=XC,Y.bHTML5Edition=ZC):ZC=XC:(ZC=qC,$C>=9&&(ew=XC))),ew||ZC||(ZC=XC);var tw,rw,nw,iw,ow={SSLPort:18626,Port:18625,bEnhancedMode:!1,oldDWASMVerStr:"dwasm_13000404",oldDWASMVer:[13,0,0,"0404"],wsProtocol:"dwt_command",managerVersion:AC,managerVersionMac:DC,managerVersionLinux:PC,serviceVersion:RC,serviceVersionMac:xC,serviceVersionLinux:kC,detect:{dcpStatus:0,ddmPort:0,dwtPort:0,dwtSSLPort:0,bConnected:!1,connectedResult:"",MaxManagerModuleConnectCount:1,EnumDCP_DetectStatus:{Init:0,Connected:1,CheckingManagerVer:15,CheckingServiceVer:16,NotInstalled:17,CheckedService:5,VerifyingZip:6,VerifiedZip:7,UpdatingService:8,UpdateSucceed:9,UpdateFailed:10,UpdateSkipped:11}},strSID:"",b64bit:!0,objEnhancedPorts:{}},aw={name:"Dynamic Web TWAIN",bHTML5Edition:ZC,bActiveXEdition:ew,_iImageCaptureDriverType:3,_iBrokerProcessType:1,getChromeEditionPath:BC.getDSPath,getPKGPath:function(){return MC()+"DynamicWebTWAINMacEdition.pkg"},getMSIPath:function(){return MC()+"DynamicWebTWAINPlugIn.msi"},getActiveXCABx86Path:function(){return MC()+"DynamicWebTWAIN.cab"},getActiveXCABx64Path:function(){return MC()+"DynamicWebTWAINx64.cab"},onlineResources:"https://demo.dynamsoft.com/DWT/Resources/",strMIMEType:"Application/DynamicWebTwain-Plugin",strFullClassID:"E7DA7F8D-27AB-4EE9-8FC0-3FEC9ECFE758",scripts:{},dwtConfigLoaded:!1,dwtConfigLoading:!1,getServerVersionInfo:function(e){var t=zC.ServerVersionInfo;return Y.bWin||(Y.bMac?t=zC.ServerMacVersionInfo:Y.bAndroid?t=zC.ServerAndroidVersionInfo:(Y.bLinux||Y.bChromeOS||Y.bHarmonyOS)&&(t=zC.ServerLinuxVersionInfo)),e?t:xt.replaceAll(t,",","")},getDWTPrefix:function(){return!0===Wt.DWT.CustomMode?"dwtc_":"dwt_"},loadResourcePath:!1,loadingResourcePath:!1,handshakeCode:void 0,organizationID:void 0,licenseServer:void 0,sessionPassword:"",bPublicLTS:!0,refProductKey:void 0,ltsDebug:!1,bDWTLoading:!1,bDWTUnloading:!1,bAndroidConnected:!1,unloadQueue:[],appendBrowserLicenseWhenServiceMode:function(){},bDCPChecked:!1,bDWTChecked:!1,bChromeEdition:ZC},sw={bFullEdition:!1,getVersionStrForCheck:function(){return"".concat(mC,"000000")},versionInfoFromServer:"",hostForCheckCert:HC,RemoteReconnectMaxTimes:200,RemoteReconnectTimeSpan:5e3,LocalReconnectMaxTimes:60,LocaleReconnectTimeSpan:3e3},uw=Y.bSSL?3e3:1e3,cw=Y.bSSL?1e3:600;function lw(){return xt.isString(aw.handshakeCode)||xt.isString(aw.organizationID)||aw.bPublicLTS||xt.isString(Wt.DWT.ProductKey)&&xt.startsWith(Wt.DWT.ProductKey,"DLS2")}function dw(e){if(void 0===e)return!0;var t;if(e)for(t=0;t<Wt.DWT.LocalHosts.length;t++)if(e===Wt.DWT.LocalHosts[t])return!0;return!1}function fw(e,t,r){e._errorCode=t,e._errorString=r}function hw(e){var t=Wt.DWT.licenseException;t.code=e._errorCode,t.message=e._errorString,t.fromLTS=!1}function gw(){return Wt.DWT.bChromeExtension?"":"Please contact the site administrator."}function pw(e){fw(e,-1033,"Invalid index.")}function _w(e){fw(e,-1034,"Invalid value.")}function mw(e){fw(e,-1035,"There is no image.")}function vw(e){fw(e,-1110,"Unrecognized file extension.")}function yw(e){fw(e,-2007,"The system is busy, some operations are not completed. Please try later.")}function Sw(e,t){var r=t?["[",t,"]"].join(""):"your device";fw(e,rw.MustUpgrade,"The Dynamsoft Service installed on "+r+" is outdated and no longer works with the JavaScript code on the website.")}function Tw(e){fw(e,-2209,"The HTML5 edition does not support this method or property.")}function Iw(e){fw(e,-2300,"Http upload error: the HTTP Server name/ip cannot be empty.")}function bw(e){fw(e,-2301,"Network error.")}function Cw(e){fw(e,-2302,"The result format is invalid.")}function ww(e,t,r,n){if(t)fE(e);else if(e._errorCode=-2003,n&&n>0||r){var i=["HTTP process error: "];r&&(r.indexOf("HTTP process error: ")>=0&&(i=[""]),i.push(r)),n&&n>0&&i.push(" ("+n+")");var o=i.toString().lastIndexOf(".");o>=0&&o==i.toString().length-1?e._errorString=i.join(""):e._errorString=i.join("")+"."}else e._errorString="HTTP process error."}function Ew(e){fw(e,-2304,"Http download error: the url is invalid.")}function Aw(e,t,r,n){if(t)fw(e,-2305,"User cancelled the operation.");else if(e._errorCode=-2003,n&&n>0||r){var i=["HTTP put error: "];r&&(r.indexOf("HTTP put error: ")>=0&&(i=[""]),i.push(r));var o=i.toString().lastIndexOf(".");o>=0&&o==i.toString().length-1?e._errorString=i.join(""):e._errorString=i.join("")+"."}else e._errorString="HTTP put error."}function Dw(e,t,r,n){if(t)fw(e,-2305,"User cancelled the operation.");else if(e._errorCode=-2003,n&&n>0||r){var i=["HTTP process error: "];r&&(r.indexOf("HTTP process error: ")>=0&&(i=[""]),i.push(r));var o=i.toString().lastIndexOf(".");o>=0&&o==i.toString().length-1?e._errorString=i.join(""):e._errorString=i.join("")+"."}else e._errorString="HTTP process error."}function Pw(e){fw(e,-2306,"Upload Error: the upload file cannot be empty.")}function Rw(e){fw(e,-2307,"The width or height you entered is invalid.")}function xw(e){fw(e,-2313,"The size of the images you are about to upload has exceeded the limit.")}function kw(e){fw(e,-2314,"The parameter cannot be empty.")}function Fw(e){fw(e,-2320,"Invalid file.")}function Ow(e){fw(e,tw.LicenseInvalid,lw()?"The license is invalid.":"The current product key is empty or invalid."),hw(e)}function Ww(e,t){e._errorCode=tw.LicenseExpired;var r,n,i,o,a="";(t&&""!=t&&(-1==t.indexOf("on")&&(a=" on "+t),e.__licenseInfo&&(e.__licenseInfo.ExpireDate=t)),lw())?(r=Wt.DWT.EnumInstance.dwt_desktop,n=e._bRemoteMode&&null!==(i=null===(o=e._dmService)||void 0===o||null===(o=o.attrs)||void 0===o?void 0:o.UUID)&&void 0!==i?i:"",e._errorString="The license has expired"+a+". Please contact the application developer.",Wt.DWT.lcexp(r,n).then((function(){e._errorString=Wt.DWT.licenseException.message}))):(e._errorString="The current product key has expired"+a+". Please contact the application developer.",hw(e))}function Nw(e,t){lw()?111==t?(e._errorCode=tw.LicenseExpiredForDLS,e._errorString="The license for v"+mC+" Service Core Module has expired."):(e._errorCode=tw.LicenseNoCoreForDLS,e._errorString="The license for v"+mC+" Service Core Module is not found."):(e._errorCode=tw.LicenseNoCore,e._errorString="The current product key is missing the Service Core license. "+gw()),hw(e)}function Mw(e){e._errorCode=-2339,lw()?e._errorString="The license for the module pdf rasterizer is not found or has expired.":e._errorString="The current product key does not support pdf rasterizer. "+gw(),hw(e)}function Lw(e){fw(e,-2351,"You cannot upload more than one image when the format is BMP, JPG or PNG")}function Bw(e){fw(e,-2352,"The indices are out of range.")}function Uw(e){fw(e,-2353,"The header name being used is a protected keyword and is not allowed.")}function Vw(e){fw(e,-2358,"The type of the parameter indices must be an Array.")}function Gw(e){fw(e,-2359,"The index is out of range.")}function jw(e){fw(e,-2360,"The index is null or undefined.")}function Hw(e){fw(e,-2362,"The image type is not supported.")}function zw(e){fw(e,-2363,"The data format is not supported.")}function Kw(e){fw(e,-2365,"The url is invalid.")}function Jw(e){fw(e,-2376,"The generate url failed.")}function Yw(e){fw(e,-2377,"Failed to set Image Capture Driver Type.")}function Qw(e){fw(e,-2391,"Invalid event name.")}function Xw(e){fw(e,-2393,"Failed to convert the data to blob.")}function qw(e){fw(e,-2399,"Invalid imageId.")}function Zw(e){fw(e,-2416,"Invalid parameter.")}function $w(e){fw(e,-2426,"You have used a full license with a trial license which is not permitted. Please check and update Dynamsoft.DWT.ProductKey.")}function eE(e){fw(e,-2510,"The callback is not a function.")}function tE(e){fw(e,-2513,"The WebTwain instance has been destroyed and can not be used anymore.")}function rE(e){fw(e,-2530,"Document name cannot be empty.")}function nE(e){fw(e,-2531,"Document name is not a string.")}function iE(e){fw(e,-2548,"You cannot call this function when Dynamsoft.DWT.UseDefaultViewer is set to false.")}function oE(e){fw(e,-2549,"You cannot call this function when there is no ui binding.")}function aE(e){fw(e,0,"")}function sE(e){var t=e;return t||(t="[]"),{code:-2601,message:"Failed to connect to the Dynamsoft Service on "+t+". Please make sure Dynamsoft Service is running or the certificate is valid."}}function uE(e){var t;return e._bRemoteMode?sE(null===(t=e._dmService)||void 0===t||null===(t=t.attrs)||void 0===t?void 0:t.name).message:"The Dynamsoft Service has been stopped."}function cE(e){fw(e,-2607,"The device selected was not found under the current service object.")}function lE(e){fw(e,-2608,"IfShowFileDialog cannot be set to true when Object is created by CreateRemoteScanObjectAsync.")}function dE(e,t){xt.isString(t)&&""!=t?fw(e,rw.RemoteDynamsoftServiceStopped,"The Dynamsoft Service on ["+t+"] has been stopped."):fw(e,-2308,"The Dynamsoft Service has been stopped.")}function fE(e){fw(e,-2615,"User cancelled the operation.")}function hE(e){fw(e,-2616,"Invalid image format type.")}function gE(e){fw(e,-2618,"Only single index selection is allowed when enumImageType is set to BMP, JPG or PNG.")}function pE(e){fw(e,-2620,"The RemoteScan object has been disposed.")}function _E(e){fw(e,-2621,"Dynamsoft.DWT.Containers was not set.")}function mE(e){fw(e,-2622,'Please do not set enumImageType to "IT_MULTIPAGE_PDF", "IT_MULTIPAGE_TIF" or "IT_ALL".')}function vE(e){fw(e,-2624,"The element within Dynamsoft.DWT.Containers should be a valid object.")}function yE(e){fw(e,-2800,pC.ErrStr_Service_NOT_INSTALLED)}function SE(e){fw(e,rw.ResponseDataTypeError,"Invalid response data was returned from the Dynamsoft Service.")}function TE(e){return{code:-2807,message:'Error: The element specified by the id "'+e+"\" doesn't exist."}}function IE(e,t){fw(e,-2811,t)}function bE(e){fw(e,-2812,pC.ErrStr_CreateID_WebTwainIdDuplicated)}function CE(e){fw(e,-2815,pC.ErrStr_CreateID_ContainerIdDuplicated)}function wE(e,t,r){fw(e,-2816,["HTTP process error: ",r," (",t,")."].join(""))}function EE(){return{code:rw.HTSTError,message:"The Connection from the insecure (HTTP) web page failed for HTST."}}function AE(){return{code:rw.DWTPortNotReady,message:"The Dynamsoft Service is not ready, please try again later."}}function DE(e){return{code:-2826,message:"Failed to connect the Dynamsoft Service on ["+e+"]."}}function PE(e){fw(e,-2828,"Invalid PDF Convert Mode Value.")}function RE(e){fw(e,-2848,"The capability value is out of range.")}function xE(e){fw(e,-2854,"The imageId does not exist.")}function kE(e){fw(e,-2855,"The blob cannot be empty.")}function FE(e){fw(e,-2856,"Invalid blob value.")}function OE(e){fw(e,-2901,"Source document does not exist. Please check the document name or create the document before performing this operation.")}function WE(e){fw(e,-2902,"Target document does not exist. Please check the document name or create the document before performing this operation.")}!function(e){e.LicenseInvalid=-2325,e.LicenseExpired=-2326,e.LicenseParseFailed=-2546,e.LicenseExpiredForDLS=-2808,e.LicenseNoCoreForDLS=-2809,e.LicenseNoCore=-2810,e.LicenseIsFuture=-2396,e.LicenseVersionNotCurrent=-2539}(tw||(tw={})),Wt.DWT.EnumDWT_LicenseErrorCode=tw,function(e){e.UserCancelled=-1032,e.CORSErrorFromService=-2137,e.CommonError=-2201,e.ModuleNotExists=-2371,e.MustUpgrade=-2207,e.RemoteDynamsoftServiceStopped=-2613,e.ResponseDataTypeError=-2801,e.HTSTError=-2817,e.SSLCertExpired=-2818,e.SSLCertInvalid=-2819,e.CORSError=-2820,e.DWTPortNotReady=-2821,e.HTTPRedirected=-2823,e.BboError=-2827}(rw||(rw={}));var NE=Y.bIE&&Y.IEVersion<=9;nw=self&&self.fetch?self.fetch:window.fetch;var ME=0;function LE(e,t){var r,n=!1;return ME=t,nw?r=function(r,i){var o=!1,a="text",s=!1;if(i&&(i.dataType&&(a=i.dataType),i.fetchRaw&&(s=!0),i.timeout)){var u=i.timeout;u<300&&(u=300);var c=new AbortController;i.signal=c.signal,setTimeout((function(){o||c.abort()}),u)}n=!1;var l=nw(r,i).then((function(r){if(r.ok){var i,a;if(o=!0,!e)return r;if(e.__clickCancel)return e.__clickCancel=!1,e.__cancelBeforObjectCreated=!1,n=!0,r;e.IfShowCancelDialogWhenImageTransfer?(UE(!0),a=e.on("cancel",(function(){n=!0}))):UE(!1);var s=r.headers.get("Content-Length"),u=0;e._onPercent&&ME==t&&e._onPercent({loaded:u,total:s});var c=null==r||null===(i=r.body)||void 0===i?void 0:i.getReader(),l=new ReadableStream({start:function(r){c?setTimeout((function i(){return c.read().then((function(o){if(o.done||n)return n?c.cancel():a&&e.off("cancel",a),r.close(),void(a=null);var l=o.value;u+=l.length,e._onPercent&&ME==t&&e._onPercent({loaded:u,total:s});try{return r.enqueue(l),i()}catch(d){xt.error(d)}}))}),0):r.close()}}),d=r.headers.get("Content-Type");return d&&""!=d||(d="application/octet-stream"),new Response(l,{headers:{"Content-Type":d}})}if("opaqueredirect"==r.type)throw{code:rw.HTTPRedirected,message:"The http url redirected."};var f;throw wE(f={},r.status,r.statusText),{code:f._errorCode,message:f._errorString,httpCode:r.status}}));return s?l:(l="blob"==a?l.then((function(e){var t=e.headers.get("content-type");return"text/json"==t?e.json():Y.bLinux?e.arrayBuffer().then((function(e){return new Blob([e],{type:t})})):e.blob()})):"json"==a?l.then((function(e){return e.json()})):"arraybuffer"==a?l.then((function(e){return"text/json"==e.headers.get("content-type")?e.json():e.arrayBuffer()})):l.then((function(e){return e.text()}))).then((function(e){var t;if(n)throw fE(t={}),{code:t._errorCode,message:t._errorString};return e}))}:(NE&&xt.addVBS(["Function dsVbsBinGetAt(strBinary,iOffset)\r\n"," dsVbsBinGetAt=AscB(MidB(strBinary,iOffset+1,1))\r\n","End Function\r\n","Function dsVbsBinGetBytes(strBinary,iOffset,iLength)\r\n"," Dim aBytes()\r\n"," ReDim aBytes(iLength-1)\r\n"," For i=0 To iLength-1\r\n","  aBytes(i)=dsVbsBinGetAt(strBinary,iOffset+i)\r\n"," Next\r\n"," dsVbsBinGetBytes=aBytes\r\n","End Function\r\n","Function dsVbsBinGetLength(strBinary)\r\n"," dsVbsBinGetLength=LenB(strBinary)\r\n","End Function"].join("")),r=function(r,n){return new(Dt.nativePromise||window.Promise)((function(i,o){var a,s=!1;a={url:r,async:!0,onSuccess:function(e,t,r){var n=!1;if(r.responseHeadersString&&-1!=r.responseHeadersString.indexOf("text/json")&&(xt.isArray(e)||e instanceof ArrayBuffer)&&(n=!0),n){var o=e;e instanceof ArrayBuffer&&(o=new Uint8Array(e));var a=String.fromCharCode.apply(null,o);i(a)}else i(e)},onError:function(e,t,r){var n;wE(n={},r.status,t),o({code:n._errorCode,message:n._errorString,httpCode:r.status})},dataType:"text",method:iw,data:iw,headers:iw,contentType:iw,mimeType:iw},n&&(n.method&&(a.method=n.method),n.body&&(a.data=n.body),n.headers&&(a.headers||(a.headers={}),xt.each(n.headers,(function(e,t){"content-type"==t.toLowerCase()&&(s=!0),a.headers[t]=e}))),n.dataType&&(a.dataType=n.dataType),n.contentType&&(a.contentType=n.contentType),xt.isNumber(n.timeout)&&n.timeout>0&&(a.timeout=n.timeout)),s&&(a.contentType=!1),"blob"==a.dataType&&NE&&(a.mimeType="text/plain; charset=x-user-defined"),e&&(e._onPercent&&(a.beforeSend=function(r,n,i){r.upload.addEventListener("progress",(function(r){e._onPercent&&ME==t&&e._onPercent(r)}),!1)}),e.IfShowCancelDialogWhenImageTransfer?UE(!0):UE(!1));var u=fC(a);e&&e.IfShowCancelDialogWhenImageTransfer&&e.on("cancel",(function(){u.abort()}))}))}),r}var BE=LE(null,0);function UE(e){var t=xt.sizzle(".dynamsoft-btnCancel");t.length>0&&(t[0].style.display=e?"":"none")}function VE(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(Qb){return void r(Qb)}s.done?t(u):Promise.resolve(u).then(n,i)}function GE(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function a(e){VE(o,n,i,a,s,"next",e)}function s(e){VE(o,n,i,a,s,"throw",e)}a(void 0)}))}}String.prototype.startsWith||(String.prototype.startsWith=function(e){return 0==this.indexOf(e)});var jE,HE,zE=function(e){var t,r=e,n=r._license||"",i=JSON.parse(JSON.stringify(r._licenseServer)),o=r._sessionPassword,s=0;if(n.startsWith("t")||n.startsWith("f"))s=0;else if(0===n.length||n.startsWith("P")||n.startsWith("L")||n.startsWith("Y")||n.startsWith("A"))s=1;else{s=2;var u=n.indexOf(":");if(-1!=u&&(n=n.substring(u+1)),n.startsWith("DLS2")){var c;try{var l=n.substring(4);l=a.Lib.atob(l),c=JSON.parse(l)}catch(g){throw new Error("Format Error: The license string you specified is invalid, please check to make sure it is correct.")}if("number"==typeof(n=c.handshakeCode?c.handshakeCode:c.organizationID?c.organizationID:"")&&(n=JSON.stringify(n)),0===i.length){var d=[];c.mainServerURL&&(d[0]=c.mainServerURL),c.standbyServerURL&&(d[1]=c.standbyServerURL),i=function(e){if(null==e)e=[];else{e instanceof Array||(e=[e]);for(var t=0;t<e.length;++t){if(document&&document.createElement){var r=document.createElement("a");r.href=e[t],e[t]=r.href}e[t].lastIndexOf("/")!=e[t].length-1&&(e[t]+="/")}}return e}(d)}!o&&c.sessionPassword&&(o=c.sessionPassword),t=c.remark}("200001"===n||n.startsWith("200001-"))&&(i&&i.length||(n="")),n||(s=1)}return 1===s&&(n=""),{lt:s,l:n,ls:i,sp:o,rmk:t}},KE=s((function e(r,n,i,o,a){t(this,e),this.server=r,this.port=n,this.ssl=i,this.useWS=o,this.protocol=a}));function JE(e,t){return(null==e?void 0:e.port)==(null==t?void 0:t.port)&&(null==e?void 0:e.protocol)==(null==t?void 0:t.protocol)&&(null==e?void 0:e.server)==(null==t?void 0:t.server)&&(null==e?void 0:e.ssl)==(null==t?void 0:t.ssl)&&(null==e?void 0:e.useWS)==(null==t?void 0:t.useWS)}function YE(t,r){if(r&&("object"===e(r)||"function"==typeof r))return r;if(void 0!==r)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(t)}function QE(e){return QE=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},QE(e)}function XE(e,t){return XE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},XE(e,t)}function qE(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&XE(e,t)}!function(e){e.OK=0,e.Custom=-1,e.NWB=-4200,e.WS_DISCONN=-4201,e.CB=-5e3,e.JSON_REQUIRED=-5001,e.OBJECT_DISPOSED=-5002,e.INVALID_TASK=-5003,e.OBJECT_DISPOSING=-5004}(jE||(jE={})),function(e){e.WS_DISCONN="The Web Socket connection failed.",e.JSON_REQUIRED="The input is not a JSON object or JSON styled string.",e.OBJECT_DISPOSED="The object has been disposed.",e.INVALID_TASK="The task is invalid.",e.OBJECT_DISPOSING="The object need to be disposed."}(HE||(HE={}));var ZE=s((function e(){t(this,e)}),null,[{key:"message",value:function(e){return this._errorMessage[e]}},{key:"init",value:function(){this._errorMessage[jE.OK]="Successful.",this._errorMessage[jE.WS_DISCONN]=HE.WS_DISCONN,this._errorMessage[jE.JSON_REQUIRED]=HE.JSON_REQUIRED,this._errorMessage[jE.OBJECT_DISPOSED]=HE.OBJECT_DISPOSED,this._errorMessage[jE.INVALID_TASK]=HE.INVALID_TASK,this._errorMessage[jE.OBJECT_DISPOSING]=HE.OBJECT_DISPOSING}}]);Mb(ZE,"_errorMessage",Object.create(null)),ZE.init();var $E,eA=s((function e(r,n){t(this,e),Mb(this,"_code",jE.OK),this.name="DSError",this.message=null!=n?n:"string"==typeof r?r:ZE.message(r),this._code="string"==typeof r?jE.Custom:r}),[{key:"code",get:function(){return this._code}}]);function tA(e){return{code:e._errorCode,message:e._errorString}}function rA(e){return"exception"in e&&"description"in e&&0!=e.exception&&""!=e.description}function nA(e){return-1416==e}!function(e){e.GET_TASKID=0,e.GET_EVENT_TASKID=1,e.ONMESSAGE_PROCESS_DATA=2,e.ONMESSAGE_GET_TASKID=3,e.ONMESSAGE_GET_EVENT_TASKID=4,e.HANDLE_RAW_MESSAGE=5,e.HANDLE_PROCESSED_MESSAGE=6}($E||($E={}));var iA=function(){return s((function e(r){t(this,e),Mb(this,"_serverInfo",void 0),Mb(this,"_disposed",!1),this._serverInfo=r,this._ref=1}),[{key:"serverInfo",get:function(){return this._serverInfo}},{key:"requestSync",value:function(e,t){VC.error("requestSync should be implemented in child class")}},{key:"request",value:function(){var e=GE(m.mark((function e(t,r,n,i){return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return VC.error("request should be implemented in child class"),e.abrupt("return",null);case 2:case"end":return e.stop()}}),e)})));return function(t,r,n,i){return e.apply(this,arguments)}}()},{key:"send",value:(i=GE(m.mark((function e(t,r,n){return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:VC.error("reqsenduestSync should be implemented in child class");case 1:case"end":return e.stop()}}),e)}))),function(e,t,r){return i.apply(this,arguments)})},{key:"testConnection",value:(n=GE(m.mark((function e(t,r,n,i){return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return VC.error("testConnection should be implemented in child class"),e.abrupt("return");case 2:case"end":return e.stop()}}),e)}))),function(e,t,r,i){return n.apply(this,arguments)})},{key:"disposed",get:function(){return this._disposed}},{key:"dispose",value:(r=GE(m.mark((function e(){return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._ref--,!(this._ref>0)){e.next=3;break}return e.abrupt("return",!1);case 3:return this._disposed=!0,e.next=6,this._terminate();case 6:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"_terminate",value:(e=GE(m.mark((function e(){return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(){return e.apply(this,arguments)})},{key:"addRef",value:function(){this._ref++}}]);var e,r,n,i}();function oA(e,t){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.add(e)}function aA(e,t,r){return t.has(e),r}var sA,uA=xt.getLogger(),cA=new WeakSet,lA=new WeakSet,dA=function(e){function r(){var e;t(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return e=function(e,t,r){return t=QE(t),YE(e,function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(QG){return!1}}()?Reflect.construct(t,r||[],QE(e).constructor):t.apply(e,r))}(this,r,[].concat(i)),oA(e,lA),oA(e,cA),e}return qE(r,e),s(r,[{key:"send",value:(i=GE(m.mark((function e(t,r,n){return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:uA.error("HTTP Client send not supported");case 1:case"end":return e.stop()}}),e)}))),function(e,t,r){return i.apply(this,arguments)})},{key:"requestSync",value:function(e,t,r){}},{key:"request",value:function(e,t,r,n){return aA(this,lA,hA).call(this,e,t,r,void 0,void 0,n)}},{key:"testConnection",value:(n=GE(m.mark((function e(t,r,n,i){return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",aA(this,lA,hA).call(this,void 0,void 0,t,r,n,i));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t,r,i){return n.apply(this,arguments)})}]);var n,i}(iA);function fA(e){var t=this.serverInfo,r="";return r=t.ssl?"https://":"http://",r+=t.server,t.port&&(r+=":",r+=t.port),e&&(xt.startsWith(e,"/")||xt.endsWith(r,"/")||(r+="/"),xt.endsWith(e,"/")?r+=e.slice(0,-1):r+=e),r}function hA(e,t,r,n,i,o){return gA.apply(this,arguments)}function gA(){return gA=GE(m.mark((function e(t,r,n,i,o,a){var s,u;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,s=null!=n?n:{},t&&(s.body=t),s.method||(s.method="POST"),a&&(s.timeout=a),u=aA(this,cA,fA).call(this,r),uA.debug("HTTP URL: "+u),e.next=9,BE(u,s);case 9:return e.abrupt("return",e.sent);case 12:if(e.prev=12,e.t0=e.catch(0),!(e.t0 instanceof eA||e.t0&&e.t0.code&&e.t0.message)){e.next=18;break}throw e.t0;case 18:if(!e.t0.message){e.next=20;break}throw new eA(e.t0.message);case 20:case"end":return e.stop()}}),e,this,[[0,12]])}))),gA.apply(this,arguments)}function pA(t){try{return"object"===e(t)?t:(t="string"!=typeof t?xt.stringify(t):t,xt.parse(t))}catch(r){throw r instanceof eA?r:new eA(jE.JSON_REQUIRED)}}function _A(e){return Math.random().toString(16).substring(2,2+e)}function mA(e,t){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.add(e)}function vA(e,t,r){return t.has(e),r}var yA,SA,TA=xt.getLogger(),IA=1006,bA=new WeakSet,CA=new WeakSet,wA=new WeakSet,EA=new WeakSet,AA=new WeakSet,DA=new WeakSet,PA=new WeakSet,RA=function(e){function r(e){var n,i,o,a;return t(this,r),i=this,a=[e],o=QE(o=r),mA(n=YE(i,function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(QG){return!1}}()?Reflect.construct(o,a||[],QE(i).constructor):o.apply(i,a)),PA),mA(n,DA),mA(n,AA),mA(n,EA),mA(n,wA),mA(n,CA),mA(n,bA),Mb(n,"_defaultRetries",1),Mb(n,"_ws",yA),Mb(n,"_events",{}),Mb(n,"_bHeartBeatStarted",!1),Mb(n,"_heartBeatTicks",6e4),n._ws=yA,n.bUseParentWS=!1,n._tasks=Object.create(null),n.bReady=!1,n._blob_callbacks=[],n._processing_blob=!1,n}return qE(r,e),s(r,[{key:"ws",get:function(){return this._ws}},{key:"requestSync",value:function(e,t,r){TA.error("WebSocket Client requestSync not supported")}},{key:"send",value:(o=GE(m.mark((function e(t,r,n){var i,o,a,s;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=n.client,e.prev=1,void 0!==(o=n.taskId)){e.next=7;break}return e.next=6,r(t,$E.GET_TASKID,i._requestTaskId,n);case 6:o=e.sent;case 7:if(a=i._tasks[o]){e.next=11;break}throw TA.error("invalid task id: "+o),new eA(jE.INVALID_TASK);case 11:return e.next=13,vA(i,AA,MA).call(i,!1);case 13:return e.next=15,vA(i,DA,BA).call(i,t,r,n,a);case 15:TA.debug("begin to send data "+o),i.disposed||i._ws.send(t),t=null,TA.debug("end to send data "+o),e.next=27;break;case 21:e.prev=21,e.t0=e.catch(1),TA.debug("failed to send data."),TA.error(e.t0),delete i._tasks[o],null===(s=a)||void 0===s||null===(s=s.resolver)||void 0===s||s.reject(e.t0.message);case 27:case"end":return e.stop()}}),e,null,[[1,21]])}))),function(e,t,r){return o.apply(this,arguments)})},{key:"request",value:function(e,t,r,n){var i=this._defaultRetries,o=null!=t?t:vA(this,EA,WA),a=null!=r?r:{client:this,userData:this};return vA(this,PA,VA).call(this,e,o,a,i,!1,void 0,n)}},{key:"connected",get:function(){var e;return(null===(e=this._ws)||void 0===e?void 0:e.readyState)==WebSocket.OPEN}},{key:"testConnection",value:function(e,t,r,n){return vA(this,AA,MA).call(this,!0,null!=t?t:0,r,n)}},{key:"_terminate",value:(i=GE(m.mark((function e(){var t,r;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r in TA.debug("terminate WSClient"),this.fireEvent("disposed"),t=!1,this._tasks)void 0!==this._tasks[r]&&this._tasks[r].resolver&&(t=!0);if(this._lic_callback=yA,this._blob_callbacks=[],this._processing_blob=!1,this._ws&&(this._ws.onopen=null,this._ws.onerror=null,this._ws.onmessage=null,this._ws.onclose=null,this._ws.close()),this._ws=yA,this._tasks=Object.create(null),!t){e.next=12;break}throw new eA(jE.OBJECT_DISPOSING);case 12:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"setRetry",value:function(e){this._defaultRetries=null!=e?e:1}},{key:"addEvent",value:function(e,t,r){var n=this._events[e];n||(this._events[e]={},n=this._events[e]),xt.isString(t)&&xt.isFunction(r)&&(n[t]=r)}},{key:"removeEvent",value:function(e,t){var r=this._events[e];r&&xt.isString(t)&&delete r[t]}},{key:"clearEvent",value:function(e){this._events[e]&&(this._events[e]={})}},{key:"fireEvent",value:function(e){var t,r=this._events[e];if(r){var n=Object.keys(r);for(t=0;t<n.length;t++)xt.isFunction(r[n[t]])&&r[n[t]]()}}},{key:"getRequestTaskId",value:function(){return this._requestTaskId?this._requestTaskId:0}}],[{key:"_waitForPreBlob",value:(n=GE(m.mark((function e(t){return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t._processing_blob){e.next=3;break}return setTimeout((function(){r._waitForPreBlob(t)}),500),e.abrupt("return");case 3:r._preBlobResolv&&r._preBlobResolv();case 4:case"end":return e.stop()}}),e)}))),function(e){return n.apply(this,arguments)})}]);var n,i,o}(iA);function xA(e){var t="";return t=e.ssl?"wss://":"ws://",t+=e.server,e.port&&(t+=":",t+=e.port),t}function kA(e,t,r,n){var i=this;return new Dt.Promise((function(o,a){try{var s,u,c=a,l=o;if(n&&(u=setTimeout((function(){var e=new eA("createWebSocket timed out.");TA.debug(e.message),c&&(c(e),c=null,l=null),u&&clearTimeout(u),s&&s.close()}),n)),e.bUseParentWS){var d=window,f=parent,h=d.WebSocket;try{for(;d!=f&&f&&f.WebSocket;)h=f.WebSocket,d=f.window,f=f.parent}catch(m){h=window.WebSocket}s=r?new h(t,r):new h(t)}else s=r?new WebSocket(t,r):new WebSocket(t);s.onopen=function(){u&&clearTimeout(u),e._ws=s,l&&(l(s),c=null,l=null)},s.onerror=function(t){s.close(),e.bReady=!1,u&&clearTimeout(u),i.fireEvent("error"),c&&(c(new eA("websocket error")),c=null,l=null)},s.onmessage=function(t){vA(e,wA,FA).call(e,e,t.data)},s.onclose=function(t){e.bReady=!1,u&&clearTimeout(u),i.fireEvent("close"),c&&(t&&t.code==IA?c(new eA("websocket error")):c(t),c=null,l=null)}}catch(v){if(v instanceof eA||v&&v.code&&v.message)throw v;if(v.message)throw new eA(v.message)}}))}function FA(e,t){return OA.apply(this,arguments)}function OA(){return OA=GE(m.mark((function t(r,n){var i,o,a,s,u,c,l,d,f;return m.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=r,t.prev=1,s={client:i,userData:void 0},"object"!==e(n)){t.next=17;break}if(!(i._blob_callbacks.length>0)){t.next=17;break}if(!i._processing_blob){t.next=9;break}return t.next=8,new Dt.Promise((function(e){sA._preBlobResolv=e,sA._waitForPreBlob(i)}));case 8:sA._preBlobResolv=null;case 9:return i._processing_blob=!0,u=i._blob_callbacks.shift(),t.next=13,u(n);case 13:return t.sent,i._processing_blob=!1,t.abrupt("return");case 17:if(!(i.bReady&&xt.isString(n)&&(n.indexOf("Function not found")>0||n.indexOf("Version not found")>0))){t.next=19;break}return t.abrupt("return");case 19:if(i._cbToGetTaskId){t.next=21;break}return t.abrupt("return");case 21:return t.next=23,i._cbToGetTaskId(n,$E.ONMESSAGE_PROCESS_DATA,i._requestTaskId,s);case 23:return c=t.sent,l=!1,t.next=27,i._cbToGetTaskId(c,$E.ONMESSAGE_GET_TASKID,i._requestTaskId,s);case 27:if(a=t.sent){t.next=36;break}if(!c.Detail||!c.Domain){t.next=32;break}return i._lic_callback&&i._lic_callback(c),t.abrupt("return");case 32:return t.next=34,i._cbToGetTaskId(c,$E.ONMESSAGE_GET_EVENT_TASKID,i._requestTaskId,s);case 34:(a=t.sent)&&(l=!0);case 36:if(o=i._tasks[a]){t.next=46;break}if(!l){t.next=42;break}o={},t.next=44;break;case 42:return""!=a&&TA.log("invalid task id: "+a),t.abrupt("return");case 44:t.next=48;break;case 46:if(!o.timedout){t.next=48;break}return t.abrupt("return");case 48:return t.next=50,i._cbToGetTaskId(n,$E.HANDLE_RAW_MESSAGE,i._requestTaskId,o.ctx);case 50:if(void 0!==(d=t.sent)){t.next=55;break}return t.next=54,i._cbToGetTaskId(c,$E.HANDLE_PROCESSED_MESSAGE,i._requestTaskId,o.ctx);case 54:d=t.sent;case 55:d&&!l&&(o.tmid&&clearTimeout(o.tmid),delete i._tasks[a],o.resolver&&o.resolver.resolve(d)),t.next=64;break;case 58:t.prev=58,t.t0=t.catch(1),TA.debug("failed to handle message."),t.t0 instanceof Error?TA.error(t.t0):TA.error(xt.stringify(t.t0)),delete i._tasks[a],null===(f=o)||void 0===f||null===(f=f.resolver)||void 0===f||f.reject(t.t0.message);case 64:case"end":return t.stop()}}),t,null,[[1,58]])}))),OA.apply(this,arguments)}function WA(e,t,r){return NA.apply(this,arguments)}function NA(){return NA=GE(m.mark((function e(t,r,n){var i,o;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=r,e.next=e.t0===$E.GET_TASKID?3:e.t0===$E.HANDLE_RAW_MESSAGE?7:9;break;case 3:return(o=pA(t)).cmdId=null!==(i=o.cmdId)&&void 0!==i?i:(void 0,void 0,[_A(8),"-",_A(4),"-",_A(4),"-",_A(4),"-",_A(8)].join("")),Dt.Promise.resolve(["cmdId"]),e.abrupt("break",9);case 7:return Dt.Promise.resolve(t),e.abrupt("break",9);case 9:case"end":return e.stop()}}),e)}))),NA.apply(this,arguments)}function MA(e,t,r,n){return LA.apply(this,arguments)}function LA(){return LA=GE(m.mark((function e(t,r,n,i){var o,a,s,u;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.connected&&!this.disposed){e.next=2;break}return e.abrupt("return");case 2:if(!(s=this)._connectPromise){e.next=7;break}return e.next=6,s._connectPromise;case 6:return e.abrupt("return");case 7:return r=null!==(o=r)&&void 0!==o?o:this._defaultRetries,n=null!==(a=n)&&void 0!==a?a:100,u=vA(s,bA,xA).call(s,s.serverInfo),TA.debug("WebSocket URL: "+u+", try to create websocket "+r+"/"+n),s._connectPromise=new Dt.Promise((function(e,t){var o=function(n){vA(s,CA,kA).call(s,s,u,s.serverInfo.protocol,i).then((function(t){e(t)})).catch((function(e){TA.debug("create websocket failed: "+e.message),n<r?a(n):t(e)}))};function a(e,t,r){setTimeout((function(){o(++e)}),n)}o(0)})),e.prev=12,e.next=15,s._connectPromise;case 15:e.next=20;break;case 17:throw e.prev=17,e.t0=e.catch(12),e.t0;case 20:return e.prev=20,s._connectPromise=null,e.finish(20);case 23:case"end":return e.stop()}}),e,this,[[12,17,20,23]])}))),LA.apply(this,arguments)}function BA(e,t,r,n){return UA.apply(this,arguments)}function UA(){return UA=GE(m.mark((function e(t,r,n,i){var o,a,s,u;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=this,a=n.eventTaskId,s=n.lastEventTaskId,void 0!==a){e.next=7;break}return e.next=6,r(t,$E.GET_EVENT_TASKID,o._requestTaskId,n);case 6:a=e.sent;case 7:a&&(o._tasks[a]?n&&n.userData&&n.userData.command&&((u=o._tasks[a]).ctx=n,s&&((u=o._tasks[s]).ctx=n)):(u={id:i.id,resolver:null,ctx:n,timedout:!1},o._tasks[a]=u,s&&(o._tasks[s]=u)));case 8:case"end":return e.stop()}}),e,this)}))),UA.apply(this,arguments)}function VA(e,t,r,n,i,o,a){return GA.apply(this,arguments)}function GA(){return GA=GE(m.mark((function e(t,r,n,i,o,a,s){var u,c,l,d;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=this,e.prev=1,n.client=u,e.next=5,vA(u,AA,MA).call(u,o,i,a,s);case 5:if("0"!=(c=n.taskId)){e.next=12;break}return u.disposed||u._ws.send(t),t=null,e.abrupt("return");case 12:if(void 0!==c){e.next=16;break}return e.next=15,r(t,$E.GET_TASKID,null,n);case 15:c=e.sent;case 16:return void 0===c&&TA.debug("websocket send: task id is invalid."),(l={}).promise=new Dt.Promise((function(e,t){l.resolve=e,l.reject=t})),d={id:c,resolver:l,ctx:n,timedout:!1},u._tasks[c]=d,u._requestTaskId=c,e.next=24,vA(u,DA,BA).call(u,t,r,n,d);case 24:return u._cbToGetTaskId=r,s&&(d.tmid=setTimeout((function(){TA.debug("ws request time out."),d.timedout=!0,d.resolver.reject("request timed out.")}),s)),u.disposed||u._ws.send(t),TA.debug("end to send task "+c),t=null,e.abrupt("return",l.promise);case 32:if(e.prev=32,e.t0=e.catch(1),c&&delete u._tasks[c],!(e.t0 instanceof eA||e.t0&&e.t0.code&&e.t0.message)){e.next=39;break}throw e.t0;case 39:if(!e.t0.message){e.next=41;break}throw new eA(e.t0.message);case 41:return e.prev=41,t=null,e.finish(41);case 44:case"end":return e.stop()}}),e,this,[[1,32,41,44]])}))),GA.apply(this,arguments)}function jA(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return HA(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?HA(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function HA(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function zA(e,t){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.add(e)}function KA(e,t,r){return t.has(e),r}sA=RA;var JA=new WeakSet,YA=new WeakSet,QA=function(){function e(){t(this,e),zA(this,YA),zA(this,JA),Mb(this,"_maxWebSocketCon",10),Mb(this,"_wsClients",[])}return s(e,[{key:"removeTerminatedWSClient",value:function(){this._wsClients=this._wsClients.filter((function(e){return!e.disposed}))}},{key:"getClient",value:function(e,t){return e.useWS?KA(this,YA,qA).call(this,e,t):new dA(e)}},{key:"closeClient",value:(r=GE(m.mark((function e(t){var r,n,i,o;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=this._wsClients,n=jA(r),e.prev=2,n.s();case 4:if((i=n.n()).done){e.next=12;break}if(!JE((o=i.value).serverInfo,t)){e.next=10;break}if(o.disposed){e.next=10;break}return e.next=10,o.dispose();case 10:e.next=4;break;case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(2),n.e(e.t0);case 17:return e.prev=17,n.f(),e.finish(17);case 20:this.removeTerminatedWSClient();case 21:case"end":return e.stop()}}),e,this,[[2,14,17,20]])}))),function(e){return r.apply(this,arguments)})},{key:"terminate",value:function(){var e=this._wsClients.slice();this._wsClients=[],e.forEach((function(e){e.dispose()}))}}],[{key:"Instance",get:function(){return this._gClientPool||(this._gClientPool=new e),this._gClientPool}}]);var r}();function XA(e){this.removeTerminatedWSClient();var t,r=jA(this._wsClients);try{for(r.s();!(t=r.n()).done;){var n=t.value;if(JE(n.serverInfo,e)&&!n.disposed)return n.addRef(),n}}catch(s){r.e(s)}finally{r.f()}return null}function qA(e,t){var r;return t||(r=KA(this,JA,XA).call(this,e)),r||(this._wsClients.length<this._maxWebSocketCon?((r=new RA(e)).addEvent("disposed","1",(function(){SA.Instance.removeTerminatedWSClient()})),this._wsClients.push(r),r):null)}SA=QA,Mb(QA,"_gClientPool",null);var ZA=function(){function e(){t(this,e)}return s(e,null,[{key:"getHttpClientForDcp",value:function(t,r){var n,i=Wt.dcp,o=Dt.detect.ssl;if(r||!Y.bSSL?(n=i.Port,o=!1):(n=i.SSLPort,o=!0),xt.isString(t)){var a=new KE;return xt.startsWith(t,"https://")?(a.ssl=!0,a.server=t.substring(8)):xt.startsWith(t,"http://")?(a.ssl=!1,a.server=t.substring(7)):(a.ssl=Dt.detect.ssl,a.server=t),QA.Instance.getClient(a)}return e.getHttpClient(null,n,o)}},{key:"getHttpClient",value:function(e,t,r){var n=r?"https":"http",i=new KE(e||JC(),t,r,!1,n);return QA.Instance.getClient(i)}},{key:"getWsClient",value:function(e,t,r,n){var i=new KE(e||JC(),t,r,!0,ow.wsProtocol);return QA.Instance.getClient(i,n)}},{key:"closeWsClient",value:function(e,t,r){var n=new KE(e||JC(),t,r,!0,ow.wsProtocol);return QA.Instance.closeClient(n)}}])}();Dt.ClientPool=QA;var $A,eD=parseInt(mC),tD=parseInt(vC),rD=parseInt("0"),nD="ddm/",iD="ddm_"+[eD,tD,rD,yC].join("");function oD(){return nD+iD}function aD(e){return sD.apply(this,arguments)}function sD(){return(sD=GE(m.mark((function e(t){var r,n,i,o;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=uw,n=[oD(),"/VersionInfo?","ts=",xt.now()].join(""),i=['{"id":"',xt.guid(),'","method":"VersionInfo"}'].join(""),o=ZA.getHttpClientForDcp(t),e.abrupt("return",o.request(i,n,{dataType:"json"},r));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function uD(){var e=window.Dynamsoft.Lib.Promise;if($A)return e.resolve($A);var t,r=navigator;if(r&&"userAgentData"in r){var n=navigator.userAgentData;if(n.platform&&""!=n.platform){var i=[];if("brands"in n&&xt.isArray(n.brands)&&n.brands.length>0?i=n.brands:"uaList"in n&&xt.isArray(n.uaList)&&n.uaList.length>0&&(i=n.uaList),i.length>0)return(t=function(e){var t=Y,r=e.architecture.toLowerCase(),n="64"==e.bitness,i=r.indexOf("arm")>-1,o=r.indexOf("mips")>-1;return{bUseUserAgent:!1,bWin:t.bWin,bMac:t.bMac,bLinux:t.bLinux,bAndroid:t.bAndroid,bMobile:t.bMobile,bPad:t.bPad,bChromeOS:t.bChromeOS,bHarmonyOS:t.bHarmonyOS,bArm64:i,bMips64:o,bEmbed:i||o,bOSx64:n,bIE:!1,bEdge:t.bEdge,bChrome:t.bChrome,bFirefox:t.bFirefox,bSafari:t.bSafari,bOpera:t.bOpera,bGecko:!0,bHuaWeiBrowser:!1,bHTML5Edition:!0,strBrowserVersion:t.strBrowserVersion,IEMode:0}},navigator.userAgentData.getHighEntropyValues(["platform","platformVersion","architecture","bitness"]).then(t)).then((function(e){return $A=e,e}))}}return $A=Y,e.resolve($A)}Dt.install={_divDWTNonInstallContainerID:"dwt-NonInstallContainerID",_divDWTemessageContainer:"",_dlgInstall:!1},Dt.install._strNonInstallDIV=['<div style="text-align:center;" id="',Dt.install._divDWTNonInstallContainerID,'"></div>'].join("");var cD=0,lD=[],dD=!(!document||!document.addEventListener),fD="DOMContentLoaded",hD="readystatechange",gD="load",pD="complete",_D=dD?function(e,t,r){e.addEventListener(t,r,!1)}:function(e,t,r){e.attachEvent("on"+t,r)},mD=dD?function(e,t,r){e.removeEventListener(t,r,!1)}:function(e,t,r){e.detachEvent("on"+t,r)};function vD(){cD||(cD=1,uD().then((function(){document&&mD(window,gD,vD),function(){for(var e=function(){try{lD[t]()}catch(QG){xt.log(QG,"error"),setTimeout((function(){throw QG}),0)}},t=0;t<lD.length;t++)e()}()})))}function yD(e){if(cD)try{e()}catch(QG){xt.log(QG,"error"),setTimeout((function(){throw QG}),0)}else lD.push(e);return this}function SD(e){xt.log(e)}yD((function(){var e=document.createElement("style"),t=["dialog[open]{display:block}dialog[closed]{display:none}.dynamsoft-backdrop{position:fixed;background:rgba(128,128,128,0.1);top:0;bottom:0;left:0;right:0;z-index:-99999999;}.dynamsoft-dwt-dialogProgress{width:330px;background:#FFF}.dynamsoft-finalMessage{margin:0;color:#3a3a3a;font:20px Arial,sans-serif}.dynamsoft-desc{margin:7px 0;color:#3a3a3a;font:14px Arial,sans-serif}.dynamsoft-status{color:#555;font:14px/22px Arial,sans-serif;margin-bottom:5px}.dynamsoft-progressBar{-webkit-appearance:none;width:280px;margin-bottom:20px;height:14px}.dynamsoft-progressBar,.dynamsoft-progressBar::-webkit-progress-bar{background-color:#e7e7e7;border-radius:7px}.dynamsoft-progressBar::-webkit-progress-value,.dynamsoft-progressBar::-moz-progress-bar{background-color:#50a8e1;border-radius:7px}.dynamsoft-loadingMsg{width:290px;height:290px;margin:auto;color:#CCC;border-width:1px;background:#FFF}.dynamsoft-loadingMsg-msg{margin:0 0 15px 25px;color:#3a3a3a;font:20px Arial,sans-serif}.dynamsoft-loadingMsg-desc{text-align:center;margin:0 0 15px 0;color:#3a3a3a;font:14px Arial,sans-serif}.ds-dwt-loaderBar-noserver-parent{height:100%;}.ds-dwt-loaderBar-noserver{margin: 0 auto;padding-top: 50px;text-align: center;}.ds-dwt-loaderBar-noserver img{height: 100px}"].join("");e.type="text/css";try{e.appendChild(document.createTextNode(t))}catch(r){e.styleSheet.cssText=t}document.body.appendChild(e)})),Dt._zdgb_xkz_dhk=function(){var e=Dt.install._dlgInstall;if(e){var t=xt.sizzle(".dynamsoft-dialog-closeTimer",e);if(t.length>0){var r=t[0],n=parseInt(r.style.width);(n-=1)<=0?Wt.DWT.CloseDialog():(r.style.width=n+"%",setTimeout(Dt._zdgb_xkz_dhk,100))}}},Dt.ShowLicenseDialog=Wt.DWT.ShowMessage,Dt.createLoadingBarContent=function(){};var TD,ID="All scripts and css loaded.",bD="Unload...",CD="Checking Product Key format...",wD="Initializing the service...",ED="Checking the service enhanced module...",AD="Getting the WebTwain port...",DD="Checking the WebTwain module...",PD="Checking the WebTwain version...",RD="Check the WebTwain version successfully.",xD="The WebTwain version not compatible.",kD="Getting Machine ID.",FD="Creating WebTwain from Dynamsoft.DWT.Containers...",OD="Decoding the license...",WD="Checking the license...";function ND(e,t){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.add(e)}function MD(e,t,r){return t.has(e),r}!function(e){e.CM_RENDERALL=1,e.CM_IMAGEONLY=2,e.CM_AUTO=3,e.CM_RENDERALLWITHANNOTATION=4}(TD||(TD={}));var LD=mC+".",BD=parseInt(mC),UD={ActiveX:0,Plugin:1,HTML5:2,WinMacLinux:3,Barcode1D:4,Barcode2D:5,BarcodeWriter:6,OCR:7,Webcam:8,PDFRasterizer:9,OCRPro:10,QR:50,PDF417:51,DataMatrix:52};function VD(e){return xt.isString(e)?xt.trim(e):e}var GD=new WeakSet,jD=new WeakSet,HD=new WeakSet,zD=new WeakSet,KD=new WeakSet,JD=new WeakSet,YD=new WeakSet,QD=new WeakSet,XD=new WeakSet,qD=s((function e(){t(this,e),ND(this,XD),ND(this,QD),ND(this,YD),ND(this,JD),ND(this,KD),ND(this,zD),ND(this,HD),ND(this,jD),ND(this,GD),Mb(this,"isLTS",lw)}),[{key:"isLongKey",value:function(e){if(xt.isString(e)&&e.length>0){var t=e.charAt(0);if("f"==t||"t"==t)return!0;if(xt.startsWith(e,"DLS"))return!1;if(xt.isNumber(e))return!1;var r=parseInt(e)+"-";return!xt.startsWith(e,r)}return!1}},{key:"isLicenseMixed",value:function(e,t){var r,n=!1,i=e||Wt.DWT.ProductKey;if(Wt.DWT.lclex(),t&&(VD(Wt.DWT.organizationID)||VD(Wt.DWT.handshakeCode))&&i&&(n=!0,fw(r={},-2444,"A license can only be specified once and has already been set using the ProductKey API.")),!n&&xt.isString(i))if(i=xt.trim(i),xt.startsWith(i,"f")||xt.startsWith(i,"t"));else if(""==i);else if(xt.startsWith(i,"DLS2"))try{MD(this,jD,$D).call(this,i)}catch(c){n=!0,fw(r={},-2440,""),r._errorString=c.message}else MD(this,GD,ZD).call(this,i).LTS||(n=!0,function(e){fw(e,tw.LicenseParseFailed,"The license is invalid.")}(r={}));if(n&&r){hw(r);var o=Wt.DWT.licenseException;xt.error(o.message)}return n}},{key:"reparseProductKey",value:function(e){e&&SD("Parsing Product Key...");var t=VD(Wt.DWT.organizationID),r=VD(Wt.DWT.handshakeCode),n=t||r,i=xt.trim(Wt.DWT.ProductKey);if(!n){var o=MD(this,GD,ZD).call(this,i);o.LTS&&(r=VD(o.handshakeCode),n=(t=VD(o.organizationID))||r)}if(n)return this._innerResetLicense(),xt.isNumber(i)&&(t=i),aw.handshakeCode=r,aw.organizationID=t,aw.licenseServer=Wt.DWT.licenseServer,aw.sessionPassword=Wt.DWT.sessionPassword,void(aw.bPublicLTS=MD(this,HD,eP).call(this,aw.licenseServer,n));var a=!1;if(aw.refProductKey!==i&&(this._innerResetLicense(),xt.isString(i)&&i.length>0&&(aw.refProductKey=i,a=!0)),a)if(this.isLongKey(aw.refProductKey))aw.bPublicLTS=!1;else{var s,u={_pLoad:{isEmpty:Bb},_license:aw.refProductKey,_licenseServer:[]};try{s=zE(u)}catch(h){xt.error(h),s=!1}if(s&&xt.isString(s.l)){var c=xt.trim(s.l);""==c?aw.organizationID=c:-1!=c.indexOf("-")?aw.handshakeCode=c:aw.organizationID=c,xt.isArray(s.ls)&&s.ls.length>0&&(aw.licenseServer=s.ls),aw.bPublicLTS=MD(this,HD,eP).call(this,aw.licenseServer,c),aw.sessionPassword=s.sp}else aw.bPublicLTS=!1}}},{key:"_innerResetLicense",value:function(){aw.refProductKey="",aw.handshakeCode=void 0,aw.organizationID=void 0,aw.licenseServer=void 0,aw.sessionPassword="",aw.bPublicLTS=!0}},{key:"checkOSForAllowCore",value:function(e,t,r){if(aw.bHTML5Edition){if(e)return MD(this,XD,aP).call(this,t);var n=r._bRemoteMode,i=r.__serverPlatform;return this.isOSOK(t,n,i)}return Bb}},{key:"checkLocalPlatformForRemoteService",value:function(e){var t,r,n,i=e.__licenseInfo,o=BC.getEnumPlatform(),a=!1;for(t=0;t<i.Detail.length;t++)if(r=i.Detail[t],(n=MD(this,YD,iP).call(this,r.EnumLicenseType,r.LicenseType)).Core&&xt.isString(r.Version)&&0==r.Version.indexOf(LD)){if(a=MD(this,XD,aP).call(this,r.OS))break;if(a=this.isOSOK(r.OS,!0,o))break;if(!e._blts&&e._bScanForProxyRemote&&n.RemoteScan)break}return a||(o==gC.enumWindow?function(e){fw(e,-2344,"The current product key does not support Windows OS. "+gw()),hw(e)}(e):o==gC.enumLinux?function(e){fw(e,-2346,"The current product key does not support Linux OS. "+gw()),hw(e)}(e):o==gC.enumMac?function(e){fw(e,-2345,"The current product key does not support MAC OS. "+gw()),hw(e)}(e):function(e){fw(e,-2347,"The current product key does not support your OS. "+gw()),hw(e)}(e)),a}},{key:"checkProductKey",value:function(e,t,r){var n,i=Wt.DWT.licenseException;return!t.Camera&&(e.__licenseInfo||(e.__licenseInfo={}),(n=MD(this,KD,rP).call(this,e,e.__licenseInfo,Lb,t,r))||(i.code=e._errorCode,i.message=e._getErrorString(),i.fromLTS=!1),n)}},{key:"isBindDomainOK",value:function(e){if(xt.isUndefined(e)||null==e||""==e||"*"==e||"*.*"==e)return Bb;var t=location.hostname,r=Lb;if(""==t)return Bb;for(var n=t.toLowerCase().split("."),i=n.length,o=e.toLowerCase().split(";"),a=0;a<o.length;a++){var s=o[a];if("*.*"==s){r=Bb;break}var u=s.split("."),c=u.length;if(c>0&&c-1<=i){for(var l=Bb,d=c-1;d>0;d--){if(u[d].indexOf("*")>-1){r=Bb;break}if(d+i-c>=0){if(n[d+i-c]!=u[d]){l=Lb;break}}else if("*"!=u[d]){l=Lb;break}}if(l&&("*"==u[0]||i>=c&&n[i-c]==u[0])){r=Bb;break}}}return r}},{key:"isExpiredOrFuture",value:function(e,t){if(""==e)return Lb;if(!t){var r=e.length;if(r>2&&"/"==e[r-2]&&"0"==e[r-1])return Lb}var n=fP(e),i=(new Date).getTime(),o=i+5184e6;return n.getTime()<i||t&&n.getTime()>o?Bb:Lb}},{key:"willTrialExpire",value:function(e){if(""==e)return Lb;var t=fP(e),r=(new Date).getTime();return t.getTime()<r+432e6&&t.getTime()>r?Bb:Lb}},{key:"isOSOK",value:function(e,t,r){var n=!1,i=!1,o=!1,a=!1,s=!1,u=!1,c=!1,l=!1;return""==e||"0"==e?Bb:(t?r==gC.enumWindow?o=!0:r==gC.enumLinux?i=!0:r==gC.enumMac?n=!0:r==gC.enumEmbed?s=!0:r==gC.enumChromeOS?u=!0:r==gC.enumAndroid?c=!0:r==gC.enumHarmonyOS?l=!0:r==gC.enumiOS&&(a=!0):(n=Y.bMac,i=Y.bLinux,o=Y.bWin,a=Y.biPhone||Y.biPad,u=Y.bChromeOS,s=Wt.navInfo.bEmbed,c=Y.bAndroid,l=Y.bHarmonyOS),(e=e.toLowerCase()).indexOf("windows")>-1&&o||e.indexOf("mac")>-1&&n||e.indexOf("linux")>-1&&(i||u||l)||e.indexOf("android")>-1&&c||e.indexOf("ios")>-1&&a||e.indexOf("embed")>-1&&s?Bb:Lb)}},{key:"isBrowserOK",value:function(e){if(xt.isString(e)){if(""==e||"0"==e)return Bb;var t=(e=e.toLowerCase()).split(";"),r=Lb;return xt.each(t,(function(e){("chrome"==xt.trim(e)&&(Y.bChrome||Y.bSafari||Y.bOpera||Y.bEdge)||"ie"==xt.trim(e)&&Y.bIE||"firefox"==xt.trim(e)&&Y.bFirefox)&&(r=Bb)})),r}return Lb}},{key:"isAllowLicenseType",value:function(e,t){return t.Core?e.Core:t.PDFRasterizer?e.PDFRasterizer:t.Webcam||t.Camera?e.Webcam:t.barcode1D?e.barcode1D:t.QR?e.QR:t.PDF417?e.PDF417:t.DataMatrix?e.DataMatrix:t.OCR?e.OCR:t.OCRPro?e.OCRPro:e.Core}},{key:"setNoAllowedLicenseTypeError",value:function(e,t,r){r.Core?Nw(e):r.Webcam||r.Camera?t||r.Camera?function(e){e._errorCode=-2431,lw()?e._errorString="The license for the Camera Addon is not found or has expired.":fw(e,-2431,"The current product key does not support Camera Addon. "+gw()),hw(e)}(e):function(e){e._errorCode=-2338,lw()?e._errorString="The license for the module direct show is not found or has expired.":e._errorString="The current product key does not support Webcam. "+gw(),hw(e)}(e):r.PDFRasterizer?t?function(e){e._errorCode=-2370,lw()?e._errorString="The license for the module pdf rasterizer is not found or has expired.":e._errorString="The current product key does not support Pdf Rasterizer Wasm. "+gw(),hw(e)}(e):Mw(e):r.OCR?function(e){e._errorCode=-2340,lw()?e._errorString="The license for the module ocr is not found or has expired.":e._errorString="The current product key does not support OCR. "+gw(),hw(e)}(e):r.OCRPro?function(e){e._errorCode=-2341,lw()?e._errorString="The license for the module ocr pro is not found or has expired.":e._errorString="The current product key does not support OCR pro. "+gw(),hw(e)}(e):Ow(e)}},{key:"getLicenseDateString",value:function(e){var t,r=e.getFullYear();return[(t=e.getMonth()+1)>=10?""+t:"0"+t,"/",e.getDate()>=10?""+e.getDate():"0"+e.getDate(),"/",r].join("")}},{key:"hasPDFRProductKey",value:function(e){return!!this.checkProductKey(e,{PDFRasterizer:!0},!0)||(e._resetErr(),!1)}},{key:"checkPDFProductKeyWhenNeeds",value:function(e,t){var r;return t!=Wt.DWT.EnumDWT_ImageType.IT_PDF&&t!=Wt.DWT.EnumDWT_ImageType.IT_MULTIPAGE_PDF||(aw.bHTML5Edition?e.__addon&&e.__addon.PDF&&(r=e._getConvertMode()):e.Addon&&e.Addon.PDF&&(r=e._getConvertMode()),r!=TD.CM_RENDERALL&&r!=TD.CM_RENDERALLWITHANNOTATION)?Bb:this.checkProductKey(e,{PDFRasterizer:!0},!0)}},{key:"getPublicLicenseContent",value:function(e){var t=[],r=e;if(!xt.isString(r)){if(xt.isUndefined(r))return"";r=r instanceof Error||"message"in r?r.message:""+r}var n=r.indexOf("["),i=r.indexOf("]",n),o=r.indexOf("(",i),a=r.indexOf(")",o);if(-1==n||-1==i||-1==o||-1==a)return r;n>0&&t.push(r.substring(0,n));var s=r.substring(n+1,i),u=r.substring(o+1,a);return t.push(['<a href="',u,'" target="_blank" class="dynamsoft-major-color">',s,"</a>"].join("")),t.push(r.substring(a+1)),t.join("")}},{key:"getLTSLicense",value:function(){return aw.bPublicLTS?"":aw.handshakeCode||aw.organizationID}}]);function ZD(e){var t,r,n=e,i=e.indexOf("-"),o=-1!=i;return r={},o&&(n=e.substring(0,i)),t=Number(n),isNaN(t)||String(Number(t))!==n||(o?r.handshakeCode=e:r.organizationID=e,r.LTS=Bb),r}function $D(e){zE({_pLoad:{isEmpty:Bb},_license:e,_licenseServer:[]})}function eP(e,t){var r=!0;if(xt.isArray(e)&&e.length>0){var n=e[0];xt.isString(n)&&""!=n&&-1==n.indexOf("https://mlts.dynamsoft.com")&&(r=!1)}return r&&(!t||"200001"===t||xt.startsWith(t,"200001-"))}function tP(e,t,r){return this.checkOSForAllowCore(e,t,r)}function rP(e,t,r,n,i){var o,a=!1;if(aw.bHTML5Edition&&xt.isFunction(e._needCheckProxyRemoteScanLicense)&&(a=e._needCheckProxyRemoteScanLicense()),t&&t.LTS){if(!t||!xt.isArray(t.Detail)||0==t.Detail.length)return this.isLTS()?Nw(e):Ow(e),Lb}else if(!t||!xt.isArray(t.Detail)||0==t.Detail.length)return this.isLTS()?Nw(e):Ow(e),Lb;var s,u,c,l,d=0,f=0,h=[],g=[],p=Lb,_=Lb,m=Lb,v=Lb,y=Lb;if(!this.isBindDomainOK(t.Domain))return function(e){fw(e,-2342,"The domain of your current site does not match the domain bound in the current product key. "+gw()),hw(e)}(e),Lb;for(t.Detail.length>0&&(o="FALSE"!=(c=t.Detail[0]).Trial),u=1;u<t.Detail.length;u++)if("FALSE"==(c=t.Detail[u]).Trial&&o||"TRUE"==c.Trial&&!o)return $w(e),Lb;if(t.bTrial=o,n.Core||n.Webcam){var S=[],T=!1;for(u=0;u<t.Detail.length;u++)if(c=t.Detail[u],l=MD(this,YD,iP).call(this,c.EnumLicenseType,c.LicenseType),n.Core&&l.Core&&this.checkOSForAllowCore(r,c.OS,e)||n.Core&&l.Core&&aw.bActiveXEdition&&l.ActiveX||n.Webcam&&l.Webcam&&!r){if(t.LTS);else if(!xt.isString(c.Version)||0!=c.Version.indexOf(LD)){S.push(c);continue}if(aw.bHTML5Edition){if(l.ActiveX&&!l.Html5)continue;if(a&&!l.RemoteScan)continue;g.push(c)}else{if(!l.ActiveX&&l.Html5)continue;g.push(c)}T=!0}if(!T&&S.length>0)return S.splice(0),function(e,t){var r=gw();fw(e,tw.LicenseVersionNotCurrent,"The current product key is not for version ".concat(t,". ").concat(r)),hw(e)}(e,[mC,vC].join(".")),!1;S.splice(0)}else g=t.Detail;for(u=0;u<g.length;u++){var I=Bb;if(c=g[u],l=MD(this,YD,iP).call(this,c.EnumLicenseType,c.LicenseType),n.Core&&l.Core||this.isAllowLicenseType(l,n)){s=c.ExpireDate.replace(/-/g,"/");var b="FALSE"!=c.Trial;if(this.isExpiredOrFuture(s,b))h.push(s);else if(b&&l.Core&&this.willTrialExpire(s)&&(t.ExpireDate=s),t.LTS||l.Core&&aw.bHTML5Edition&&parseInt(c.Version)>=BD||l.Core&&aw.bActiveXEdition||!l.Core){var C=!1;if(l.Core)(this.checkOSForAllowCore(r,c.OS,e)||aw.bActiveXEdition&&l.ActiveX)&&(C=!0);else{var w=r;n.Camera&&(w=!0),MD(this,zD,tP).call(this,w,c.OS,e)&&(C=!0)}C?this.isBrowserOK(c.Browser)||i?(d++,I=Lb):_=Bb:n.Core?p=Bb:n.PDFRasterizer?v=Bb:(n.Webcam||n.Camera)&&(y=Bb)}else m=Bb;I&&f++}}if(d>0)return Bb;if(0==f)return this.setNoAllowedLicenseTypeError(e,r,n),Lb;if(h.length>0){var E,A=0,D=1e20,P="",R=(new Date).getTime();for(s="",u=0;u<h.length;u++)(E=fP(h[u])).getTime()<R&&E.getTime()>A?(A=E.getTime(),s=h[u]):E.getTime()>R&&E.getTime()<D&&(D=E.getTime(),P=h[u]);return""!=s?(E=fP(s),Ww(e,s=this.getLicenseDateString(E))):""!=P?(E=fP(P),P=this.getLicenseDateString(E),function(e,t){fw(e,tw.LicenseIsFuture,"The current product key is invalid. "+gw()),hw(e)}(e)):Ww(e,""),Lb}return m?(function(e){fw(e,-2348,"The current product key is invalid because it's generated with the licenses of a different major version."),hw(e)}(e),Lb):_?(Y.bEdge?function(e){fw(e,-2330,"The current product key does not support Edge. "+gw()),hw(e)}(e):Y.bChrome?function(e){fw(e,-2327,"The current product key does not support Chrome. "+gw()),hw(e)}(e):Y.bFirefox?function(e){fw(e,-2328,"The current product key does not support Firefox. "+gw()),hw(e)}(e):Y.bIE?function(e){fw(e,-2329,"The current product key does not support IE. "+gw()),hw(e)}(e):Y.bSafari?function(e){fw(e,-2392,"The current product key does not support Safari. "+gw()),hw(e)}(e):function(e){fw(e,-2343,"The current product key does not support your browser. "+gw()),hw(e)}(e),Lb):p?(this.setNoAllowedLicenseTypeError(e,r,{Core:!0}),Lb):v?(this.setNoAllowedLicenseTypeError(e,r,{PDFRasterizer:!0}),Lb):y?(this.setNoAllowedLicenseTypeError(e,r,{Webcam:!0}),Lb):(Ow(e),Lb)}function nP(e){var t=Lb,r=Lb,n=Lb,i=Lb,o=Lb,a=Lb,s=Lb,u=Lb,c=Lb;return xt.isString(e)&&""!=e&&xt.each(e.split(";"),(function(e){var l=1*e;l==UD.HTML5||l==UD.WinMacLinux||l==UD.ActiveX||l==UD.Plugin?t=Bb:l==UD.Barcode1D?r=Bb:l==UD.QR?n=Bb:l==UD.PDF417?i=Bb:l==UD.DataMatrix?o=Bb:l==UD.OCR?a=Bb:l==UD.Webcam?s=Bb:l==UD.PDFRasterizer?u=Bb:l==UD.OCRPro&&(c=Bb)})),{Core:t,PDFRasterizer:u,Webcam:s,barcode1D:r,QR:n,PDF417:i,DataMatrix:o,OCR:a,OCRPro:c}}function iP(e,t){var r=MD(this,JD,nP).call(this,e),n=MD(this,QD,oP).call(this,t);return xt.each(["Core","Html5","RemoteScan","LocalScan","ActiveX","PDFRasterizer","Webcam","barcode1D","QR","PDF417","DataMatrix","OCR","OCRPro"],(function(e){r[e]=r[e]||n[e]})),r}function oP(e){var t=Lb,r=Lb,n=Lb,i=Lb,o=Lb,a=Lb,s=Lb,u=Lb,c=Lb,l=Lb,d=Lb,f=Lb,h=Lb;return e&&""!=e&&((e=e.toLowerCase()).indexOf("html5")>-1||"win=(aph) or mac=(ph) or linux(h)"==e?(t=Bb,e.indexOf("html5;activex;oldie")>-1?i=Bb:e.indexOf("html5;activex")>-1?(r=Bb,h=Bb,i=Bb):(r=Bb,h=Bb),e.indexOf(";remotescan")>-1&&(r=Bb,f=Bb,e.indexOf(";onlyremote")>-1&&(h=Lb))):"1d barcode reader"==e?n=Bb:"2d barcode reader(qrcode)"==e?o=Bb:"2d barcode reader(pdf417)"==e?a=Bb:"2d barcode reader(data matrix)"==e?s=Bb:"ocr"==e?u=Bb:"webcam"==e?c=Bb:"pdf rasterizer"==e?l=Bb:"proocr"==e&&(d=Bb)),{Core:t,Html5:r,RemoteScan:f,LocalScan:h,ActiveX:i,PDFRasterizer:l,Webcam:c,barcode1D:n,QR:o,PDF417:a,DataMatrix:s,OCR:u,OCRPro:d}}function aP(e){var t=e.toLowerCase();return t.indexOf("wasm")>-1||t.indexOf("mobile")>-1}var sP=new qD;function uP(e,t){return cP.apply(this,arguments)}function cP(){return(cP=GE(m.mark((function e(t,r){var n;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(lw()){e.next=2;break}return e.abrupt("return");case 2:if(e.prev=2,Wt.DWT.li({instanceMode:Wt.DWT.EnumInstance.dwt_desktop},"")){e.next=17;break}return r&&SD(kD),e.prev=6,e.next=9,aD();case 9:return n=e.sent,e.next=12,lP(n);case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(6),xt.log(e.t0);case 17:e.next=22;break;case 19:e.prev=19,e.t1=e.catch(2),xt.log(e.t1);case 22:case"end":return e.stop()}}),e,null,[[2,19],[6,14]])})))).apply(this,arguments)}function lP(e){return dP.apply(this,arguments)}function dP(){return(dP=GE(m.mark((function e(t){var r;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=7;break}if(!(xt.isArray(t.result)&&t.result.length>3)){e.next=5;break}r=t.result[3],e.next=7;break;case 5:if(!t.description){e.next=7;break}return e.abrupt("return",{code:t.exception,message:t.description});case 7:xt.isString(r)&&""!=r&&(Wt.DWT.lsmid(r,""),Wt.DWT.lsmid2b(r));case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function fP(e){var t,r=e;return r=r.replace(/-/g,"/"),t=Date.parse(r),isNaN(t)&&(t=0),(t=new Date(t)).setHours(23,59,59,999),t}function hP(e){if(""==e)return 65536;var t=fP(e),r=(new Date).getTime(),n=(t.getTime()-r)/864e5;return t.getTime()<r?0:Math.ceil(n)}Wt.DWT.isPublicLicense=function(){return aw.bPublicLTS};var gP,pP=s((function e(){t(this,e),Mb(this,"_exec",{})}),[{key:"fire",value:function(e,t){var r,n=this;e=e.toLowerCase(),r=Array.prototype.slice.call(arguments,1),xt.each(n._exec[e]||[],(function(e){var t=e.f,i=e.c||n;try{t.apply(i,r)}catch(QG){xt.error(QG)}}))}},{key:"on",value:function(e,t,r){e=e.toLowerCase(),this._exec[e]=this._exec[e]||[],this._exec[e].push({f:t,c:r})}},{key:"off",value:function(e,t,r){if(e&&t){e=e.toLowerCase();for(var n=this._exec[e]||[],i=n.length-1;i>=0;i--)n[i]===t&&n.splice(i,1)}else this._exec={}}}]);function _P(e,t){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.add(e)}function mP(e,t,r){return t.has(e),r}var vP,yP="[bio]: ",SP=window,TP=SP&&SP.FormData,IP=new WeakSet,bP=new WeakSet,CP=new WeakSet,wP=new WeakSet,EP=new WeakSet,AP=new WeakSet,DP=new WeakSet,PP=new WeakSet,RP=function(e){function r(e){var n,i,o,a;return t(this,r),i=this,o=QE(o=r),_P(n=YE(i,function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(QG){return!1}}()?Reflect.construct(o,[],QE(i).constructor):o.apply(i,a)),PP),_P(n,DP),_P(n,AP),_P(n,EP),_P(n,wP),_P(n,CP),_P(n,bP),_P(n,IP),Mb(n,"_attrs",{}),xt.mix(n._attrs,{action:"",data:{},bChunkedSendData:Bb,ajaxConfig:{value:{},type:"post",processData:Lb,cache:Lb,dataType:"text",async:Bb,contentType:Lb,retry:0,headers:{"X-Requested-With":Lb}},ajax:"",formData:"",CORS:Lb,bOnlyResponseEmptyIsOK:Bb}),xt.mix(n._attrs,e),mP(n,IP,xP).call(n),n}return qE(r,e),s(r,[{key:"get",value:function(e){return e in this._attrs?this._attrs[e]:""}},{key:"set",value:function(e,t){e in this._attrs&&(this._attrs[e]=t)}},{key:"uploadFilesToServer",value:function(e){return mP(this,bP,kP).call(this,e)}},{key:"uploadToServer",value:function(e){var t=this,n=t.get("ajaxConfig");mP(t,CP,FP).call(t),e&&e.size>0&&(mP(t,wP,OP).call(t,e),xt.isString(e.name)&&""!=e.name?t.name=e.name:t.name=e.fileName,e=null),xt.mix(n,{data:t.get(r.PROP.formData),url:t.get(r.PROP.action),beforeSend:function(e,n,i){e.upload.addEventListener("progress",(function(e){t.fire(r.event.PROGRESS,{loaded:e.loaded,total:e.total,name:t.name})}),!1)}});var i=t.get("async");if(xt.mix(n,{method:"POST",async:i,onSuccess:function(e){MP(t.get(r.PROP.data)),MP(t.get(r.PROP.formData));var n=t.get(r.PROP.ajax);xt.isFunction(n.dispose)&&n.dispose(),t.set(r.PROP.data,null),t.set(r.PROP.formData,null),t.set(r.PROP.ajax,null);var i=mP(t,PP,NP).call(t,e);t.fire(r.event.SUCCESS,i)},onError:function(e,n,i){MP(t.get(r.PROP.data)),MP(t.get(r.PROP.formData));var o,a,s=t.get(r.PROP.ajax);xt.isFunction(s.dispose)&&s.dispose(),t.set(r.PROP.data,null),t.set(r.PROP.formData,null),t.set(r.PROP.ajax,null),e&&xt.isArray(e)&&e.length>2?(o=e[1],a=e[2]):(o=n,a=i),mP(t,EP,WP).call(t,a,o)}}),i){var o=fC(n);return t.set(r.PROP.ajax,o),!0}return fC(n)}},{key:"abort",value:function(){var e=this,t=e.get("ajax");return xt.isObject(t)?(t.abort(),e.set("ajax",!1),e):(xt.log(yP+"abort(), the value of io invalid!"),e)}},{key:"setRequestHeader",value:function(e,t){var r=this.get("ajaxConfig");return r.headers[e]=t,this.set("ajaxConfig",r),r=null,t}}])}(pP);function xP(){this.get("CORS");var e=this.get("ajaxConfig");return xt.mix(e,{xhrFields:{withCredentials:!1}}),e}function kP(e){var t=this,r=t.get(gP.PROP.ajaxConfig),n=[];if(mP(t,CP,FP).call(t),xt.each(e,(function(e){e&&e.size>0?(mP(t,wP,OP).call(t,e),xt.isString(e.name)&&""!=e.name?n.push(e.name):n.push(e.fileName)):n.push("")})),xt.mix(r,{data:t.get(gP.PROP.formData),url:t.get(gP.PROP.action),beforeSend:function(e,r,n){e.upload.addEventListener("progress",(function(e){t.fire(gP.event.PROGRESS,{loaded:e.loaded,total:e.total,name:""})}),!1)}}),xt.mix(r,{method:"POST",async:t.get("async"),onSuccess:function(e){var r="";n=[],e&&(e&&xt.isArray(e)&&e.length>1?r=e[0]:xt.isString(e)&&(r=e)),r=mP(t,PP,NP).call(t,r),t.fire(gP.event.SUCCESS,r)},onError:function(e,r,i){var o,a;n=[],e&&xt.isArray(e)&&e.length>2?(o=e[1],a=e[2]):(o=r,a=i),mP(t,EP,WP).call(t,a,o)}}),t.name="",t.get("async")){var i=fC(r);return t.set(gP.PROP.formData,null),t.set(gP.PROP.ajax,i),!0}var o=fC(r);return t.set(gP.PROP.formData,null),o}function FP(){var e,t=this,r=t.get("data");if(TP)if(r instanceof TP)t.set(gP.PROP.formData,r);else{e=new TP;try{xt.each(r,(function(t,r){e.append(r,t)})),t.set(gP.PROP.formData,e)}catch(QG){xt.log(yP+"something error when reset FormData.")}}else xt.log(yP+"the browser does not support ajax.")}function OP(e){if(!xt.isObject(e))return xt.log(yP+"_addFileData(), file parameter invalid!"),!1;var t=this.get(gP.PROP.formData),r=e.name,n=e.remoteFilename;return n||(n="RemoteFile"),t.append(n,e,r),this.set(gP.PROP.formData,t),e=null,t}function WP(e,t){var r=gP.status.ERROR,n={status:r,msg:t,response:!1,name:this.name};e&&(n.httpStatus=e.status,n.response=e.responseText),this.fire(r,n)}function NP(e){var t,r,n,i=!1,o=this.name,a=gP.status.SUCCESS,s=gP.event.ERROR;if(xt.log("Response from server: "+e),!this.get("bOnlyResponseEmptyIsOK"))return{status:a,msg:!1,json:!1,response:e,name:o};if(xt.isUndefined(e)||""===e)t={status:a,msg:!1,json:!1,response:"",name:o};else if(xt.isString(e)){try{for(r=0;r<e.length&&!(r>10);r++){if("{"==(n=e[r])){i=!0;break}if(" "!=n&&"\r"!=n&&"\n"!=n&&"\t"!=n)break}if(i){var u=xt.parse(e);t=1==u.status?{status:a,msg:!1,json:u,response:e,name:o}:{status:s,msg:!1,json:u,response:e,name:o}}}catch(QG){i=!1,xt.log(QG)}if(!i){var c=String(e);t=""==(c=c.replace(/( |\t|\r|\n)/g,""))?{status:a,msg:!1,json:!1,response:e,name:o}:{status:s,msg:!1,json:!1,response:e,name:o}}}else t={status:a,msg:!1,json:!1,response:"",name:o};return t}function MP(e){e&&e instanceof TP&&e.forEach&&e.forEach((function(t,r){r&&e.delete(r)}))}function LP(e,t){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.add(e)}function BP(e,t,r){return t.has(e),r}gP=RP,Mb(RP,"event",{SUCCESS:"success",ERROR:"error",PROGRESS:"progress"}),Mb(RP,"status",{SUCCESS:"success",ERROR:"error"}),Mb(RP,"PROP",{action:"action",data:"data",bChunkedSendData:"bChunkedSendData",ajaxConfig:"ajaxConfig",ajax:"ajax",formData:"formData",CORS:"CORS",bOnlyResponseEmptyIsOK:"bOnlyResponseEmptyIsOK"});var UP=new WeakSet,VP=new WeakSet,GP=new WeakSet,jP=new WeakSet,HP=function(e){function r(e){var n,i,o,a;return t(this,r),i=this,o=QE(o=r),LP(n=YE(i,function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(QG){return!1}}()?Reflect.construct(o,[],QE(i).constructor):o.apply(i,a)),jP),LP(n,GP),LP(n,VP),LP(n,UP),n._attrs={action:"",retry:0,timeout:0,CORS:Lb,async:Bb,dataType:"text",fileStatus:"",data:{},bOnlyResponseEmptyIsOK:Bb},xt.mix(n._attrs,e),BP(n,VP,KP).call(n),n}return qE(r,e),s(r,[{key:"get",value:function(e){return e in this._attrs?this._attrs[e]:""}},{key:"set",value:function(e,t){e in this._attrs&&(this._attrs[e]=t)}},{key:"upload",value:function(e){var t;if(e){if(xt.isArray(e))return t=this._uploadType.uploadFilesToServer(e),e=null,t;if(xt.isObject(e)){var r=e;return r.size?(r.id||(r.id=xt.guid("file-")),r.size&&(r.textSize=BP(this,UP,zP).call(this,r.size))):r.size=0,t=this._uploadType.uploadToServer(r),r=null,e=null,t}}return t=this._uploadType.uploadToServer(e),e=null,t}},{key:"abort",value:function(e){return this._uploadType&&this._uploadType.abort(),!0}},{key:"setRequestHeader",value:function(e,t){this._uploadType.setRequestHeader(e,t)}}])}(pP);function zP(e){var t=-1;do{e/=1024,t++}while(e>99&&t<4);return Math.max(e,.1).toFixed(1)+["KB","MB","GB","TB"][t]}function KP(){var e=this,t={async:e.get(vP.PROP.async),action:e.get(vP.PROP.action),data:e.get(vP.PROP.data),CORS:e.get(vP.PROP.CORS),bOnlyResponseEmptyIsOK:e.get(vP.PROP.bOnlyResponseEmptyIsOK)};this._uploadType=new RP(t);var r=this._uploadType.get(RP.PROP.ajaxConfig);return r&&(r.dataType=e.get(vP.PROP.dataType),r.async=e.get(vP.PROP.async),r.retry=e.get(vP.PROP.retry)),this._uploadType.on(RP.event.SUCCESS,BP(e,jP,YP),e),this._uploadType.on(RP.event.ERROR,BP(e,jP,YP),e),this._uploadType.on(RP.event.PROGRESS,BP(e,GP,JP),e),this._uploadType}function JP(e){this.fire(vP.event.PROGRESS,e)}function YP(e){var t=this,r=e.status,n=e.msg,i=t.get("file");xt.mix(e,{file:i}),"success"===r?t.fire(vP.event.SUCCESS,e):(!1===n||("abort"===n?xt.mix(e,{canceled:!0}):"timeout"===n&&xt.mix(e,{timeout:!0})),t.fire(vP.event.ERROR,e))}vP=HP,Mb(HP,"event",{SUCCESS:"success",ERROR:"error",PROGRESS:"progress"}),Mb(HP,"PROP",{action:"action",retry:"retry",timeout:"timeout",CORS:"CORS",async:"async",dataType:"dataType",fileStatus:"fileStatus",data:"data",bOnlyResponseEmptyIsOK:"bOnlyResponseEmptyIsOK"});var QP={Loading:"Processing...",LoadingTiff:"Processing tiff...",LoadingPdf:"Processing pdf...",Encoding:"Processing...",ConvertingToBlob:"Converting to blob...",ConvertingToBase64:"Converting to base64...",SavingPdf:"Saving pdf...",SavingTiff:"Saving tiff...",Downloading:"Downloading...",Uploading:"Uploading...",Transfer:"Transferring...",CanvasLoading:"Loading ...",Err_ServiceModeNotSupportMobile:"Service Mode does not support your Operating System. Please contact the site administrator."};function XP(e,t){Dt.detect.bMaskShow=!0,Wt.DWT.ScanDirectly||xt.isFunction(Wt.DWT.OnWebTwainPreExecute)&&Wt.DWT.OnWebTwainPreExecute(e,t)}function qP(){Dt.detect.bMaskShow=!1,Wt.DWT.ScanDirectly||xt.isFunction(Wt.DWT.OnWebTwainPostExecute)&&Wt.DWT.OnWebTwainPostExecute()}var ZP=Y.bWin,$P=Y.bMac,eR=Y.bLinux,tR=Y.bSafari,rR=Y.bFirefox,nR=Y.bChrome,iR=location.hostname,oR=location.pathname,aR=0,sR=Y.bMobile,uR=parseFloat(Y.strBrowserVersion);if(Y.bWin||Y.bMac||Y.bLinux||Y.bChromeOS){if(Wt.navInfo){var cR=Wt.navInfo;sR=sR||cR.bAndroid||cR.bPad||cR.biPhone||cR.biPad}}else sR=!0;""===iR?ZP&&oR.lastIndexOf("\\")>1?oR=oR.substring(1,oR.lastIndexOf("\\")).replace(/%20/g," "):(aR=1,oR=oR.substring(1,oR.lastIndexOf("/")).replace(/%20/g," ")):(aR=1,oR=oR.substring(0,oR.lastIndexOf("/")));var lR={bChrome:nR,bFirefox:rR,bSafari:tR,bIE:Y.bIE,bEdge:Y.bEdge,bWin:ZP,bMac:$P,bLinux:eR,iPluginLength:0,bFileSystem:Y.bFileSystem,bMobile:sR,strIEVersion:Y.IEVersion,strChromeVersion:Y.bChrome?uR:"",strFirefoxVersion:Y.bFirefox?uR:"",basePath:oR,pathType:aR,isDesktopViewer:function(){return Y.bWin||Y.bLinux||Y.bChromeOS||Y.bMac},isPadViewer:function(){return Y.bPad||Y.biPad},isMobileViewer:function(){return Y.bMobile||Y.biPhone||Y.bAndroid||Y.bHarmonyOS},WSVersion:"18.5.0",WSSession:(new Date).getTime(),bDiscardBlankImage:Lb},dR={getImageUrl:function(e,t,r,n,i){var o,a=[e];if(xt.isNumber(t)&&t<0)return"";if(void 0!==t&&null!==t&&(a.push("&index="),a.push(t)),a.push("&width="),a.push(r),a.push("&height="),a.push(n),lR.bMobile&&a.push("&type=1&quality=85"),a.push("&ticks="),i?a.push(i):a.push(Date.now()),o=a.join(""),Y.bFileSystem&&o.indexOf("dwt://")<0){var s=new Image;s.crossOrigin="anonymous",s.src=o,s=null}return o},getUrlByAct:function(e,t,r){var n=[e];return void 0!==t&&null!==t&&(n.push("&index="),n.push(t)),r&&(n.push("&act="),n.push(r)),n.push("&ticks="),n.push(Date.now()),n.join("")},output:function(e,t){xt.debug&&xt.log(t)},print:function(e){var t,r=850,n=1120,i=0,o=0,a=0,s="";for(aw.bHTML5Edition&&(Y.bIE&&(n=1160),Y.bFirefox&&(n=1150),Wt.navInfoSync.bMac&&Wt.navInfoSync.bSafari&&(n=900)),i=0;i<e.length;i++){var u=n,c=e[i],l=c.Width,d=c.Height,f=c.Url;l<=0&&(l=r),d<=0&&(d=u);var h=r/l,g=u/d;h<g?u=Math.floor(d*h):h>g&&(r=Math.floor(l*g)),o+=l,a+=d,s=s+'<div style="width:'+r+"px;height:"+u+'px"><img id="D_img'+i+'" src="'+f+'" style="position:relative;left:0px;top:0px;width: '+r+"px;height: "+u+'px" referrerpolicy="strict-origin-when-cross-origin" /></div>'}var p,_=["alwaysRaised=yes,z-look=yes,top=0,left=0,toolbar=no,menubar=no,location=no,status=no,width=",o,",height=",a].join(""),m=window.open("about:blank","_blank",_);t='<html><body id="D_body">'+s+"</body></html>",m&&(m.document.write(t),m.document.close(),m.focus(),(p=m.document.getElementById("D_body"))?p.onload=function(){m&&m.print(),xt.log("print image...ok")}:xt.log("cannot find image"))}};Dt.html5.Funs2=dR;var fR,hR=xt.isString,gR=xt.isArray,pR=xt.each;function _R(e,t){if(hR(t))e.push('"'),e.push(t),e.push('"');else if(gR(t)){var r=Bb;e.push("["),pR(t,(function(t){r?r=Lb:e.push(","),_R(e,t)})),e.push("]")}else void 0===t?e.push('""'):e.push(t)}function mR(){for(var e=[],t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(r.length>0)if(1===r.length){var i=r[0];e.push("["),_R(e,i),e.push("]")}else if(2===r.length){var o=r[0],a=r[1];e.push("["),_R(e,o),e.push(","),_R(e,a),e.push("]")}else _R(e,Array.prototype.slice.call(r));return e.join("")}function vR(e){return e instanceof ArrayBuffer||e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Uint32Array||e instanceof Int8Array||e instanceof Int16Array||e instanceof Int32Array||window.Uint8ClampedArray&&e instanceof window.Uint8ClampedArray||e instanceof Float32Array||e instanceof Float64Array}!function(e){e.TWAINSCANNER=16,e.WIASCANNER=32,e.TWAINX64SCANNER=64,e.ICASCANNER=128,e.SANESCANNER=256,e.ESCLSCANNER=512,e.WIFIDIRECTSCANNER=1024,e.WIATWAINSCANNER=2048}(fR||(fR={}));var yR=fR.TWAINSCANNER|fR.WIASCANNER|fR.TWAINX64SCANNER|fR.ICASCANNER|fR.SANESCANNER|fR.ESCLSCANNER|fR.WIFIDIRECTSCANNER|fR.WIATWAINSCANNER,SR=fR.TWAINSCANNER|fR.WIASCANNER|fR.TWAINX64SCANNER|fR.ICASCANNER|fR.SANESCANNER,TR=fR.TWAINSCANNER|fR.WIATWAINSCANNER|fR.TWAINX64SCANNER|fR.ICASCANNER|fR.SANESCANNER;fR.TWAINSCANNER,fR.WIASCANNER,fR.WIATWAINSCANNER;var IR=fR.ESCLSCANNER|fR.WIFIDIRECTSCANNER,bR=fR.TWAINSCANNER|fR.WIATWAINSCANNER,CR=1;function wR(){return(++CR).toString()}function ER(){return["dwt_",xt.getRandom()].join("")}var AR=0;function DR(e,t,r){if(xt.log("showMask:"+e+"--"+AR),0==AR)if(t){XP(t);var n=Dt.mask.dlgMask;if(n){n.style.zIndex="10000";var i=xt.sizzle(".dynamsoft-backdrop",n.parentNode);i&&i.length>0&&(i[0].style.zIndex="10000")}}else XP(r||{});AR++}function PR(e){xt.log("hideMask:"+e+"--"+AR),AR>1?AR--:AR<=1&&(qP(),AR=0)}var RR=s((function e(r,n){t(this,e),Mb(this,"m_server",""),Mb(this,"m_iUsingTime",0),Mb(this,"m_countMap",{}),Mb(this,"m_newConsum",!1),Mb(this,"m_mapSavedToDb",!1),this.clearData(),this.m_enumInstance=r,r==Wt.DWT.EnumInstance.dwt_desktop?(this.m_deploymentType="desktop",this.m_server=n):r==Wt.DWT.EnumInstance.dbr&&(this.m_deploymentType="browser",this.m_server="")}),[{key:"clearData",value:function(){this.m_iUsingTime=0,this.m_jvUsingTime=xt.nil,this.m_countMap={},this.m_newConsum=!1,this.m_mapSavedToDb=!1,this.m_minExpiredTime=xt.nil,this.m_maxExpiredTime=xt.nil,this.m_cu=xt.nil,this.m_ar=xt.nil,this.m_ltsInstance=xt.nil}},{key:"set_cu",value:function(e){this.m_cu=e}},{key:"get_cu",value:function(){return this.m_cu}},{key:"set_ar",value:function(e){this.m_ar=e}},{key:"get_ar",value:function(){return this.m_ar}},{key:"get_ltsInstance",value:function(e){return this.m_ltsInstance||(this.m_ltsInstance=e(this.m_enumInstance)),this.m_ltsInstance}},{key:"inited_ltsInstance",value:function(){return!!this.m_ltsInstance}},{key:"set_maxExpiredTime",value:function(e){this.m_maxExpiredTime=e}},{key:"get_maxExpiredTime",value:function(){return this.m_maxExpiredTime}},{key:"set_minExpiredTime",value:function(e){this.m_minExpiredTime=e}},{key:"get_minExpiredTime",value:function(){return this.m_minExpiredTime}},{key:"get_deploymentType",value:function(){return this.m_deploymentType}},{key:"get_enumDeploymentType",value:function(){return this.m_enumInstance}}]),xR=Wt.DWT;xR.LTS=xR.LTS||{},xR.licenseException={code:0,message:"",fromLTS:!1},xR.bLTSOnline=!0,xR.axInstance=void 0,xR.lOnUpdateDWObj=[],xR.EnumInstance={dwt_desktop:0,dwt_browser:1,dbr:2};var kR,FR=0,OR={},WR=!1,NR=!1,MR=!1,LR=!1,BR=!1;function UR(){var e=aw.handshakeCode;return xt.isString(e)||(e=""),e}function VR(){var e=aw.organizationID;return xt.isNumber(e)?e=""+e:xt.isString(e)||(e=""),e}function GR(){return xt.replaceAll(zC.JSVersion,",",".")}function jR(e,t){var r=e;return r===xt.nil&&(r=xR.EnumInstance.dwt_desktop),r==xR.EnumInstance.dbr?(xR._dbrLicense||(xR._dbrLicense=new RR(r,"")),xR._dbrLicense):(xR._dwtDLicense||(xR._dwtDLicense=new RR(r,"")),xR._dwtDLicense)}xR.lupverfy=function(){jR(xR.EnumInstance.dwt_desktop).get_ltsInstance(zR),jR(xR.EnumInstance.dbr).get_ltsInstance(zR)},xR.lsmid=function(e,t){jR(xR.EnumInstance.dwt_desktop).set_cu(e)},xR.lsar=function(e,t){jR(xR.EnumInstance.dwt_desktop).set_ar(e)},xR.lsmid2b=function(e){jR(xR.EnumInstance.dwt_desktop).set_cu(e)},xR.lgar=function(e,t){jR(e).get_ar()},xR.laddDWTObj=function(e){var t=!1;xt.each(xR.lOnUpdateDWObj,(function(r){if(r==e)return t=!0,!1})),t||xR.lOnUpdateDWObj.push(e)},xR.lremoveDWTObj=function(e){xt.each(xR.lOnUpdateDWObj,(function(t,r){if(t==e)return xR.lOnUpdateDWObj.splice(r,1),!1}))},xR.lsendUpdateEvt=function(e,t){var r=[];if(xt.each(xR.lOnUpdateDWObj,(function(t){e==xR.EnumInstance.dwt_desktop&&r.push(t)})),0==r.length)return Dt.Promise.resolve();var n,i=r[0];return i._bAx?(xt.each(r,(function(t){t.SetLTSInfo(jR(e).get_ar(),jR(e).get_cu())})),i.GetLicenseInfo().then((function(r){r&&xt.isArray(r.Detail)&&r.Detail.length>0&&xR.lsexp(e,r.Detail[0].ExpireDate,t)}))):(n=i.SetLTSLicenseAsync(jR(e).get_ar()).then((function(r){r&&xt.isArray(r.Detail)&&r.Detail.length>0&&xR.lsexp(e,r.Detail[0].ExpireDate,t)})),xt.each(r,(function(t,r){0!=r&&t.SetLTSLicenseAsync(jR(e).get_ar())})),n)},xR.lgcb=function(){var e=[];return Y.bChrome?e.push("Chrome"):Y.bFirefox?e.push("Firefox"):Y.bEdge?e.push("Edge"):Y.bIE?e.push("IE"):Y.bSafari?e.push("Safari"):Y.bOpera?e.push("Opera"):Y.b360SE?e.push("360SE"):Y.bTencentTraveler?e.push("TencentTraveler"):Y.bMaxthon?e.push("Maxthon"):Y.bMetaSr?e.push("MetaSr"):Y.bTheWorld?e.push("TheWorld"):Y.bUC?e.push("UC"):Y.bHuaWeiBrowser&&e.push("HuaWeiBrowser"),e.push(Y.strBrowserVersion),Y.bWin?e.push("Windows"):Y.bMac?e.push("Mac"):Y.bLinux?e.push("Linux"):Y.bAndroid?e.push("Android"):Y.bChromeOS?e.push("ChromeOS"):Y.bHarmonyOS?e.push("HarmonyOS"):lR.bMobile?e.push("Mobile OS"):Wt.navInfo.bEmbed&&e.push("Embed OS"),e.join(" ")};var HR={NetworkError:-2440,Timedout:-2441,JsonError:-2442,CorsError:-2443,Expired:-2445,LtsJsLoadError:-2446,UUIDError:-2447};function zR(e){var t,r,n=aw.licenseServer;if(n&&n.length>0)for(t=0;t<n.length;t++)r=n[t],xt.endsWith(r,"/")||(n[t]=r+"/");var i={dm:location.origin?xt.startsWith(location.origin,"http")?location.origin:"https://localhost":xt.startsWith(location.href,"http")?location.href:"https://localhost",lf:Dt.localforage,btoa:xt.btoa,atob:xt.atob,sutlcb:function(){xt.isFunction(xR.lonsend)&&xR.lonsend()},fol:xR.OnFirstOffline,dwt:!0};if(e==xR.EnumInstance.dwt_browser||e==xR.EnumInstance.dbr?i.feab=xR.lfeab_wasm:i.feab=xR.lfeab_ax,!Y.bIE&&aw.ltsDebug&&(i.debugLog=console.log),Wt.LTS&&Wt.LTS._)return Wt.LTS._.createLtsInstance(i);var o={},a=function(){return Dt.Promise.reject({code:HR.LtsJsLoadError,message:"The dynamsoft.lts.js load failed."})};return o.i=a,o.s=a,o.u=a,o.caret=a,o}function KR(e,t){var r=null!=t?t:"",n=jR(e),i=n.get_enumDeploymentType();if(xR.lclex(),n.get_ar()&&n.get_cu())return Dt.Promise.resolve({ar:n.get_ar(),cu:n.get_cu()});var o={pd:xR.lgpd(e),v:GR(),os:xR.lgcb(),fn:xR.DeviceFriendlyName||"",ls:aw.licenseServer,sp:aw.sessionPassword,l:sP.getLTSLicense(),mnet:function(){return n.get_maxExpiredTime()},mxet:function(){return n.get_minExpiredTime()},fol:xR.OnFirstOffline};if(o.dt=n.get_deploymentType(),i==xR.EnumInstance.dwt_desktop){var a;if(""==n.get_cu())return Ow(a={}),Dt.Promise.reject({code:a._errorCode,message:a._errorString});o.lsu=n.get_cu()}else i==xR.EnumInstance.dbr||(o.dwt=!0,""!=n.get_cu()&&(o.lsu=n.get_cu()),o.updateLicense=function(e){n.set_ar(e.ar),n.get_cu()||n.set_cu(e.cu),xR.lsendUpdateEvt(i,r)});return n.get_ltsInstance(zR).i(o).then((function(e){return n.get_ar()||n.set_ar(e.ar),n.get_cu()||n.set_cu(e.cu),e}),(function(e){throw n.clearData(),e}))}function JR(){return Date.now()}function YR(e){var t=e?new Date(e):new Date,r="yyyy-MM-ddTHH:mm:ss.SSSZ",n={"M+":t.getUTCMonth()+1,"d+":t.getUTCDate(),"H+":t.getUTCHours(),"h+":t.getUTCHours()%12||12,"m+":t.getUTCMinutes(),"s+":t.getUTCSeconds(),"q+":Math.floor((t.getUTCMonth()+3)/3),"S+":t.getUTCMilliseconds()};for(var i in/(y+)/.test(r)&&(r=r.replace(RegExp.$1,(t.getUTCFullYear()+"").substr(4-RegExp.$1.length))),n)new RegExp("("+i+")").test(r)&&(r=r.replace(RegExp.$1,1==RegExp.$1.length?n[i]:("000"+n[i]).substr(("000"+n[i]).length-RegExp.$1.length)));return r}function QR(e,t){e.__licenseInfo=t,function(e){e.__calic||(e.__calic=e.__licenseInfo)}(e)}function XR(e){var t=Wt.DWT.licenseException;t.code=e.code,t.message=e.message,e&&(qR(e),e instanceof Error?xt.error(e):xt.error(xt.stringify(e)))}function qR(e){xt.isFunction(Wt.DWT.OnWebTwainError)?Wt.DWT.OnWebTwainError(e):xt.isFunction(window.Dynamsoft_OnError)&&window.Dynamsoft_OnError(e)}function ZR(e){return e==tw.LicenseExpiredForDLS||e==tw.LicenseNoCoreForDLS||e==tw.LicenseNoCore||e==tw.LicenseInvalid||e==tw.LicenseExpired||e==tw.LicenseParseFailed||e==tw.LicenseIsFuture||e==tw.LicenseVersionNotCurrent}function $R(e){return e==tw.LicenseExpired}function ex(e){var t=0,r=e.message;xt.isNumber(e.code)?t=e.code:xt.isString(r)&&(t=-1),0!=t&&function(e,t){xt.isFunction(Wt.OnLicenseError)&&Wt.OnLicenseError(t,e)}(t,r)}function tx(e){ex(tA(e))}xR.lgpd=function(e){return Y.bWin&&e==xR.EnumInstance.dwt_desktop?"dwt|dbr":"dwt"},xR.lglic=KR,xR.lgbuuid=function(){return""},xR.lshow=function(){return{t:kR,t2:FR,m:xt.stringify(OR)}},xR.lgct=function(e){switch(e){case 0:return"3011";case 1:return"3012";case 2:return"3014";case 3:return"3013";case 4:return"3015";case 14:return"3016";case 3001:return"3001";case 3002:return"3002";case 3003:return"3003";case 3004:return"3004";case 3005:return"3005";case 3006:return"3006";case 3007:return"3007";case 3008:return"3008";case 3009:return"3009";case 5001:return"5001";case 4001:return"4001";case 4002:return"4002";case 4003:return"4003"}return""},xR.lcvrf=function(e){e&&(e._canConsume&&!e._canConsume()||setTimeout((function(){xR.lcvrf_(e)}),1))},xR.lcvrf_=function(e){var t;t=xR.EnumInstance.dwt_desktop;var r,n=xR.DeviceFriendlyName||"",i=xR.lgcb(),o=jR(t),a={hs:UR(),og:VR(),cu:o.get_cu(),fn:n,cw:"",os:i,v:GR(),dt:o.get_deploymentType(),ed:"js"},s=function(e,t){var r,n,i=0;if(xt.isString(e)&&""!=e&&"{}"!=e&&t&&xt.isArray(t)&&!(t.length<1)){if(n=jR(t[0]),r=xt.parse(e),xR.lclex(),0==FR){var o=JR(),a="";FR=o,kR=YR(o),OR={},i=0,xt.each(r,(function(e,t){(t<i||0==i)&&(i=t,a=e)})),i>0&&n.get_ltsInstance(zR).s(aw.licenseServer,a,i,!0).then((function(){}),(function(e){}))}xt.each(r,(function(e,t){var r=!1,o=parseInt(t);o>0&&o!=i&&(o+18e4<JR()&&(r=!0),n.get_ltsInstance(zR).s(aw.licenseServer,e,t,r).then((function(){}),(function(e){})))}))}};if(a.pd=xR.lgpd(t),r=xt.stringify(a),!e._bAx){var u="GetBuffer",c=mR(xt.replaceAll(r,'"','\\"')),l={cmd:u,cmdId:wR(),sFun:s,fFun:function(){},params:[t]};return e._innerSendByWS(u,c,l,null,!0)}s(e.GetBuffer(r),[t,""])},xR.lavrf=function(e,t,r,n){var i=1;if(""!=e){t>1&&(i=t);var o=JR();if(FR>0&&FR+18e4<o){NR?(OR={},xR.lavrf__unload()):xR.lavrf__(!0,r,n);var a=JR()+1;FR=a,kR=YR(a),OR={}}WR=!0,NR=!1,OR[e]?OR[e]+=i:OR[e]=i,0==FR&&xR.lavrf__(!0,r,n)}},xR.lavrf_=function(e,t,r){if(WR){var n=1;e&&(n=e),setTimeout((function(){xR.lavrf__(!1,t,r)}),n)}},xR.lavrf__=function(e,t,r){var n,i,o,a=JR(),s=!1,u=!!e,c=0,l=t;xt.isUndefined(l)&&(l=xR.EnumInstance.dwt_desktop),o=jR(l),WR=!1,0==FR&&(s=!0,FR=a,kR=YR(a)),n=FR,i=kR;var d={};d.ut=i;var f={};if(xt.each(OR,(function(e,t){f[t]=e,e>0&&c++})),d.cts=f,u||n+18e4<a){u=!0;var h=JR()+1;if(FR=h,kR=YR(h),OR={},NR=!1,0==c)return}else{if(0==c)return;NR=!0}d.dur=s?1:180;var g,p=xR.DeviceFriendlyName||"",_=xR.lgcb(),m={hs:UR(),og:VR(),cu:o.get_cu(),fn:p,cw:"",os:_,v:GR(),dt:o.get_deploymentType(),ed:"js",rcs:[d]};m.product=xR.lgpd(t),g=xt.stringify(m),aw.ltsDebug&&YR(),xR.lclex(),o.get_ltsInstance(zR).s(aw.licenseServer,g,""+n,u).then((function(){}),(function(e){}))},xR.lavrf__unload=GE(m.mark((function e(){var t,r,n,i,o,a,s;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=JR(),r=!0,i=!1,o=jR(xR.EnumInstance.dwt_desktop),a=jR(xR.EnumInstance.dbr),WR=!1,0==FR&&(FR=t,kR=YR(t)),n=FR,s=JR()+1,FR=s,kR=YR(s),OR={},NR=!1,n+=1,xR.lclex(),!o.inited_ltsInstance()){e.next=20;break}return e.prev=13,e.next=16,o.get_ltsInstance(zR).s(aw.licenseServer,i,""+n,r);case 16:e.next=20;break;case 18:e.prev=18,e.t0=e.catch(13);case 20:if(!a.inited_ltsInstance()){e.next=28;break}return e.prev=21,e.next=24,a.get_ltsInstance(zR).s(aw.licenseServer,i,""+n,r);case 24:e.next=28;break;case 26:e.prev=26,e.t1=e.catch(21);case 28:case"end":return e.stop()}}),e,null,[[13,18],[21,26]])}))),xR.lclex=function(){var e=xR.licenseException;e.code=0,e.message="",e.httpResponse="",e.fromLTS=!1},xR.li=function(e,t){var r;return e.axInstance&&(xR.axInstance=e.axInstance,xR.axInstance)?(r=xR.axInstance.GetUUID(),aw.ltsDebug&&xt.log("ActiveX cu: "+r),jR(e.instanceMode).set_cu(r),r):jR(e.instanceMode).get_cu()},xR.lfeab_ax=function(e){return new Dt.Promise((function(t,r){var n="";if(xR.axInstance)try{n=xR.axInstance.Encrypt(e,0)}catch(ij){}t(n)}))},xR.lfeab_wasm=function(e){return Dt.Promise.resolve("")},xR.lwsproc=function(e,t){try{e=xt.parse(e)}catch(r){return void(t.fFun&&t.fFun(r))}"GetBuffer"==e.method?t.sFun&&e.result.length>0?t.sFun(e.result[0],t.params):t.sFun("",t.params):t.sFun&&t.sFun(e)},xR.lsexp=function(e,t,r){var n,i=t;if(3==(n=(i=xt.replaceAll(i,"/","-")).split("-")).length){var o=n[0],a=n[1],s=n[2];a.length<2&&(a=(a="00"+a).substr(a.length-2)),s.length<2&&(s=(s="00"+s).substr(s.length-2)),i=[o,a,s].join("-")}var u=[i,"T23:59:59.999Z"].join("");jR(e).set_minExpiredTime(u),jR(e).set_maxExpiredTime(u)},xR.lunload=GE(m.mark((function e(){return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,xR.lavrf__unload();case 2:FR=0,kR=xt.nil,OR={},NR=!1,WR=!1,MR=!1,LR=!1,BR=!1,xR.lclex(),xR.bLTSOnline=!0,xR.axInstance=xt.nil,xR.lOnUpdateDWObj=[];case 14:case"end":return e.stop()}}),e)}))),xR.lcexp=function(e,t){return jR(e).get_ltsInstance(zR).caret().then((function(){return!1}),(function(e){var t=xR.licenseException,r="";return e instanceof Error||"message"in e?r=e.message:xt.isString(e)&&(r=e),xR.lsetException(HR.Expired,r,!1),LR||(LR=!0,xt.error(r),Wt.OnLTSLicenseError&&Wt.OnLTSLicenseError(sP.getPublicLicenseContent(t.message),t.code)),!0}))},xR.OnLicenseException=function(){var e=xR.licenseException,t=e.message;if(xt.isString(t)&&(t.indexOf("Error Code")>-1?t=xt.replaceAll(t,"Error Code","error code"):t.indexOf("Error code")>-1&&(t=xt.replaceAll(t,"Error code","error code"))),t.indexOf("(https://www.dynamsoft.com/purchase-center/)")>-1&&(t=t.replace("(https://www.dynamsoft.com/purchase-center/)","(https://www.dynamsoft.com/store/dynamic-web-twain/)"),e.message=t),t.indexOf("error code:")>-1){var r=t.substr(0,t.indexOf("message")),n=t.substr(t.indexOf("message"));r.indexOf("{")>-1&&(r=r.substr(r.indexOf("{")+1)),n.indexOf("}")>-1&&(n=n.substr(0,n.indexOf("}"))),r=xt.replaceAll(r,"error code:",""),n=xt.replaceAll(n,"message: ",""),xR.lsetException(parseInt(r),n,!0),xt.error(n),Wt.OnLTSLicenseError&&Wt.OnLTSLicenseError(sP.getPublicLicenseContent(t),e.code)}else{if(!e.code){var i=HR.NetworkError;t.indexOf("timed out")>-1||t.indexOf("timeout")>-1?i=HR.Timedout:(t.indexOf("access-control-allow-origin")>-1||t.indexOf("cors")>-1)&&(i=HR.CorsError),xR.lsetException(i,t,!0)}if(xt.error(e.message),e.code==HR.LtsJsLoadError)return;Wt.OnLTSLicenseError&&Wt.OnLTSLicenseError(sP.getPublicLicenseContent(e.message),e.code)}},xR.lol=function(){return xR.bLTSOnline},xR.OnFirstOffline=function(e){xR.bLTSOnline=!1},xR.lpubdlg=function(e,t){if(xt.isString(e)&&""!=e){if(e=xt.atob(e),console&&console.warn,1==t)return MR||(MR=!0,Wt.OnLTSPublicLicenseWarning&&Wt.OnLTSPublicLicenseWarning(sP.getPublicLicenseContent(e))),!0;2==t&&(MR||(MR=!0))}return!1},xR.lcheckLic=function(e,t,r){var n=!1;if(t){if(xt.isArray(t.Detail)&&t.Detail.length>0){var i=t.Detail[0].ExpireDate;return xR.lsexp(e,i,r),xR.lcexp(e,r).then((function(e){var r=!1;e?r=!0:1!=t.Trial&&2!=t.Trial||(r=xR.lpubdlg(t.Message,t.Trial)),r||xR.bLTSOnline||BR||(BR=!0,Wt.OnLTSConnectionWarning&&Wt.OnLTSConnectionWarning())}))}1!=t.Trial&&2!=t.Trial||(n=xR.lpubdlg(t.Message,t.Trial))}return n||xR.bLTSOnline||BR||(BR=!0,Wt.OnLTSConnectionWarning&&Wt.OnLTSConnectionWarning()),Dt.Promise.resolve()},xR.lisValidID=function(e){if(xt.isString(e)&&""!=e)return!0;var t,r=xR.licenseException;return xR.lsetException(HR.UUIDError,"Failed to generate an ID for your device to license it: not enough permission.",!0),xt.error(r.message),t=r.message,Wt.OnLTSLicenseError&&Wt.OnLTSLicenseError(t,r.code),!1},xR.lsetException=function(e,t,r){var n=xR.licenseException;n.code=e,n.message=t,xt.isUndefined(r)||(n.fromLTS=r)},xR.lgcuid=function(e){var t=Wt.DWT.li({instanceMode:e},"");return t?Dt.Promise.resolve(t):jR(e).get_ltsInstance(zR).u().then((function(e){return Wt.DWT.lsmid(e,""),Wt.DWT.lsmid2b(e),e}))};var rx,nx=s((function e(){t(this,e)}));function ix(e){var t=new nx;return t.server=e.server,t.normal=!0,e.attrs&&(t.attrs=xt.clone(e.attrs)),t}function ox(t,r,n){if(xt.isString(t)&&(t.indexOf("Function not found")>0||t.indexOf("Version not found")>0))r&&r(t);else{var i=t.data;if("object"===e(i))return i=null,t=null,void(n&&n());var o=i.replace(/\0/g,"");try{r&&r(o)}catch(c){xt.log(i),n&&n()}i=null,t=null}}function ax(e,t){e&&e.readyState!=rx.CLOSING&&e.readyState!=rx.CLOSED?e.readyState==rx.CONNECTING?(e.onerror=function(t){t&&xt.log("websocket error: "+t),e._reject&&(e._reject(t),e._reject=null),e.close()},e.onclose=function(t){e.onclose=null,e.onerror=null,e.onmessage=null,e.onopen=null,e._reject=null},e.onopen=function(){e.readyState==rx.OPEN?(e.onopen=null,e.send(t)):e.readyState==rx.CONNECTING&&(e.onopen?setTimeout(e.onopen,100):e._reject&&(e._reject(),e._reject=null))}):e.readyState==rx.OPEN&&(e.onopen=null,e.send(t)):e._reject&&(e._reject({closed:!0}),e._reject=null)}function sx(e,t,r){var n,i=r;return i||(Wt.DWT.ConnectWithSocket?xt.startsWith(e,"wss://")||xt.startsWith(e,"ws://")||(i=Y.bSSL?"wss://":"ws://"):xt.startsWith(e,"https://")||xt.startsWith(e,"http://")||(i=Y.bSSL?"https://":"http://")),t?(xt.endsWith(e,"/")&&(e=e.substring(0,e.length-1)),n=":"+t+"/"):xt.endsWith(e,"/")||(n="/"),[i,e,n].join("")}!function(e){e.CONNECTING=0,e.OPEN=1,e.CLOSING=2,e.CLOSED=3}(rx||(rx={}));var ux,cx=function(){function e(){t(this,e)}return s(e,null,[{key:"postStringDataByWS",value:function(e,t){return new Dt.Promise((function(r,n){e.onmessage=function(t){ox(t,(function(t){r(t),e.close(),e=null}),(function(){n(),e.close(),e=null}))},e._reject=n,ax(e,t)}))}},{key:"postStringDataByWSUrl",value:function(t,r){var n=new Dt.Promise((function(n,i){var o=e.newWebsocket(t,!1);o.onmessage=function(e){ox(e,(function(e){n(e),o.close(),o=null}),(function(e){i(e),o.close(),o=null}))},o._reject=i,ax(o,r)}));return Y.bEdge&&n.catch((function(){return new Dt.Promise((function(n,i){var o=e.newWebsocket(t,!0);o.onmessage=function(e){ox(e,(function(e){n(e),o.close(),o=null}),(function(e){i(e),o.close(),o=null}))},o._reject=i,ax(o,r)}))})),n}},{key:"newWebsocket",value:function(e,t){var r,n=ow.wsProtocol,i=window.MozWebSocket;if(void 0!==i)r=n?new i(e,n):new i(e);else{var o=window.WebSocket;if(t){var a=window,s=parent;try{for(;a!=s&&s.WebSocket;)o=s.WebSocket,a=s.window,s=s.parent}catch(d){o=window.WebSocket}}r=n?new o(e,n):new o(e)}return r}},{key:"getWsUrl",value:function(e,t,r){var n=r;return void 0===n&&(n=Y.bSSL),sx(e,t,n?"wss://":"ws://")}},{key:"getDDMUrl",value:function(e,t,r){var n,i,o="/";return xt.startsWith(e,"https://")?n=!0:xt.startsWith(e,"http://")?n=!1:e=(n=Dt.detect.ssl)?"https://"+e:"http://"+e,i=n?"18626/":"18625/",xt.endsWith(e,"/")&&(o=""),t?[e,o,"ddm/",i,r].join(""):[e,o,r].join("")}},{key:"getModuleUrl",value:function(e){var t;return t=sx(JC(),Y.bSSL?Wt.DWT.SSLPort:Wt.DWT.Port),e?t+e:t}}])}();Wt.DWT.NetManager=cx,function(e){e.ST_UNKNOWN=0,e.ST_TWAIN_DIRECT=1,e.ST_DYNAMSOFT_SERVICE=2,e.ST_ESCL=3,e.ST_WIFI_DIRECT=4}(ux||(ux={}));var lx,dx,fx,hx=s((function e(r){t(this,e);var n=this;if(n._id=r.id,n._clientId=xt.getRandom(),n._uuidForActiveUI=null,n._bReady=Lb,n._destroy=Lb,n._bMustUpgradeService=Lb,n._wsClient=null,n._wsRetry=0,n._wsFailedTimes=0,n._bConnecting=Lb,n._bNoMask=Lb,n._bNotShowMessage=Lb,n.__serverPlatform=gC.enumWindow,n.__productKey="",n.__licenseInfo=null,n._reconnectTimeSpan=sw.RemoteReconnectTimeSpan,n._reconnectShortSpan=300,n._reconnectShortSpanTimes=5,n._bIfShowProgressBar=Bb,n.__IfShowCancelDialogWhenImageTransfer=Bb,n._bLicenseErrorDispose=!0,r.dmService){var i,o,a,s,u,c,l=ix(r.dmService),d="/",f="";o=l.server;var h=new Jb(r.dmService.server),g=h.scheme;g&&(g=g.toLowerCase()),"https"==g?(i=!0,a=o.substring(8)):"http"==g?(i=!1,a=o.substring(7)):"wss"==g?(i=!0,a=o,o=xt.replaceAll(o,"wss://","")):"ws"==g?(i=!1,a=o,o=xt.replaceAll(o,"ws://","")):(a=o,o=(i=Dt.detect.ssl)?"https://"+o:"http://"+o),dw(h.hostname||h.scheme)?n._bRemoteMode=Lb:n._bRemoteMode=Bb,xt.endsWith(o,"/")&&(d="");var p=l.attrs;if(p){var _,m;s=(null===(_=p)||void 0===_?void 0:_.UUID)||"";var v,y=(null===(m=p.modules)||void 0===m?void 0:m.length)||0;""!=s&&y>0&&(i?y>1&&y>1+(v=p.modules[1])+2&&(u=p.modules[1+v+2]):y>2&&(u=p.modules[2]),xt.endsWith(u,"/")&&(d=""),f=[s,"/",u,"/"].join(""))}else p={UUID:"",service_type:ux.ST_DYNAMSOFT_SERVICE};c=[o,d,f].join(""),p.url=c,n._serverInfo=new KE([a,d,f].join(""),null,i,!0,ow.wsProtocol),n._httpUrl=c,n._dmService=l}else{var S,T=Dt.detect.ssl,I=r.port,b=r.sslPort;dw(S=r.host?r.host:JC())?n._bRemoteMode=!1:n._bRemoteMode=!0,I||(I=Wt.DWT.Port),b||(b=Wt.DWT.SSLPort),n._serverInfo=new KE(S,T?b:I,T,!0,ow.wsProtocol),n._httpUrl=function(e){var t=e.server;if(t){if(xt.startsWith(t,"wss://")||xt.startsWith(t,"ws://"))return t}else t=JC();return e.ssl?["https://",t,":",e.port,"/"].join(""):["http://",t,":",e.port,"/"].join("")}(n._serverInfo),n._dmService={server:n._httpUrl,attrs:{url:n._httpUrl,UUID:"",service_type:ux.ST_DYNAMSOFT_SERVICE},normal:!0}}}),[{key:"_resetErr",value:function(){this._errorCode=0,this._errorString="";var e=Wt.DWT.licenseException;e.code=0,e.message=""}},{key:"dispose",value:function(){this._bReady=Lb,this._destroy=Bb}},{key:"isDestroy",get:function(){return this._destroy}}]),gx=s((function e(){t(this,e)}));function px(e,t){var r,n=[],i=t;if(xt.isString(i)&&(i=xt.parse(i)),xt.isArray(i))for(r=0;r<i.length;r++){var o=vx(i[r]);n.push(o)}for(r=0;r<n.length;r++){var a=n[r],s=a.deviceType;a.name&&(a.name=xt.base64.decode(a.name)),s&yR&&a.deviceInfo&&mx(a.deviceInfo),a.serviceInfo=null==e?void 0:e._dmService,_x(a,null==e?void 0:e._dmService),xt.isBoolean(a.isSystemDefaultPrinter)||(a.isSystemDefaultPrinter=!1)}return n}function _x(e,t){var r,n=e.name,i="",o=e.deviceType;o==fR.TWAINSCANNER?r="":o==fR.TWAINX64SCANNER?r="Twain64-":o==fR.WIASCANNER?r="WIA-":o==fR.WIATWAINSCANNER?(n=xt.replaceAll(n,"WIA-",""),r="WIATWAIN-"):r=o==fR.ICASCANNER?"ICA-":o==fR.SANESCANNER?"Sane-":o==fR.ESCLSCANNER?"eSCL-":(fR.WIFIDIRECTSCANNER,""),t&&t.attrs&&t.attrs.ty&&(i=" on ["+t.attrs.ty+"]"),e.displayName=[r,n,i].join("")}function mx(e){if(e.ProductName){var t=e.ProductName;e.ProductName=xt.base64.decode(t)}if(e.ProductFamily){var r=e.ProductFamily;e.ProductFamily=xt.base64.decode(r)}if(e.Manufacturer){var n=e.Manufacturer;e.Manufacturer=xt.base64.decode(n)}if(e.Version&&e.Version.Info){var i=e.Version.Info;e.Version.Info=xt.base64.decode(i)}}function vx(e){var t=new gx;return t.strDevice=xt.stringify(e),e.deviceInfo&&(t.deviceInfo=xt.clone(e.deviceInfo)),e.deviceType&&(t.deviceType=xt.clone(e.deviceType)),e.displayName&&(t.displayName=xt.clone(e.displayName)),e.name&&(t.name=xt.clone(e.name)),e.serviceInfo&&(t.serviceInfo=ix(e.serviceInfo)),xt.isBoolean(e.isSystemDefaultPrinter)?t.isSystemDefaultPrinter=e.isSystemDefaultPrinter:t.isSystemDefaultPrinter=!1,t}function yx(e){var t=e||{};t.basePath&&(lR.basePath=t.basePath),t.pathType&&(lR.pathType=t.pathType),xt.isUndefined(t.bDiscardBlankImage)||(lR.bDiscardBlankImage=t.bDiscardBlankImage),t.msgPrefix&&t.msgPrefix,t.msgSuffix&&t.msgSuffix,t.detectType&&(Dt.detect.detectType=t.detectType),t.tryTimes&&(Dt.detect.tryTimes=t.tryTimes);var r=Wt.DWT.RemoteScanConfig;r||(r={sessionTimeout:300,keepAwake:!0},Wt.DWT.RemoteScanConfig=r),void 0===r.keepAwake&&(r.keepAwake=!0)}function Sx(){return!!xt.getWakeLock()}function Tx(e){return Ix.apply(this,arguments)}function Ix(){return(Ix=GE(m.mark((function e(t){var r;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=xt.getWakeLock(),!t){e.next=7;break}if(null!=r){e.next=5;break}return e.next=5,xt.toggleWakeLock();case 5:e.next=10;break;case 7:if(!r){e.next=10;break}return e.next=10,xt.toggleWakeLock();case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function bx(){for(var e,t,r,n=["dynamsoft.webtwain.install.js","dynamsoft.webtwain.viewer.js","dynamsoft.lts.js","dynamsoft.webtwain.viewer.css","dynamsoft.webtwain.css"],i=document.head.childNodes,o=i.length-1;o>=0;o--)if("LINK"==(t=i[o]).tagName?r=t.href:"SCRIPT"==t.tagName&&(r=t.src),r)for(e=0;e<n.length;e++)r.indexOf(n[e])>=0&&t.remove();Dt.detect.cssLoaded=!1}function Cx(e){return wx.apply(this,arguments)}function wx(){return(wx=GE(m.mark((function e(t){var r;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t&&((r=document.createElement("style")).innerHTML=['@import url("',Wt.DWT.ResourcesPath,"/src/dynamsoft.webtwain.viewer.css",Dt.timestamp,'")'].join(""),t.appendChild(r));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ex(e,t){var r;for(r=0;r<e.length;r++)if(e[r]==t)return!0;return!1}function Ax(e){var t="application/octet-stream";switch(e){case dx.IT_BMP:t="image/bmp";break;case dx.IT_JPG:t="image/jpeg";break;case dx.IT_TIF:t="image/tiff";break;case dx.IT_PNG:t="image/png";break;case dx.IT_PDF:t="application/pdf";break;case dx.IT_J2K:t="image/jp2"}return t}Dt.removeNonPrintableChar,function(e){e.SMF_NAME=1,e.SMF_TWAINVERSION=2,e.SMF_TWAINPROTOCOL=4,e.SMF_ICAUUID=8,e.SMF_ICAMODULEVERSION=16,e.SMF_ICALOCATIONTYPE=32}(lx||(lx={})),function(e){e.IT_BMP=0,e.IT_JPG=1,e.IT_TIF=2,e.IT_PNG=3,e.IT_PDF=4,e.IT_ALL=5,e.IT_MULTIPAGE_PDF=7,e.IT_MULTIPAGE_TIF=8,e.IT_J2K=14}(dx||(dx={})),function(e){e.RGBA=15,e.Auto=16}(fx||(fx={}));var Dx={isSupportLS:function(){var e=!1;if(Y.bEdge&&Y.bFileSystem);else try{e=!!window.localStorage}catch(QG){}return e},item:function(e,t,r){var n=null;return this.isSupportLS()?(t?(localStorage.setItem(e,t),n=t):n=localStorage.getItem(e),null===n?r:n):r},removeItem:function(e){return!!this.isSupportLS()&&(localStorage.removeItem(e),!0)}},Px=!0,Rx=!1;function xx(e){if(xt.isUndefined(e))return Rx;var t,r,n,i=(n=e.toString().toLowerCase().toLowerCase().replace(aw.name.toLowerCase()+" ",""),(n=xt.replaceAll(n,"[.]",",")).split(","));t=aw.bActiveXEdition?zC.ActiveXVersion:aw.getServerVersionInfo(!0),r=(t=xt.replaceAll(String(t),"[.]",",")).split(",");for(var o=i.length>r.length?i.length:r.length,a=0;a<o;a++){if(null==i[a]&&(i[a]=0),null==r[a]&&(r[a]=0),parseInt(i[a])<parseInt(r[a]))return Rx;if(parseInt(i[a])>parseInt(r[a]))return Px}return Px}function kx(e,t){var r=e.split(","),n=t.split(",");return r.length>3&&xt.trim(r[0])==n[0]&&(xt.trim(r[1])>n[1]||xt.trim(r[1])==n[1]&&xt.trim(r[2])>n[2]||xt.trim(r[1])==n[1]&&xt.trim(r[2])==n[2]&&parseInt(xt.trim(r[3]))>=parseInt(n[3]))}var Fx=3;function Ox(e,t){Dt.detect.urls.splice(0),Dt.detect.urls.push({port:e,ssl:Y.bSSL}),Dt.detect.ports=[{port:e,ssl:Y.bSSL}],Dt.detect.cUrlIndex=0,ow.detect.dwtPort=e,ow.detect.dwtSSLPort=t,Wt.DWT.Port=e,Wt.DWT.SSLPort=t}function Wx(e,t,r){return Nx.apply(this,arguments)}function Nx(){return Nx=GE(m.mark((function e(t,r,n){var i,o,a;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!aw.bDCPChecked){e.next=2;break}return e.abrupt("return",{host:t,port:Wt.DWT.Port,sslPort:Wt.DWT.SSLPort});case 2:return SD(wD),e.prev=3,e.next=6,Vx(t);case 6:i=e.sent,e.next=13;break;case 9:throw e.prev=9,e.t0=e.catch(3),xt.log(e.t0),AE();case 13:if(!ow.bEnhancedMode){e.next=27;break}if(SD(ED),o=Dt.install._dlgInstall,a=500,o&&o.open||(a=0),!(i.port<=0||i.sslPort<=0)){e.next=25;break}if(!(a>0)){e.next=21;break}return e.next=21,new Dt.Promise((function(e,t){setTimeout((function(){e()}),a)}));case 21:return SD(AD),e.next=24,Mx(t);case 24:i=e.sent;case 25:e.next=28;break;case 27:i={host:t,port:r,sslPort:n};case 28:return aw.bDCPChecked=!0,e.abrupt("return",i);case 30:case"end":return e.stop()}}),e,null,[[3,9]])}))),Nx.apply(this,arguments)}function Mx(e){return Lx.apply(this,arguments)}function Lx(){return Lx=GE(m.mark((function e(t){var r,n,i,o;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=5,i=1500,o={host:t,port:0,sslPort:0},r=0;case 3:if(!(r<n)){e.next=22;break}return r>2&&(i=3e3),SD(AD),e.prev=6,e.next=9,Bx(t);case 9:o=e.sent,e.next=14;break;case 12:e.prev=12,e.t0=e.catch(6);case 14:if(!(xt.isNumber(o.port)&&o.port>0&&xt.isNumber(o.sslPort)&&o.sslPort>0)){e.next=17;break}return Ox(o.port,o.sslPort),e.abrupt("return",o);case 17:return e.next=19,new Dt.Promise((function(e,t){setTimeout((function(){e()}),i)}));case 19:r++,e.next=3;break;case 22:throw Dt.detect.dcpStatus=Fx,AE();case 25:case"end":return e.stop()}}),e,null,[[6,12]])}))),Lx.apply(this,arguments)}function Bx(e){return Ux.apply(this,arguments)}function Ux(){return Ux=GE(m.mark((function e(t){var r,n,i,o,a,s,u,c,l;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=aw.refProductKey,xt.startsWith(t,"wss://")||xt.startsWith(t,"ws://")?i=t:(o=Y.bSSL?ow.SSLPort:ow.Port,i=cx.getWsUrl(t,o,Y.bSSL)),a={id:xt.guid(),method:"GetPorts",version:"dwasm2_"+NC(),parameter:[ow.strSID]},sP.isLongKey(r)&&(a.productKey=r),e.next=6,cx.postStringDataByWSUrl(i,xt.stringify(a));case 6:if(s=e.sent,!xt.isString(s)){e.next=19;break}if(e.prev=8,(u=xt.parse(s))&&"result"in u&&(n=u.result),!(xt.isArray(n)&&n.length>1&&n[1])){e.next=15;break}if(!(c=n[1]).dwt){e.next=15;break}return e.abrupt("return",{host:t,port:c.dwt.port,sslPort:c.dwt.sslPort});case 15:e.next=19;break;case 17:e.prev=17,e.t0=e.catch(8);case 19:throw SE(l={}),tA(l);case 22:case"end":return e.stop()}}),e,null,[[8,17]])}))),Ux.apply(this,arguments)}function Vx(e){return Gx.apply(this,arguments)}function Gx(){return(Gx=GE(m.mark((function e(t){var r,n;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return ow.detect.bConnected=!1,e.prev=1,e.next=4,jx(t);case 4:return zx(e.sent),ow.detect.bConnected=!0,e.abrupt("return",{host:t,port:ow.detect.dwtPort,sslPort:ow.detect.dwtSSLPort});case 10:if(e.prev=10,e.t0=e.catch(1),!e.t0){e.next=21;break}if(r=e.t0.code,!xt.isNumber(r)){e.next=21;break}if(r!=rw.ResponseDataTypeError&&r!=rw.HTSTError&&r!=rw.CORSError&&r!=rw.CORSErrorFromService&&r!=rw.SSLCertExpired&&r!=rw.SSLCertInvalid){e.next=19;break}throw e.t0;case 19:if(r!=rw.MustUpgrade){e.next=21;break}throw e.t0;case 21:throw ow.detect.dcpStatus=ow.detect.EnumDCP_DetectStatus.NotInstalled,Wt.dcp._sendStatusEvent(),yE(n={}),{code:n._errorCode,message:n._errorString};case 26:case"end":return e.stop()}}),e,null,[[1,10]])})))).apply(this,arguments)}function jx(e){return Hx.apply(this,arguments)}function Hx(){return Hx=GE(m.mark((function e(t){var r,n,i,o,a,s,u,c,l;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=aw.refProductKey,xt.startsWith(t,"wss://")||xt.startsWith(t,"ws://")?i=t:(o=Y.bSSL?ow.SSLPort:ow.Port,i=cx.getWsUrl(t,o,Y.bSSL)),a={id:xt.guid(),method:"VersionInfo",version:"dwasm2_"+sw.getVersionStrForCheck(),parameter:[]},sP.isLongKey(r)&&(a.productKey=r),e.next=6,cx.postStringDataByWSUrl(i,xt.stringify(a));case 6:if(s=e.sent,xt.isString(s))try{(u=xt.parse(s))&&"result"in u&&(n=u.result)}catch(g){}if(c={},!(xt.isArray(n)&&n.length>0&&n[0])){e.next=23;break}if(l=n[0],!xt.isString(l)||""==l){e.next=23;break}if(!kx(l,aw.getServerVersionInfo(!0))){e.next=18;break}return ow.detect.dcpStatus=ow.detect.EnumDCP_DetectStatus.UpdateSkipped,Wt.dcp._sendStatusEvent(),e.abrupt("return",n);case 18:throw SD(xD),Sw(c),tA(c);case 21:e.next=23;break;case 23:throw SE(c),tA(c);case 25:case"end":return e.stop()}}),e)}))),Hx.apply(this,arguments)}function zx(e){var t="",r=!1,n=!1,i={};if(e.length>4&&(t=xt.isString(e[2])?e[2]:"",r=xt.isString(e[3])&&"true"===e[3],n=xt.isString(e[4])&&"64"===e[4]),e.length>5&&(i=e[5]),ow.detect.connectedResult=e,ow.strSID=t,ow.bEnhancedMode=r,ow.b64bit=n,ow.objEnhancedPorts=i,r&&i){if(i.dcp){var o=i.dcp;ow.SSLPort=o.sslPort,ow.Port=o.port}if(i.ddm){var a=i.ddm;a?Y.bSSL?ow.detect.ddmPort=a.sslPort:ow.detect.ddmPort=a.port:ow.detect.ddmPort=0}if(Wt.DWT.Port=0,Wt.DWT.SSLPort=0,i.dwt){var s=i.dwt;s&&s.port>0&&s.sslPort>0&&Ox(s.port,s.sslPort)}}}function Kx(e,t){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.add(e)}function Jx(e,t,r){return t.has(e),r}Wt.DWT.NetManager.checkModuleManager=function(e,t){Vx(JC()).then(e,t)};var Yx=new WeakSet,Qx=new WeakSet,Xx=function(e){function r(e){var n,i,o,a;return t(this,r),i=this,a=[e],o=QE(o=r),Kx(n=YE(i,function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(QG){return!1}}()?Reflect.construct(o,a||[],QE(i).constructor):o.apply(i,a)),Qx),Kx(n,Yx),n._acquireDivEL=null,n.__serverId="",n.__bAcquireImageNow=Lb,n._blts=lw(),n._bltsCopyImage=!1,n._b64bit=ow.b64bit,n._logLevel=0,n._bServerAlwaysFocusOnPopupWindow=Bb,n._bPageFocus=Bb,n.__bOpenFileNow=Lb,n._bScanForProxyRemote=Lb,n}return qE(r,e),s(r,[{key:"_isValid",value:function(){return!this._destroy||(tE(this),!1)}},{key:"_connnect",value:(w=GE(m.mark((function e(){var t;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this,e.abrupt("return",new Dt.Promise((function(e,r){var n,i;n=t._serverInfo.server,i=t._serverInfo.port,Wt.DWT.CheckConnectToTheService(n,i,e,r)})));case 2:case"end":return e.stop()}}),e,this)}))),function(){return w.apply(this,arguments)})},{key:"_waitForConnect",value:function(){var e=this;return e._wsRetry=0,e._bReady?Dt.Promise.resolve():new Dt.Promise((function(t,r){e._wsCheckResolve=t,e._wsCheckReject=r,rk(e)}))}},{key:"_getWSCallback",value:function(){return nk}},{key:"_getWSContextData",value:function(){return{}}},{key:"_additionalWSCallback",value:function(e,t,r,n){"ConvertToBlob"==e&&t._blob_callbacks.push((function(e){return r(e,$E.HANDLE_RAW_MESSAGE,"0",n)}))}},{key:"_innerSendBlobByWS",value:function(e,t,r,n,i){var o={cmd:e,cmdId:wR(),sFun:function(e){xt.isFunction(n)&&n(e)},fFun:i,contextData:{document:r.currentFileName,tag:r.currentTagName,bNeedClearTag:r.bNeedClearCurrentTagName,bNeedRefresh:"UpdateImage"==e},rawData:!0};return this._innerSendByWS(e,t,o,r,!0)}},{key:"_innerSendByWS",value:function(e,t,r,n,i){var o,a,s,u,c=this,l=this._getWSCallback();r&&r.cmdId?(o=r.cmdId,s=tk(c._clientId,o),u=tk(c._clientId,"")):(o=0,s=0,u=0);var d=ek(c._clientId,e,t,o,c._bScanForProxyRemote),f=c._wsClient;a={client:f,userData:{stwain:c,command:r},taskId:o,eventTaskId:s,lastEventTaskId:u};var h,g,p,_,m,v,y,S,T=0;if(!i){try{f.request(d,l,a)}catch(QG){xt.log(QG)}return Lb}if(p=new ArrayBuffer(12),n)if(n instanceof Blob)T=n.size;else if(n instanceof ArrayBuffer||n instanceof Uint8Array)T=n.byteLength;else if(n instanceof Array)T=n.length;else{var I=n;T=I.size||I.byteLength||I.length}for(g=(h=(y=new Blob([d])).size)+T,_=new DataView(p),v=0;v<8&&g;v++)_.setUint8(v,g%256),g=Math.floor(g/256);for(v=0;v<4&&h;v++)_.setUint8(8+v,h%256),h=Math.floor(h/256);return m=new Blob([p,y]),S=f.request(m,l,a),this._additionalWSCallback(e,f,l,a),T>0&&(S=f.request(n,l,a)),p=null,y=null,m=null,_=null,n=null,S}},{key:"_sendDataConnectWithSocket",value:function(e,t,r,n){var i=this;return new Dt.Promise((function(r,o){i._sendData(e,t,!0,(function(e){var t=!1;try{t=xt.isString(e)?xt.parse(e):e}catch(QG){}if(i._resetErr(),t){if(t instanceof Blob||vR(t))return void r(t);rA(t)&&(i._errorCode=t.exception,i._errorString=t.description)}r(n?t:t.result)}),(function(e){o({code:i._errorCode,message:i._getErrorString()})}))}))}},{key:"_sendDataByHttpAsync",value:function(e,t,n,i,o){var a,s=this;if(s._resetErr(),!s._isValid())return Dt.Promise.reject({code:s._errorCode,message:s._getErrorString()});if(r.isServerInvalid(s))return o?Dt.Promise.reject({code:s._errorCode,message:s._getErrorString()}):s._waitForConnect().then((function(){return s._sendDataByHttpAsync(e,t,n)}));if(Wt.DWT.ConnectWithSocket)return s._sendDataConnectWithSocket(e,t,n,i);a={method:"post",async:!0,body:ek(s._clientId,e,t,0,s._bScanForProxyRemote),dataType:null!=n?n:"text"};var u=null,c=xt.guid();return s._bIfShowProgressBar&&(u=Dt.progressContext),LE(u,c)([s._httpUrl,"fa/",e].join(""),a).then((function(e){var t=!1;try{t=xt.isString(e)?xt.parse(e):e}catch(QG){}if(t){if(t instanceof Blob||vR(t))return t;if(!rA(t))return s._resetErr(),i?t:t.result;s._errorCode=t.exception,s._errorString=t.description}else Cw(s);throw{code:s._errorCode,message:s._getErrorString()}}),(function(e){if(s._errorCode=e.code,s._errorString=e.message,!Dt.page.bUnload)throw e}))}},{key:"_sendData",value:function(e,t,n,i,o){var a=this,s=null,u=null,c=!1,l=!0;if(!a._destroy){if("ActiveUI"==e?l=!1:c=r.isServerInvalid(a),c)return a._waitForConnect().then((function(){a._sendData(e,t,n,i,o)})).catch((function(e){xt.isFunction(o)&&o(e.code,e.message)}));var d;xt.isFunction(i)&&(u=i),xt.isFunction(o)&&(s=o),d="ConvertToBlob"==e||"Heartbeat"==e?0:wR();var f=this._getWSContextData(),h={cmd:e,cmdId:d,sFun:u,fFun:s,contextData:f,rawData:null!=n&&n};return a._innerSendByWS(e,t,h,null,l)}}},{key:"_innerFunV2",value:(C=GE(m.mark((function e(t,r,n){var i,o,a;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this,!(a=n)&&!xt.isUndefined(a)){e.next=7;break}return e.next=4,i._sendDataConnectWithSocket(t,r,"json",!0);case 4:o=e.sent,e.next=10;break;case 7:return e.next=9,i._sendDataByHttpAsync(t,r,"json",!0);case 9:o=e.sent;case 10:if(!(o&&xt.isArray(o)&&o.length>0)){e.next=12;break}return e.abrupt("return",o[0]);case 12:if(!(o&&xt.isArray(o.result)&&o.result.length>0)){e.next=14;break}return e.abrupt("return",o.result[0]);case 14:return e.abrupt("return",o);case 15:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return C.apply(this,arguments)})},{key:"_OnReady",value:(b=GE(m.mark((function e(){var t,r;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((t=this)._wsRetry=0,t._wsFailedTimes=0,Dt.detect.starting=!1,t._bRemoteMode||(Dt.detect.bOK=!0),t._bReady=!0,null!==(r=t._wsClient.ws)){e.next=9;break}return e.abrupt("return");case 9:r.onopen=null,t._wsClient.addEvent("close",t._clientId,(function(e){e&&xt.log("websocket close: "+e),t.__bAcquireImageNow=!1,t._OnWSClose(e)})),t._wsClient.addEvent("error",t._clientId,(function(e){e&&xt.log("websocket error: "+e),t.__bAcquireImageNow=!1,t._OnWSError(e)})),t._wsClient.addEvent("timeout",t._clientId,(function(e){e&&xt.log("websocket timeout: "+e),t._OnWSTimeout(e)}));case 13:case"end":return e.stop()}}),e,this)}))),function(){return b.apply(this,arguments)})},{key:"getServiceInfo",value:function(){return this._dmService}},{key:"_OnWSClose",value:function(e){var t,n,i,o=this;o._bReady=!1,o._wsRetry=0,o._bRemoteMode&&(t=null!==(n=null===(i=o.getServiceInfo())||void 0===i||null===(i=i.attrs)||void 0===i?void 0:i.name)&&void 0!==n?n:""),dE(o,t),o.__closeRemoteScanUI(!0),o._heartBeatTimer&&(clearTimeout(o._heartBeatTimer),o._heartBeatTimer=null),o._bNoMask||(xt.log("hideMask:websocket close--"+AR),qP(),AR=0),o.__OnWSClose&&o.__OnWSClose();var a=o._bRemoteMode?sw.RemoteReconnectMaxTimes:sw.LocalReconnectMaxTimes;if(o._wsFailedTimes<a){var s=o._reconnectTimeSpan;o._wsFailedTimes<o._reconnectShortSpanTimes&&(s=o._reconnectShortSpan),o._heartBeatTimer=setTimeout((function(){r.startDWTReconnect(o)}),s)}}},{key:"_OnWSError",value:function(e){var t=this;t._bReady=!1,t.__OnWSError&&t.__OnWSError()}},{key:"_OnWSTimeout",value:function(e){var t,n,i,o=this;o._bReady=!1,o._wsRetry=0,o._bRemoteMode&&(t=null!==(n=null===(i=o.getServiceInfo())||void 0===i||null===(i=i.attrs)||void 0===i?void 0:i.name)&&void 0!==n?n:""),dE(o,t),o.__closeRemoteScanUI(!0),o._heartBeatTimer&&(clearTimeout(o._heartBeatTimer),o._heartBeatTimer=null);var a=o._bRemoteMode?sw.RemoteReconnectMaxTimes:sw.LocalReconnectMaxTimes;if(o._wsFailedTimes<a){var s=o._reconnectTimeSpan;o._wsFailedTimes<o._reconnectShortSpanTimes&&(s=o._reconnectShortSpan),o._heartBeatTimer=setTimeout((function(){r.startDWTReconnect(o)}),s)}}},{key:"__OnRecieveMsg",value:function(e,t){var r=this;if(e.event)return r._handleEvent(e,t.contextData);if(rA(e)?(r._errorCode=e.exception,r._errorString=e.description):(r._errorCode=0,r._errorString=""),Wt.DWT.ConnectWithSocket){var n=e,i=null==t?void 0:t.cmd;return"ActiveUI"==i||"VersionInfo"==i||"ConvertToBase64"==i||"SaveSelectedImagesToBase64Binary"==i||"ConvertToBlob"==i?t.sFun&&xt.isArray(e.result)&&e.result.length>0?(t.sFun(e.result),!0):(t.fFun&&t.fFun(e.result),!1):(0!=r._errorCode&&t.fFun&&t.fFun(r._errorString),"BeginSaveMem"==i||"CreateLocalStorage"==i||"LocalStorageExist"==i||"SaveToLocalStorage"==i||"LoadFromLocalStorage"==i||"RemoveLocalStorage"==i?t.sFun&&xt.isArray(e.result)&&e.result.length>0?(t.sFun(e.result),!0):(t.fFun&&t.fFun(e.result),!1):(n=t.rawData?e:xt.isArray(e.result)&&e.result.length>0?e.result[0]:e.result,t.sFun?t.sFun(n):t.fFun&&t.fFun(n),e=null,!0))}if(0==r._errorCode)return t.sFun&&xt.isArray(e.result)&&e.result.length>0?(t.sFun(e.result),!0):(t.fFun(e.result),!0);var o=!1;t.fFun&&(o=t.fFun(r._errorString)),!o&&e.exception&&e.exception<0&&-2115!=e.exception&&xt.isFunction(r.__OnPrintMsg)&&r.__OnPrintMsg(r._errorString)}},{key:"_handleOnBitmapChangedEvent",value:function(e,t){try{var r,n,i,o,a,s,u,c,l,d,f,h,g,p,_,m,v=e.result[0],y=e.result[1];if(xt.isString(y)){var S=JSON.parse(y);r=xt.isArray(S)?S:[S]}else xt.isArray(y)&&(r=y);if(xt.isArray(r))for(m=t||{},p=0;p<r.length;p++)if(_=r[p],xt.isArray(_.images))if(n=_.consumeType,i=_.curImageId,o=_.type,a=_.images.length,o!=sk.enumBCAppend&&o!=sk.enumBCInsert||(!m.document&&_.document&&(m.document=_.document),!m.tag&&_.tag&&(m.tag=_.tag)),o==sk.enumBCRemove){var T=[];for(s=0;s<a;s++)T.push(_.images[s].id);var I=[v,T.join(","),o,i,a,null,null,null,null,null,null,c];this._OnBitmapChanged(I,e,m)}else for(s=0;s<a;s++){u=_.images[s].id,d=_.images[s].width,f=_.images[s].height,l=_.images[s].depth,h=_.images[s].xdpi,g=_.images[s].ydpi,c=_.images[s].uid;var b=[v,u.toString(),o,i,a,d,f,l,h,g,n,c];this._OnBitmapChanged(b,e,m)}}catch(C){GC(C)}return Bb}},{key:"_handleEvent",value:function(e,t){var r=this,n=e.result[0],i=Lb;return"OnBitmapChanged"==e.event?r._handleOnBitmapChangedEvent(e,t):(xt.each(dk,(function(t,n){if(e.event===t){var o=["_",t].join("");return i=Bb,xt.isFunction(r[o])&&r[o](e.result,e),Lb}})),i?(xt.log("handled event:"+e.event),xt.each(fk,(function(t,i){if(e.event===t)return xt.log("sendback event:"+e.event),r._innerSendByWS(e.event,mR(n),null,null,Bb),Lb}))):(xt.each(Dt.Addon_Events,(function(t,n){if(e.event===t){var o=["_",t].join("");return i=Bb,xt.isFunction(r[o])&&r[o](e.result),Lb}})),i&&(xt.log("handled addon event:"+e.event),xt.each(Dt.Addon_Sendback_Events,(function(t,i){if(e.event===t)return xt.log("sendback addon event:"+e.event),r._innerSendByWS(e.event,mR(n),null,null,Bb),Lb})))),i)}},{key:"_setProductKeyAsync",value:function(e){var t=this,r=e;return t._resetErr(),t._isValid()?xt.isString(r)?sP.isLicenseMixed(r,!1)?Dt.Promise.reject(Wt.DWT.licenseException):sP.isLongKey(r)?Jx(t,Yx,qx).call(t,r).then((function(e){var r=e;if(!r||r.message)throw Ow(t),r&&r.message&&(t._errorString=r.message),{code:t._errorCode,message:t._getErrorString()};return QR(t,r),r})):(Ow(t),Dt.Promise.reject({code:t._errorCode,message:t._getErrorString()})):(Ow(t),Dt.Promise.reject({code:t._errorCode,message:t._getErrorString()})):Dt.Promise.reject({code:t._errorCode,message:t._getErrorString()})}},{key:"_setLTSLic",value:function(e){var t=this,r=e;return t._resetErr(),!!t._isValid()&&(xt.isString(r)?t._sendDataByHttpAsync("LTSLicense",mR(r),null,!0).then((function(e){if(e){if(rA(e))throw t._errorCode=e.exception,t._errorString=e.description,{code:t._errorCode,message:t._getErrorString()};return t._innerFunV2("GetLicenseInfo",mR(0))}throw Ow(t),{code:t._errorCode,message:t._getErrorString()}})):(Ow(t),Dt.Promise.reject({code:t._errorCode,message:t._getErrorString()})))}},{key:"_setLTSLicenseAsync",value:function(e){var t=this;return t._resetErr(),t._isValid()?xt.isString(e)?t._setLTSLic(e).then((function(e){var r=e;if(!r||r.message)throw Ow(t),r&&r.message&&(t._errorString=r.message),{code:t._errorCode,message:t._getErrorString()};return QR(t,r),t.__licenseInfo&&(t.__licenseInfo.LTS=!0),r})):(Ow(t),Dt.Promise.reject({code:t._errorCode,message:t._getErrorString()})):Dt.Promise.reject({code:t._errorCode,message:t._getErrorString()})}},{key:"_innerActiveUI",value:(I=GE(m.mark((function e(t){var r,n,i,o,a;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this,n=Dt.detect.ssl,i=YC(),r._bRemoteMode||(i=5),o="",r._blts&&(o=null!=t?t:""),e.next=6,new Dt.Promise((function(e,t){r._sendData("ActiveUI",mR(lR.WSVersion,lR.WSSession,1,o,n,1,i),!1,e,t)}));case 6:return a=e.sent,r=null,e.abrupt("return",a);case 9:case"end":return e.stop()}}),e,this)}))),function(e){return I.apply(this,arguments)})},{key:"_reconnected",value:(T=GE(m.mark((function e(t){var n,i,o,a,s,u,c,l;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=this)._wsFailedTimes=0,e.next=4,n._innerActiveUI(n._uuidForActiveUI);case 4:if(i=e.sent,o=!1,i&&(i.length>12?(n.__serverId=i[1],o=i[12]):i.length>8?(n.__serverId=i[1],o=i[8]):i.length>=2&&(n.__serverId=i[1])),n._bReady=!0,n._bRemoteMode||(Dt.detect.bOK=!0),Dt.detect.starting=!1,!o){e.next=20;break}return e.prev=11,e.next=14,n._removeAllImagesAsync("ActiveUI",!1);case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(11),n._resetErr();case 19:fw(n,-2614,"The Dynamsoft Service has been restarted.");case 20:if(e.prev=20,!n._blts){e.next=30;break}return a=n._bRemoteMode&&null!==(s=null===(u=n._dmService)||void 0===u||null===(u=u.attrs)||void 0===u?void 0:u.UUID)&&void 0!==s?s:"",e.next=25,KR(Wt.DWT.EnumInstance.dwt_desktop,a);case 25:return c=e.sent,e.next=28,n._setLTSLicenseAsync(c.ar);case 28:e.next=33;break;case 30:return l=aw.refProductKey,e.next=33,n._setProductKeyAsync(l);case 33:return e.next=35,n._OnReconnected();case 35:e.next=41;break;case 37:throw e.prev=37,e.t1=e.catch(20),n._bRemoteMode&&Nw(n),{code:n._errorCode,message:n._errorString};case 41:return e.prev=41,n._bRemoteMode&&r.startHeartBeat(n),e.finish(41);case 44:case"end":return e.stop()}}),e,this,[[11,16],[20,37,41,44]])}))),function(e){return T.apply(this,arguments)})},{key:"_OnReconnected",value:(S=GE(m.mark((function e(){return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(){return S.apply(this,arguments)})},{key:"_initRemoteDiv",value:function(){if(!this._acquireDivEL){var e=document.createElement("div");e.style.position="fixed",e.style.zIndex="510000",e.style.left="0",e.style.top="0";var t=document.createElement("img");t.className="ds-img-screen",e.appendChild(t),document.body.appendChild(e),this._acquireDivEL=e}}},{key:"getHeartBeatData",value:function(e){var t,r=ek(this._clientId,e.cmd,null,e.cmdId,this._bScanForProxyRemote),n=r.length,i=n,o=new ArrayBuffer(12+i),a=new DataView(o);for(t=0;t<8&&i;t++)a.setUint8(t,i%256),i=Math.floor(i/256);for(t=0;t<4&&n;t++)a.setUint8(8+t,n%256),n=Math.floor(n/256);for(t=0;t<r.length;t++)a.setUint8(12+t,r.charCodeAt(t));return o}},{key:"__closeRemoteScanUI",value:function(e){var t=this;if(t._acquireDivEL){var r=xt.sizzle(".ds-img-screen");t._acquireDivEL.evtFun?(r&&r.length>0&&xt.removeEventListener(r[0],"mouseup",t._acquireDivEL.evtFun),t._acquireDivEL.evtFun=null):r&&r.length>0&&xt.removeEventListener(r[0],"mouseup"),r&&r.length>0&&(r[0].src=""),e&&(document.body.removeChild(t._acquireDivEL),t._acquireDivEL=null)}}},{key:"_removeImageByIdAsync",value:(y=GE(m.mark((function e(t){var r;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((r=this)._resetErr(),r._isValid()){e.next=4;break}throw{code:r._errorCode,message:r._errorString};case 4:return e.next=6,r._innerFunV2("RemoveAllImages",mR(t));case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e,this)}))),function(e){return y.apply(this,arguments)})},{key:"_removeAllImagesAsync",value:(v=GE(m.mark((function e(t,r){var n;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((n=this)._resetErr(),n._isValid()){e.next=4;break}throw{code:n._errorCode,message:n._getErrorString()};case 4:return e.next=6,n._innerFunV2("RemoveAllImages");case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e,this)}))),function(e,t){return v.apply(this,arguments)})},{key:"_LicensePromptExpired",value:function(){}},{key:"_OnActiveUI",value:(_=GE(m.mark((function e(t){var n,i,o,a,s,u,c,l,d,f,h,g,p,_,v,y,S;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this,o=!1,t&&t.length>=6?(t[2],i=t[5],a=!1,s=!1,u=0,t.length>12?(t[6],n._b64bit="64"==t[7],t[8],a=t[9],s=t[10],u=t[11],t[12]):t.length>8&&(a=t[6],s=t[7],u=t[8]),a?s&&u&&(n._bRemoteMode=!0):n._bRemoteMode=!0,xt.isString(i)&&("win"==i?n.__serverPlatform=gC.enumWindow:"linux"==i?n.__serverPlatform=gC.enumLinux:"mac"==i?n.__serverPlatform=gC.enumMac:"embed"==i?n.__serverPlatform=gC.enumEmbed:"chromeos"==i&&(n.__serverPlatform=gC.enumChromeOS))):o=!0,n._bMustUpgradeService=o,o){e.next=67;break}if(SD("Activating the WebTwain instance..."),c=!1,!n._blts){e.next=44;break}return d=n._bRemoteMode&&null!==(f=null===(h=n._dmService)||void 0===h||null===(h=h.attrs)||void 0===h?void 0:h.UUID)&&void 0!==f?f:"",e.prev=10,e.next=13,KR(Wt.DWT.EnumInstance.dwt_desktop,d);case 13:l=e.sent,e.next=27;break;case 16:if(e.prev=16,e.t0=e.catch(10),ok(n,e.t0),g=$R(n._errorCode),!n._bLicenseErrorDispose){e.next=25;break}throw n._bRemoteMode||(g?this._LicensePromptExpired():tx(n)),{code:n._errorCode,message:n._errorString};case 25:g||xt.warn(n._errorString),l=null;case 27:if(SD(OD),!l){e.next=41;break}return e.next=31,n._setLTSLicenseAsync(l.ar);case 31:return p=e.sent,Wt.DWT.laddDWTObj(n),d="",n._bRemoteMode&&(d=null!==(_=null===(v=n._dmService)||void 0===v||null===(v=v.attrs)||void 0===v?void 0:v.UUID)&&void 0!==_?_:""),SD(WD),e.next=38,Wt.DWT.lcheckLic(Wt.DWT.EnumInstance.dwt_desktop,p,d);case 38:c=0==Wt.DWT.licenseException.code,e.next=42;break;case 41:c=!1;case 42:e.next=62;break;case 44:return SD(OD),y=aw.refProductKey,e.prev=46,e.next=49,n._setProductKeyAsync(y);case 49:e.sent&&(c=!0),e.next=62;break;case 53:if(e.prev=53,e.t1=e.catch(46),!n._bLicenseErrorDispose){e.next=60;break}throw n._bRemoteMode||ZR(e.t1.code)&&ex(e.t1),e.t1;case 60:xt.warn(e.t1.message);case 61:c=!1;case 62:if(c&&(SD(WD),sP.checkProductKey(n,{Core:!0})||(S={code:n._errorCode,message:n._getErrorString()},n._resetErr(),Wt.DWT.lclex(),Y.bWin&&sP.checkProductKey(n,{Webcam:!0},!0)||(n._errorCode=S.code,n._errorString=S.message))),0==n._errorCode){e.next=67;break}if(n._bRemoteMode||($R(n._errorCode)?this._LicensePromptExpired():tx(n)),!n._bLicenseErrorDispose){e.next=67;break}throw{code:n._errorCode,message:n._getErrorString()};case 67:n._bRemoteMode&&r.startHeartBeat(n);case 68:case"end":return e.stop()}}),e,this,[[10,16],[46,53]])}))),function(e){return _.apply(this,arguments)})},{key:"_innerConvertToArrayBufferAsync",value:(p=GE(m.mark((function e(t,r,n,i){var o,a,s,u,c;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=this,a=n,s=null!=i?i:"arraybuffer",u=",",xt.isString(a)&&""!=a||(a="",u=""),c=["[",t,',"',r.join(","),'"',u,a,"]"].join(""),e.next=6,o._sendDataByHttpAsync("ConvertToBlob",c,s,!0);case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e,this)}))),function(e,t,r,n){return p.apply(this,arguments)})},{key:"_getImageByServerId",value:(g=GE(m.mark((function e(t){var r,n,i;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=dx.IT_PNG,e.next=3,this._innerConvertToArrayBufferAsync(r,[t],void 0,void 0);case 3:return n=e.sent,i=Ax(r),e.abrupt("return",new Blob([n],{type:i}));case 6:case"end":return e.stop()}}),e,this)}))),function(e){return g.apply(this,arguments)})},{key:"_getSourcesAsync",value:(h=GE(m.mark((function e(t,r,n){var i,o;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=this,e.next=3,i._innerFunV2("GetSources",mR(t,null!=r&&r,null!=n&&n));case 3:return o=e.sent,e.abrupt("return",px(this,o));case 5:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return h.apply(this,arguments)})},{key:"_getDevices",value:(f=GE(m.mark((function e(t,r,n){var i,o,a,s,u,c;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=[],a="getDevices",s=(i=this)._bRemoteMode?SR:Y.bAndroid?IR:SR,u=null!=t?t:s,i._resetErr(),i._isValid()){e.next=5;break}return e.abrupt("return",Dt.Promise.reject({code:i._errorCode,message:i._getErrorString()}));case 5:return i._bNoMask||DR(a,i),e.prev=6,e.next=9,i._getSourcesAsync(u,r,n);case 9:c=e.sent,xt.isArray(c)&&c.length>0&&(o=o.concat(c)),e.next=16;break;case 13:throw e.prev=13,e.t0=e.catch(6),e.t0;case 16:return e.prev=16,i._bNoMask||PR(a),e.finish(16);case 19:return e.abrupt("return",o);case 20:case"end":return e.stop()}}),e,this,[[6,13,16,19]])}))),function(e,t,r){return f.apply(this,arguments)})},{key:"_innerAcquireImageFromService",value:function(e,t,r){var n,i,o=this;if(i=xt.clone(e),!sP.checkProductKey(o,{Core:!0}))return xt.isFunction(r)&&r(o._errorCode,o._getErrorString()),!1;var a=o._bRemoteMode?Bb:Lb,s=Lb;i.RemoteScan=a?1:0,o._bRemoteMode&&(xt.isFunction(o.__OnRemoteScanStatusAsync)||(o.__OnRemoteScanStatusAsync=function(){}),xt.isFunction(o.__OnSourceUIClose)||(o.__OnSourceUIClose=function(){}));for(var u=0,c=0;c<uk.length;c++){var l=["__",uk[c]].join("");xt.isFunction(o[l])&&(u|=1<<c)}return i.EnableEvents=u,a&&(o._isBindViewer()||s)&&o._initRemoteDiv(),o._bRemoteMode||(o._bPageFocus&&Wt.DWT.IfAlwaysFocusOnPopupWindow?o._bServerAlwaysFocusOnPopupWindow||o._OnPageFocus(!0):o._bServerAlwaysFocusOnPopupWindow&&o._OnPageBlur(!0)),n=["[",xt.stringify(i),"]"].join(""),o._sendData("AcquireImage",n,!0,(function(e){t(e)}),(function(e){r(o._errorCode,o._getErrorString())})),!0}},{key:"_canConsume",value:function(){return this._blts&&!this._bltsCopyImage}},{key:"_acquireImageFromServiceAsync",value:function(e){var t=this;return new Dt.Promise((function(r,n){return t._innerAcquireImageFromService(e,(function(){t._canConsume()&&Wt.DWT.lcvrf(t),r(!0)}),(function(e,t){n({code:e,message:t})}))}))}},{key:"_acquireImage",value:(d=GE(m.mark((function e(t,r){var n,i,o,a,s;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this,i=r?xt.clone(r):{},o="acuqireImage",n._resetErr(),n._isValid()){e.next=4;break}throw{code:n._errorCode,message:n._getErrorString()};case 4:if(sP.checkProductKey(n,{Core:!0})&&n._isValid()){e.next=6;break}throw{code:n._errorCode,message:n._getErrorString()};case 6:if(!n.__bAcquireImageNow){e.next=9;break}throw yw(n),{code:n._errorCode,message:n._getErrorString()};case 9:return n.__bAcquireImageNow=!0,n._bNoMask||DR(o,n),a=Wt.DWT.RemoteScanConfig,s=Sx(),e.prev=12,ak(i),a&&Tx(a.keepAwake),null!=t&&(i.Device=t.strDevice,i.DeviceMatchField=lx.SMF_NAME),e.next=18,n._acquireImageFromServiceAsync(i);case 18:e.next=23;break;case 20:throw e.prev=20,e.t0=e.catch(12),e.t0;case 23:return e.prev=23,n.__bAcquireImageNow=!1,n._bNoMask||PR(o),Tx(s),e.finish(23);case 28:return e.abrupt("return",!0);case 29:case"end":return e.stop()}}),e,this,[[12,20,23,28]])}))),function(e,t){return d.apply(this,arguments)})},{key:"_getCapabilities",value:(l=GE(m.mark((function e(t,r,n){var i,o,a,s,u;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=null,Jx(i=this,Qx,Zx).call(i,t),i._initRemoteDiv(),e.next=5,i._innerSelectDeviceAsync(t);case 5:return xt.isArray(n)&&(o=mR(n)),e.next=8,i._sendDataByHttpAsync("GetCapabilities",o);case 8:if(a=e.sent,e.prev=9,a.length>0&&(u=a[0]),!xt.isString(u)){e.next=22;break}if(u=Dt.removeNonPrintableChar(u),u=xt.replaceAll(u,"\\\\","\\\\"),0!=(s=JSON.parse(u)).errorCode){e.next=17;break}return e.abrupt("return",s.response);case 17:throw i._errorCode=s.errorCode,i._errorString=s.errorString,{code:i._errorCode,message:i._getErrorString()};case 22:throw SE(i),{code:i._errorCode,message:i._getErrorString()};case 24:e.next=31;break;case 26:throw e.prev=26,e.t0=e.catch(9),i._errorCode=-2302,i._errorString=e.t0,{code:i._errorCode,message:i._getErrorString()};case 31:case"end":return e.stop()}}),e,this,[[9,26]])}))),function(e,t,r){return l.apply(this,arguments)})},{key:"_setCapabilities",value:(c=GE(m.mark((function e(t,r,n){var i,o;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Jx(i=this,Qx,Zx).call(i,t),xt.isObject(r)&&!xt.isArray(r)){e.next=5;break}throw Zw(i),{code:i._errorCode,message:i._getErrorString()};case 5:return i._initRemoteDiv(),e.next=8,i._innerSelectDeviceAsync(t);case 8:return o=["[",xt.stringify(r),"]"].join(""),e.next=11,i._sendDataByHttpAsync("SetCapabilities",o);case 11:return e.abrupt("return",e.sent);case 12:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return c.apply(this,arguments)})},{key:"_closeSource",value:(u=GE(m.mark((function e(){var t;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this,e.next=3,t._innerFunV2("CloseSource");case 3:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"_innerSelectDeviceAsync",value:(a=GE(m.mark((function e(t,r){var n,i,o,a,s,u,c,l;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this,t&&t instanceof gx){e.next=4;break}throw Zw(i),{code:i._errorCode,message:i._errorString};case 4:if(!(o=null===(n=this._dmService.attrs)||void 0===n?void 0:n.UUID)){e.next=15;break}if((null===(a=t.serviceInfo.attrs)||void 0===a?void 0:a.UUID)!=o){e.next=9;break}e.next=15;break;case 9:if(!((u=(null===(s=t.serviceInfo.attrs)||void 0===s?void 0:s.url)||t.serviceInfo.server)&&u.indexOf(o)>-1)){e.next=13;break}e.next=15;break;case 13:throw cE(i),{code:i._errorCode,message:i._errorString};case 15:return c=null!=r?r:lx.SMF_NAME,l=["[",t.strDevice,",",c,"]"].join(""),e.next=18,i._innerFunV2("SelectSourceEx",l);case 18:return e.abrupt("return",e.sent);case 19:case"end":return e.stop()}}),e,this)}))),function(e,t){return a.apply(this,arguments)})},{key:"registerEvent",value:function(e,t){return!!this._registerEvent(e,t)}},{key:"unregisterEvent",value:function(e,t){return this._unregisterEvent(e,t)}},{key:"_registerEvent",value:function(e,t){var r=this;return r._resetErr(),!!r._isValid()&&(r[["__",e].join("")]=t,!0)}},{key:"_unregisterEvent",value:function(e,t){var r=this;return r._resetErr(),!!r._isValid()&&(r[["__",e].join("")]=null,Bb)}},{key:"_OnPageFocus",value:function(e){var t=this;if(t._bPageFocus=!0,t._bReady&&Y.bWin&&Wt.DWT.IfAlwaysFocusOnPopupWindow){var r=xt.stringify({sequence:0,wnds:0,wnd:"0",type:3,x:0,y:0});if(t.__bAcquireImageNow||e||t.__bOpenFileNow){t._bServerAlwaysFocusOnPopupWindow=!0;try{t._isValid()&&t._sendDataByHttpAsync("SendEventToScannerUI",["[",r,"]"].join(""))}catch(n){}}}}},{key:"_OnPageBlur",value:function(e){var t=this;if(Y.bWin&&t._bReady){var r=xt.stringify({sequence:0,wnds:0,wnd:"0",type:4,x:0,y:0});if((0!=t._bPageFocus||e)&&(t._bPageFocus=!1,t.__bAcquireImageNow||e||t.__bOpenFileNow)){t._bServerAlwaysFocusOnPopupWindow=!1;try{t._isValid()&&t._sendDataByHttpAsync("SendEventToScannerUI",["[",r,"]"].join(""))}catch(n){}}}}},{key:"_OnRemoteScanStatusAsync",value:function(e){var t,r,n,i,o,a,s,u=this;if(e&&e.length>=2){try{var c=new String(e[1]);t=xt.parse(c)}catch(d){xt.error(d.message),xt.log("parse json failed: "+e[1])}t||(t={sequence:0,screen:[]})}if(t&&t.sequence)if(t.sequence>0&&t.screen&&t.screen.length>0){if(r=t.screen,i=t.sequence,a=t.wnds,s=(n=r[0]).img,xt.isString(s)&&""!=s&&(o=n.wnd),i&&o){var l=xt.sizzle(".ds-img-screen");l&&l.length>0&&u._acquireDivEL&&(u._acquireDivEL.evtFun&&(xt.removeEventListener(l[0],"mouseup",u._acquireDivEL.evtFun),u._acquireDivEL.evtFun=null),l[0].src=s,u._acquireDivEL.evtFun=function(e){a||(a="0");var t=xt.stringify({sequence:i,wnds:a,wnd:o+"",type:2,x:e.offsetX,y:e.offsetY});u._sendDataByHttpAsync("SendEventToScannerUI",["[",t,"]"].join(""))},xt.addEventListener(l[0],"mouseup",u._acquireDivEL.evtFun))}}else u.__closeRemoteScanUI(!1);return xt.isFunction(u.__OnRemoteScanStatusAsync)&&u.__OnRemoteScanStatusAsync(t),!0}},{key:"_OnBitmapChanged",value:function(e,t,r){var n=this,i="m1"==e[0],o="c1"==e[0],a="c2"==e[0],s=o||a||i,u=e[2],c=e[3],l=-1;if(!s){if(e.length>10&&(l=e[10]),l>-1&&n._canConsume()&&(u==sk.enumBCAppend||u==sk.enumBCInsert)){var d=Wt.DWT.lgct(l);xt.isFunction(n.__OnLtsverify)&&n.__OnLtsverify(d,1)}if((u==sk.enumBCAppend||u==sk.enumBCInsert)&&xt.isFunction(n.__OnBufferChanged)){var f={action:"add",currentId:c,imageIds:[],selectedIds:[]};n.__OnBufferChanged(f)}}}},{key:"_OnPostTransferAsync",value:function(e,t,r){var n,i=this;if(e&&e.length>=2)try{var o=String(e[1]).replace(/\\/g,"\\\\");n=xt.parse(o)}catch(a){xt.error(a)}n||(n={imageId:""});var s=!1;if(xt.isFunction(i.__OnPostTransferAsync))try{s=i.__OnPostTransferAsync(n)}catch(u){GC(u)}if(xt.isFunction(i.__OnPostTransferAsync2))try{i.__OnPostTransferAsync2(n)}catch(u){GC(u)}return s}},{key:"_getErrorCode",value:function(){return this._errorCode}},{key:"_getErrorString",value:function(){return 0!=this._errorCode?this._errorString:"Successful."}},{key:"_isBindViewer",value:function(){return!1}},{key:"_isNoViewer",value:function(){return!0}},{key:"_isMobileMode",value:function(){return!1}},{key:"_needCheckProxyRemoteScanLicense",value:function(){if(!this._blts&&this._bScanForProxyRemote){if(""==this._strRemoteServiceVer)return!0;var e=function(e){var t=e.split(","),r=[18,3];return xt.trim(t[0])>r[0]||t.length>1&&xt.trim(t[0])==r[0]&&xt.trim(t[1])>=r[1]}(this._strRemoteServiceVer);if(e)return!0}return!1}}],[{key:"isServerInvalid",value:function(e){var t,r,n,i,o;(t=!e._bReady||null===e._wsClient,r=e._bMustUpgradeService,t)?(e._bRemoteMode&&(n=null!==(i=null===(o=e._dmService)||void 0===o||null===(o=o.attrs)||void 0===o?void 0:o.name)&&void 0!==i?i:""),dE(e,n)):r?Sw(e):e.isDestroy&&tE(e);return t||r||-2208==e._errorCode||e.isDestroy}},{key:"STwainConnectToServer",value:(o=GE(m.mark((function e(t){var r,n;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t._id,!Wt.DWT.WebTwainIdMap[r]){e.next=5;break}return e.next=4,t._OnReady();case 4:return e.abrupt("return");case 5:if(!t._bReady&&!t._destroy){e.next=7;break}return e.abrupt("return");case 7:return t._bConnecting=!0,(n=QA.Instance.getClient(t._serverInfo)).setRetry(0),t._bNoMask||DR("",t),e.prev=11,e.next=14,uP(t._bRemoteMode);case 14:return e.next=17,n.testConnection(void 0,0,void 0,1e4);case 17:if(t._wsClient=n,t._wsClient.bReady=!0,Dt.detect.bFirst&&(gk(),Dt.detect.bFirst=!1),t._bReady){e.next=24;break}return t._bReady=!0,e.next=24,t._OnReady();case 24:e.next=30;break;case 26:throw e.prev=26,e.t0=e.catch(11),t._bReady=!1,{code:t._errorCode,message:t._getErrorString()};case 30:return e.prev=30,t._bConnecting=!1,t._bNoMask||PR(""),e.finish(30);case 34:case"end":return e.stop()}}),e,null,[[11,26,30,34]])}))),function(e){return o.apply(this,arguments)})},{key:"_innerSendHeartBeat",value:(i=GE(m.mark((function e(t,n){var i,o,a,s;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!t.__bAcquireImageNow){e.next=4;break}e.next=14;break;case 4:if(i={client:null,userData:null,taskId:"0",eventTaskId:"0",lastEventTaskId:"0"},o=wR(),a={cmd:"Heartbeat",cmdId:o,sFun:null,fFun:null,contextData:null,rawData:!0},s=t.getHeartBeatData(a),!t._wsClient){e.next=12;break}return t._wsClient.setRetry(0),e.next=12,t._wsClient.request(s,null,i);case 12:a=null,s=null;case 14:e.next=18;break;case 16:e.prev=16,e.t0=e.catch(0);case 18:t._wsClient&&t._wsClient.connected&&n&&setTimeout((function(){r._innerSendHeartBeat(t,n)}),t._wsClient._heartBeatTicks);case 19:case"end":return e.stop()}}),e,null,[[0,16]])}))),function(e,t){return i.apply(this,arguments)})},{key:"startDWTReconnect",value:(n=GE(m.mark((function e(t){var n,i,o,a,s;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!t._destroy){e.next=3;break}return e.abrupt("return");case 3:if(n=t._serverInfo,!(ow.bEnhancedMode&&n&&n.port)){e.next=24;break}return aw.bDCPChecked=!1,e.prev=6,e.next=9,Wx(JC(),Wt.DWT.Port,Wt.DWT.SSLPort);case 9:if(!(i=e.sent)){e.next=14;break}t._serverInfo.port=Y.bSSL?i.sslPort:i.port,e.next=16;break;case 14:throw SE(t),tA(t);case 16:e.next=24;break;case 18:return e.prev=18,e.t0=e.catch(6),t._wsFailedTimes++,o=t._bRemoteMode?sw.RemoteReconnectMaxTimes:sw.LocalReconnectMaxTimes,t._wsFailedTimes<o&&(a=t._reconnectTimeSpan,t._wsFailedTimes<t._reconnectShortSpanTimes&&(a=t._reconnectShortSpan),t._heartBeatTimer=setTimeout((function(){r.startDWTReconnect(t)}),a)),e.abrupt("return");case 24:return t._bConnecting=!0,(s=QA.Instance.getClient(t._serverInfo)).setRetry(0),e.next=30,s.testConnection(void 0,0,void 0,3e4);case 30:return t._wsClient=s,t._wsClient.bReady=!0,t._wsRetry=0,e.next=35,t._reconnected(s);case 35:e.next=40;break;case 37:e.prev=37,e.t1=e.catch(0),t._wsFailedTimes++;case 40:return e.prev=40,t._bConnecting=!1,e.finish(40);case 43:case"end":return e.stop()}}),e,null,[[0,37,40,43],[6,18]])}))),function(e){return n.apply(this,arguments)})},{key:"startHeartBeat",value:function(e){var t=e._wsClient;t&&t.connected&&!t._bHeartBeatStarted&&(t._bHeartBeatStarted=!0,setTimeout((function(){r._innerSendHeartBeat(e,!0)}),t._heartBeatTicks))}},{key:"getServerImageUrlPrefix",value:function(e){var t,r=e._httpUrl;return t=e._bScanForProxyRemote?sw.getVersionStrForCheck():aw.getServerVersionInfo(),[r,"dwt/",aw.getDWTPrefix(),t,"/img?id=",e._clientId].join("")}}]);var n,i,o,a,u,c,l,d,f,h,g,p,_,v,y,S,T,I,b,C,w}(hx);function qx(e){var t,r=this,n=e;return r._resetErr(),r._isValid()?(n=xt.isString(n)?xt.trim(n):"",t=r._sendDataConnectWithSocket("ProductKey",mR(n),"json",!0),r.__productKey=n,t=t.then((function(e){if(xt.isArray(e)&&e.length>0){if(0!=r._errorCode)throw r.__productKey="",{code:r._errorCode,message:r._getErrorString()};return Wt.DWT.ProductKey=r.__productKey,sP.reparseProductKey(),r._innerFunV2("GetLicenseInfo",mR(0))}throw Ow(r),t.context=null,{code:r._errorCode,message:r._getErrorString()}}))):Dt.Promise.reject({code:r._errorCode,message:r._getErrorString()})}function Zx(e){return $x.apply(this,arguments)}function $x(){return($x=GE(m.mark((function e(t){var r;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((r=this)._resetErr(),r._isValid()){e.next=4;break}return e.abrupt("return",Dt.Promise.reject({code:r._errorCode,message:r._errorString}));case 4:if(t&&t instanceof gx){e.next=7;break}throw Zw(r),{code:r._errorCode,message:r._errorString};case 7:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}function ek(e,t,r,n,i){var o,a=[];return a.push("{"),a.push('"id":"'),a.push(e),a.push('"'),n&&(a.push(',"cmdId":"'),a.push(n),a.push('"')),a.push(',"method":"'),a.push(t),a.push('"'),a.push(',"module":"dwt","version":"'),o=i?[aw.getDWTPrefix(),sw.getVersionStrForCheck()].join(""):[aw.getDWTPrefix(),aw.getServerVersionInfo()].join(""),a.push(o),a.push('"'),void 0!==r&&null!==r&&(a.push(',"parameter":'),xt.isArray(r)?a.push(xt.stringify(r)):a.push(r)),a.push("}"),a.join("")}function tk(e,t){return["evt",e,t].join("_")}function rk(e){if(e._bReady)e._wsCheckResolve();else{if(Wt.DWT.bConnectCanceled)return xt.asyncQueue.stop(),fE(e),void e._wsCheckReject({code:e._errorCode,message:e._getErrorString()});if(e._wsRetry>10)return uE(e),void e._wsCheckReject({code:e._errorCode,message:e._getErrorString()});e._wsRetry++,setTimeout((function(){rk(e)}),1100)}}function nk(e,t,r,n){return ik.apply(this,arguments)}function ik(){return ik=GE(m.mark((function t(r,n,i,o){var a,s,u,c,l,d,f;return m.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n!=$E.GET_TASKID){t.next=4;break}return t.abrupt("return",o.taskId);case 4:if(n!=$E.GET_EVENT_TASKID){t.next=8;break}return t.abrupt("return",o.eventTaskId);case 8:if(n!=$E.ONMESSAGE_PROCESS_DATA){t.next=17;break}if("object"!==e(r)){t.next=11;break}return t.abrupt("return",r);case 11:if(!((c=r).indexOf("Version not found")>=0||c.indexOf("Function not found")>=0)){t.next=14;break}return t.abrupt("return",{cmdId:null!=i?i:0});case 14:return t.abrupt("return",xt.parse(r));case 17:if(n!=$E.ONMESSAGE_GET_TASKID){t.next=25;break}if(!r){t.next=22;break}if(!r.event){t.next=21;break}return t.abrupt("return",0);case 21:return t.abrupt("return",r.cmdId);case 22:return t.abrupt("return",r);case 25:if(n!=$E.ONMESSAGE_GET_EVENT_TASKID){t.next=31;break}if(!r||!r.event){t.next=28;break}return t.abrupt("return",tk(r.id,r.cmdId));case 28:return t.abrupt("return",0);case 31:if(n!=$E.HANDLE_RAW_MESSAGE){t.next=59;break}if(a=null==o?void 0:o.userData){t.next=35;break}return t.abrupt("return",!1);case 35:if(s=a.stwain,u=a.command){t.next=39;break}return t.abrupt("return",!1);case 39:if(s&&xt.isFunction(s.__OnWSMessage)&&s.__OnWSMessage(r),"object"!==e(r)){t.next=44;break}if(!Wt.DWT.ConnectWithSocket){t.next=44;break}return"ConvertToBlob"!=u.cmd&&"GetImageByIndex"!=u.cmd||u.sFun(r),t.abrupt("return",!0);case 44:if(!((l=r.replace(/\0/g,"")).indexOf('"method" : "Heartbeat"')>=0)){t.next=47;break}return t.abrupt("return",!0);case 47:if(!(l.indexOf('"method" : "EnableBuffer"')>=0||l.indexOf('"method" : "GetBuffer"')>=0)){t.next=50;break}return Wt.DWT.lwsproc(l,u),t.abrupt("return",!0);case 50:if(!(l.indexOf("Exception:")>=0||0==l.indexOf("Error"))){t.next=57;break}return d=r,f=!1,xt.log(d+"@"+u.cmd),u.fFun&&(f=u.fFun(d)),!f&&s&&xt.isFunction(s.__OnPrintMsg)&&s.__OnPrintMsg(d),t.abrupt("return",!0);case 57:t.next=70;break;case 59:if(n!=$E.HANDLE_PROCESSED_MESSAGE){t.next=70;break}if(a=null==o?void 0:o.userData){t.next=63;break}return t.abrupt("return",!1);case 63:if(s=a.stwain){t.next=66;break}return t.abrupt("return",!1);case 66:if(u=a.command){t.next=69;break}return t.abrupt("return",!1);case 69:return t.abrupt("return",s.__OnRecieveMsg(r,u));case 70:case"end":return t.stop()}}),t)}))),ik.apply(this,arguments)}function ok(e,t){if(t){var r=t.code||t.ltsErrorCode,n=t.message;111==r||106==r||108==r?(Nw(e,r),e._errorString=n):(e._errorCode=r,e._errorString=n),Wt.DWT.lsetException(e._errorCode,e._errorString,!0)}}function ak(e){void 0!==e.Resolution&&(e.Resolution=parseInt(e.Resolution)),void 0!==e.PixelType&&(e.PixelType=parseInt(e.PixelType)),void 0!==e.SelectSourceByIndex&&(e.SelectSourceByIndex=parseInt(e.SelectSourceByIndex))}var sk,uk=["OnPreAllTransfers","OnPreTransfer","OnPostTransfer","OnPostTransferAsync"];!function(e){e.enumBCAppend=1,e.enumBCInsert=2,e.enumBCRemove=3,e.enumBCEdit=4,e.enumBCIndexChange=5,e.enumBCUpdate=6}(sk||(sk={}));var ck,lk,dk=["OnPostAllTransfers","OnPostTransfer","OnPostLoad","OnPreTransfer","OnPreAllTransfers","OnResult","OnTransferCancelled","OnTransferError","OnSourceUIClose","OnGetFilePath","OnPercentDone","OnPostTransferAsync","OnPreAllTransfersAsync","OnRemoteScanStatusAsync","OnConsumed","OnDiskExceedLimit"],fk=["OnPreAllTransfers","OnPreTransfer","OnPostTransfer","OnGetFilePath","OnPostLoad"],hk=xt.each;function gk(){var e,t=Dx.item("DWT_port"),r=Dx.item("DWT_ssl");if(ow.bEnhancedMode)return!0;Dt.detect.urls.splice(0),Dt.detect.cUrlIndex=0,t!==ck&&r!==ck&&(e={port:t,ssl:"true"==r});var n=function(t){return!e||!(!t||t.port==e.port&&t.ssl==e.ssl)};1===Dt.detect.detectType?(e!==ck&&e.ssl&&Dt.detect.urls.push(e),hk(Dt.detect.ports,(function(e){e.ssl&&n(e)&&Dt.detect.urls.push(e)}))):0===Dt.detect.detectType?(e===ck||e.ssl||Dt.detect.urls.push(e),hk(Dt.detect.ports,(function(e){!1===e.ssl&&n(e)&&Dt.detect.urls.push(e)}))):(e!==ck&&Dt.detect.urls.push(e),hk(Dt.detect.ports,(function(e){n(e)&&Dt.detect.urls.push(e)})))}!function(e){e.TWAIN=0,e.ICA=3,e.SANE=3,e.TWAIN_AND_ICA=4,e.TWAIN_AND_TWAIN64=4,e.TWAIN64=5}(lk||(lk={}));var pk={notSupportProperty:function(e){},notSupportMethod:function(e){},refreshImageAfterInvokeFun:function(e,t,r){return 1==r},loadHttpBlob:function(e,t,r,n,i,o,a,s){var u,c,l=Lb;if(c={method:t,dataType:"blob"},s&&(c.headers=s),""!=e.HTTPUserName&&(c.username=e.HTTPUserName,c.password=e.HTTPPassword),e.__HTTPPostResponseString="",n){if("get"==t){var d=xt.guid();return Dt.progressContext&&(Dt.progressContext._onPercent=a),void LE(Dt.progressContext,d)(r,c).then((function(t){var r=t.type;if("text/plain"==r||"text/html"==r||"text/json"==r){var n=new FileReader;n.readAsText(t),n.onload=function(){e.__HTTPPostResponseString=n.result,i(t)},n.onerror=function(){i(t)}}else i(t)}),(function(t){t&&t.code?(e._errorCode=t.code,e._errorString=t.message):t&&t.httpCode?Dw(e,!1,t.message,t.httpCode):Ew(e),xt.isFunction(o)&&o({code:e._errorCode,message:e._errorString})}))}c.onSuccess=function(t,r,n){if((n?n.getResponseHeader("content-type"):"").indexOf("text/")>=0){var o=new FileReader;o.readAsText(t),o.onload=function(){e.__HTTPPostResponseString=o.result,i(t)},o.onerror=function(){i(t)}}else i(t)},xt.isFunction(a)&&(c.beforeSend=function(e){e.addEventListener("progress",(function(e){!Y.bSafari&&e&&(delete e.totalSize,delete e.position),a(e)}),Lb)})}else Y.bIE?(c.dataType="arraybuffer",c.onSuccess=function(t,r,n){var o,a;(o=t||n.responseData)&&(a=new Uint8Array(o)),e.__HTTPPostResponseString=n.responseText,e._errorCode=0,e._errorString="",i(a),a=null,l=Bb}):(c.dataType="text",c.contentType="text/plain; charset=x-user-defined",c.mimeType="text/plain; charset=x-user-defined",c.onSuccess=function(t,r,n){var o,a,s;o=n.responseText,e.__HTTPPostResponseString=o,a=o.length,s=new Uint8Array(a);for(var u=0;u<a;u++)s[u]=o.charCodeAt(u);e._errorCode=0,e._errorString="",i(s),s=null,l=Bb}),c.headers?xt.mix(c.headers,{"X-Requested-With":Lb}):c.headers={"X-Requested-With":Lb};if("post"==t){var f,h=e.httpFormFields;if(h)try{f=new FormData,xt.each(h,(function(e,t){if(e instanceof Blob){var r=e.name;f.append(t,e,r)}else f.append(t,e)})),xt.mix(c,{data:f,processData:Lb,contentType:Lb})}catch(QG){}}u=function(t,r,n){var i,a;t&&xt.isArray(t)&&t.length>2?(i=t[1],a=t[2]):(i=r,a=n),2!=a.state&&3!=a.state||0!=a.status?Dw(e,Lb,i,a.status):"abort"===a.statusText?Dw(e,Bb):Ew(e),xt.isFunction(o)&&o()},c.url=r,c.async=n,c.onError=u,c.onComplete=function(){e._cancelableObj=null};var g=fC(c);if(!n)return l;Dt.progressContext&&(Dt.progressContext._onPercent=a,e.IfShowCancelDialogWhenImageTransfer&&Dt.progressContext.on("cancel",(function(){g.abort()})))},combineUrl:function(e,t,r){var n=[],i=t;return void 0===i||void 0===r?void 0:(xt.isString(i)||(i=String(t)),0==i.indexOf("http://")?(i=i.replace("http://",""),n.push("http://")):0==i.indexOf("https://")?(i=i.replace("https://",""),n.push("https://")):(0==i.indexOf("//")&&(i=i.replace("//","")),e.IfSSL?n.push("https://"):n.push("http://")),n.push(i),i.indexOf(":")<0&&(e.HTTPPort||(e.HTTPPort=Dt.detect.ssl?443:80),(!Dt.detect.ssl&&80!=e.HTTPPort||Dt.detect.ssl&&443!=e.HTTPPort)&&(n.push(":"),n.push(e.HTTPPort))),0!==r.indexOf("/")&&n.push("/"),n.push(r),n.join(""))},httpPutImage:function(e,t,r,n,i,o,a){var s=Bb,u={method:"PUT",url:t,hasContent:Bb,processData:Lb,async:n,data:r,onSuccess:i,onError:function(t,r,n){var i,a;s=Lb,t&&xt.isArray(t)&&t.length>2?(i=t[1],a=t[2]):(i=r,a=n),2!=a.state&&3!=a.state||0!=a.status?Aw(e,Lb,i,a.status):"abort"===a.statusText?Aw(e,Bb):function(e){fw(e,-2304,"Http put error: the url is invalid.")}(e),xt.isFunction(o)&&o()},onComplete:function(){e._cancelableObj=null},beforeSend:function(e){xt.isFunction(a)&&e.upload.addEventListener("progress",(function(e){!Y.bSafari&&e&&(delete e.totalSize,delete e.position),a(e)}),Lb)}};""!=e.HTTPUserName&&(u.username=e.HTTPUserName,u.password=e.HTTPPassword),n||xt.mix(u,{headers:{"X-Requested-With":Lb}});var c=fC(u);return Dt.progressContext&&(Dt.progressContext._onPercent=a,Dt.progressContext._onCancel=function(){c.abort()}),s},GetImageInfo:function(e,t){var r=e._ImgManager.convertClientIndexToServerId(t);return-1==r?(Gw(e),!1):e._innerFun("GetImageInfo",mR(r))},getBlobTypeByImageType:Ax,callbacks:[],pushCallback:function(e,t,r){var n={method:e,callback:t,ticks:r};pk.callbacks.push(n)},refreshUIRef:0,isServerInvalid:function(e){Xx.isServerInvalid(e)},replaceLocalFilename:function(e){var t;return void 0===e?"":(t=(e=String(e)).replace(/\\/g,"\\\\"),Y.bFileSystem&&(t=decodeURI(t)),t)},getImageType:function(e){if(void 0===e)return-1;if(e.length<4)return-1;var t=e.lastIndexOf(".");if(-1===t)return-1;var r=e.slice(t).toLowerCase();return".bmp"===r||".dib"===r?Wt.DWT.EnumDWT_ImageType.IT_BMP:".jpg"===r||".jpe"===r||".jpeg"===r||".jfif"===r?Wt.DWT.EnumDWT_ImageType.IT_JPG:".tif"===r||".tiff"===r?Wt.DWT.EnumDWT_ImageType.IT_TIF:".png"===r?Wt.DWT.EnumDWT_ImageType.IT_PNG:".pdf"===r?Wt.DWT.EnumDWT_ImageType.IT_PDF:".jp2"===r||".j2k"===r||".j2c"===r?Wt.DWT.EnumDWT_ImageType.IT_J2K:-1},makeParams:mR,showMask:DR,hideMask:PR};function _k(e,t,r,n,i){var o=0;return e==lk.TWAIN&&(o=bR),e==lk.TWAIN64?o=fR.TWAINX64SCANNER:e==lk.ICA?r?o=fR.SANESCANNER:n?o=fR.ICASCANNER:(t||i)&&(o=bR):e==lk.TWAIN_AND_TWAIN64&&(r?o=bR|fR.SANESCANNER:n?o=bR|fR.ICASCANNER:t?o=bR|fR.TWAINX64SCANNER:i&&(o=bR)),o}function mk(e,t){for(var r=e.HowManyImagesInBuffer,n=0;n<r;n++)t.push(e._ImgManager.convertClientIndexToServerId(n))}function vk(e,t){return 0!=e._ImgManager.count()||(mw(e),xt.isFunction(t)&&t(e._errorCode,e._getErrorString()),!1)}function yk(e,t,r){return!!vk(e,r)&&(!(isNaN(t)||!xt.isNumber(t)||t<0||t>=e._ImgManager.count())||(Gw(e),xt.isFunction(r)&&r(e._errorCode,e._getErrorString()),!1))}function Sk(e){var t,r,n,i=[];return e._ImgManager.count()<=0||((r=e._ImgManager.getCurrentImageIndex())>=0&&(t=e._ImgManager.convertClientIndexToServerId(r)),n=e._ImgManager.getSelectedClientIndexArray(),xt.isArray(n)&&xt.each(n,(function(t){var r=e._ImgManager.convertClientIndexToServerId(t);-1!=r&&i.push(r)})),-1!=t&&0==i.length&&i.push(t)),i}function Tk(e){var t,r=[];return e._ImgManager.count()<=0||(t=e._ImgManager.getCurrentImageIndex(),r=e._ImgManager.getSelectedClientIndexArray(),-1!=t&&0==r.length&&r.push(t)),r}function Ik(e,t,r){return e._resetErr(),!!e._isValid()&&(isNaN(t)?(pw(e),xt.isFunction(r)&&r(e._errorCode,e.ErrorString),Lb):t<0||t>=e._ImgManager.count()?(Gw(e),xt.isFunction(r)&&r(e._errorCode,e.ErrorString),Lb):Bb)}function bk(e){var t,r=[],n=e.HowManyImagesInBuffer;for(t=0;t<n;t++)r.push(t);return e._imageBufferWrapper.convertIndicesToServerIds(r)}function Ck(e,t){return e._imageBufferWrapper.convertIndicesToServerIds(t)}function wk(e,t,r,n,i){try{e(t,r,n,i)}catch(u){}t=r=n=i=null}function Ek(e,t,r){try{e(t._errorCode,t._getErrorString(),r)}catch(n){}t=r=null}function Ak(e,t,r,n,i,o){try{e(t._errorCode,t._getErrorString(),r,n,i,o)}catch(c){}t=r=n=i=o=null}function Dk(){return Dk="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=QE(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}},Dk.apply(this,arguments)}function Pk(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Rk(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o,a,s=[],u=!0,c=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);u=!0);}catch(h){c=!0,i=h}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw i}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Pk(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Pk(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}Dt.html5.Funs=pk;var xk=s((function e(){t(this,e),Mb(this,"bIsDirty",!1),Mb(this,"imageWidth",0),Mb(this,"imageHeight",0),Mb(this,"iImageControlWidth",0),Mb(this,"iImageControlHeight",0),Mb(this,"imageUrl",""),Mb(this,"minImageUrl",""),Mb(this,"uuid",-1),Mb(this,"serverId",-1),Mb(this,"uidFromServer",""),Mb(this,"aryOverlayRectangleData",[]),Mb(this,"ticks",Date.now())}),[{key:"Clear",value:function(){this.imageUrl="",this.minImageUrl="",this.serverId=-1,this.uuid=-1,this.uidFromServer="",this.aryOverlayRectangleData=[]}}]),kk=uo,Fk=Jt,Ok=$S,Wk=Z_,Nk=Ni,Mk=Fr,Lk=ws,Bk=Vt,Uk=Br("Reflect","construct"),Vk=Object.prototype,Gk=[].push,jk=Bk((function(){function e(){}return!(Uk((function(){}),[],e)instanceof e)})),Hk=!Bk((function(){Uk((function(){}))})),zk=jk||Hk;kk({target:"Reflect",stat:!0,forced:zk,sham:zk},{construct:function(e,t){Wk(e),Nk(t);var r=arguments.length<3?e:Wk(arguments[2]);if(Hk&&!jk)return Uk(e,t,r);if(e===r){switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3])}var n=[null];return Fk(Gk,n,t),new(Fk(Ok,e,n))}var i=r.prototype,o=Lk(Mk(i)?i:Vk),a=Fk(e,o,t);return Mk(a)?a:o}});var Kk=c(Or.Reflect.construct),Jk=c(Or.Object.getOwnPropertySymbols),Yk={exports:{}},Qk=uo,Xk=Vt,qk=xr,Zk=ur.f,$k=cr;Qk({target:"Object",stat:!0,forced:!$k||Xk((function(){Zk(1)})),sham:!$k},{getOwnPropertyDescriptor:function(e,t){return Zk(qk(e),t)}});var eF=Or.Object,tF=Yk.exports=function(e,t){return eF.getOwnPropertyDescriptor(e,t)};eF.getOwnPropertyDescriptor.sham&&(tF.sham=!0);var rF=Yk.exports,nF=c(rF),iF=bp,oF=xr,aF=ur,sF=Oo;uo({target:"Object",stat:!0,sham:!cr},{getOwnPropertyDescriptors:function(e){for(var t,r,n=oF(e),i=aF.f,o=iF(n),a={},s=0;o.length>s;)void 0!==(r=i(n,t=o[s++]))&&sF(a,t,r);return a}});var uF=c(Or.Object.getOwnPropertyDescriptors),cF={exports:{}},lF=uo,dF=cr,fF=Oa.f;lF({target:"Object",stat:!0,forced:Object.defineProperties!==fF,sham:!dF},{defineProperties:fF});var hF=Or.Object,gF=cF.exports=function(e,t){return hF.defineProperties(e,t)};hF.defineProperties.sham&&(gF.sham=!0);var pF=c(cF.exports),_F=SS,mF=Jt,vF=Rs,yF=Av,SF=dn,TF=uv;uo({target:"Promise",stat:!0,forced:!0},{try:function(e){var t=vF(arguments,1),r=yF.f(this),n=TF((function(){return mF(SF(e),void 0,t)}));return(n.error?r.reject:r.resolve)(n.value),r.promise}});var IF=_F,bF=c(IF);function CF(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(Qb){return void r(Qb)}s.done?t(u):bF.resolve(u).then(n,i)}function wF(e){return function(){var t=this,r=arguments;return new bF((function(n,i){var o=e.apply(t,r);function a(e){CF(o,n,i,a,s,"next",e)}function s(e){CF(o,n,i,a,s,"throw",e)}a(void 0)}))}}function EF(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var AF=Fn,DF=fr,PF=Fr,RF=Ni,xF=ur,kF=od;uo({target:"Reflect",stat:!0},{get:function e(t,r){var n,i,o=arguments.length<3?t:arguments[2];return RF(t)===o?t[r]:(n=xF.f(t,r))?function(e){return void 0!==e&&(AF(e,"value")||AF(e,"writable"))}(n)?n.value:void 0===n.get?void 0:DF(n.get,o):PF(i=kF(t))?e(i,r,o):void 0}});var FF=c(Or.Reflect.get),OF=c(oT),WF=c(rF);uo({target:"Object",stat:!0},{setPrototypeOf:xd});var NF=Or.Object.setPrototypeOf,MF=c(NF),LF=Rn,BF=od,UF=ql;uo({target:"Object",stat:!0,forced:Vt((function(){BF(1)})),sham:!UF},{getPrototypeOf:function(e){return BF(LF(e))}});var VF=Or.Object.getPrototypeOf,GF=c(VF);function jF(e){var t;return jF=MF?OF(t=GF).call(t):function(e){return e.__proto__||GF(e)},jF(e)}function HF(){var e;return HF="undefined"!=typeof Reflect&&FF?OF(e=FF).call(e):function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=jF(e)););return e}(e,t);if(n){var i=WF(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}},HF.apply(this,arguments)}uo({target:"Object",stat:!0,sham:!cr},{create:ws});var zF=Or.Object,KF=function(e,t){return zF.create(e,t)},JF=c(KF);function YF(e,t){var r;return YF=MF?OF(r=MF).call(r):function(e,t){return e.__proto__=t,e},YF(e,t)}function QF(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=JF(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),mo(e,"prototype",{writable:!1}),t&&YF(e,t)}var XF=c(wg),qF=c(Qp),ZF=lg,$F=c(ZF),eO=Ni,tO=a_,rO=Ri,nO=fr,iO=Rn,oO=function(e,t,r,n){try{return n?t(eO(r)[0],r[1]):t(r)}catch(Qb){tO(e,"throw",Qb)}},aO=jp,sO=aa,uO=Do,cO=Oo,lO=r_,dO=Qp,fO=Array,hO=function(e){var t=iO(e),r=sO(this),n=arguments.length,i=n>1?arguments[1]:void 0,o=void 0!==i;o&&(i=rO(i,n>2?arguments[2]:void 0));var a,s,u,c,l,d,f=dO(t),h=0;if(!f||this===fO&&aO(f))for(a=uO(t),s=r?new this(a):fO(a);a>h;h++)d=o?i(t[h],h):t[h],cO(s,h,d);else for(s=r?new this:[],l=(c=lO(t,f)).next;!(u=nO(l,c)).done;h++)d=o?oO(c,i,[u.value,h],!0):u.value,cO(s,h,d);return s.length=h,s},gO=hO;uo({target:"Array",stat:!0,forced:!Ay((function(e){Array.from(e)}))},{from:gO});var pO=Or.Array.from,_O=c(pO);function mO(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function vO(e,t){var r;if(e){if("string"==typeof e)return mO(e,t);var n=$F(r=Object.prototype.toString.call(e)).call(r,8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?_O(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?mO(e,t):void 0}}function yO(e,t){return function(e){if(XF(e))return e}(e)||function(e,t){var r=null==e?null:void 0!==Of&&qF(e)||e["@@iterator"];if(null!=r){var n,i,o,a,s=[],u=!0,c=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);u=!0);}catch(h){c=!0,i=h}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw i}}return s}}(e,t)||vO(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function SO(e){return function(e){if(XF(e))return mO(e)}(e)||function(e){if(void 0!==Of&&null!=qF(e)||null!=e["@@iterator"])return _O(e)}(e)||vO(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function TO(e,t,r){return(t=rh(t))in e?mo(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var IO={exports:{}},bO={exports:{}};!function(e){var t=Ff,r=Zf;function n(i){return e.exports=n="function"==typeof t&&"symbol"==typeof r?function(e){return typeof e}:function(e){return e&&"function"==typeof t&&e.constructor===t&&e!==t.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,n(i)}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports}(bO);var CO=bO.exports,wO=Ou.forEach,EO=Ah("forEach")?[].forEach:function(e){return wO(this,e,arguments.length>1?arguments[1]:void 0)};uo({target:"Array",proto:!0,forced:[].forEach!==EO},{forEach:EO});var AO=Sh("Array","forEach"),DO=jo,PO=Fn,RO=Ur,xO=AO,kO=Array.prototype,FO={DOMTokenList:!0,NodeList:!0},OO=function(e){var t=e.forEach;return e===kO||RO(kO,e)&&t===kO.forEach||PO(FO,DO(e))?xO:t},WO=OO,NO=uo,MO=yo,LO=Zt([].reverse),BO=[1,2];NO({target:"Array",proto:!0,forced:String(BO)===String(BO.reverse())},{reverse:function(){return MO(this)&&(this.length=this.length),LO(this)}});var UO=Sh("Array","reverse"),VO=Ur,GO=UO,jO=Array.prototype,HO=function(e){var t=e.reverse;return e===jO||VO(jO,e)&&t===jO.reverse?GO:t};!function(e){var t=CO.default,r=_o,n=Ff,i=KF,o=VF,a=WO,s=NF,u=IF,c=HO,l=ZF;function d(){e.exports=d=function(){return f},e.exports.__esModule=!0,e.exports.default=e.exports;var f={},h=Object.prototype,g=h.hasOwnProperty,p=r||function(e,t,r){e[t]=r.value},_="function"==typeof n?n:{},m=_.iterator||"@@iterator",v=_.asyncIterator||"@@asyncIterator",y=_.toStringTag||"@@toStringTag";function S(e,t,n){return r(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{S({},"")}catch(G){S=function(e,t,r){return e[t]=r}}function T(e,t,r,n){var o=t&&t.prototype instanceof C?t:C,a=i(o.prototype),s=new N(n||[]);return p(a,"_invoke",{value:k(e,r,s)}),a}function I(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(G){return{type:"throw",arg:G}}}f.wrap=T;var b={};function C(){}function w(){}function E(){}var A={};S(A,m,(function(){return this}));var D=o&&o(o(M([])));D&&D!==h&&g.call(D,m)&&(A=D);var P=E.prototype=C.prototype=i(A);function R(e){var t;a(t=["next","throw","return"]).call(t,(function(t){S(e,t,(function(e){return this._invoke(t,e)}))}))}function x(e,r){function n(i,o,a,s){var u=I(e[i],e,o);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==t(l)&&g.call(l,"__await")?r.resolve(l.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):r.resolve(l).then((function(e){c.value=e,a(c)}),(function(e){return n("throw",e,a,s)}))}s(u.arg)}var i;p(this,"_invoke",{value:function(e,t){function o(){return new r((function(r,i){n(e,t,r,i)}))}return i=i?i.then(o,o):o()}})}function k(e,t,r){var n="suspendedStart";return function(i,o){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw o;return L()}for(r.method=i,r.arg=o;;){var a=r.delegate;if(a){var s=F(a,r);if(s){if(s===b)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var u=I(e,t,r);if("normal"===u.type){if(n=r.done?"completed":"suspendedYield",u.arg===b)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n="completed",r.method="throw",r.arg=u.arg)}}}function F(e,t){var r=t.method,n=e.iterator[r];if(void 0===n)return t.delegate=null,"throw"===r&&e.iterator.return&&(t.method="return",t.arg=void 0,F(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),b;var i=I(n,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,b;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,b):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,b)}function O(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function W(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function N(e){this.tryEntries=[{tryLoc:"root"}],a(e).call(e,O,this),this.reset(!0)}function M(e){if(e){var t=e[m];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,n=function t(){for(;++r<e.length;)if(g.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return n.next=n}}return{next:L}}function L(){return{value:void 0,done:!0}}return w.prototype=E,p(P,"constructor",{value:E,configurable:!0}),p(E,"constructor",{value:w,configurable:!0}),w.displayName=S(E,y,"GeneratorFunction"),f.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},f.mark=function(e){return s?s(e,E):(e.__proto__=E,S(e,y,"GeneratorFunction")),e.prototype=i(P),e},f.awrap=function(e){return{__await:e}},R(x.prototype),S(x.prototype,v,(function(){return this})),f.AsyncIterator=x,f.async=function(e,t,r,n,i){void 0===i&&(i=u);var o=new x(T(e,t,r,n),i);return f.isGeneratorFunction(t)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},R(P),S(P,y,"Generator"),S(P,m,(function(){return this})),S(P,"toString",(function(){return"[object Generator]"})),f.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return c(r).call(r),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},f.values=M,N.prototype={constructor:N,reset:function(e){var t;if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,a(t=this.tryEntries).call(t,W),!e)for(var r in this)"t"===r.charAt(0)&&g.call(this,r)&&!isNaN(+l(r).call(r,1))&&(this[r]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(r,n){return o.type="throw",o.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n],o=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var a=g.call(i,"catchLoc"),s=g.call(i,"finallyLoc");if(a&&s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(a){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&g.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,b):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),b},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),W(r),b}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;W(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:M(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),b}},f}e.exports=d,e.exports.__esModule=!0,e.exports.default=e.exports}(IO);var zO=(0,IO.exports)(),KO=zO;try{regeneratorRuntime=zO}catch($J){"object"==typeof o?o.regeneratorRuntime=zO:Function("r","regeneratorRuntime = r")(zO)}var JO=c(KO),YO=c(OO),QO=Rn,XO=es;uo({target:"Object",stat:!0,forced:Vt((function(){XO(1)}))},{keys:function(e){return XO(QO(e))}});var qO=c(Or.Object.keys);uo({target:"Number",stat:!0},{isNaN:function(e){return e!=e}});var ZO=c(Or.Number.isNaN),$O=Sh("Array","concat"),eW=Ur,tW=$O,rW=Array.prototype,nW=c((function(e){var t=e.concat;return e===rW||eW(rW,e)&&t===rW.concat?tW:t})),iW=Vt,oW=Jn("iterator"),aW=!iW((function(){var e=new URL("b?a=1&b=2&c=3","http://a"),t=e.searchParams,r=new URLSearchParams("a=1&a=2&b=3"),n="";return e.pathname="c%20d",t.forEach((function(e,r){t.delete("b"),n+=r+e})),r.delete("a",2),r.delete("b",void 0),!e.toJSON||!r.has("a",1)||r.has("a",2)||!r.has("a",void 0)||r.has("b")||!t.size&&true||!t.sort||"http://a/c%20d?a=1&c=3"!==e.href||"3"!==t.get("c")||"a=1"!==String(new URLSearchParams("?a=1"))||!t[oW]||"a"!==new URL("https://a@b").username||"b"!==new URLSearchParams(new URLSearchParams("a=b")).get("a")||"xn--e1aybc"!==new URL("http://\u0442\u0435\u0441\u0442").host||"#%D0%B1"!==new URL("http://a#\u0431").hash||"a1c3"!==n||"x"!==new URL("http://x",void 0).host})),sW=Ls,uW=function(e,t,r){for(var n in t)r&&r.unsafe&&e[n]?e[n]=t[n]:sW(e,n,t[n],r);return e},cW=Rs,lW=Math.floor,dW=function(e,t){var r=e.length;if(r<8)for(var n,i,o=1;o<r;){for(i=o,n=e[o];i&&t(e[i-1],n)>0;)e[i]=e[--i];i!==o++&&(e[i]=n)}else for(var a=lW(r/2),s=dW(cW(e,0,a),t),u=dW(cW(e,a),t),c=s.length,l=u.length,d=0,f=0;d<c||f<l;)e[d+f]=d<c&&f<l?t(s[d],u[f])<=0?s[d++]:u[f++]:d<c?s[d++]:u[f++];return e},fW=uo,hW=Ut,gW=Wm,pW=fr,_W=Zt,mW=cr,vW=aW,yW=Ls,SW=Us,TW=uW,IW=lu,bW=Id,CW=Eu,wW=Y_,EW=sr,AW=Fn,DW=Ri,PW=jo,RW=Ni,xW=Fr,kW=Fa,FW=ws,OW=yr,WW=r_,NW=Qp,MW=Jd,LW=Pg,BW=dW,UW=Jn("iterator"),VW="URLSearchParams",GW=VW+"Iterator",jW=CW.set,HW=CW.getterFor(VW),zW=CW.getterFor(GW),KW=gW("fetch"),JW=gW("Request"),YW=gW("Headers"),QW=JW&&JW.prototype,XW=YW&&YW.prototype,qW=hW.RegExp,ZW=hW.TypeError,$W=hW.decodeURIComponent,eN=hW.encodeURIComponent,tN=_W("".charAt),rN=_W([].join),nN=_W([].push),iN=_W("".replace),oN=_W([].shift),aN=_W([].splice),sN=_W("".split),uN=_W("".slice),cN=/\+/g,lN=Array(4),dN=function(e){return lN[e-1]||(lN[e-1]=qW("((?:%[\\da-f]{2}){"+e+"})","gi"))},fN=function(e){try{return $W(e)}catch(Qb){return e}},hN=function(e){var t=iN(e,cN," "),r=4;try{return $W(t)}catch(Qb){for(;r;)t=iN(t,dN(r--),fN);return t}},gN=/[!'()~]|%20/g,pN={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},_N=function(e){return pN[e]},mN=function(e){return iN(eN(e),gN,_N)},vN=bW((function(e,t){jW(this,{type:GW,target:HW(e).entries,index:0,kind:t})}),VW,(function(){var e=zW(this),t=e.target,r=e.index++;if(!t||r>=t.length)return e.target=void 0,MW(void 0,!0);var n=t[r];switch(e.kind){case"keys":return MW(n.key,!1);case"values":return MW(n.value,!1)}return MW([n.key,n.value],!1)}),!0),yN=function(e){this.entries=[],this.url=null,void 0!==e&&(xW(e)?this.parseObject(e):this.parseQuery("string"==typeof e?"?"===tN(e,0)?uN(e,1):e:kW(e)))};yN.prototype={type:VW,bindURL:function(e){this.url=e,this.update()},parseObject:function(e){var t,r,n,i,o,a,s,u=this.entries,c=NW(e);if(c)for(r=(t=WW(e,c)).next;!(n=pW(r,t)).done;){if(o=(i=WW(RW(n.value))).next,(a=pW(o,i)).done||(s=pW(o,i)).done||!pW(o,i).done)throw new ZW("Expected sequence with length 2");nN(u,{key:kW(a.value),value:kW(s.value)})}else for(var l in e)AW(e,l)&&nN(u,{key:l,value:kW(e[l])})},parseQuery:function(e){if(e)for(var t,r,n=this.entries,i=sN(e,"&"),o=0;o<i.length;)(t=i[o++]).length&&(r=sN(t,"="),nN(n,{key:hN(oN(r)),value:hN(rN(r,"="))}))},serialize:function(){for(var e,t=this.entries,r=[],n=0;n<t.length;)e=t[n++],nN(r,mN(e.key)+"="+mN(e.value));return rN(r,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var SN=function(){wW(this,TN);var e=jW(this,new yN(arguments.length>0?arguments[0]:void 0));mW||(this.size=e.entries.length)},TN=SN.prototype;if(TW(TN,{append:function(e,t){var r=HW(this);LW(arguments.length,2),nN(r.entries,{key:kW(e),value:kW(t)}),mW||this.length++,r.updateURL()},delete:function(e){for(var t=HW(this),r=LW(arguments.length,1),n=t.entries,i=kW(e),o=r<2?void 0:arguments[1],a=void 0===o?o:kW(o),s=0;s<n.length;){var u=n[s];if(u.key!==i||void 0!==a&&u.value!==a)s++;else if(aN(n,s,1),void 0!==a)break}mW||(this.size=n.length),t.updateURL()},get:function(e){var t=HW(this).entries;LW(arguments.length,1);for(var r=kW(e),n=0;n<t.length;n++)if(t[n].key===r)return t[n].value;return null},getAll:function(e){var t=HW(this).entries;LW(arguments.length,1);for(var r=kW(e),n=[],i=0;i<t.length;i++)t[i].key===r&&nN(n,t[i].value);return n},has:function(e){for(var t=HW(this).entries,r=LW(arguments.length,1),n=kW(e),i=r<2?void 0:arguments[1],o=void 0===i?i:kW(i),a=0;a<t.length;){var s=t[a++];if(s.key===n&&(void 0===o||s.value===o))return!0}return!1},set:function(e,t){var r=HW(this);LW(arguments.length,1);for(var n,i=r.entries,o=!1,a=kW(e),s=kW(t),u=0;u<i.length;u++)(n=i[u]).key===a&&(o?aN(i,u--,1):(o=!0,n.value=s));o||nN(i,{key:a,value:s}),mW||(this.size=i.length),r.updateURL()},sort:function(){var e=HW(this);BW(e.entries,(function(e,t){return e.key>t.key?1:-1})),e.updateURL()},forEach:function(e){for(var t,r=HW(this).entries,n=DW(e,arguments.length>1?arguments[1]:void 0),i=0;i<r.length;)n((t=r[i++]).value,t.key,this)},keys:function(){return new vN(this,"keys")},values:function(){return new vN(this,"values")},entries:function(){return new vN(this,"entries")}},{enumerable:!0}),yW(TN,UW,TN.entries,{name:"entries"}),yW(TN,"toString",(function(){return HW(this).serialize()}),{enumerable:!0}),mW&&SW(TN,"size",{get:function(){return HW(this).entries.length},configurable:!0,enumerable:!0}),IW(SN,VW),fW({global:!0,constructor:!0,forced:!vW},{URLSearchParams:SN}),!vW&&EW(YW)){var IN=_W(XW.has),bN=_W(XW.set),CN=function(e){if(xW(e)){var t,r=e.body;if(PW(r)===VW)return t=e.headers?new YW(e.headers):new YW,IN(t,"content-type")||bN(t,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),FW(e,{body:OW(0,kW(r)),headers:OW(0,t)})}return e};if(EW(KW)&&fW({global:!0,enumerable:!0,dontCallGetSet:!0,forced:!0},{fetch:function(e){return KW(e,arguments.length>1?CN(arguments[1]):{})}}),EW(JW)){var wN=function(e){return wW(this,QW),new JW(e,arguments.length>1?CN(arguments[1]):{})};QW.constructor=wN,wN.prototype=QW,fW({global:!0,constructor:!0,dontCallGetSet:!0,forced:!0},{Request:wN})}}var EN,AN={URLSearchParams:SN,getState:HW},DN=cr,PN=Zt,RN=fr,xN=Vt,kN=es,FN=Ns,ON=hr,WN=Rn,NN=Cr,MN=Object.assign,LN=Object.defineProperty,BN=PN([].concat),UN=!MN||xN((function(){if(DN&&1!==MN({b:1},MN(LN({},"a",{enumerable:!0,get:function(){LN(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var e={},t={},r=Symbol("assign detection"),n="abcdefghijklmnopqrst";return e[r]=7,n.split("").forEach((function(e){t[e]=e})),7!==MN({},e)[r]||kN(MN({},t)).join("")!==n}))?function(e,t){for(var r=WN(e),n=arguments.length,i=1,o=FN.f,a=ON.f;n>i;)for(var s,u=NN(arguments[i++]),c=o?BN(kN(u),o(u)):kN(u),l=c.length,d=0;l>d;)s=c[d++],DN&&!RN(a,u,s)||(r[s]=u[s]);return r}:MN,VN=Zt,GN=2147483647,jN=/[^\0-\u007E]/,HN=/[.\u3002\uFF0E\uFF61]/g,zN="Overflow: input needs wider integers to process",KN=RangeError,JN=VN(HN.exec),YN=Math.floor,QN=String.fromCharCode,XN=VN("".charCodeAt),qN=VN([].join),ZN=VN([].push),$N=VN("".replace),eM=VN("".split),tM=VN("".toLowerCase),rM=function(e){return e+22+75*(e<26)},nM=function(e,t,r){var n=0;for(e=r?YN(e/700):e>>1,e+=YN(e/t);e>455;)e=YN(e/35),n+=36;return YN(n+36*e/(e+38))},iM=function(e){var t=[];e=function(e){for(var t=[],r=0,n=e.length;r<n;){var i=XN(e,r++);if(i>=55296&&i<=56319&&r<n){var o=XN(e,r++);56320==(64512&o)?ZN(t,((1023&i)<<10)+(1023&o)+65536):(ZN(t,i),r--)}else ZN(t,i)}return t}(e);var r,n,i=e.length,o=128,a=0,s=72;for(r=0;r<e.length;r++)(n=e[r])<128&&ZN(t,QN(n));var u=t.length,c=u;for(u&&ZN(t,"-");c<i;){var l=GN;for(r=0;r<e.length;r++)(n=e[r])>=o&&n<l&&(l=n);var d=c+1;if(l-o>YN((GN-a)/d))throw new KN(zN);for(a+=(l-o)*d,o=l,r=0;r<e.length;r++){if((n=e[r])<o&&++a>GN)throw new KN(zN);if(n===o){for(var f=a,h=36;;){var g=h<=s?1:h>=s+26?26:h-s;if(f<g)break;var p=f-g,_=36-g;ZN(t,QN(rM(g+p%_))),f=YN(p/_),h+=36}ZN(t,QN(rM(f))),s=nM(a,d,c===u),a=0,c++}}a++,o++}return qN(t,"")},oM=uo,aM=cr,sM=aW,uM=Ut,cM=Ri,lM=Zt,dM=Ls,fM=Us,hM=Y_,gM=Fn,pM=UN,_M=hO,mM=Rs,vM=jf.codeAt,yM=Fa,SM=lu,TM=Pg,IM=AN,bM=Eu,CM=bM.set,wM=bM.getterFor("URL"),EM=IM.URLSearchParams,AM=IM.getState,DM=uM.URL,PM=uM.TypeError,RM=uM.parseInt,xM=Math.floor,kM=Math.pow,FM=lM("".charAt),OM=lM(/./.exec),WM=lM([].join),NM=lM(1..toString),MM=lM([].pop),LM=lM([].push),BM=lM("".replace),UM=lM([].shift),VM=lM("".split),GM=lM("".slice),jM=lM("".toLowerCase),HM=lM([].unshift),zM="Invalid scheme",KM="Invalid host",JM="Invalid port",YM=/[a-z]/i,QM=/[\d+-.a-z]/i,XM=/\d/,qM=/^0x/i,ZM=/^[0-7]+$/,$M=/^\d+$/,eL=/^[\da-f]+$/i,tL=/[\0\t\n\r #%/:<>?@[\\\]^|]/,rL=/[\0\t\n\r #/:<>?@[\\\]^|]/,nL=/^[\u0000-\u0020]+/,iL=/(^|[^\u0000-\u0020])[\u0000-\u0020]+$/,oL=/[\t\n\r]/g,aL=function(e){var t,r,n,i;if("number"==typeof e){for(t=[],r=0;r<4;r++)HM(t,e%256),e=xM(e/256);return WM(t,".")}if("object"==typeof e){for(t="",n=function(e){for(var t=null,r=1,n=null,i=0,o=0;o<8;o++)0!==e[o]?(i>r&&(t=n,r=i),n=null,i=0):(null===n&&(n=o),++i);return i>r&&(t=n,r=i),t}(e),r=0;r<8;r++)i&&0===e[r]||(i&&(i=!1),n===r?(t+=r?":":"::",i=!0):(t+=NM(e[r],16),r<7&&(t+=":")));return"["+t+"]"}return e},sL={},uL=pM({},sL,{" ":1,'"':1,"<":1,">":1,"`":1}),cL=pM({},uL,{"#":1,"?":1,"{":1,"}":1}),lL=pM({},cL,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),dL=function(e,t){var r=vM(e,0);return r>32&&r<127&&!gM(t,e)?e:encodeURIComponent(e)},fL={ftp:21,file:null,http:80,https:443,ws:80,wss:443},hL=function(e,t){var r;return 2===e.length&&OM(YM,FM(e,0))&&(":"===(r=FM(e,1))||!t&&"|"===r)},gL=function(e){var t;return e.length>1&&hL(GM(e,0,2))&&(2===e.length||"/"===(t=FM(e,2))||"\\"===t||"?"===t||"#"===t)},pL=function(e){return"."===e||"%2e"===jM(e)},_L={},mL={},vL={},yL={},SL={},TL={},IL={},bL={},CL={},wL={},EL={},AL={},DL={},PL={},RL={},xL={},kL={},FL={},OL={},WL={},NL={},ML=function(e,t,r){var n,i,o,a=yM(e);if(t){if(i=this.parse(a))throw new PM(i);this.searchParams=null}else{if(void 0!==r&&(n=new ML(r,!0)),i=this.parse(a,null,n))throw new PM(i);(o=AM(new EM)).bindURL(this),this.searchParams=o}};ML.prototype={type:"URL",parse:function(e,t,r){var n,i,o,a,s,u=this,c=t||_L,l=0,d="",f=!1,h=!1,g=!1;for(e=yM(e),t||(u.scheme="",u.username="",u.password="",u.host=null,u.port=null,u.path=[],u.query=null,u.fragment=null,u.cannotBeABaseURL=!1,e=BM(e,nL,""),e=BM(e,iL,"$1")),e=BM(e,oL,""),n=_M(e);l<=n.length;){switch(i=n[l],c){case _L:if(!i||!OM(YM,i)){if(t)return zM;c=vL;continue}d+=jM(i),c=mL;break;case mL:if(i&&(OM(QM,i)||"+"===i||"-"===i||"."===i))d+=jM(i);else{if(":"!==i){if(t)return zM;d="",c=vL,l=0;continue}if(t&&(u.isSpecial()!==gM(fL,d)||"file"===d&&(u.includesCredentials()||null!==u.port)||"file"===u.scheme&&!u.host))return;if(u.scheme=d,t)return void(u.isSpecial()&&fL[u.scheme]===u.port&&(u.port=null));d="","file"===u.scheme?c=PL:u.isSpecial()&&r&&r.scheme===u.scheme?c=yL:u.isSpecial()?c=bL:"/"===n[l+1]?(c=SL,l++):(u.cannotBeABaseURL=!0,LM(u.path,""),c=OL)}break;case vL:if(!r||r.cannotBeABaseURL&&"#"!==i)return zM;if(r.cannotBeABaseURL&&"#"===i){u.scheme=r.scheme,u.path=mM(r.path),u.query=r.query,u.fragment="",u.cannotBeABaseURL=!0,c=NL;break}c="file"===r.scheme?PL:TL;continue;case yL:if("/"!==i||"/"!==n[l+1]){c=TL;continue}c=CL,l++;break;case SL:if("/"===i){c=wL;break}c=FL;continue;case TL:if(u.scheme=r.scheme,i===EN)u.username=r.username,u.password=r.password,u.host=r.host,u.port=r.port,u.path=mM(r.path),u.query=r.query;else if("/"===i||"\\"===i&&u.isSpecial())c=IL;else if("?"===i)u.username=r.username,u.password=r.password,u.host=r.host,u.port=r.port,u.path=mM(r.path),u.query="",c=WL;else{if("#"!==i){u.username=r.username,u.password=r.password,u.host=r.host,u.port=r.port,u.path=mM(r.path),u.path.length--,c=FL;continue}u.username=r.username,u.password=r.password,u.host=r.host,u.port=r.port,u.path=mM(r.path),u.query=r.query,u.fragment="",c=NL}break;case IL:if(!u.isSpecial()||"/"!==i&&"\\"!==i){if("/"!==i){u.username=r.username,u.password=r.password,u.host=r.host,u.port=r.port,c=FL;continue}c=wL}else c=CL;break;case bL:if(c=CL,"/"!==i||"/"!==FM(d,l+1))continue;l++;break;case CL:if("/"!==i&&"\\"!==i){c=wL;continue}break;case wL:if("@"===i){f&&(d="%40"+d),f=!0,o=_M(d);for(var p=0;p<o.length;p++){var _=o[p];if(":"!==_||g){var m=dL(_,lL);g?u.password+=m:u.username+=m}else g=!0}d=""}else if(i===EN||"/"===i||"?"===i||"#"===i||"\\"===i&&u.isSpecial()){if(f&&""===d)return"Invalid authority";l-=_M(d).length+1,d="",c=EL}else d+=i;break;case EL:case AL:if(t&&"file"===u.scheme){c=xL;continue}if(":"!==i||h){if(i===EN||"/"===i||"?"===i||"#"===i||"\\"===i&&u.isSpecial()){if(u.isSpecial()&&""===d)return KM;if(t&&""===d&&(u.includesCredentials()||null!==u.port))return;if(a=u.parseHost(d))return a;if(d="",c=kL,t)return;continue}"["===i?h=!0:"]"===i&&(h=!1),d+=i}else{if(""===d)return KM;if(a=u.parseHost(d))return a;if(d="",c=DL,t===AL)return}break;case DL:if(!OM(XM,i)){if(i===EN||"/"===i||"?"===i||"#"===i||"\\"===i&&u.isSpecial()||t){if(""!==d){var v=RM(d,10);if(v>65535)return JM;u.port=u.isSpecial()&&v===fL[u.scheme]?null:v,d=""}if(t)return;c=kL;continue}return JM}d+=i;break;case PL:if(u.scheme="file","/"===i||"\\"===i)c=RL;else{if(!r||"file"!==r.scheme){c=FL;continue}switch(i){case EN:u.host=r.host,u.path=mM(r.path),u.query=r.query;break;case"?":u.host=r.host,u.path=mM(r.path),u.query="",c=WL;break;case"#":u.host=r.host,u.path=mM(r.path),u.query=r.query,u.fragment="",c=NL;break;default:gL(WM(mM(n,l),""))||(u.host=r.host,u.path=mM(r.path),u.shortenPath()),c=FL;continue}}break;case RL:if("/"===i||"\\"===i){c=xL;break}r&&"file"===r.scheme&&!gL(WM(mM(n,l),""))&&(hL(r.path[0],!0)?LM(u.path,r.path[0]):u.host=r.host),c=FL;continue;case xL:if(i===EN||"/"===i||"\\"===i||"?"===i||"#"===i){if(!t&&hL(d))c=FL;else if(""===d){if(u.host="",t)return;c=kL}else{if(a=u.parseHost(d))return a;if("localhost"===u.host&&(u.host=""),t)return;d="",c=kL}continue}d+=i;break;case kL:if(u.isSpecial()){if(c=FL,"/"!==i&&"\\"!==i)continue}else if(t||"?"!==i)if(t||"#"!==i){if(i!==EN&&(c=FL,"/"!==i))continue}else u.fragment="",c=NL;else u.query="",c=WL;break;case FL:if(i===EN||"/"===i||"\\"===i&&u.isSpecial()||!t&&("?"===i||"#"===i)){if(".."===(s=jM(s=d))||"%2e."===s||".%2e"===s||"%2e%2e"===s?(u.shortenPath(),"/"===i||"\\"===i&&u.isSpecial()||LM(u.path,"")):pL(d)?"/"===i||"\\"===i&&u.isSpecial()||LM(u.path,""):("file"===u.scheme&&!u.path.length&&hL(d)&&(u.host&&(u.host=""),d=FM(d,0)+":"),LM(u.path,d)),d="","file"===u.scheme&&(i===EN||"?"===i||"#"===i))for(;u.path.length>1&&""===u.path[0];)UM(u.path);"?"===i?(u.query="",c=WL):"#"===i&&(u.fragment="",c=NL)}else d+=dL(i,cL);break;case OL:"?"===i?(u.query="",c=WL):"#"===i?(u.fragment="",c=NL):i!==EN&&(u.path[0]+=dL(i,sL));break;case WL:t||"#"!==i?i!==EN&&("'"===i&&u.isSpecial()?u.query+="%27":u.query+="#"===i?"%23":dL(i,sL)):(u.fragment="",c=NL);break;case NL:i!==EN&&(u.fragment+=dL(i,uL))}l++}},parseHost:function(e){var t,r,n;if("["===FM(e,0)){if("]"!==FM(e,e.length-1))return KM;if(t=function(e){var t,r,n,i,o,a,s,u=[0,0,0,0,0,0,0,0],c=0,l=null,d=0,f=function(){return FM(e,d)};if(":"===f()){if(":"!==FM(e,1))return;d+=2,l=++c}for(;f();){if(8===c)return;if(":"!==f()){for(t=r=0;r<4&&OM(eL,f());)t=16*t+RM(f(),16),d++,r++;if("."===f()){if(0===r)return;if(d-=r,c>6)return;for(n=0;f();){if(i=null,n>0){if(!("."===f()&&n<4))return;d++}if(!OM(XM,f()))return;for(;OM(XM,f());){if(o=RM(f(),10),null===i)i=o;else{if(0===i)return;i=10*i+o}if(i>255)return;d++}u[c]=256*u[c]+i,2!=++n&&4!==n||c++}if(4!==n)return;break}if(":"===f()){if(d++,!f())return}else if(f())return;u[c++]=t}else{if(null!==l)return;d++,l=++c}}if(null!==l)for(a=c-l,c=7;0!==c&&a>0;)s=u[c],u[c--]=u[l+a-1],u[l+--a]=s;else if(8!==c)return;return u}(GM(e,1,-1)),!t)return KM;this.host=t}else if(this.isSpecial()){if(e=function(e){var t,r,n=[],i=eM($N(tM(e),HN,"."),".");for(t=0;t<i.length;t++)r=i[t],ZN(n,JN(jN,r)?"xn--"+iM(r):r);return qN(n,".")}(e),OM(tL,e))return KM;if(t=function(e){var t,r,n,i,o,a,s,u=VM(e,".");if(u.length&&""===u[u.length-1]&&u.length--,(t=u.length)>4)return e;for(r=[],n=0;n<t;n++){if(""===(i=u[n]))return e;if(o=10,i.length>1&&"0"===FM(i,0)&&(o=OM(qM,i)?16:8,i=GM(i,8===o?1:2)),""===i)a=0;else{if(!OM(10===o?$M:8===o?ZM:eL,i))return e;a=RM(i,o)}LM(r,a)}for(n=0;n<t;n++)if(a=r[n],n===t-1){if(a>=kM(256,5-t))return null}else if(a>255)return null;for(s=MM(r),n=0;n<r.length;n++)s+=r[n]*kM(256,3-n);return s}(e),null===t)return KM;this.host=t}else{if(OM(rL,e))return KM;for(t="",r=_M(e),n=0;n<r.length;n++)t+=dL(r[n],sL);this.host=t}},cannotHaveUsernamePasswordPort:function(){return!this.host||this.cannotBeABaseURL||"file"===this.scheme},includesCredentials:function(){return""!==this.username||""!==this.password},isSpecial:function(){return gM(fL,this.scheme)},shortenPath:function(){var e=this.path,t=e.length;!t||"file"===this.scheme&&1===t&&hL(e[0],!0)||e.length--},serialize:function(){var e=this,t=e.scheme,r=e.username,n=e.password,i=e.host,o=e.port,a=e.path,s=e.query,u=e.fragment,c=t+":";return null!==i?(c+="//",e.includesCredentials()&&(c+=r+(n?":"+n:"")+"@"),c+=aL(i),null!==o&&(c+=":"+o)):"file"===t&&(c+="//"),c+=e.cannotBeABaseURL?a[0]:a.length?"/"+WM(a,"/"):"",null!==s&&(c+="?"+s),null!==u&&(c+="#"+u),c},setHref:function(e){var t=this.parse(e);if(t)throw new PM(t);this.searchParams.update()},getOrigin:function(){var e=this.scheme,t=this.port;if("blob"===e)try{return new LL(e.path[0]).origin}catch(Qb){return"null"}return"file"!==e&&this.isSpecial()?e+"://"+aL(this.host)+(null!==t?":"+t:""):"null"},getProtocol:function(){return this.scheme+":"},setProtocol:function(e){this.parse(yM(e)+":",_L)},getUsername:function(){return this.username},setUsername:function(e){var t=_M(yM(e));if(!this.cannotHaveUsernamePasswordPort()){this.username="";for(var r=0;r<t.length;r++)this.username+=dL(t[r],lL)}},getPassword:function(){return this.password},setPassword:function(e){var t=_M(yM(e));if(!this.cannotHaveUsernamePasswordPort()){this.password="";for(var r=0;r<t.length;r++)this.password+=dL(t[r],lL)}},getHost:function(){var e=this.host,t=this.port;return null===e?"":null===t?aL(e):aL(e)+":"+t},setHost:function(e){this.cannotBeABaseURL||this.parse(e,EL)},getHostname:function(){var e=this.host;return null===e?"":aL(e)},setHostname:function(e){this.cannotBeABaseURL||this.parse(e,AL)},getPort:function(){var e=this.port;return null===e?"":yM(e)},setPort:function(e){this.cannotHaveUsernamePasswordPort()||(""===(e=yM(e))?this.port=null:this.parse(e,DL))},getPathname:function(){var e=this.path;return this.cannotBeABaseURL?e[0]:e.length?"/"+WM(e,"/"):""},setPathname:function(e){this.cannotBeABaseURL||(this.path=[],this.parse(e,kL))},getSearch:function(){var e=this.query;return e?"?"+e:""},setSearch:function(e){""===(e=yM(e))?this.query=null:("?"===FM(e,0)&&(e=GM(e,1)),this.query="",this.parse(e,WL)),this.searchParams.update()},getSearchParams:function(){return this.searchParams.facade},getHash:function(){var e=this.fragment;return e?"#"+e:""},setHash:function(e){""!==(e=yM(e))?("#"===FM(e,0)&&(e=GM(e,1)),this.fragment="",this.parse(e,NL)):this.fragment=null},update:function(){this.query=this.searchParams.serialize()||null}};var LL=function(e){var t=hM(this,BL),r=TM(arguments.length,1)>1?arguments[1]:void 0,n=CM(t,new ML(e,!1,r));aM||(t.href=n.serialize(),t.origin=n.getOrigin(),t.protocol=n.getProtocol(),t.username=n.getUsername(),t.password=n.getPassword(),t.host=n.getHost(),t.hostname=n.getHostname(),t.port=n.getPort(),t.pathname=n.getPathname(),t.search=n.getSearch(),t.searchParams=n.getSearchParams(),t.hash=n.getHash())},BL=LL.prototype,UL=function(e,t){return{get:function(){return wM(this)[e]()},set:t&&function(e){return wM(this)[t](e)},configurable:!0,enumerable:!0}};if(aM&&(fM(BL,"href",UL("serialize","setHref")),fM(BL,"origin",UL("getOrigin")),fM(BL,"protocol",UL("getProtocol","setProtocol")),fM(BL,"username",UL("getUsername","setUsername")),fM(BL,"password",UL("getPassword","setPassword")),fM(BL,"host",UL("getHost","setHost")),fM(BL,"hostname",UL("getHostname","setHostname")),fM(BL,"port",UL("getPort","setPort")),fM(BL,"pathname",UL("getPathname","setPathname")),fM(BL,"search",UL("getSearch","setSearch")),fM(BL,"searchParams",UL("getSearchParams")),fM(BL,"hash",UL("getHash","setHash"))),dM(BL,"toJSON",(function(){return wM(this).serialize()}),{enumerable:!0}),dM(BL,"toString",(function(){return wM(this).serialize()}),{enumerable:!0}),DM){var VL=DM.createObjectURL,GL=DM.revokeObjectURL;VL&&dM(LL,"createObjectURL",cM(VL,DM)),GL&&dM(LL,"revokeObjectURL",cM(GL,DM))}SM(LL,"URL"),oM({global:!0,constructor:!0,forced:!sM,sham:!aM},{URL:LL});var jL=uo,HL=Vt,zL=Pg,KL=Fa,JL=aW,YL=Br("URL"),QL=JL&&HL((function(){YL.canParse()})),XL=HL((function(){return 1!==YL.canParse.length}));jL({target:"URL",stat:!0,forced:!QL||XL},{canParse:function(e){var t=zL(arguments.length,1),r=KL(e),n=t<2||void 0===arguments[1]?void 0:KL(arguments[1]);try{return!!new YL(r,n)}catch(Qb){return!1}}});var qL=uo,ZL=Pg,$L=Fa,eB=Br("URL");qL({target:"URL",stat:!0},{parse:function(e){var t=ZL(arguments.length,1),r=$L(e),n=t<2||void 0===arguments[1]?void 0:$L(arguments[1]);try{return new eB(r,n)}catch(Qb){return null}}});var tB=c(Or.URL),rB=uo,nB=Ou.findIndex,iB="findIndex",oB=!0;iB in[]&&Array(1)[iB]((function(){oB=!1})),rB({target:"Array",proto:!0,forced:oB},{findIndex:function(e){return nB(this,e,arguments.length>1?arguments[1]:void 0)}});var aB=Sh("Array","findIndex"),sB=Ur,uB=aB,cB=Array.prototype,lB=c((function(e){var t=e.findIndex;return e===cB||sB(cB,e)&&t===cB.findIndex?uB:t})),dB=cr,fB=Vt,hB=Zt,gB=od,pB=es,_B=xr,mB=hB(hr.f),vB=hB([].push),yB=dB&&fB((function(){var e=Object.create(null);return e[2]=2,!mB(e,2)})),SB=function(e){return function(t){for(var r,n=_B(t),i=pB(n),o=yB&&null===gB(n),a=i.length,s=0,u=[];a>s;)r=i[s++],dB&&!(o?r in n:mB(n,r))||vB(u,e?[r,n[r]]:n[r]);return u}},TB=[SB(!0),SB(!1)][0];uo({target:"Object",stat:!0},{entries:function(e){return TB(e)}});var IB=c(Or.Object.entries),bB=uo,CB=Ou.find,wB="find",EB=!0;wB in[]&&Array(1)[wB]((function(){EB=!1})),bB({target:"Array",proto:!0,forced:EB},{find:function(e){return CB(this,e,arguments.length>1?arguments[1]:void 0)}});var AB=Sh("Array","find"),DB=Ur,PB=AB,RB=Array.prototype,xB=c((function(e){var t=e.find;return e===RB||DB(RB,e)&&t===RB.find?PB:t})),kB=Ou.filter;uo({target:"Array",proto:!0,forced:!_a("filter")},{filter:function(e){return kB(this,e,arguments.length>1?arguments[1]:void 0)}});var FB=Sh("Array","filter"),OB=Ur,WB=FB,NB=Array.prototype,MB=c((function(e){var t=e.filter;return e===NB||OB(NB,e)&&t===NB.filter?WB:t})),LB=Ou.map;uo({target:"Array",proto:!0,forced:!_a("map")},{map:function(e){return LB(this,e,arguments.length>1?arguments[1]:void 0)}});var BB=Sh("Array","map"),UB=Ur,VB=BB,GB=Array.prototype,jB=c((function(e){var t=e.map;return e===GB||UB(GB,e)&&t===GB.map?VB:t})),HB=ja.includes;uo({target:"Array",proto:!0,forced:Vt((function(){return!Array(1).includes()}))},{includes:function(e){return HB(this,e,arguments.length>1?arguments[1]:void 0)}});var zB=Sh("Array","includes"),KB=uo,JB=ES,YB=Dr,QB=Fa,XB=DS,qB=Zt("".indexOf);KB({target:"String",proto:!0,forced:!XB("includes")},{includes:function(e){return!!~qB(QB(YB(this)),QB(JB(e)),arguments.length>1?arguments[1]:void 0)}});var ZB=Sh("String","includes"),$B=Ur,eU=zB,tU=ZB,rU=Array.prototype,nU=String.prototype,iU=c((function(e){var t=e.includes;return e===rU||$B(rU,e)&&t===rU.includes?eU:"string"==typeof e||e===nU||$B(nU,e)&&t===nU.includes?tU:t})),oU=c(pO),aU={exports:{}},sU=Vt((function(){if("function"==typeof ArrayBuffer){var e=new ArrayBuffer(8);Object.isExtensible(e)&&Object.defineProperty(e,"a",{value:8})}})),uU=Vt,cU=Fr,lU=rr,dU=sU,fU=Object.isExtensible,hU=uU((function(){fU(1)}))||dU?function(e){return!!cU(e)&&(!dU||"ArrayBuffer"!==lU(e))&&(!fU||fU(e))}:fU,gU=!Vt((function(){return Object.isExtensible(Object.preventExtensions({}))})),pU=uo,_U=Zt,mU=Ha,vU=Fr,yU=Fn,SU=xi.f,TU=Es,IU=Ps,bU=hU,CU=gU,wU=!1,EU=Ln("meta"),AU=0,DU=function(e){SU(e,EU,{value:{objectID:"O"+AU++,weakData:{}}})},PU=aU.exports={enable:function(){PU.enable=function(){},wU=!0;var e=TU.f,t=_U([].splice),r={};r[EU]=1,e(r).length&&(TU.f=function(r){for(var n=e(r),i=0,o=n.length;i<o;i++)if(n[i]===EU){t(n,i,1);break}return n},pU({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:IU.f}))},fastKey:function(e,t){if(!vU(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!yU(e,EU)){if(!bU(e))return"F";if(!t)return"E";DU(e)}return e[EU].objectID},getWeakData:function(e,t){if(!yU(e,EU)){if(!bU(e))return!0;if(!t)return!1;DU(e)}return e[EU].weakData},onFreeze:function(e){return CU&&wU&&bU(e)&&!yU(e,EU)&&DU(e),e}};mU[EU]=!0;var RU=aU.exports,xU=uo,kU=Ut,FU=RU,OU=Vt,WU=Xi,NU=S_,MU=Y_,LU=sr,BU=Fr,UU=wr,VU=lu,GU=xi.f,jU=Ou.forEach,HU=cr,zU=Eu.set,KU=Eu.getterFor,JU=ws,YU=Us,QU=uW,XU=Ri,qU=Y_,ZU=wr,$U=S_,eV=Kd,tV=Jd,rV=z_,nV=cr,iV=RU.fastKey,oV=Eu.set,aV=Eu.getterFor,sV={getConstructor:function(e,t,r,n){var i=e((function(e,i){qU(e,o),oV(e,{type:t,index:JU(null),first:void 0,last:void 0,size:0}),nV||(e.size=0),ZU(i)||$U(i,e[n],{that:e,AS_ENTRIES:r})})),o=i.prototype,a=aV(t),s=function(e,t,r){var n,i,o=a(e),s=u(e,t);return s?s.value=r:(o.last=s={index:i=iV(t,!0),key:t,value:r,previous:n=o.last,next:void 0,removed:!1},o.first||(o.first=s),n&&(n.next=s),nV?o.size++:e.size++,"F"!==i&&(o.index[i]=s)),e},u=function(e,t){var r,n=a(e),i=iV(t);if("F"!==i)return n.index[i];for(r=n.first;r;r=r.next)if(r.key===t)return r};return QU(o,{clear:function(){for(var e=a(this),t=e.first;t;)t.removed=!0,t.previous&&(t.previous=t.previous.next=void 0),t=t.next;e.first=e.last=void 0,e.index=JU(null),nV?e.size=0:this.size=0},delete:function(e){var t=this,r=a(t),n=u(t,e);if(n){var i=n.next,o=n.previous;delete r.index[n.index],n.removed=!0,o&&(o.next=i),i&&(i.previous=o),r.first===n&&(r.first=i),r.last===n&&(r.last=o),nV?r.size--:t.size--}return!!n},forEach:function(e){for(var t,r=a(this),n=XU(e,arguments.length>1?arguments[1]:void 0);t=t?t.next:r.first;)for(n(t.value,t.key,this);t&&t.removed;)t=t.previous},has:function(e){return!!u(this,e)}}),QU(o,r?{get:function(e){var t=u(this,e);return t&&t.value},set:function(e,t){return s(this,0===e?0:e,t)}}:{add:function(e){return s(this,e=0===e?0:e,e)}}),nV&&YU(o,"size",{configurable:!0,get:function(){return a(this).size}}),i},setStrong:function(e,t,r){var n=t+" Iterator",i=aV(t),o=aV(n);eV(e,t,(function(e,t){oV(this,{type:n,target:e,state:i(e),kind:t,last:void 0})}),(function(){for(var e=o(this),t=e.kind,r=e.last;r&&r.removed;)r=r.previous;return e.target&&(e.last=r=r?r.next:e.state.first)?tV("keys"===t?r.key:"values"===t?r.value:[r.key,r.value],!1):(e.target=void 0,tV(void 0,!0))}),r?"entries":"values",!r,!0),rV(t)}};!function(e,t,r){var n,i=-1!==e.indexOf("Map"),o=-1!==e.indexOf("Weak"),a=i?"set":"add",s=kU[e],u=s&&s.prototype,c={};if(HU&&LU(s)&&(o||u.forEach&&!OU((function(){(new s).entries().next()})))){var l=(n=t((function(t,r){zU(MU(t,l),{type:e,collection:new s}),UU(r)||NU(r,t[a],{that:t,AS_ENTRIES:i})}))).prototype,d=KU(e);jU(["add","clear","delete","forEach","get","has","set","keys","values","entries"],(function(e){var t="add"===e||"set"===e;!(e in u)||o&&"clear"===e||WU(l,e,(function(r,n){var i=d(this).collection;if(!t&&o&&!BU(r))return"get"===e&&void 0;var a=i[e](0===r?0:r,n);return t?this:a}))})),o||GU(l,"size",{configurable:!0,get:function(){return d(this).collection.size}})}else n=r.getConstructor(t,e,i,a),FU.enable();VU(n,e,!1,!0),c[e]=n,xU({global:!0,forced:!0},c),o||r.setStrong(n,e,i)}("Set",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),sV);var uV=sn,cV=TypeError,lV=function(e){if("object"==typeof e&&"size"in e&&"has"in e&&"add"in e&&"delete"in e&&"keys"in e)return e;throw new cV(uV(e)+" is not a set")},dV=function(e,t){return 1===t?function(t,r){return t[e](r)}:function(t,r,n){return t[e](r,n)}},fV=Br("Set"),hV=fV.prototype,gV={Set:fV,add:dV("add",1),has:dV("has",1),remove:dV("delete",1),proto:hV},pV=fr,_V=function(e,t,r){for(var n,i,o=r?e:e.iterator,a=e.next;!(n=pV(a,o)).done;)if(void 0!==(i=t(n.value)))return i},mV=_V,vV=function(e,t,r){return r?mV(e.keys(),t,!0):e.forEach(t)},yV=vV,SV=gV.Set,TV=gV.add,IV=function(e){var t=new SV;return yV(e,(function(e){TV(t,e)})),t},bV=function(e){return e.size},CV=dn,wV=Ni,EV=fr,AV=bo,DV="Invalid size",PV=RangeError,RV=TypeError,xV=Math.max,kV=function(e,t){this.set=e,this.size=xV(t,0),this.has=CV(e.has),this.keys=CV(e.keys)};kV.prototype={getIterator:function(){return function(e){return{iterator:e,next:e.next,done:!1}}(wV(EV(this.keys,this.set)))},includes:function(e){return EV(this.has,this.set,e)}};var FV=function(e){wV(e);var t=+e.size;if(t!=t)throw new RV(DV);var r=AV(t);if(r<0)throw new PV(DV);return new kV(e,r)},OV=lV,WV=IV,NV=bV,MV=FV,LV=vV,BV=_V,UV=gV.has,VV=gV.remove;uo({target:"Set",proto:!0,real:!0,forced:!0},{difference:function(e){var t=OV(this),r=MV(e),n=WV(t);return NV(t)<=r.size?LV(t,(function(e){r.includes(e)&&VV(n,e)})):BV(r.getIterator(),(function(e){UV(t,e)&&VV(n,e)})),n}});var GV=lV,jV=bV,HV=FV,zV=vV,KV=_V,JV=gV.Set,YV=gV.add,QV=gV.has;uo({target:"Set",proto:!0,real:!0,forced:!0},{intersection:function(e){var t=GV(this),r=HV(e),n=new JV;return jV(t)>r.size?KV(r.getIterator(),(function(e){QV(t,e)&&YV(n,e)})):zV(t,(function(e){r.includes(e)&&YV(n,e)})),n}});var XV=lV,qV=gV.has,ZV=bV,$V=FV,eG=vV,tG=_V,rG=a_;uo({target:"Set",proto:!0,real:!0,forced:!0},{isDisjointFrom:function(e){var t=XV(this),r=$V(e);if(ZV(t)<=r.size)return!1!==eG(t,(function(e){if(r.includes(e))return!1}),!0);var n=r.getIterator();return!1!==tG(n,(function(e){if(qV(t,e))return rG(n,"normal",!1)}))}});var nG=lV,iG=bV,oG=vV,aG=FV;uo({target:"Set",proto:!0,real:!0,forced:!0},{isSubsetOf:function(e){var t=nG(this),r=aG(e);return!(iG(t)>r.size)&&!1!==oG(t,(function(e){if(!r.includes(e))return!1}),!0)}});var sG=lV,uG=gV.has,cG=bV,lG=FV,dG=_V,fG=a_;uo({target:"Set",proto:!0,real:!0,forced:!0},{isSupersetOf:function(e){var t=sG(this),r=lG(e);if(cG(t)<r.size)return!1;var n=r.getIterator();return!1!==dG(n,(function(e){if(!uG(t,e))return fG(n,"normal",!1)}))}});var hG=lV,gG=IV,pG=FV,_G=_V,mG=gV.add,vG=gV.has,yG=gV.remove;uo({target:"Set",proto:!0,real:!0,forced:!0},{symmetricDifference:function(e){var t=hG(this),r=pG(e).getIterator(),n=gG(t);return _G(r,(function(e){vG(t,e)?yG(n,e):mG(n,e)})),n}});var SG=lV,TG=gV.add,IG=IV,bG=FV,CG=_V;uo({target:"Set",proto:!0,real:!0,forced:!0},{union:function(e){var t=SG(this),r=bG(e).getIterator(),n=IG(t);return CG(r,(function(e){TG(n,e)})),n}});var wG=c(Or.Set),EG=c(po);function AG(e,t){var r=qO(e);if(Jk){var n=Jk(e);t&&(n=MB(n).call(n,(function(t){return nF(e,t).enumerable}))),r.push.apply(r,n)}return r}function DG(e){for(var t=1;t<arguments.length;t++){var r,n,i=null!=arguments[t]?arguments[t]:{};t%2?YO(r=AG(Object(i),!0)).call(r,(function(t){TO(e,t,i[t])})):uF?pF(e,uF(i)):YO(n=AG(Object(i))).call(n,(function(t){EG(e,t,nF(i,t))}))}return e}function PG(e){var t=function(){if("undefined"==typeof Reflect||!Kk)return!1;if(Kk.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Kk(Boolean,[],(function(){}))),!0}catch(QG){return!1}}();return function(){var r,n=jF(e);if(t){var i=jF(this).constructor;r=Kk(n,arguments,i)}else r=n.apply(this,arguments);return function(e,t){if(t&&("object"===eh(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return EF(e)}(this,r)}}var RG=function(e){return Eg?Eg(e):"[object Array]"===function(e){return Object.prototype.toString.call(e)}(e)},xG=function(e){return void 0===e},kG=function(e,t){var r,n;e=null!==(r=e)&&void 0!==r?r:"yyyy-MM-dd hh:mm:ss";var i=xG(t)?new Date:new Date(t),o={"M+":(i.getMonth()+1).toString(),"d+":i.getDate().toString(),"h+":i.getHours().toString(),"m+":i.getMinutes().toString(),"s+":i.getSeconds().toString(),"q+":Math.floor((i.getMonth()+3)/3).toString(),S:i.getMilliseconds().toString()};return/(y+)/.test(e)&&(e=e.replace(RegExp.$1,"".concat(i.getFullYear()).substring(4-RegExp.$1.length))),YO(n=qO(o)).call(n,(function(t){new RegExp("(".concat(t,")")).test(e)&&(e=e.replace(RegExp.$1,1===RegExp.$1.length?o[t]:"00".concat(o[t]).substring("".concat(o[t]).length)))})),e},FG=function(e){return"string"==typeof e},OG=function(e){return"number"==typeof e&&!ZO(e)},WG=function(e){return"function"==typeof e},NG=0,MG=function(){var e;return NG+=1,nW(e="".concat((new Date).getTime().toString(36))).call(e,NG.toString(36))},LG=function(e){var t=tB||window.webkitURL;/^blob:/.test(e)&&t.revokeObjectURL(e)},BG=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";Mt(this,e),TO(this,"prefix",void 0),TO(this,"postfix",void 0),TO(this,"isDestroyed",!1),TO(this,"uid",MG()),TO(this,"cacheEvents",void 0),TO(this,"events",void 0),TO(this,"isCached",void 0),this.cacheEvents=[],this.events={},this.isCached=!1,this.prefix=t,this.postfix=r}return ih(e,[{key:"save",value:function(){this.isCached=!0}},{key:"restore",value:function(){var e,t=this;this.isCached=!1,YO(e=this.cacheEvents).call(e,(function(e){var r,n=e.eventName,i=e.param;t.emit.apply(t,nW(r=[n]).call(r,SO(i)))})),this.cacheEvents.length=0}},{key:"destroy",value:function(){var e=this;if(!this.isDestroyed){for(var t in this.events)if(Object.prototype.hasOwnProperty.call(this.events,t)){var r,n=this.events[t];n&&YO(r=dg(n).call(n)).call(r,(function(t){var r=t.name,n=t.fn,i=t.context,o=t.once;e.off(r,n,i,o)}))}this.events={},this.isDestroyed=!0}}},{key:"on",value:function(e,t,r){var n,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=this.events,a={name:e=this.format(e),uid:MG(),context:r,once:i,fn:t};return o[e]||(o[e]=[]),Mh(n=o[e]).call(n,a)<0&&o[e].push(a),a}},{key:"once",value:function(e,t,r){return this.on(e,t,r,!0)}},{key:"emit",value:function(e){for(var t,r,n=this,i=arguments.length,o=new Array(i>1?i-1:0),a=1;a<i;a++)o[a-1]=arguments[a];if(this.isCached)return this.cacheEvents.push({eventName:e,param:o}),!0;var s=this.events[e=this.format(e)];return!(!s||!s.length||(YO(t=dg(s).call(s)).call(t,(function(e){var t,r=e.fn,n=e.context;r.call.apply(r,nW(t=[n||null]).call(t,o))})),YO(r=dg(s).call(s)).call(r,(function(t){var r=t.fn,i=t.context,o=t.once;o&&n.off(e,r,i,o)})),0))}},{key:"off",value:function(e,t,r,n){var i=this.events[e=this.format(e)];if(!i)return!1;if(!arguments.length)return i.length=0,!0;for(var o=i.length-1;o>=0;o--){var a=i[o];t&&a.fn!==t||r&&a.context!==r||n&&a.once!==n||mp(i).call(i,o,1)}return!0}},{key:"removeAllEventListeners",value:function(e){if(e){var t,r;e=this.format(e);var n=lB(t=this.cacheEvents).call(t,(function(t){return t.eventName===e}));n>-1&&mp(r=this.cacheEvents).call(r,n,1),this.events[e]&&delete this.events[e]}else this.cacheEvents=[],this.events={}}},{key:"getAllEvents",value:function(){return this.events}},{key:"format",value:function(e){var t,r;return nW(t=nW(r="".concat(this.prefix||"")).call(r,e)).call(t,this.postfix||"")}}],[{key:"create",value:function(t,r){return new e(t,r)}}]),e}(),UG="default",VG=function(){function e(){Mt(this,e),TO(this,"emitter",new BG)}return ih(e,[{key:"on",value:function(e){this.emitter.on(UG,e)}},{key:"emit",value:function(){for(var e,t,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];(e=this.emitter).emit.apply(e,nW(t=[UG]).call(t,n))}},{key:"off",value:function(e){this.emitter.off(UG,e)}}],[{key:"create",value:function(){return new e}}]),e}(),GG=function(){function e(t){Mt(this,e),TO(this,"uid",void 0),TO(this,"children",void 0),this.uid=t.uid,this.children=t.children||[]}return ih(e,[{key:"append",value:function(e){var t=this.children;return Mh(t).call(t,e)<0&&(t.push(e),!0)}},{key:"insert",value:function(e,t){var r=this.children;return!(t<0||(t>r.length&&(t=r.length),mp(r).call(r,t,0,e),0))}},{key:"remove",value:function(e){var t=this.children,r=Mh(t).call(t,e);return!(r<0||(mp(t).call(t,r,1),0))}},{key:"clear",value:function(){return this.children=[],!0}},{key:"move",value:function(e,t){if(e===t)return!0;var r=this.children,n=yO(mp(r).call(r,e,1),1)[0];return mp(r).call(r,t,0,n),!0}},{key:"switch",value:function(e,t){if(e===t)return!0;var r=this.children,n=r[e];return r[e]=r[t],r[t]=n,!0}},{key:"reorder",value:function(e){var t=this.children,r=e.length,n=[],i=0;if(t.length!==r||0===r)return!1;for(var o=0;o<r;o++)e[o]===o&&(i+=1);if(i===r)return!0;for(var a=0;a<r;a++)n[a]=t[e[a]];for(var s=0;s<r;s++)t[s]=n[s];return!0}}]),e}(),jG=function(){function e(t,r){Mt(this,e),TO(this,"isDestroyed",!1),TO(this,"data",void 0),TO(this,"table",["database","table","item"]),TO(this,"dbName",void 0),TO(this,"tableName",void 0),this.data={},this.dbName=t,this.tableName=r,this.createDatabase(t,r)}return ih(e,[{key:"destroy",value:function(){if(!this.isDestroyed){for(var e=0,t=IB(this.data);e<t.length;e++){var r=yO(t[e],2),n=r[0];r[1],this.data[n]=null}this.data=null,this.isDestroyed=!0}}},{key:"createDatabase",value:function(e,t){this.data[e]={},this.data[e][t]={}}},{key:"set",value:function(e,t){var r=this,n=this.dbName,i=this.tableName;return new TS((function(o,a){r.checkId(e)?a(new Error("The ".concat(e," already exists."))):(r.data[n][i][e]=t,o("Save ".concat(e," to database successful.")))}))}},{key:"get",value:function(e){var t=this,r=this.dbName,n=this.tableName;return new TS((function(i,o){t.checkId(e)?i(t.data[r][n][e]):o(t.erMsg(2,e))}))}},{key:"remove",value:function(e){var t=this,r=this.dbName,n=this.tableName;return new TS((function(i,o){delete t.data[r][n][e],i("Remove ".concat(e," successful."))}))}},{key:"update",value:function(e,t){var r=this,n=this.dbName,i=this.tableName;return new TS((function(o,a){r.checkId(e)?(r.data[n][i][e]=t,o("Update ".concat(e," successful."))):a(r.erMsg(2,e))}))}},{key:"checkId",value:function(e){var t=this.dbName,r=this.tableName;return void 0!==this.data[t][r][e]}},{key:"erMsg",value:function(e,t){var r;return nW(r="The ".concat(this.table[e]," ")).call(r,t," does not exist.")}}]),e}(),HG=function(){function e(){Mt(this,e),TO(this,"isDestroyed",!1),TO(this,"data",void 0),this.data={}}return ih(e,[{key:"destroy",value:function(){if(!this.isDestroyed){for(var e=0,t=IB(this.data);e<t.length;e++){var r,n=yO(t[e],2),i=n[0];n[1],null!==(r=this.data[i])&&void 0!==r&&r.destroy(),this.data[i]=null}this.data=null,this.isDestroyed=!0}}},{key:"set",value:function(e,t){return!this.check(e)&&(this.data[e]=t,!0)}},{key:"get",value:function(e){return this.data[e]}},{key:"remove",value:function(e){return!!this.check(e)&&(delete this.data[e],!0)}},{key:"update",value:function(e,t){return!!this.check(e)&&(this.data[e]=t,!0)}},{key:"check",value:function(e){return void 0!==this.data[e]}}]),e}(),zG=function(e){QF(r,e);var t=PG(r);function r(e){var n;return Mt(this,r),TO(EF(n=t.call(this,e)),"name",void 0),TO(EF(n),"type",void 0),TO(EF(n),"fileType",void 0),TO(EF(n),"createdDate",void 0),TO(EF(n),"modifiedDate",void 0),TO(EF(n),"parent",void 0),TO(EF(n),"isRoot",!1),n.name=e.name,n.type=e.type,n.fileType=e.fileType,n.parent=e.parent||null,n.isRoot=e.isRoot||!1,n.createdDate=kG(),n.modifiedDate=n.createdDate,n}return ih(r,[{key:"updateDate",value:function(){this.modifiedDate=kG()}},{key:"setName",value:function(e){this.name=e}},{key:"reorder",value:function(e){var t=this.type;return("file"===t||"default"===t)&&HF(jF(r.prototype),"reorder",this).call(this,e)}}]),r}(GG),KG=function(){function e(){Mt(this,e),TO(this,"root",void 0),TO(this,"currentNode",void 0),TO(this,"selectedUid",void 0),TO(this,"defaultNode",void 0),TO(this,"hooks",{fileChanged:VG.create(),beforeRemoveFile:VG.create(),removeFile:VG.create(),afterRemoveFile:VG.create(),afterRenameFile:VG.create(),destroy:VG.create()}),this.root=new zG({uid:MG(),children:[],name:"root",type:"file",fileType:"folder",parent:void 0,isRoot:!0}),this.defaultNode=this.root,this.currentNode=this.root}return ih(e,[{key:"appendChildrenToFile",value:function(e,t,r){var n=r,i=JG(this.defaultNode,e);return i||(i=this.createFile(e),this.hooks.fileChanged.emit(this.defaultNode)),YO(t).call(t,(function(e){xG(n)?i.append(e):(i.insert(e,n),n+=1)})),i}},{key:"removeChildFromFile",value:function(e,t){FG(t)&&(t=[t]);var r=this.getFileByUid(e);r&&YO(t).call(t,(function(e){r.remove(e)}))}},{key:"findChild",value:function(e,t){var r;return xB(r=e.children).call(r,(function(e){return e.name===t}))}},{key:"createFile",value:function(e){var t=this.defaultNode;t||(t=this.root);var r=JG(t,e);return r&&"file"===r.type||(r=new zG({uid:MG(),children:[],name:e,type:"file",fileType:"file",parent:t,isRoot:!1}),this.currentNode.append(r),this.hooks.fileChanged.emit(this.currentNode.children)),r}},{key:"removeFile",value:function(e){for(var t=this.defaultNode.children,r=0;r<t.length;r++){var n=t[r];if(n.name===e)return this.hooks.beforeRemoveFile.emit(n),mp(t).call(t,r,1),this.hooks.afterRemoveFile.emit(n),this.hooks.fileChanged.emit(n),!0}return!1}},{key:"renameFile",value:function(e,t){var r=this.findChild(this.defaultNode,e),n=this.findChild(this.defaultNode,t);return!!r&&!n&&(r.name=t,this.hooks.afterRenameFile.emit(r),this.hooks.fileChanged.emit(this.currentNode.children),!0)}},{key:"getFile",value:function(e){return this.findChild(this.defaultNode,e)}},{key:"getFileByUid",value:function(e){return xB(this).call(this,e,this.root)}},{key:"getCurrentFileList",value:function(){return this.currentNode.children}},{key:"isFileExist",value:function(e){return!!this.findChild(this.defaultNode,e)}},{key:"createFolder",value:function(){}},{key:"find",value:function(e,t){for(var r=t.children,n=r.length,i=0;i<n;i++){if(r[i].uid===e)return r[i];if(r[i].children){var o=xB(this).call(this,e,r[i]);if(o)return o}}return null}}]),e}();function JG(e,t){var r,n=MB(r=e.children).call(r,(function(e){return e.name===t}));return 0===n.length?null:n[0]}var YG,QG,XG=function(e){QF(r,e);var t=PG(r);function r(e){var n;return Mt(this,r),TO(EF(n=t.call(this,e)),"name",void 0),TO(EF(n),"type","tag"),n.name=e.name,n.uid=e.uid||MG(),n.type="tag",n}return ih(r)}(GG),qG=function(){function e(){Mt(this,e),TO(this,"tags",void 0),TO(this,"defaultName",void 0),TO(this,"defaultUid",void 0),TO(this,"selectedUid",void 0),TO(this,"emptyItem",void 0),TO(this,"hooks",{beforeRemoveTag:VG.create(),afterRenameTag:VG.create(),destroy:VG.create(),load:VG.create()}),this.tags=[],this.defaultName=null,this.defaultUid=null,this.selectedUid=null,this.emptyItem=new XG({name:"defaultTag",children:[]})}return ih(e,[{key:"appendChildToTag",value:function(e,t){var r=this.createTag(e);FG(t)&&(t=[t]);var n=!1;return YO(t).call(t,(function(e){r.append(e)&&(n=!0)})),n}},{key:"removeChildFromTag",value:function(e,t){var r=this.getTag(e);return!!r&&(FG(t)&&(t=[t]),YO(t).call(t,(function(e){r.remove(e)})),!0)}},{key:"createTag",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=this.getTag(e);return r||(r=new XG({name:e,children:t}),this.tags.push(r)),r}},{key:"removeTag",value:function(e){var t,r,n=this.getTag(e);if(!n)return!1;this.hooks.beforeRemoveTag.emit(n);var i=lB(t=this.tags).call(t,(function(t){return t.name===e}));return e===this.defaultName&&(this.defaultName=null,this.selectedUid=null),mp(r=this.tags).call(r,i,1),!0}},{key:"renameTag",value:function(e,t){if(!FG(e)||!FG(t))return!1;var r=this.isTagExisted(t),n=this.getTag(e);return!(!n||r||(n.name=t,this.hooks.afterRenameTag.emit(n),0))}},{key:"getTag",value:function(e){var t;return xB(t=this.tags).call(t,(function(t){return t.name===e}))}},{key:"getTagByUid",value:function(e){var t;return xB(t=this.tags).call(t,(function(t){return t.uid===e}))}},{key:"getTagList",value:function(){var e;return dg(e=this.tags).call(e)}},{key:"setDefaultTag",value:function(e){if(!e)return this.defaultName=null,this.defaultUid=null,!0;var t=this.getTag(e);return!!t&&(this.defaultName=e,this.defaultUid=t.uid,!0)}},{key:"getDefaultTag",value:function(){return this.defaultName}},{key:"isTagExisted",value:function(e){return!!this.getTag(e)}}]),e}(),ZG=function(){function e(){Mt(this,e)}return ih(e,[{key:"apply",value:function(e){var t=e.hooks,r={beforeStatus:null,afterStatus:null,operation:null,docUid:null},n=function(e){r.beforeStatus={uids:[],selectedUids:[],currentUid:"",modifiedUid:e.modifiedUid,removedUids:e.removedUids}},i=function(t){r.afterStatus={uids:[],selectedUids:[],currentUid:"",modifiedUid:t.modifiedUid,removedUids:t.removedUids},r.docUid="",r.operation=t.operation,e.emit("bufferChanged",DG({},r)),r={beforeStatus:null,afterStatus:null,operation:null,docUid:null}};t.beforeBufferChanged.on(n),t.afterBufferChanged.on(i),t.destroy.on((function(){t.beforeBufferChanged.off(n),t.afterBufferChanged.off(i)}))}}]),e}(),$G=function(){function e(){Mt(this,e)}return ih(e,[{key:"apply",value:function(e){var t=e.hooks;e.customStore=new HG;var r=function(t){var r=t.data;YO(r).call(r,(function(t){var r=t.customData;r||(r={}),e.customStore.set(t.uid,r)}))},n=function(t){var r=t.removedUids;YO(r).call(r,(function(t){e.customStore.remove(t)}))},i=function(t){var r=t.data.customData;r&&e.customStore.update(t.modifiedUid,r)};t.loadSource.on(r),t.removeSource.on(n),t.updateSource.on(i),t.destroy.on((function(){t.loadSource.off(r),t.removeSource.off(n),t.updateSource.off(i)}))}}]),e}(),ej=function(e){QF(r,e);var t=PG(r);function r(){var e;return Mt(this,r),TO(EF(e=t.call(this,{uid:MG(),children:[]})),"name","dvs-default"),TO(EF(e),"isDestroyed",!1),TO(EF(e),"type",void 0),e}return ih(r,[{key:"destroy",value:function(){this.isDestroyed||(this.isDestroyed=!0)}}]),r}(GG),tj=function(){function e(){Mt(this,e)}return ih(e,[{key:"apply",value:function(e){e.defaultFile=new ej;var t=e.hooks,r=function(t){var r,n,i,o=t.filename,a=t.index,s=t.data;if(xG(o)){var u=jB(s).call(s,(function(e){return e.uid}));void 0===a?(r=e.defaultFile.children).push.apply(r,SO(u)):mp(n=e.defaultFile.children).apply(n,nW(i=[a,0]).call(i,SO(u)));var c={docUid:e.defaultFile.uid,sourceUids:u,type:"default",index:a};e.hooks.loadToDoc.emit(c)}},n=function(t){var r=t.removedUids,n=[];YO(r).call(r,(function(t){var r=e.statusStore.get(t);r&&r.ownerDefaultFile&&(e.defaultFile.remove(t),n.push(t))})),n.length&&e.hooks.removeFromDoc.emit({docUid:e.defaultFile.uid,sourceUids:r,type:"default"})};t.loadSource.on(r),t.removeSource.on(n),t.destroy.on((function(){t.loadSource.off(r),t.removeSource.off(n)}))}}]),e}(),rj=function(){function e(){Mt(this,e)}return ih(e,[{key:"apply",value:function(e){e.dir=new KG,this.listenDirectoryHooks(e),this.listenSpaceHooks(e)}},{key:"listenDirectoryHooks",value:function(e){var t=e.dir.hooks,r=function(t){var r;YO(r=t.children).call(r,(function(r){var n=e.statusStore.get(r);n&&n.ownerFiles.remove(t.uid)})),e.hooks.removeDoc.emit(t)},n=function(t){e.hooks.renameDoc.emit(t)};t.beforeRemoveFile.on(r),t.afterRenameFile.on(n),t.destroy.on((function(){t.beforeRemoveFile.off(r),t.afterRenameFile.off(n)}))}},{key:"listenSpaceHooks",value:function(e){var t=e.hooks,r=function(t){var r=t.data,n=t.filename,i=t.index;if(!xG(n)){var o=jB(r).call(r,(function(e){return e.uid})),a={docUid:e.dir.appendChildrenToFile(n,o,i).uid,sourceUids:o,type:"file",index:i};e.hooks.loadToDoc.emit(a)}},n=function(t){var r=t.removedUids,n={};YO(r).call(r,(function(t){var r,i,o=e.statusStore.get(t);o&&YO(r=dg(i=o.ownerFiles.children).call(i)).call(r,(function(e){n[e]||(n[e]=[]),n[e].push(t)}))}));for(var i=0,o=IB(n);i<o.length;i++){var a=yO(o[i],2),s=a[0],u=a[1];e.dir.removeChildFromFile(s,u),e.hooks.removeFromDoc.emit({docUid:s,sourceUids:u})}};t.loadSource.on(r),t.removeSource.on(n),t.destroy.on((function(){t.loadSource.off(r),t.removeSource.off(n)}))}}]),e}(),nj=function(){function e(){Mt(this,e)}return ih(e,[{key:"apply",value:function(e){var t=e.hooks;e.metadataStore=new HG;var r=function(t){var r=t.data;YO(r).call(r,(function(t){var r=t.metadata;r||(r={width:void 0,height:void 0}),e.metadataStore.set(t.uid,r)}))},n=function(t){var r=t.removedUids;YO(r).call(r,(function(t){e.metadataStore.remove(t)}))},i=function(t){var r=t.data.metadata;r&&e.metadataStore.update(t.modifiedUid,r)};t.loadSource.on(r),t.removeSource.on(n),t.updateSource.on(i),t.destroy.on((function(){t.loadSource.off(r),t.removeSource.off(n),t.updateSource.off(i)}))}}]),e}(),ij=function(){function e(t){Mt(this,e),TO(this,"uid",null),TO(this,"minData",null),TO(this,"oriData",null),TO(this,"customData",{}),TO(this,"activeOri",!1),TO(this,"activeMin",!1),TO(this,"minTask",null),TO(this,"oriTask",null),TO(this,"load",!1),TO(this,"preload",[]),TO(this,"visible",[]),TO(this,"overlays",[]),TO(this,"img",null),TO(this,"minImg",null),TO(this,"imageScale",1),TO(this,"owners",[]),TO(this,"oriType",null),TO(this,"minType",null),TO(this,"metadata",null),TO(this,"realTimeWidth",0),TO(this,"realTimeHeight",0),TO(this,"isFromFile",!1),TO(this,"isCached",!1),TO(this,"isDestroyed",!1),TO(this,"isLoading",!1),TO(this,"isMinLoading",!1),TO(this,"isSaving",!1),TO(this,"annotations",void 0),TO(this,"ownerFiles",new GG({children:[]})),TO(this,"ownerTags",new GG({children:[]})),TO(this,"ownerDefaultFile",void 0),TO(this,"operations",[]),TO(this,"useFillColor",!1),this.uid=t.uid,this.metadata=DG({},t.metadata),this.setRealTimeSize(this.metadata.width,this.metadata.height)}return ih(e,[{key:"setRealTimeSize",value:function(e,t){this.realTimeWidth=e,this.realTimeHeight=t}},{key:"destroy",value:function(){this.isDestroyed||(this.customData=null,this.img=null,this.owners=null,this.metadata=null,this.isDestroyed=!0)}},{key:"addOwner",value:function(e){var t=this.owners;Mh(t).call(t,e)<0&&t.push(e)}},{key:"removeOwner",value:function(e){var t=this.owners,r=Mh(t).call(t,e);r>-1&&mp(t).call(t,r,1)}},{key:"removeViewer",value:function(e){var t=this.owners,r=Mh(t).call(t,e);r>-1&&mp(t).call(t,r,1)}},{key:"setVisible",value:function(e){var t;Mh(t=this.visible).call(t,e)<0&&this.visible.push(e)}},{key:"cancelVisible",value:function(e){var t,r,n=Mh(t=this.visible).call(t,e);n>-1&&mp(r=this.visible).call(r,n,1)}},{key:"setPreload",value:function(e){var t;Mh(t=this.preload).call(t,e)<0&&this.preload.push(e)}},{key:"cancelPreload",value:function(e){var t,r,n=Mh(t=this.preload).call(t,e);n>-1&&mp(r=this.preload).call(r,n,1)}},{key:"reset",value:function(){this.minData=null,this.oriData=null,this.img=null,this.activeOri=!1,this.activeMin=!1,this.minTask=null,this.oriTask=null,this.operations=[]}}]),e}(),oj=function(){function e(){Mt(this,e)}return ih(e,[{key:"apply",value:function(e){var t=e.hooks;e.statusStore=new HG;var r=function(t){var r=t.data;t.filename,t.index,YO(r).call(r,(function(t){var r=new ij(t);e.statusStore.set(t.uid,r)}))},n=function(t){var r=t.removedUids;YO(r).call(r,(function(t){var r,n,i=e.statusStore.get(t);i&&(LG(i.minData),LG(i.oriData),i.ownerFiles.clear(),i.ownerTags.clear(),i.ownerDefaultFile=!1,null!==(r=i.img)&&void 0!==r&&r.src&&(i.img.src=""),null!==(n=i.minImg)&&void 0!==n&&n.src&&(i.minImg.src=""),i.img=null,i.minImg=null),e.statusStore.remove(t)}))},i=function(t){var r=t.modifiedUid,n=t.data,i=t.revoke,o=e.statusStore.get(r);if(o){o.img=null,o.minImg=null;var a=n.metadata;a&&(o.metadata=DG({},a),o.setRealTimeSize(a.width,a.height)),i&&(LG(o.oriData),LG(o.minData)),o.reset(),e.statusStore.update(r,o)}},o=function(t){var r;YO(r=t.children).call(r,(function(r){var n=e.statusStore.get(r);n&&("file"===t.type?n.ownerFiles.remove(t.uid):"tag"===t.type&&n.ownerTags.remove(t.uid))}))},a=function(t){var r=t.docUid,n=t.sourceUids,i=t.type;YO(n).call(n,(function(t){var n=e.statusStore.get(t);n&&("file"===i?n.ownerFiles.append(r):"tag"===i?n.ownerTags.append(r):"default"===i&&(n.ownerDefaultFile=!0))}))},s=function(t){var r=t.docUid,n=t.sourceUids,i=t.type;YO(n).call(n,(function(t){var n=e.statusStore.get(t);n&&("file"===i?n.ownerFiles.remove(r):"tag"===i?n.ownerTags.remove(r):"default"===i&&(n.ownerDefaultFile=!0))}))};t.loadSource.on(r),t.afterRemoveSource.on(n),t.updateSource.on(i),t.removeDoc.on(o),t.loadToDoc.on(a),t.removeFromDoc.on(s),t.destroy.on((function(){t.loadSource.off(r),t.afterRemoveSource.off(n),t.updateSource.off(i),t.removeDoc.off(o),t.loadToDoc.off(a),t.removeFromDoc.off(s)}))}}]),e}(),aj=function(){function e(){Mt(this,e)}return ih(e,[{key:"apply",value:function(e){var t=e.hooks;e.store=new jG("space_db","space_doc");var r=function(t){var r=t.data;r&&YO(r).call(r,(function(t){e.store.set(t.uid,t)}))},n=function(t){var r;YO(r=t.removedUids).call(r,(function(t){e.store.remove(t)}))},i=function(t){e.store.update(t.modifiedUid,t.data)};t.loadSource.on(r),t.removeSource.on(n),t.updateSource.on(i),t.destroy.on((function(){t.loadSource.off(r),t.removeSource.off(n),t.updateSource.off(i)}))}}]),e}(),sj=function(){function e(){Mt(this,e)}return ih(e,[{key:"apply",value:function(e){e.tag=new qG,this.listenSpaceHooks(e),this.listenTagHooks(e)}},{key:"listenTagHooks",value:function(e){var t=e.tag.hooks,r=function(t){var r;YO(r=t.children).call(r,(function(r){var n=e.statusStore.get(r);n&&n.ownerFiles.remove(t.uid)})),e.hooks.removeDoc.emit(t)},n=function(t){e.hooks.renameDoc.emit(t)};t.beforeRemoveTag.on(r),t.afterRenameTag.on(n),t.destroy.on((function(){t.beforeRemoveTag.off(r),t.afterRenameTag.off(n)}))}},{key:"listenSpaceHooks",value:function(e){var t=e.hooks,r=function(t){var r=t.data,n=e.tag.defaultName;YO(r).call(r,(function(e){var t;e.tags||(e.tags=[]),n&&Mh(t=e.tags).call(t,n)<0&&e.tags.push(n)}))},n=function(t){var r=t.data;YO(r).call(r,(function(t){var r;null!==(r=t.tags)&&void 0!==r&&YO(r).call(r,(function(r){e.tag.appendChildToTag(r,t.uid);var n={docUid:e.tag.getTag(r).uid,sourceUids:[t.uid],type:"tag"};e.hooks.loadToDoc.emit(n)})),t.tags.length=0}))},i=function(t){var r=t.removedUids,n={};YO(r).call(r,(function(t){var r,i,o=e.statusStore.get(t);o&&YO(r=dg(i=o.ownerTags.children).call(i)).call(r,(function(e){n[e]||(n[e]=[]),n[e].push(t)}))}));for(var i=0,o=IB(n);i<o.length;i++){var a=yO(o[i],2),s=a[0],u=a[1],c=e.tag.getTagByUid(s);c&&e.tag.removeChildFromTag(c.name,u),e.hooks.removeFromDoc.emit({docUid:s,sourceUids:u,type:"tag"})}},o=function(e){"tag"!==e.type&&i({removedUids:e.children})},a=function(t){var r=t.docUid,n=t.sourceUids;if("tag"===t.type){var i=e.tag.getTagByUid(r);i&&YO(n).call(n,function(){var t=wF(JO.mark((function t(r){var n,o;return JO.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.store.get(r);case 3:if(o=t.sent,t.t0=o&&Mh(n=o.tags).call(n,i.name)<0,!t.t0){t.next=9;break}return o.tags.push(i.name),t.next=9,e.store.update(r,o);case 9:t.next=14;break;case 11:t.prev=11,t.t1=t.catch(0);case 14:case"end":return t.stop()}}),t,null,[[0,11]])})));return function(e){return t.apply(this,arguments)}}())}},s=function(t){var r=t.docUid,n=t.sourceUids;if("tag"===t.type){var i=e.tag.getTagByUid(r);i&&YO(n).call(n,function(){var t=wF(JO.mark((function t(r){var n,o,a,s;return JO.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.store.get(r);case 3:if(!(n=t.sent)){t.next=9;break}return(s=Mh(o=n.tags).call(o,i.name))>-1&&mp(a=n.tags).call(a,s,1),t.next=9,e.store.update(r,n);case 9:t.next=14;break;case 11:t.prev=11,t.t0=t.catch(0);case 14:case"end":return t.stop()}}),t,null,[[0,11]])})));return function(e){return t.apply(this,arguments)}}())}};t.beforeLoadSource.on(r),t.loadSource.on(n),t.removeSource.on(i),t.removeDoc.on(o),t.loadToDoc.on(a),t.removeFromDoc.on(s),t.destroy.on((function(){t.beforeLoadSource.off(r),t.loadSource.off(n),t.removeSource.off(i),t.removeDoc.off(o),t.loadToDoc.off(a),t.removeFromDoc.off(s)}))}}]),e}(),uj=function(e){QF(r,e);var t=PG(r);function r(){var e;return Mt(this,r),TO(EF(e=t.call(this)),"uid",MG()),TO(EF(e),"hooks",{init:VG.create(),destroy:VG.create(),beforeLoadSource:VG.create(),loadSource:VG.create(),afterLoadSource:VG.create(),beforeRemoveSource:VG.create(),removeSource:VG.create(),afterRemoveSource:VG.create(),beforeUpdateSource:VG.create(),updateSource:VG.create(),afterUpdateSource:VG.create(),beforeBufferChanged:VG.create(),afterBufferChanged:VG.create(),directoryChanged:VG.create(),tagChanged:VG.create(),openDoc:VG.create(),loadToDoc:VG.create(),removeFromDoc:VG.create(),removeDoc:VG.create(),renameDoc:VG.create(),move:VG.create(),afterMove:VG.create(),switch:VG.create(),afterSwitch:VG.create(),reorder:VG.create(),afterReorder:VG.create()}),TO(EF(e),"dir",void 0),TO(EF(e),"tag",void 0),TO(EF(e),"store",void 0),TO(EF(e),"customStore",void 0),TO(EF(e),"metadataStore",void 0),TO(EF(e),"statusStore",void 0),TO(EF(e),"defaultFile",void 0),TO(EF(e),"plugins",[]),TO(EF(e),"imageLoader",void 0),e.initPlugins(),e.hooks.init.emit(),e}return ih(r,[{key:"destroy",value:function(){this.hooks.destroy.emit()}},{key:"initPlugins",value:function(){(new aj).apply(this),(new oj).apply(this),(new $G).apply(this),(new nj).apply(this),(new ZG).apply(this),(new tj).apply(this),(new rj).apply(this),(new sj).apply(this)}},{key:"setImageLoader",value:function(e){this.imageLoader=e}},{key:"getCustomData",value:function(e){return this.customStore.get(e)}},{key:"setCustomData",value:function(e,t){return this.customStore.set(e,t)}},{key:"getMetadata",value:function(e){return this.metadataStore.get(e)}},{key:"setMetadata",value:function(e,t){return this.metadataStore.set(e,t)}},{key:"createStore",value:function(e){var t=e.type,r=void 0===t?"sync":t,n=e.tableName,i=e.dbName;return"sync"===r?new HG:i&&n?new jG(i,n):null}},{key:"loadSource",value:function(e,t){if(xG(e))return[];var r=e.data;if(!RG(r))return[];var n=[];return YO(r).call(r,(function(e){e.uid=MG(),n.push(e.uid)})),WG(t)&&t(n),this.hooks.beforeBufferChanged.emit(e),this.hooks.beforeLoadSource.emit(e),this.hooks.loadSource.emit(e),this.hooks.afterLoadSource.emit(e),this.hooks.afterBufferChanged.emit(e),n}},{key:"removeSource",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];FG(e)&&(e=[e]);var r={removedUids:e,docUid:"",trigger:this.uid,operation:"remove"};return this.hooks.beforeRemoveSource.emit(r),this.hooks.beforeBufferChanged.emit(r),this.hooks.removeSource.emit(r),t&&this.hooks.afterRemoveSource.emit(r),this.hooks.afterBufferChanged.emit(r),!0}},{key:"updateSource",value:function(e,t){var r={modifiedUid:e,data:t,revoke:!(arguments.length>2&&void 0!==arguments[2])||arguments[2],operation:"modify"};return this.hooks.beforeUpdateSource.emit(r),this.hooks.beforeBufferChanged.emit(r),this.hooks.updateSource.emit(r),this.hooks.afterUpdateSource.emit(r),this.hooks.afterBufferChanged.emit(r),!0}},{key:"getSource",value:function(e){return this.store.get(e)}},{key:"openDefault",value:function(e){var t={node:this.defaultFile,type:"default",config:e};this.hooks.openDoc.emit(t)}},{key:"createFile",value:function(e){return this.dir.createFile(e)}},{key:"removeFile",value:function(e){return this.dir.removeFile(e)}},{key:"renameFile",value:function(e,t){return this.dir.renameFile(e,t)}},{key:"openFile",value:function(e,t){var r=this.getFile(e);if(!r)return!1;var n={node:r,type:"file",config:t};return this.hooks.openDoc.emit(n),!0}},{key:"movePagesToFile",value:function(e,t,r,n){var i=this,o=this.getFile(e),a=this.getFile(r);if(!o||!a)return!1;for(var s=0;s<t.length;s++)if(t[s]<0||t[s]>=o.children.length)return!1;if(n<0)return!1;var u=jB(t).call(t,(function(e){return o.children[e]}));YO(u).call(u,(function(e){var t=i.statusStore.get(e);t&&t.ownerFiles.remove(o.uid)})),this.dir.removeChildFromFile(o.uid,u),this.hooks.removeFromDoc.emit({docUid:o.uid,sourceUids:u}),n>a.children.length&&(n=a.children.length);var c=this.dir.appendChildrenToFile(r,u,n),l={docUid:c.uid,sourceUids:u,type:"file",index:n};return YO(u).call(u,(function(e){var t=i.statusStore.get(e);t&&t.ownerFiles.append(c.uid)})),this.hooks.loadToDoc.emit(l),!0}},{key:"getFile",value:function(e){return this.dir.getFile(e)}},{key:"getFileList",value:function(){return this.dir.getCurrentFileList()}},{key:"isFileExisted",value:function(e){return this.dir.isFileExist(e)}},{key:"createTag",value:function(e){return this.tag.createTag(e)}},{key:"removeTag",value:function(e){for(var t=this.getTag(e).children||[],r=0;r<t.length;r++)this.store.get(t[r]).then((function(t){var r,n,i=Mh(r=(null==t?void 0:t.tags)||[]).call(r,e);-1!==i&&mp(n=t.tags).call(n,i,1)}));return this.tag.removeTag(e)}},{key:"renameTag",value:function(e,t){var r=this.getTag(e).children||[],n=this.tag.renameTag(e,t);if(n)for(var i=0;i<r.length;i++)this.store.get(r[i]).then((function(r){var n,i,o=Mh(n=(null==r?void 0:r.tags)||[]).call(n,e);-1!==o&&mp(i=r.tags).call(i,o,1,t)}));return n}},{key:"openTag",value:function(e,t){var r=this.getTag(e);if(!r)return!1;var n={node:r,type:"tag",config:t};return this.hooks.openDoc.emit(n),!0}},{key:"getTag",value:function(e){return this.tag.getTag(e)}},{key:"getTagList",value:function(){return this.tag.getTagList()}},{key:"setDefaultTag",value:function(e){return this.tag.setDefaultTag(e)}},{key:"getDefaultTag",value:function(){return this.tag.getDefaultTag()}},{key:"isTagExisted",value:function(e){return this.tag.isTagExisted(e)}},{key:"addTagToSource",value:function(e,t){if(this.statusStore.get(e)){FG(t)&&(t=[t]);for(var r=0;r<t.length;r++)if(!this.addSourceToTag(t[r],e))return!1;return!0}return!1}},{key:"removeTagFromSource",value:function(e,t){if(this.statusStore.get(e)){var r;xG(t)?t=jB(r=this.tag.tags).call(r,(function(e){return e.name})):FG(t)&&(t=[t]);for(var n=0;n<t.length;n++)if(!this.removeSourceFromTag(t[n],e))return!1;return!0}return!1}},{key:"addSourceToTag",value:function(e,t){var r=this.tag.getTag(e);if(r&&this.tag.appendChildToTag(e,t)){FG(t)&&(t=[t]);for(var n=0;n<t.length;n++)this.store.get(t[n]).then((function(t){var r;t&&(RG(t.tags)||(t.tags=[]),iU(r=t.tags).call(r,e)||t.tags.push(e))}));var i={sourceUids:t,docUid:r.uid,type:"tag"};return this.hooks.loadToDoc.emit(i),!0}return!1}},{key:"removeSourceFromTag",value:function(e,t){var r=this.tag.getTag(e);if(r){this.tag.removeChildFromTag(e,t),FG(t)&&(t=[t]);for(var n=0;n<t.length;n++)this.store.get(t[n]).then((function(t){var r,n,i=Mh(r=(null==t?void 0:t.tags)||[]).call(r,e);-1!==i&&mp(n=t.tags).call(n,i,1)}));var i={docUid:r.uid,sourceUids:t,type:"tag"};return this.hooks.removeFromDoc.emit(i),!0}return!1}},{key:"getSourceTags",value:function(e){var t,r=this,n=this.statusStore.get(e);return n?jB(t=n.ownerTags.children).call(t,(function(e){return r.tag.getTagByUid(e).name})):[]}},{key:"switch",value:function(e){var t=e.one,r=e.other,n=e.type,i=e.docUid,o=e.emit,a=this.getDocNode(i,n);if(a){if(a.switch(t,r),o||xG(o)){var s={one:t,other:r,docUid:i,type:a.type,trigger:this.uid,operation:"shift"};this.hooks.switch.emit(s)}return!0}return!1}},{key:"move",value:function(e){var t=e.from,r=e.to,n=e.type,i=e.docUid,o=e.emit,a=this.getDocNode(i,n);if(a){if(a.move(t,r),o||xG(o)){var s={from:t,to:r,docUid:i,type:a.type,trigger:this.uid,operation:"shift"};this.hooks.move.emit(s)}return!0}return!1}},{key:"reorder",value:function(e){var t=e.indexes,r=e.type,n=e.docUid,i=e.emit,o=this.getDocNode(n,r);if(o&&(o.reorder(t),i||xG(i))){var a={indexes:t,docUid:n,type:o.type,trigger:this.uid,operation:"shift"};this.hooks.move.emit(a)}}},{key:"getDocNode",value:function(e,t){switch(t){case"default":return this.defaultFile;case"file":return this.dir.getFileByUid(e);case"tag":return this.tag.getTagByUid(e);default:return e===this.defaultFile.uid?this.defaultFile:this.tag.getTagByUid(e)||this.dir.getFileByUid(e)||null}}}]),r}(BG),cj={Successful:{errorCode:0,errorString:"Successful."},InvalidIndex:{errorCode:-1033,errorString:"Invalid index."},InvalidValue:{errorCode:-1034,errorString:"Invalid value."},NoImage:{errorCode:-1035,errorString:"There is no image."},UnBindViewer:{errorCode:-2210,errorString:"You cannot call this method on this WebTwain instance because it does not use the default viewer."},AlReadyBindViewer:{errorCode:-2211,errorString:"The element is already bound to the viewer."},ParameterCannotEmpty:{errorCode:-2314,errorString:"The parameter cannot be empty."},IndicesNotArray:{errorCode:-2358,errorString:"The type of the parameter indices must be an Array."},IndexOutOfRange:{errorCode:-2359,errorString:"The index is out of range."},InvalidTagName:{errorCode:-2394,errorString:"Invalid tag name."},InvalidLeftOrTopOrRightOrBottom:{errorCode:-2417,errorString:"The left or top or right or bottom you entered is invalid."},InvalidWidth:{errorCode:-2418,errorString:"The width you entered is invalid."},InvalidHeight:{errorCode:-2419,errorString:"The height you entered is invalid."},WidthOrHeightOutOfImageSize:{errorCode:-2420,errorString:"The width or height is out of image size."},MobileServer_InvalidIndex:{errorCode:-2423,errorString:"The index is invalid."},ImageEditorExist:{errorCode:-2500,errorString:"An ImageEditor already exists."},ThumbnailViewerExist:{errorCode:-2501,errorString:"A ThumbnailViewer already exists."},CustomElementExist:{errorCode:-2502,errorString:"A CustomElement already exists."},ImageEditorDispose:{errorCode:-2504,errorString:"The ImageEditor object has been disposed."},ThumbnailViewerNotExist:{errorCode:-2505,errorString:"This ThumbnailViewer doesn't exist."},ThumbnailViewerDispose:{errorCode:-2506,errorString:"The ThumbnailViewer object has been disposed."},CallbackNotAFunction:{errorCode:-2510,errorString:"The callback is not a function."},ElementRequired:{errorCode:-2511,errorString:"Parameter 'element' is required."},ElementNotExist:{errorCode:-2512,errorString:"Parameter 'element' doesn't instanceof HTMLDivElement."},InvalidPropertyValue:{errorCode:-2514,errorString:"Invalid property value."},CursorInvalidMode:{errorCode:-2519,errorString:"The current mode does not support setting the cursor to zoom."},OldTagNameRequired:{errorCode:-2517,errorString:"Old tag name is required."},NewTagNameRequired:{errorCode:-2518,errorString:"New tag name is required."},FileNameCannotEmpty:{errorCode:-2530,errorString:"Document name cannot be empty."},FileNameNotString:{errorCode:-2531,errorString:"Document name is not a string."},FileNotExist:{errorCode:-2540,errorString:"The document does not exist."},FileExist:{errorCode:-2541,errorString:"The document already exists."},CustomElementDispose:{errorCode:-2508,errorString:"The CustomElement object has been disposed."},CustomElementNotExist:{errorCode:-2507,errorString:"This CustomElement doesn't exist."},ParameterOutRange:{errorCode:80002,errorString:"The parameter is out of range."},TagNotExist:{errorCode:80009,errorString:"Tag does not exist."},TagExist:{errorCode:80010,errorString:"The tag already exists."},OperationError:{errorCode:80022,errorString:"The operation mode is wrong."}};(QG=YG||(YG={}))[QG.Normal=0]="Normal",QG[QG.Balance=1]="Balance";var lj=function(){function e(t){Mt(this,e),TO(this,"space",void 0),TO(this,"webViewer",void 0),TO(this,"isActiveFile",!1),TO(this,"isActiveTag",!1),TO(this,"currentFileName",""),TO(this,"currentTagName",""),TO(this,"bufferConfig",null),TO(this,"currentSelected",[]),this.space=new uj,t&&(this.bufferConfig=t)}return ih(e,[{key:"e",value:function(){this.setError("Successful")}},{key:"IsFileNameExist",value:function(e){var t=this.space.getFileList();if("dynamsoft-default-document"===e)return!0;if(t)for(var r=0;r<t.length;r++)if(t[r].name===e)return!0;return!1}},{key:"getCurrentDataSet",value:function(){if(this.webViewer){var e=this.webViewer.myViewer.getCurrentTab();if(void 0===e)return!1;var t=e.type;this.isActiveFile="file"===t,this.isActiveTag="tag"===t}if(this.isActiveFile){var r=this.getCurrentFileName(),n=this.space.getFile(r);if(n)return n}if(this.isActiveTag){var i=this.space.getTag(this.currentTagName);if(i)return i}return!1}},{key:"setError",value:function(e){var t;if("Default"!==e){if(this.webViewer)this.webViewer.setError(e);else if(this.bufferConfig&&this.bufferConfig.viewerError){var r=cj[e],n=r.errorCode,i=r.errorString;this.bufferConfig.viewerError.setError(n,i)}}else null==this||null===(t=this.webViewer)||void 0===t||t.setDefaultError()}},{key:"emitViewerEvent",value:function(){var e,t;this.webViewer&&0===this.getHowManyImagesInBuffer()&&(null===(e=this.webViewer)||void 0===e||null===(t=e.myViewer)||void 0===t||t.emit("pageRendered",-1))}},{key:"bindViewer",value:function(e){this.webViewer=e}},{key:"getCurrentTag",value:function(){return this.currentTagName}},{key:"getCurrentDocument",value:function(){return this.currentFileName}},{key:"getCurrentFileName",value:function(){var e=this,t=this.space.getFileList(),r="";return t&&YO(t).call(t,(function(t){t.name===e.currentFileName&&(r=e.currentFileName)})),r}},{key:"getCurrentIndex",value:function(){if(this.webViewer)return this.webViewer.getCurrentIndex();var e=this.getSelectedImagesIndices().length;if(e<=0){var t=this.getCurrentDataSet();return!!t&&t.children.length-1}return this.getSelectedImagesIndices()[e-1]}},{key:"getHowManyImagesInBuffer",value:function(){if(this.webViewer)return this.webViewer.getHowManyImagesInBuffer();var e=this.getCurrentDataSet();return e?e.children.length:0}},{key:"getSelectedImagesIndices",value:function(){return this.webViewer?this.webViewer.getSelectedImagesIndices():this.currentSelected}},{key:"getIndexByUid",value:function(e){if(!FG(e)||!e)return this.setError("InvalidValue"),!1;if(this.webViewer)return this.webViewer.myViewer.getIndexByUid(e);var t=this.getCurrentDataSet(),r=t.children;return!!(t&&r&&RG(r))&&Mh(r).call(r,e)}},{key:"getUidByIndex",value:function(e){if(e<0||e>=this.getHowManyImagesInBuffer())return this.setError("IndexOutOfRange"),!1;if(this.webViewer)return this.webViewer.myViewer.getUidByIndex(e);var t=this.getCurrentDataSet().children;return!(t&&t.length<e)&&t[e]}},{key:"getDataByUid",value:function(e){return this.space.getSource(e)}},{key:"updateDataByUid",value:function(e,t){return this.space.store.set(e,t)}},{key:"setCustomDataByUid",value:function(e,t){return FG(e)&&""!==e?this.space.setCustomData(e,t):(this.setError("InvalidValue"),!1)}},{key:"getCustomDataByUid",value:function(e){return this.space.getCustomData(e)}},{key:"setMetadataByUid",value:function(e,t){return FG(e)&&""!==e?this.space.setMetadata(e,t):(this.setError("InvalidValue"),!1)}},{key:"getMetadataByUid",value:function(e){return this.space.getMetadata(e)}},{key:"addImage",value:function(e,t,r){var n,i,o={},a=this.currentFileName,s="";!xG(r)&&FG(r)?(this.IsFileNameExist(r)||this.createDocument(r),s=r):xG(a)||""===a?(this.space.isFileExisted("dynamsoft-default-document")||this.createDocument("dynamsoft-default-document"),this.webViewer&&(this.webViewer.bEmitBufferChanged=!1),this.openDocument("dynamsoft-default-document"),this.webViewer&&(this.webViewer.bEmitBufferChanged=!0),s="dynamsoft-default-document"):s=a,t&&(delete(i=DG({},t)).oriBlobData,t.oriBlobData&&(n=t.oriBlobData));var u=e.imageUrl,c=e.minImageUrl,l=e.imageId,d=e.serverId,f=e.uidFromServer,h=e.index;if(n&&(o=DG({},n)),l&&(o.imageId=l),d&&(o.serverId=d),f&&(o.uidFromServer=f),!xG(h)&&OG(h)){var g=this.getDocumentContents(s).length;h>=g&&(h=g)}var p=this.space.loadSource({data:[{oriData:u,minData:c,metadata:i,customData:o}],filename:s,index:h},(function(t){var r=yO(t,1)[0];e.uuid=r}));if(this.isActiveTag){var _=this.getHowManyImagesInBuffer();this.currentSelected=_>0?[_-1]:[]}else this.currentSelected=!xG(h)&&OG(h)?[h]:[];return p}},{key:"insertImage",value:function(e,t,r){var n;return r&&r>=0?(n=this.space.loadSource({data:[e],filename:t,index:r}))[0]&&(this.currentSelected=[r]):(n=this.space.loadSource({data:[e],filename:t}),this.currentSelected=[]),n[0]}},{key:"updateImage",value:function(e,t){var r=e.imageUrl,n=e.minImageUrl,i=e.imageId,o=e.serverId,a=e.uidFromServer,s=e.uuid,u=DG({},t);return s&&""!==s&&-1!==s?(this.space.updateSource(s,{oriData:r,minData:n,metadata:u,customData:{imageId:i,serverId:o,uidFromServer:a}}),s):(this.setError("IndexOutOfRange"),!1)}},{key:"removeImageByUid",value:function(e){if(this.e(),this.webViewer){var t=this.webViewer.removePageByUid(e);return this.webViewer.resized(),this.emitViewerEvent(),t}return this.space.removeSource(e)}},{key:"removeImageByIndex",value:function(e){if(this.e(),e<0||e>=this.getHowManyImagesInBuffer())return this.setError("IndexOutOfRange"),!1;var t=this.getCurrentIndex(),r=!1;if(this.webViewer)r=this.webViewer.removePageByIndexes(e),this.webViewer.resized(),this.emitViewerEvent();else{var n=this.getCurrentDataSet();if(!n)return!1;r=this.space.removeSource(n.children[e])}return r||this.setError("Default"),this.currentSelected=e===t&&0===e?this.getHowManyImagesInBuffer()>0?[0]:[]:e<=t?[t-1]:[t],r}},{key:"removeSelectedImages",value:function(e){this.e();var t=this.getSelectedImagesIndices();RG(e)&&e.length>0&&(t=e);var r=!1;if(this.webViewer)r=this.webViewer.removePageByIndexes(t),this.webViewer.resized(),this.emitViewerEvent();else{var n=[],i=this.getCurrentDataSet();if(!i)return!1;YO(t).call(t,(function(e){i.children[e]&&i.children[e]&&n.push(i.children[e])})),r=this.space.removeSource(n)}return r||this.setError("Default"),r}},{key:"removeImageByIndexArr",value:function(e){if(this.e(),!RG(e))return!1;var t=this.getCurrentDataSet();if(!t)return!1;var r,n=[];return YO(e).call(e,(function(e){var r=t.children[e];r&&n.push(r)})),(r=this.space.removeSource(n))||this.setError("Default"),this.webViewer&&(this.webViewer.resized(),this.emitViewerEvent()),this.currentSelected=[],r}},{key:"removeAllImages",value:function(){this.e();var e=!1;if(this.webViewer)e=this.webViewer.removeAllPages(),this.webViewer.resized(),this.emitViewerEvent();else{var t=this.getCurrentDataSet();t&&(e=this.space.removeSource(SO(t.children)))}return e||this.setError("Default"),this.currentSelected=[],e}},{key:"tagImages",value:function(e,t){this.e();var r=this.getHowManyImagesInBuffer();if(!RG(e))return this.setError("IndicesNotArray"),!1;if(!FG(t)||""===t)return this.setError("InvalidTagName"),!1;for(var n=0;n<r;n++){var i=e[n];if(ZO(i)||i<0||i>=r)return this.setError("IndexOutOfRange"),!1}this.space.createTag(t);for(var o=0;o<e.length;o++){var a=e[o];if(a>=0){var s=this.getUidByIndex(a);s&&""!==s&&-1!==Cg(s,10)&&this.space.addTagToSource(s,t)}}return!0}},{key:"removeImageTag",value:function(e,t){if(this.e(),!OG(e))return this.setError("InvalidValue"),!1;if(e<0||e>this.getHowManyImagesInBuffer())return this.setError("IndexOutOfRange"),!1;var r=this.getUidByIndex(e),n=!1;return r&&""!==r&&-1!==r&&(n=this.space.removeTagFromSource(r,t)),n||this.setError("Default"),n}},{key:"getDefaultTag",value:function(){return this.space.getDefaultTag()}},{key:"setDefaultTag",value:function(e){return this.e(),FG(e)?""===e?(this.space.setDefaultTag(null),!0):(this.space.createTag(e),(t=this.space.setDefaultTag(e))||this.setError("Default"),t):(this.setError("InvalidValue"),!1);var t}},{key:"removeTag",value:function(e,t){var r=this;if(this.e(),!FG(e))return this.setError("InvalidValue"),!1;if(!xG(t)&&!RG(t))return this.setError("IndicesNotArray"),!1;if(!this.space.isTagExisted(e))return this.setError("TagNotExist"),!1;var n=this.currentTagName,i=!1,o=!1;if(n&&(i=n===e),xG(t))o=this.space.removeTag(e),i&&this.clearFilter();else{var a=[];YO(t).call(t,(function(e){var t=r.getUidByIndex(e);-1!==t&&a.push(t)}));for(var s=0;s<(null==a?void 0:a.length);s++)if(!(o=this.space.removeTagFromSource(a[s],e)))return!1}return o||this.webViewer.setDefaultError(),o}},{key:"renameTag",value:function(e,t){return this.e(),xG(e)||""===e?(this.setError("OldTagNameRequired"),!1):xG(t)||""===t?(this.setError("NewTagNameRequired"),!1):this.space.isTagExisted(e)?this.space.isTagExisted(t)?(this.setError("TagExist"),!1):(e===this.currentTagName&&(this.currentTagName=t),(r=this.space.renameTag(e,t))?this.space.setDefaultTag(t):this.setError("Default"),r):(this.setError("TagNotExist"),!1);var r}},{key:"getTagContents",value:function(e){return this.e(),e&&FG(e)&&""!==e?this.space.getTag(e).children:[]}},{key:"getTagList",value:function(){var e=this;this.e();var t=this.space.getTagList(),r=[];return t?YO(t).call(t,(function(t){var n,i=[];YO(n=t.children).call(n,(function(t){var r=e.getCustomDataByUid(t);if(r){var n=r.uidFromServer;i.push(n)}})),r.push({name:t.name,imageIds:i})})):r=[],r}},{key:"getTagListByIndex",value:function(e){if(!OG(e))return!1;var t=this.getUidByIndex(e);return this.space.getSourceTags(t)}},{key:"clearFilter",value:function(){this.e(),this.currentTagName="",this.space.setDefaultTag(null);var e,t=this.getCurrentFileName();return""===t&&(t="dynamsoft-default-document"),(e=this.openDocument(t))||this.setError("Default"),e}},{key:"filterImagesByTag",value:function(e,t,r){this.e();var n=!1;if(xG(e)||null===e||""===e){this.currentTagName="";var i=this.getCurrentFileName();""===i&&(i="dynamsoft-default-document"),(n=this.openDocument(i))?WG(t)&&t():(this.setError("Default"),WG(r)&&r())}else{var o,a;if(!this.space.isTagExisted(e))return this.setError("TagNotExist"),WG(r)&&r(),!1;if(this.isActiveTag=!0,this.isActiveFile=!1,this.currentTagName=e,this.setDefaultTag(e),n=this.space.openTag(e,null==this||null===(o=this.webViewer)||void 0===o||null===(a=o.myViewer)||void 0===a?void 0:a.uid)){var s=this.space.getTag(e);if(s){var u,c=(null==s||null===(u=s.children)||void 0===u?void 0:u.length)||0;this.currentSelected=c>0?[c-1]:[]}WG(t)&&t()}else this.setError("Default"),WG(r)&&r()}return this.webViewer&&this.webViewer.render(),n}},{key:"createDocument",value:function(e){if(this.e(),!e||""===e){var t=OG(e)?"FileNameNotString":"FileNameCannotEmpty";return this.setError(t),!1}return FG(e)?this.space.isFileExisted(e)?(this.setError("FileExist"),!1):!!this.space.createFile(e)||(this.setError("Default"),!1):(this.setError("FileNameNotString"),!1)}},{key:"openDocument",value:function(e,t){var r,n;if(this.e(),!e||""===e){var i=OG(e)?"FileNameNotString":"FileNameCannotEmpty";return this.setError(i),!1}if(!FG(e))return this.setError("FileNameNotString"),!1;if(!this.space.isFileExisted(e))return this.setError("FileNotExist"),!1;var o=t&&""!==t?t:null==this||null===(r=this.webViewer)||void 0===r||null===(n=r.myViewer)||void 0===n?void 0:n.uid;if(!this.space.openFile(e,{viewerUid:o}))return this.setError("Default"),!1;this.currentFileName=e,this.isActiveFile=!0,this.isActiveTag=!1;var a=this.space.getFile(e);if(a){var s,u=null==a||null===(s=a.children)||void 0===s?void 0:s.length;this.currentSelected=u>0?[u-1]:[]}return!0}},{key:"getDocumentContents",value:function(e){return this.e(),e&&FG(e)&&""!==e?this.space.getFile(e).children:[]}},{key:"renameDocument",value:function(e,t){return this.e(),FG(e)&&FG(t)?(e&&""!==e&&t&&""!==t||this.setError("FileNameCannotEmpty"),this.space.isFileExisted(e)?this.space.isFileExisted(t)?(this.setError("FileExist"),!1):this.space.renameFile(e,t)?(this.currentFileName===e&&(this.currentFileName=t),!0):(this.setError("Default"),!1):(this.setError("FileNotExist"),!1)):(this.setError("FileNameNotString"),!1)}},{key:"removeDocument",value:function(e){if(this.e(),!e||!FG(e))return this.setError("FileNameNotString"),!1;if(!this.space.isFileExisted(e))return this.setError("FileNotExist"),!1;var t=this.space.removeFile(e);return t?(t&&this.webViewer&&this.webViewer.resized(),this.currentFileName===e&&(this.currentFileName=""),!0):(this.setError("Default"),!1)}},{key:"getDocumentInfoList",value:function(){var e=this;this.e();var t=this.space.getFileList(),r=[];return t?(YO(t).call(t,(function(t){if(t.children){for(var n=[],i=0;i<t.children.length;i++){var o=t.children[i],a=e.getCustomDataByUid(o);if(a){var s=a.uidFromServer;n.push(s)}}r.push({imageIds:n,name:t.name})}})),r):[]}},{key:"getDocumentInfo",value:function(e){this.e();var t=this.space.getFile(e);if(!t)return{imageIds:[],length:0};for(var r=[],n=0;n<t.children.length;n++){var i=t.children[n],o=this.getCustomDataByUid(i);if(o){var a=o.uidFromServer;r.push(a)}}return{imageIds:r,length:r.length}}},{key:"selectImages",value:function(e){this.e();var t=!0;if(!e||!RG(e))return!1;if(this.webViewer){var r=this.webViewer.getIfAutoScroll();!1===r&&this.webViewer.setIfAutoScroll(!0),t=this.webViewer.selectPages(e),!1===r&&this.webViewer.setIfAutoScroll(!1)}else{for(var n=this.getHowManyImagesInBuffer(),i=0;i<e.length;i++)if(!OG(e[i])||e[i]<0||e[i]>=n)return this.setError("ParameterOutRange"),!1;t=!0}return t?this.currentSelected=e:this.setError("Default"),t}},{key:"selectAllImages",value:function(){this.e();var e=!0;if(this.webViewer)e=this.webViewer.myViewer.selectAll(),this.currentSelected=this.webViewer.getSelectedImagesIndices();else{var t,r=this.getCurrentDataSet();this.currentSelected=oU(zh(t=new Array(r.children.length)).call(t))}return e||this.setError("Default"),e}},{key:"moveImage",value:function(e,t){this.e();var r=Cg(e,10),n=Cg(t,10);if(ZO(e)||ZO(t))return this.setError("InvalidIndex"),!1;var i=this.getHowManyImagesInBuffer();if(r<0||r>=i||n<0||n>i)return this.setError("IndexOutOfRange"),!1;var o=!1;if(this.webViewer)o=this.webViewer.myViewer.movePage(e,t);else{var a=this.getCurrentDataSet();if(!a)return!1;o=this.space.move({docUid:a.uid,type:a.type,from:e,to:t})}return o||this.setError("Default"),this.currentSelected=[t],o}},{key:"switchImage",value:function(e,t){this.e();var r=Cg(e,10),n=Cg(t,10);if(ZO(e)||ZO(t))return this.setError("InvalidIndex"),!1;var i=this.getHowManyImagesInBuffer(),o=this.getCurrentIndex();if(r<0||r>=i||n<0||n>i)return this.setError("IndexOutOfRange"),!1;var a=!1;if(this.webViewer)a=this.webViewer.myViewer.switchPage(e,t);else{var s=this.getCurrentDataSet();if(!s)return!1;a=this.space.switch({docUid:s.uid,type:s.type,one:e,other:t})}a||this.setError("Default");var u=o;return r===o?u=n:n===o&&(u=r),this.currentSelected=[u],a}},{key:"moveImageToFile",value:function(e,t,r,n){if(!this.space.isFileExisted(e)||!this.space.isFileExisted(r))return this.setError("FileNotExist"),!1;t=SO(new wG(t));var i=this.getDocumentInfo(e).length;if(!RG(t)||t.length>i)return this.setError("ParameterOutRange"),!1;var o=this.getDocumentInfo(r).length,a=this.space.movePagesToFile(e,t,r,n);if(!this.webViewer&&this.isActiveFile){var s=this.getHowManyImagesInBuffer();e===this.currentFileName&&(this.currentSelected=s>0?[s-1]:[]),r===this.currentFileName&&(OG(n)&&n<o&&n>=0?this.currentSelected=[n+t.length-1]:this.currentSelected=s>0?[s-1]:[])}return a}}]),e}();HTMLCanvasElement.prototype.toBlob||EG(HTMLCanvasElement.prototype,"toBlob",{value:function(e,t,r){for(var n=atob(this.toDataURL(t,r).split(",")[1]),i=n.length,o=new Uint8Array(i),a=0;a<i;a++)o[a]=n.charCodeAt(a);e(new Blob([o],{type:t||"image/png"}))}});var dj,fj,hj=s((function e(r){if(t(this,e),r)this._baseUrl=r._baseUrl,this._buffer=r._buffer,this._serverIdMap=r._serverIdMap,this._uidMap=r._uidMap;else{var n={viewerError:{setError:function(e,t){xt.log(e,t),this._error={code:e,message:t}}}};this._baseUrl="",this._buffer=new lj(n),this._serverIdMap={},this._uidMap={}}}),[{key:"getError",value:function(){return this._error}},{key:"BaseUrl",get:function(){return this._baseUrl}},{key:"getImageUrl",value:function(e){var t=this.convertClientIndexToServerId(e),r=Date.now();return dR.getImageUrl(this._baseUrl,t,-1,-1,r)}},{key:"getMinImageUrl",value:function(e,t,r){var n=this.convertClientIndexToServerId(e),i=Date.now();return n&&t&&r?dR.getImageUrl(this._baseUrl,n,parseInt(t),parseInt(r),i):""}},{key:"append",value:function(e,t,r,n,i){var o,a,s,u,c=Date.now(),l=t,d=r;if(o={imageId:l,serverId:t,uidFromServer:d,imageUrl:s=dR.getImageUrl(this._baseUrl,l,-1,-1,c),minImageUrl:a=n&&n.controlWidth&&n.controlWidth>0&&n.controlHeight&&n.controlHeight>0?Wt.navInfoSync.bMobile?dR.getImageUrl(this._baseUrl,l,Math.round(n.controlWidth*devicePixelRatio),Math.round(n.controlHeight*devicePixelRatio),c):dR.getImageUrl(this._baseUrl,l,parseInt(n.controlWidth),parseInt(n.controlHeight),c):s},u=n.currentFileName.length>0?this._buffer.addImage(o,n,n.currentFileName):this._buffer.addImage(o,n)){var f=Rk(u,1)[0],h=this._buffer.getCustomDataByUid(f);return h.serverId=l,h.uidFromServer=d,this._innerInsertModel(l,d,f,s,a),f}return!1}},{key:"insertBefore",value:function(e,t,r,n,i){var o,a,s,u=Date.now(),c=r,l=n;o={index:e,imageId:c,serverId:c,uidFromServer:l,imageUrl:s=dR.getImageUrl(this._baseUrl,c,-1,-1,u),minImageUrl:a=i&&i.controlWidth&&i.controlWidth>0&&i.controlHeight&&i.controlHeight>0?Wt.navInfoSync.bMobile?dR.getImageUrl(this._baseUrl,c,Math.round(i.controlWidth*devicePixelRatio),Math.round(i.controlHeight*devicePixelRatio),u):dR.getImageUrl(this._baseUrl,c,parseInt(i.controlWidth),parseInt(i.controlHeight),u):s};var d=this._buffer.addImage(o);if(d){var f=Rk(d,1)[0],h=this._buffer.getCustomDataByUid(f);return h.serverId=c,h.uidFromServer=l,this._innerInsertModel(c,l,f,s,a),this._buffer.openDocument(this.getCurrentFileName()),f}return!1}},{key:"_innerInsertModel",value:function(e,t,r,n,i){var o=new xk;o.serverId=e,o.uidFromServer=t,o.uuid=r,o.imageUrl=n,o.minImageUrl=i,this._serverIdMap[e]=o,this._uidMap[t]=o}},{key:"refresh",value:function(e,t,r,n){var i=1*e;if(r){var o=this.count();if(i<0||i>o)return!1;this._setDataImageControl(i,n)}return!0}},{key:"refreshByImageId",value:function(e,t,r){var n=e;return t&&this._setDataImageControl(n,r,!0),!0}},{key:"_setDataImageControl",value:function(e,t,r){var n,i,o,a,s,u,c=this,l=c._baseUrl;if(r)s=e;else if(s=(a=c.getCustomDataByIndex(e)).serverId,u=a.uidFromServer,s<=0)return!1;if((n=c.getImageIdMap(s))||((n=new xk).serverId=s,n.uidFromServer=u,c._serverIdMap[s]=n,c._uidMap[u]=n),l){null!=n&&(n.ticks=Date.now()),i=dR.getImageUrl(l,s,-1,-1,n.ticks),o=t&&t.controlWidth&&t.controlWidth>0&&t.controlHeight&&t.controlHeight>0?Wt.navInfoSync.bMobile?dR.getImageUrl(l,s,Math.round(t.controlWidth*devicePixelRatio),Math.round(t.controlHeight*devicePixelRatio),n.ticks):dR.getImageUrl(l,s,parseInt(t.controlWidth),parseInt(t.controlHeight),n.ticks):i,n.imageUrl=i,n.minImageUrl=o;var d=xt.clone(n);d.imageId=s,c._buffer.updateImage(d,t)}return!0}},{key:"convertIndicesToServerIds",value:function(e){var t,r=e.length,n=[];for(t=0;t<r;t++){var i=this.convertClientIndexToServerId(e[t]);-1!=i&&n.push(i)}return n}},{key:"removeImagesByServerId",value:function(e,t){var r=this,n=null!=t?t:this._buffer.getCurrentDocument(),i=[];return xt.each(e,(function(e,t){var o,a=parseInt(e);return r._removeMapModelImageControlByServerId(a),o=r._buffer.isActiveFile?r._convertServerIdToIndexInFile(n,a):r._convertServerIdToIndex(a),!isNaN(o)&&!(o<0||o>=r.count())&&void i.push(o)})),i.length>0&&r._buffer.removeImageByIndexArr(i)}},{key:"removeByServerId",value:function(e,t,r){var n,i=this,o=null!=r?r:this._buffer.getCurrentDocument();return i._removeMapModelImageControlByServerId(e),n=this._buffer.isActiveFile?this._convertServerIdToIndexInFile(o,e):t,!isNaN(n)&&!(n<0||n>=i.count())&&i._buffer.removeImageByIndex(n)}},{key:"exists",value:function(e){if(this._serverIdMap[e])return!0;var t=-1;if(this._buffer.isActiveFile){var r=this.getCurrentFileName();t=this._convertServerIdToIndexInFile(r,e)}else t=this._convertServerIdToIndex(e);return t>-1}},{key:"removeImages",value:function(e){var t,r,n;for(n=e.length,t=0;t<n;t++)r=this.convertClientIndexToServerId(e[t]),this._removeMapModelImageControlByServerId(r);return this._buffer.removeSelectedImages(e)}},{key:"clear",value:function(){var e,t,r,n=this;for(r=n.count(),e=0;e<r;e++)t=n.convertClientIndexToServerId(e),this._removeMapModelImageControlByServerId(t);return r==Object.keys(n._serverIdMap).length&&(n._serverIdMap={},n._uidMap={}),n._buffer.removeAllImages()}},{key:"_uidFromServer2index",value:function(e){var t,r,n,i=this;if((n=i._uidMap[e])&&(r=n.uuid),r&&-1!=r)t=i._buffer.getIndexByUid(r);else if(i._buffer.isActiveFile){var o=this.getCurrentFileName();t=this._convertUidFromServerToIndexInFile(o,e)}else t=this._convertUidFromServerToIndex(e);return xt.isNumber(t)||(t=-1),t}},{key:"_serverId2uidFromServer",value:function(e){if(e&&e>0){var t,r,n;if((n=this._serverIdMap[e])&&(r=n.uidFromServer))return r;if((t=this.convertServerIdToClientIndex(e))>=0)return this._index2uidFromServer(t)}return-1}},{key:"_uidFromServer2ServerId",value:function(e){if(e){var t,r,n;if((n=this._uidMap[e])&&(r=n.serverId))return r;if((t=this._uidFromServer2index(e))>=0)return this.convertClientIndexToServerId(t)}return-1}},{key:"_index2uidFromServer",value:function(e){var t=this.getCustomDataByIndex(e);return t?t.uidFromServer:-1}},{key:"convertServerIdToClientIndex",value:function(e){var t,r,n,i=this;if((n=i._serverIdMap[e])&&(r=n.uuid),r&&-1!=r)t=i._buffer.getIndexByUid(r);else if(i._buffer.isActiveFile){var o=this.getCurrentFileName();t=this._convertServerIdToIndexInFile(o,e)}else t=this._convertServerIdToIndex(e);return xt.isNumber(t)||(t=-1),t}},{key:"getIndexByUid",value:function(e){var t;return!1===(t=this._buffer.getIndexByUid(e))?-1:t}},{key:"getUidByIndex",value:function(e){return this._buffer.getUidByIndex(e)}},{key:"convertClientIndexToServerId",value:function(e){var t=this.getCustomDataByIndex(e);return t?t.serverId:-1}},{key:"getCurrentImageIndex",value:function(){return this._buffer.getCurrentIndex()}},{key:"setCurrentImageIndex",value:function(e){return this._buffer.selectImages([e])}},{key:"getCurrentFileName",value:function(){return this._buffer.getCurrentFileName()}},{key:"setDefaultTag",value:function(e){return this._buffer.setDefaultTag(e)}},{key:"getDefaultTag",value:function(){return this._buffer.getDefaultTag()}},{key:"count",value:function(){return this._buffer.getHowManyImagesInBuffer()}},{key:"getCountByDocumentName",value:function(e){return this._buffer.getDocumentInfo(e).length}},{key:"dispose",value:function(){this.clear()}},{key:"getImageData",value:function(e){var t=this._buffer.getUidByIndex(e);return t?this._buffer.getDataByUid(t):Dt.Promise.resolve(null)}},{key:"getCustomDataByIndex",value:function(e){return this._buffer.getCustomDataByUid(this._buffer.getUidByIndex(e))}},{key:"getMetadataByIndex",value:function(e){return this._buffer.getMetadataByUid(this._buffer.getUidByIndex(e))}},{key:"setCustomData",value:function(e,t){var r=this._buffer.getUidByIndex(e);return!(!r||!t)&&this._buffer.setCustomDataByUid(r,t)}},{key:"openDocument",value:function(e){return this._buffer.openDocument(e)}},{key:"createDocument",value:function(e){return this._buffer.createDocument(e)}},{key:"getImageIdMap",value:function(e){return this._serverIdMap[e]}},{key:"_removeMapModelImageControlByServerId",value:function(e){var t=this;if(e>0&&t._serverIdMap[e]){var r=t._serverIdMap[e],n=r.uidFromServer;r.Clear(),delete t._serverIdMap[e],delete t._uidMap[n]}}},{key:"_convertServerIdToIndexInFile",value:function(e,t){var r,n,i=-1;for(r=this._buffer.getDocumentContents(e),n=0;n<r.length;n++){var o=r[n];if(o){var a=this._buffer.getCustomDataByUid(o);if(a&&a.serverId==t){i=n;break}}}return i}},{key:"_convertServerIdToIndex",value:function(e){var t,r=-1;for(t=0;t<this.count();t++){var n=this._buffer.getUidByIndex(t);if(n){var i=this._buffer.getCustomDataByUid(n);if(i&&i.serverId==e){r=t;break}}}return r}},{key:"_convertUidFromServerToIndexInFile",value:function(e,t){var r,n,i=-1;for(r=this._buffer.getDocumentContents(e),n=0;n<r.length;n++){var o=r[n];if(o){var a=this._buffer.getCustomDataByUid(o);if(a&&a.uidFromServer==t){i=n;break}}}return i}},{key:"_convertUidFromServerToIndex",value:function(e){var t,r=-1;for(t=0;t<this.count();t++){var n=this._buffer.getUidByIndex(t);if(n){var i=this._buffer.getCustomDataByUid(n);if(i&&i.uidFromServer==e){r=t;break}}}return r}},{key:"convertUUIDToServerId",value:function(e){var t=this._buffer.getCustomDataByUid(e);return t&&-1!=t.serverId?t.serverId:-1}},{key:"UpdateImage",value:function(e,t){return this._buffer.updateImage(e,t),!0}}],[{key:"_setBaseUrl",value:function(e,t){e._baseUrl=t}},{key:"_getBuffer",value:function(e){return e._buffer}}]),gj=function(e){function r(e){var n,i,o,a;t(this,r),i=this,a=[e],o=QE(o=r),(n=YE(i,function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(QG){return!1}}()?Reflect.construct(o,a||[],QE(i).constructor):o.apply(i,a))).__IfAppendImage=Bb,n.__maxImagesInBuffer=32767,n.__insertingIndex=-1,n._aryBitmapCache=[],n._imageBufferWrapper=new hj;var s=Xx.getServerImageUrlPrefix(n);return hj._setBaseUrl(n._imageBufferWrapper,s),n}return qE(r,e),s(r,[{key:"_registerMultiEvent",value:function(e,t){var r=this;if(r._resetErr(),!r._isValid())return!1;var n=["_$",e].join("");r[n]||(r[n]={});var i=r[n],o=xt.guid();return i[o]=t,o}},{key:"_unregisterMultiEvent",value:function(e,t){var r=this;if(r._resetErr(),!r._isValid())return!1;var n=["_$",e].join(""),i=r[n];if(t){var o;if(xt.isString(t))return delete i[t],Bb;if(xt.isFunction(t))for(o=0;o<i.length;o++)if(t==i[o])return i.splice(o,1),Bb}return r[n]=null,Bb}},{key:"_getMetadata",value:function(e){return this._imageBufferWrapper.getMetadataByIndex(e)}},{key:"_updateImage",value:function(e,t,r){var n,i,o,a,s=fx.Auto,u=this;return r&&(void 0!=r.width&&(o=parseInt(r.width)),void 0!=r.height&&(a=parseInt(r.height)),s=xt.isNumber(o)&&xt.isNumber(a)&&t.byteLength===o*a*4?fx.RGBA:fx.Auto),n={imageId:e,serverId:e,bufferLen:t.byteLength,imageType:s},r&&s==fx.RGBA&&(n.width=o,n.height=a,void 0!=r.bitDepth&&(n.bit=r.bitDepth),void 0!=r.resolutionX&&(n.xres=parseInt(r.resolutionX)),void 0!=r.resolutionY&&(n.yres=parseInt(r.resolutionY)),void 0!=r.uid&&(n.uidFromServer=r.uid)),i=xt.stringify([xt.stringify(n)]),new Dt.Promise((function(e,r){u._innerSendBlobByWS("UpdateImage",i,t,(function(t){xt.log("UpdateImage success."),e(t)}),(function(e){xt.log("UpdateImage failed."),xt.error(e),r({code:u._errorCode,message:u._errorString})}))}))}},{key:"_removeImages",value:function(e){return this._imageBufferWrapper.removeImages(e)}},{key:"_getCurrentDocumentName",value:function(){var e="";return this._imageBufferWrapper&&(e=this._imageBufferWrapper.getCurrentFileName()),e}},{key:"_getCurrentDefaultTagName",value:function(){var e="";return this._imageBufferWrapper&&(e=this._imageBufferWrapper.getDefaultTag()||""),e}},{key:"_innerRefreshUI",value:function(e,t,r,n,i){var o=this;return r&&o._imageBufferWrapper.refresh(e,o._imageBufferWrapper.count(),!0,n),xt.isFunction(o.__OnRefreshUI)&&o.__OnRefreshUI(o._imageBufferWrapper.getCurrentImageIndex(),o._imageBufferWrapper.count()),!0}},{key:"_innerRefreshUIByImageId",value:function(e,t,r,n){var i=this;return t&&i._imageBufferWrapper.refreshByImageId(e,!0,r),xt.isFunction(i.__OnRefreshUI)&&i.__OnRefreshUI(i._imageBufferWrapper.getCurrentImageIndex(),i._imageBufferWrapper.count()),!0}},{key:"_getHowManyImagesInBuffer",value:function(){return this._isValid()?this._imageBufferWrapper.count():0}},{key:"_OnBitmapChanged",value:function(e,t,r){var n,i,o,a=this,s="m1"==e[0],u="c1"==e[0],c="c2"==e[0],l=u||c||s,d=e[1].split(","),f=e[2],h=e[3],g=a.__maxImagesInBuffer,p=-1,_=!1,m=[];if(r&&(n=r.document,i=r.tag,r.bNeedClearTag&&(o=r.bNeedClearTag)),xt.log("_OnBitmapChanged.currentFileName="+n+", tag="+i),n?n!=a._getCurrentDocumentName()&&(_=!0):n=a._getCurrentDocumentName(),a._imageBufferWrapper&&(i?(a._imageBufferWrapper.setDefaultTag(i),xt.log("metaDataObj.currentTag="+i)):o&&(a._imageBufferWrapper.setDefaultTag(""),xt.log("metaDataObj.currentTag=''"))),s);else if(c)e.length>5&&(m=e[5]),xt.isArray(m)||(m=[]);else{var v={};if(e.length>5&&(v.width=e[5]),e.length>6&&(v.height=e[6]),e.length>7&&(v.bitDepth=e[7]),e.length>8&&(v.resolutionX=e[8]),e.length>9&&(v.resolutionY=e[9]),e.length>10&&(p=e[10]),e.length>11&&xt.isString(e[11])&&(v.uidFromServer=e[11]),m.push(v),p>-1&&a._canConsume()&&(f==sk.enumBCAppend||f==sk.enumBCInsert)){var y=Wt.DWT.lgct(p);xt.isFunction(a.__OnLtsverify)&&a.__OnLtsverify(y,1)}}if(xt.log("OnBitmapChanged:"+e),f==sk.enumBCInsert||f==sk.enumBCAppend&&!a.__IfAppendImage)xt.each(d,(function(e,t){var r,i,o=parseInt(e),s=a._imageBufferWrapper.getCurrentImageIndex();if(t<m.length&&m[t]?(r=(i=m[t]).uidFromServer,delete i.uidFromServer):i={},i.currentFileName=n,isNaN(o)||o<0)return!0;if(l)a._aryBitmapCache.push(o);else for(var u=0;u<a._aryBitmapCache.length;u++)if(a._aryBitmapCache[u]==o)return a._aryBitmapCache.splice(u,1),!0;if(a._imageBufferWrapper.exists(o))return!0;a.__insertingIndex>-1&&(s=a.__insertingIndex),i.controlWidth=400,i.controlHeight=400,a._controlWidth&&a._controlWidth>400&&(i.controlWidth=a._controlWidth),a._controlHeight&&a._controlHeight>400&&(i.controlHeight=a._controlHeight),-1==s&&(s=0),a._imageBufferWrapper.insertBefore(s,g,o,r,i),a.__insertingIndex>-1&&(a.__insertingIndex=a.__insertingIndex+1)})),xt.isFunction(a.__OnRefreshUI)&&a.__OnRefreshUI(a._imageBufferWrapper.getCurrentImageIndex(),a._imageBufferWrapper.count());else if(f==sk.enumBCAppend&&a.__IfAppendImage)xt.each(d,(function(e,t){var r,i,o=parseInt(e);if(isNaN(o)||o<0)return!0;if(t<m.length&&m[t]?(r=(i=m[t]).uidFromServer,delete i.uidFromServer):i={},i.currentFileName=n,xt.log("metaDataObj.currentFileName="+n),l)a._aryBitmapCache.push(o);else for(var s=0;s<a._aryBitmapCache.length;s++)if(a._aryBitmapCache[s]==o)return a._aryBitmapCache.splice(s,1),!0;if(a._imageBufferWrapper.exists(o))return!0;i.controlWidth=400,i.controlHeight=400,a._controlWidth&&a._controlWidth>400&&(i.controlWidth=a._controlWidth),a._controlHeight&&a._controlHeight>400&&(i.controlHeight=a._controlHeight),_?a._imageBufferWrapper.append(g,o,r,i,n):a._imageBufferWrapper.append(g,o,r,i)})),xt.isFunction(a.__OnRefreshUI)&&a.__OnRefreshUI(a._imageBufferWrapper.getCurrentImageIndex(),a._imageBufferWrapper.count());else if(f==sk.enumBCRemove&&l){var S=!1;if(1==d.length&&-1==d[0]&&(S=!0),S)a._imageBufferWrapper.clear();else{var T=[];xt.each(d,(function(e,t){var r=parseInt(e);if(isNaN(r)||r<0)return!0;T.push(r)})),a._imageBufferWrapper.removeImagesByServerId(T,n)}xt.isFunction(a.__OnRefreshUI)&&a.__OnRefreshUI(a._imageBufferWrapper.getCurrentImageIndex(),a._imageBufferWrapper.count())}else if(f==sk.enumBCEdit||f==sk.enumBCUpdate)xt.each(d,(function(e,t){var i,o=parseInt(e);if(isNaN(o)||o<0)return!0;if(t<m.length&&m[t]?delete(i=m[t]).uidFromServer:i={},i.currentFileName=n,o>=0&&!a.__bLoadingImage){var s=a._imageBufferWrapper.convertServerIdToClientIndex(o);s>-1?a._innerRefreshUI(s,a._imageBufferWrapper.count(),!0,i,f):r.bNeedRefresh&&a._innerRefreshUIByImageId(o,!0,i,f)}}));else if(f==sk.enumBCIndexChange){var I;h>=0&&!a.__bLoadingImage&&((I=0<m.length&&m[0]?m[0]:{}).currentFileName=n,0==a.__IfAppendImage&&a._innerRefreshUI(h,a._imageBufferWrapper.count(),!0,I,f),a._imageBufferWrapper.refresh(h,a._imageBufferWrapper.count(),!1,I))}if(xt.isFunction(a.__OnBitmapChanged)){if(!s)if(l){if(f==sk.enumBCRemove);else if(!Y.bFirefox&&l)return!0}else{if(f==sk.enumBCRemove)return!0;if(Y.bFirefox&&!l)return!0}var b=[];xt.each(d,(function(e){var t,r=parseInt(e);if(isNaN(r)||r<0)return!0;(t=a._imageBufferWrapper.convertServerIdToClientIndex(r))>-1&&b.push(t)}));var C=a._imageBufferWrapper.getCurrentImageIndex(),w=f;f==sk.enumBCAppend&&(w=a.__IfAppendImage?sk.enumBCAppend:sk.enumBCInsert),a.__OnBitmapChanged(b,w,C,a._imageBufferWrapper.count())}}},{key:"_removeImageAsync",value:(i=GE(m.mark((function e(t,r){var n,i,o;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this,i=parseInt(r),Ik(n,i)){e.next=4;break}return e.abrupt("return",!1);case 4:return o=n._imageBufferWrapper.convertClientIndexToServerId(i),e.next=7,n._removeImageByIdAsync(o);case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e,this)}))),function(e,t){return i.apply(this,arguments)})},{key:"_removeImageByIdAsync",value:(n=GE(m.mark((function e(t){var r,n;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this,-1!=t){e.next=4;break}return Gw(r),e.abrupt("return",!1);case 4:return e.next=6,r._innerFunV2("RemoveImage",mR(t));case 6:return((n=e.sent)||-1033==r._errorCode)&&r._OnBitmapChanged(["c1",""+t,3,r._imageBufferWrapper.getCurrentImageIndex(),r._imageBufferWrapper.count()]),e.abrupt("return",n);case 9:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})}]);var n,i}(Xx);!function(e){e.Text=0,e.Blob=1,e.ArrayBuffer=2,e.XML=3,e.JSON=4,e.UserDefined=5}(dj||(dj={})),function(e){e.Other=0,e.HTTPUpload=1,e.HTTPDownload=2,e.FTPUpload=3,e.FTPDownload=4,e.Scan=5,e.LoadImage=6,e.ConvertToBlob=7,e.HTTPPut=8}(fj||(fj={}));var pj={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[+-]/};function _j(e,t){if(xt.isFunction("_".repeat))return e.repeat(t);for(var r=0,n=[];r<t;r++)n.push(e);return n.join("")}var mj,vj=Object.create?Object.create(null):{};function yj(t,r,n,i){return function(t,r){var n,i,o,a,s,u,c,l,d,f=1,h=t.length,g="";for(i=0;i<h;i++)if("string"==typeof t[i])g+=t[i];else if("object"===e(t[i])){if((a=t[i]).keys)for(n=r[f],o=0;o<a.keys.length;o++){if(void 0==n)throw new Error(yj('[sprintf] Cannot access property "%s" of undefined value "%s"',a.keys[o],a.keys[o-1]));n=n[a.keys[o]]}else n=a.param_no?r[a.param_no]:r[f++];if(pj.not_type.test(a.type)&&pj.not_primitive.test(a.type)&&n instanceof Function&&(n=n()),pj.numeric_arg.test(a.type)&&"number"!=typeof n&&isNaN(n))throw new TypeError(yj("[sprintf] expecting number but found %T",n));switch(pj.number.test(a.type)&&(l=n>=0),a.type){case"b":n=parseInt(n,10).toString(2);break;case"c":n=String.fromCharCode(parseInt(n,10));break;case"d":case"i":n=parseInt(n,10);break;case"j":n=xt.stringify(n,null,a.width?parseInt(a.width):0);break;case"e":n=a.precision?parseFloat(n).toExponential(a.precision):parseFloat(n).toExponential();break;case"f":n=a.precision?parseFloat(n).toFixed(a.precision):parseFloat(n);break;case"g":n=a.precision?String(Number(n.toPrecision(a.precision))):parseFloat(n);break;case"o":n=(parseInt(n,10)>>>0).toString(8);break;case"s":n=String(n),n=a.precision?n.substring(0,a.precision):n;break;case"t":n=String(!!n),n=a.precision?n.substring(0,a.precision):n;break;case"T":n=Object.prototype.toString.call(n).slice(8,-1).toLowerCase(),n=a.precision?n.substring(0,a.precision):n;break;case"u":n=parseInt(n,10)>>>0;break;case"v":n=n.valueOf(),n=a.precision?n.substring(0,a.precision):n;break;case"x":n=(parseInt(n,10)>>>0).toString(16);break;case"X":n=(parseInt(n,10)>>>0).toString(16).toUpperCase()}pj.json.test(a.type)?g+=n:(!pj.number.test(a.type)||l&&!a.sign?d="":(d=l?"+":"-",n=n.toString().replace(pj.sign,"")),u=a.pad_char?"0"===a.pad_char?"0":a.pad_char.charAt(1):" ",c=a.width-(d+n).length,s=a.width&&c>0?_j(u,c):"",g+=a.align?d+n+s:"0"===u?d+s+n:s+d+n)}return g}(function(e){if(vj[e])return vj[e];for(var t,r=e,n=[],i=0;r;){if(null!==(t=pj.text.exec(r)))n.push(t[0]);else if(null!==(t=pj.modulo.exec(r)))n.push("%");else{if(null===(t=pj.placeholder.exec(r)))throw new SyntaxError("[sprintf] unexpected placeholder");if(t[2]){i|=1;var o=[],a=t[2],s=[];if(null===(s=pj.key.exec(a)))throw new SyntaxError("[sprintf] failed to parse named argument key");for(o.push(s[1]);""!==(a=a.substring(s[0].length));)if(null!==(s=pj.key_access.exec(a)))o.push(s[1]);else{if(null===(s=pj.index_access.exec(a)))throw new SyntaxError("[sprintf] failed to parse named argument key");o.push(s[1])}t[2]=o}else i|=2;if(3===i)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");n.push({placeholder:t[0],param_no:t[1],keys:t[2],sign:t[3],pad_char:t[4],align:t[5],width:t[6],precision:t[7],type:t[8]})}r=r.substring(t[0].length)}return vj[e]=n,n}(t),arguments)}function Sj(e,t){if(xt.isString(e)){var r,n,i,o,a,s=e.indexOf("<%");if(-1==s)return e;if(n=e.substring(0,s),!(s+2<(r=e.indexOf(">",n))))return e;i=e.substring(s+1,r),o=e.substring(r+1);try{a=yj(i,t)}catch(ij){a=""}return[n,a,o].join("")}return""}function Tj(e,t){var r,n=e.substring(e.lastIndexOf(".")).toLowerCase();if(t==Wt.DWT.EnumDWT_ImageType.IT_BMP){if(".bmp"==n||".dib"==n)return e;r=[e,".bmp"].join("")}else if(t==Wt.DWT.EnumDWT_ImageType.IT_JPG){if(".jpg"==n||".jpe"==n||".jpeg"==n||".jfif"==n)return e;r=[e,".jpg"].join("")}else if(t==Wt.DWT.EnumDWT_ImageType.IT_PNG){if(".png"==n)return e;r=[e,".png"].join("")}else if(t==Wt.DWT.EnumDWT_ImageType.IT_TIF){if(".tif"==n||".tiff"==n)return e;r=[e,".tif"].join("")}else if(t==Wt.DWT.EnumDWT_ImageType.IT_PDF){if(".pdf"==n)return e;r=[e,".pdf"].join("")}else if(t==Wt.DWT.EnumDWT_ImageType.IT_J2K){if(".jp2"==n)return e;r=[e,".jp2"].join("")}return r}function Ij(e,t,r,n){var i,o,a,s,u=t.url,c=t.headers,l=t.retry,d=t.httpFormData,f=t.bOnlyResponseEmptyIsOK,h=t.bAsync,g=(o=t.responseType)==dj.Text?"text":o==dj.JSON?"json":o==dj.Blob?"blob":o==dj.ArrayBuffer?"arraybuffer":o==dj.XML?"xml":5==o?"user-defined":"text",p=e.IfShowProgressBar,_=e.IfShowCancelDialogWhenImageTransfer,m=e.objUploadStatus;(i=t.content)&&(i.remoteFilename||(i.remoteFilename=t.remoteFilename),i.fileName||(i.fileName=t.fileName||i.name),i.name||(i.name=t.fileName||i.fileName));var v,y=new HP({action:u,data:d,async:h,retry:l,bOnlyResponseEmptyIsOK:f,dataType:g});if(_&&Dt.progressContext&&(v=Dt.progressContext.on("cancel",(function(){y.abort(),y=null}))),(a=y._uploadType)&&(s=a.get("ajaxConfig"),c&&s&&s.headers&&c&&xt.mix(s.headers,c),e.HTTPRequestswithCredentials&&xt.mix(s.xhrFields,{withCredentials:!0}),s=null),y.on(HP.event.SUCCESS,(function(n){var i;(t.content=null,y=null,v&&Dt.progressContext.off("cancel",v),n?e.HTTPPostResponse=n.response:t.responseType==dj.ArrayBuffer?e.HTTPPostResponse=[]:t.responseType==dj.Blob?e.HTTPPostResponse=new Blob([]):t.responseType==dj.JSON?e.HTTPPostResponse={}:e.HTTPPostResponse="",xt.isFunction(e.onHttpUploadStatus))&&(i={fileName:n.name,percentage:100,statusCode:200,responseString:e.HTTPPostResponse},e.onHttpUploadStatus(i));xt.isFunction(r)&&r(e.HTTPPostResponse)})),y.on(HP.event.ERROR,(function(r){t.content=null,y=null;var i=r&&r.canceled;r&&r.timeout;var o="",a=0;v&&Dt.progressContext.off("cancel",v),r&&xt.isString(r.response)?e.HTTPPostResponse=r.response:e.HTTPPostResponse="",i||(r&&r.msg&&(o=r.msg),r&&r.httpStatus&&(a=r.httpStatus));var s,u={};ww(u,i,o,a),xt.isFunction(e.onHttpUploadStatus)&&(s={fileName:r.name,percentage:100,statusCode:a,responseString:e.HTTPPostResponse},e.onHttpUploadStatus(s)),xt.isFunction(n)&&n(u._errorCode,u._errorString,e.HTTPPostResponse)})),(p||xt.isFunction(e.onHttpUploadStatus))&&(y.on(HP.event.PROGRESS,(function(t){!Y.bSafari&&t&&(delete t.totalSize,delete t.position);var r,n=0===t.total?100:Math.round(100*t.loaded/t.total);([t.loaded," / ",t.total].join(""),xt.isFunction(e.onHttpUploadStatus))&&(r={fileName:t.name,percentage:n,statusCode:0,responseString:""},e.onHttpUploadStatus(r));e.onPercent([0,n,"","http",t.name])})),e.onPercent([0,-1,QP.Uploading,"http"]),xt.isFunction(e.onHttpUploadStatus))){var S="";xt.isArray(i)&&i.length>0||(i&&i.name&&""!=i.name?S=i.name:i&&i.fileName&&(S=i.fileName)),!S&&t.fileName&&(S=t.fileName),e.onHttpUploadStatus({fileName:S,percentage:0,statusCode:0,responseString:""})}if(m&&m.bCancel){m.st=2;var T={};return fE(T),t.content=null,xt.isFunction(n)&&n(T._errorCode,T._errorString),!1}var I=y.upload(i);return i=null,I}function bj(e,t,r,n){var i,o,a=e.MaxUploadImageSize,s=0,u=t.content;if(!u||!xt.isArray(u)||u.length<=0){t.content=null;var c={};return Pw(c),xt.isFunction(n)&&n(c._errorCode,c._errorString),Lb}for(i=0;i<u.length;i++){var l=u[i];if(!l||l.size<=0){var d={};return Pw(d),xt.isFunction(n)&&n(d._errorCode,d._errorString),Lb}var f=l.size,h=l.type;if(s+=f,""===h||h&&h!=t.contentType){var g=l.slice||l.webkitSlice||l.mozSlice,p=l.name,_=g.call(l,0,f,t.contentType);xt.isString(p)&&""!=p||(p=l.fileName),_.name=Sj(p,i+1),u[i]=_}u[i].remoteFilename=Sj(t.remoteFilename,i+1),l=null}if(s>a&&-1!=a){var m={};return xw(m),xt.isFunction(n)&&n(m._errorCode,m._errorString),Lb}for(Dt.cancelFrom=fj.HTTPUpload,o=Ij(e,t,r,n),t=null,i=0;i<u.length;i++)u[i]=null;return u=null,o}function Cj(e){Dt.dlgRef<=0||0==Dt.dialogShowStatus||UE(e)}!function(e){e.Init=-1,e.OK=0,e.Failed=1,e.Cancelled=2}(mj||(mj={})),Dt.setBtnCancelVisibleForProgress=UE;var wj,Ej=s((function e(){t(this,e)}),[{key:"_onProgress",value:function(e,t,r){var n=0===r.total?100:Math.round(100*r.loaded/r.total);[r.loaded," / ",r.total].join(""),e.onPercent([0,n,"","http",t])}},{key:"_uploadBlobFragment",value:function(e,t,r,n){var i=t.fileName,o=t.blockSize,a=0;t.method;var s,u,c,l=t.offset,d=this,f=function(e,r){t.content=null,xt.isFunction(n)&&n(e,r)};if((s=t.content).size<=0){var h={};return Pw(h),f(h._errorCode,h._errorString),Lb}if(a=s.size,(u=a-l)>0){var g;if(u>=o&&o>0?(u-=o,c=o):(c=u,u=0),!(g=0==l&&c==a?s:s.slice(l,l+c))){var p={};Pw(p),f(p._errorCode,p._errorString)}if(!e.IfShowProgressBar||e.IfShowProgressBar&&Dt.dlgRef>0){g.name=i,Cj(e.IfShowCancelDialogWhenImageTransfer),t.headers["Content-Range"]=["bytes ",l,"-",l+g.size-1,"/",a].join(""),d._onProgress(e,i,{total:a,loaded:l});var _=xt.clone(t);return _.content=g,_.offset=0,d.httpPostUpload(e,_,(function(n){0==u&&(Dt.needShowTwiceShowDialog=!1),d._onProgress(e,i,{total:a,loaded:l+c}),0==u?(t.content=null,xt.isFunction(r)&&wk(r,n)):(t.offset=t.offset+c,setTimeout((function(){d._uploadBlobFragment(e,t,r,f)}),100))}),f),!0}var m={};return fE(m),f(m._errorCode,m._errorString),!1}return Dt.needShowTwiceShowDialog=!1,t.content=null,xt.isFunction(r)&&r(""),!0}},{key:"httpPostUploadFragment",value:function(e,t,r,n){var i;if(!(i=t.content)){var o={};return Pw(o),xt.isFunction(n)&&n(o._errorCode,o._errorString),Lb}if(xt.isString(i)){if(""==i){var a={};return Pw(a),xt.isFunction(n)&&n(a._errorCode,a._errorString),Lb}var s=new Blob([i],{type:"text/plain"}),u=t.fileName;s.name=u,t.content=s,s=null}return Dt.cancelFrom=fj.HTTPUpload,this._uploadBlobFragment(e,t,r,n)}},{key:"httpPostUpload",value:function(e,t,r,n){var i,o,a=t.bAsync,s=function(r,i){var o;return t.content=null,t=null,xt.isFunction(n)&&n(r,i,null!==(o=null==e?void 0:e.HTTPPostResponse)&&void 0!==o?o:""),!1};if(!(i=t.content)){var u={};return Pw(u),s(u._errorCode,u._errorString),!!a&&void 0}if(xt.isString(i)){var c,l=t.fileName;if(""==i){var d={};return Pw(d),s(d._errorCode,d._errorString),!!a&&void 0}if(c=e.MaxUploadImageSize,i.length>c&&-1!=c){var f={};return xw(f),s(f._errorCode,f._errorString),!!a&&void 0}(o=new Blob([i],{type:"text/plain"})).name=l,i=null}else if(i instanceof Blob&&(o=i,i=null,o.size<=0)){var h={};return Pw(h),s(h._errorCode,h._errorString),!!a&&void 0}if(o){var g,p,_=e.MaxUploadImageSize,m=o.size,v=o.type;if(m>_&&-1!=_){var y={};return xw(y),s(y._errorCode,y._errorString),!!a&&void 0}""===v||v&&v!=t.contentType?(g=(o.slice||o.webkitSlice||o.mozSlice).call(o,0,m,t.contentType))instanceof File?(p=g.fileName,g.name=p):g.name=o.name||o.fileName:g=o,o=null,g&&(t.content=g),g=null}Cj(e.IfShowCancelDialogWhenImageTransfer),Dt.cancelFrom=fj.HTTPUpload;var S=Ij(e,t,(function(e){return t.content=null,t=null,xt.isFunction(r)&&r(e),e=null,!0}),s);return a?void 0:!!S}}]),Aj=s((function e(){t(this,e),this.method="",this.httpMethod="POST",this.contentType="application/octet-stream",this.remoteFilename="RemoteFile",this.blockSize=0,this.offset=0,this.retry=0,this.bOnlyResponseEmptyIsOK=!0,this.bAsync=!0,this.responseType=dj.Text})),Dj=s((function e(){t(this,e),this.IfShowProgressBar=!1,this.IfShowCancelDialogWhenImageTransfer=!0}));!function(e){e.URL=0,e.Blob=1,e.Base64=2}(wj||(wj={}));var Pj=window.SparkMD5,Rj=s((function e(r,n,i,o){t(this,e);var a=this;a._md5=i,a._length=n,a._content=o}),[{key:"getLength",value:function(){return this._length}},{key:"getMD5",value:function(){return this._md5}},{key:"getData",value:function(e,t){var r=this,n=t;return xt.isNumber(e)&&xt.isNumber(t)?e<0||t<=0?"":0==e&&n==r._length?r._content:(e+n>r._length&&(n=r._length-e),r._content.substr(e,n)):""}}]);Dt.html5.Base64Result=Rj;var xj=function(e){function r(e){var n,i,o,a;return t(this,r),i=this,a=[e],o=QE(o=r),(n=YE(i,function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(QG){return!1}}()?Reflect.construct(o,a||[],QE(i).constructor):o.apply(i,a))).__maxUploadImageSize=-1,n._strHttpContentTypeFieldValue="application/octet-stream",n}return qE(r,e),s(r,[{key:"_saveBlob",value:(I=GE(m.mark((function e(t,r){var n,i;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this,!Wt.navInfo.bIE){e.next=7;break}return e.next=5,n._innerSaveLocal(t,r);case 5:e.next=11;break;case 7:return i=URL.createObjectURL(t),e.next=10,n._innerSaveLocal(i,r);case 10:URL.revokeObjectURL(i);case 11:t=null;case 12:case"end":return e.stop()}}),e,this)}))),function(e,t){return I.apply(this,arguments)})},{key:"_saveImages",value:(T=GE(m.mark((function e(t,r,n,i){var o,a,s,u,c,l;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=this,a=Tj(r,i),s=Ck(o,n),Dt.cancelFrom=fj.Other,e.next=5,o._innerConvertToArrayBufferWithUIAsync(t,i,s);case 5:return u=e.sent,c=pk.getBlobTypeByImageType(i),l=new Blob([u],{type:c}),e.next=10,o._saveBlob(l,a);case 10:l=null;case 11:case"end":return e.stop()}}),e,this)}))),function(e,t,r,n){return T.apply(this,arguments)})},{key:"_innerSaveLocal",value:(S=GE(m.mark((function e(t,r){return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Dt.Promise((function(e,n){var i=window,o=Wt.navInfo,a=i.requestFileSystem||i.webkitRequestFileSystem||i.mozRequestFileSystem;if(!o.biPad&&!o.biPhone||a||!(Y.bSafari&&parseFloat(Y.strBrowserVersion)<13)&&Y.bSafari){var s=document.createElementNS("http://www.w3.org/1999/xhtml","a");if(s.href=t,s.download=r,s.target="_blank",document.body.appendChild(s),o.bEdge)s.click(),t=null,s.href=null;else if(o.bIE){var u;(u=window.navigator)&&"msSaveOrOpenBlob"in u&&u.msSaveOrOpenBlob(t,r)}else{var c=document.createEvent("MouseEvents");c.initMouseEvent("click",!0,!1),s.dispatchEvent(c)}setTimeout((function(){document.body.removeChild(s),s=null,e()}),6e3)}else{var l=i.open(t,"","",!1);setTimeout((function(){l.document.title=r,e()}),6e3)}})));case 2:case"end":return e.stop()}}),e,this)}))),function(e,t){return S.apply(this,arguments)})},{key:"_OnPostTransferAsync",value:function(e,t,r){var n,i=this;if(e&&e.length>=2)try{var o=String(e[1]).replace(/\\/g,"\\\\");n=xt.parse(o),!r&&n.imageId&&(n.imageId=i._serverId2uidFromServer(n.imageId))}catch(a){xt.log(e)}n||(n={imageId:""});var s=!1;if(xt.isFunction(i.__OnPostTransferAsync))try{s=i.__OnPostTransferAsync(n)}catch(u){GC(u)}if(xt.isFunction(i.__OnPostTransferAsync2))try{i.__OnPostTransferAsync2(n)}catch(u){GC(u)}return s}},{key:"_checkIndices",value:function(e,t){return Fj(e,!xt.isUndefined(t)&&t>=0?t:this._imageBufferWrapper.count(),this)}},{key:"_acquireImageForSendTo",value:(y=GE(m.mark((function e(t,r,n,i){var o,a,s,u,c,l,d,f;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=this,a=n?xt.clone(n):{},u=s=i,o._resetErr(),o._isValid()){e.next=4;break}throw{code:o._errorCode,message:o._errorString};case 4:if(xt.isString(s._id)){e.next=6;break}throw{code:-2602,message:'The parameter "SendTo" is invalid.'};case 6:if(!o.__bAcquireImageNow){e.next=9;break}throw yw(o),{code:o._errorCode,message:o._getErrorString()};case 9:if(o.__bAcquireImageNow=!0,DR(t,u),c=Dt.Promise.resolve(),l=Wt.DWT.RemoteScanConfig,d=Sx(),e.prev=13,ak(a),l&&Tx(l.keepAwake),sP.checkProductKey(o,{Core:!0})&&o._isValid()){e.next=18;break}throw{code:o._errorCode,message:o._errorString};case 18:return Xx._innerSendHeartBeat(s,!1),f=function(){var e=GE(m.mark((function e(t){return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c=c.then((function(){return new Dt.Promise((function(e,r){var n=[o._uidFromServer2ServerId(t.imageId)],i=Wt.DWT.EnumDWT_ImageType.IT_PNG;Dt.cancelFrom=fj.Scan,o._innerConvertToArrayBufferAsync(i,n).then((function(n){s._bltsCopyImage=!0,s.__LoadImageFromBytesV2(n,i,"",!0,0,0,!1,0,function(){var r=GE(m.mark((function r(n,i){var a;return m.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return a=o._uidFromServer2ServerId(t.imageId),i?(xt.log("LoadImageFromBinary success"),s._bltsCopyImage=!1,t.imageId=s._uidFromServer2ServerId(i.ids),xt.isFunction(s._OnPostTransferAsync)&&s._OnPostTransferAsync([!0,xt.stringify(t)],null,!0)):xt.log("LoadImageFromBinary return null."),e(),r.next=5,o._removeImageByIdAsync(a);case 5:case"end":return r.stop()}}),r)})));return function(e,t){return r.apply(this,arguments)}}(),(function(e,t){xt.log(t),s._bltsCopyImage=!1,r({code:e,message:t})}))}),(function(e){e&&e.message&&xt.log(e.message),r(e)}))}))}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),o._registerEvent("OnPostTransferAsync2",f),null!=r&&(a.Device=r.strDevice,a.DeviceMatchField=lx.SMF_NAME),e.next=24,o._acquireImageFromServiceAsync(a);case 24:e.next=29;break;case 26:throw e.prev=26,e.t0=e.catch(13),e.t0;case 29:return e.prev=29,e.prev=30,e.next=33,c;case 33:e.next=37;break;case 35:e.prev=35,e.t1=e.catch(30);case 37:return o._unregisterEvent("OnPostTransferAsync2"),o.__bAcquireImageNow=!1,PR(t),Tx(d),e.finish(29);case 42:case"end":return e.stop()}}),e,this,[[13,26,29,42],[30,35]])}))),function(e,t,r,n){return y.apply(this,arguments)})},{key:"_uidFromServer2index",value:function(e){var t,r=this;return r._resetErr(),!!r._isValid()&&(xt.isString(e)?(-1==(t=r._imageBufferWrapper._uidFromServer2index(e))&&xE(r),t):(qw(r),-1))}},{key:"_index2uidFromServer",value:function(e){var t=this;if(t._resetErr(),!t._isValid())return!1;var r=parseInt(e);return isNaN(r)?(pw(t),""):r<0||r>=this._imageBufferWrapper.count()?(Gw(t),""):t._imageBufferWrapper._index2uidFromServer(e)}},{key:"__LoadImageFromBytesV2",value:function(e,t,r,n,i,o,a,s,u,c){var l,d=this,f=t||3,h=0,g=e.name,p=!0,_=1;if(e)if(e instanceof Blob)h=e.size;else if(vR(e))h=e.byteLength;else if(e instanceof Array)h=e.length;else{var m=e;h=m.size||m.byteLength||m.length}!isNaN(i)&&i>=0&&!isNaN(o)&&o>0?_=0:(i=0,o=0),l=["[",h,",",0,",",f,',"',r,'",',i,",",o,",",s,",",_,",",a?"true":"false","]"].join("");var v=function(){if(d.__bLoadingImage=!1,p){var e=d._imageBufferWrapper.getCurrentImageIndex();e>=0&&d._innerRefreshUI(e)}return xt.isFunction(c)&&c(d._errorCode,d._getErrorString(),g),!1};return sP.checkProductKey(d,{Core:!0})||Y.bWin&&sP.checkProductKey(d,{Webcam:!0},!0)?sP.checkPDFProductKeyWhenNeeds(d,t)?0===h?(fw(d,-2312,"The file length is empty."),p=!1,v()):this._innerSendBlob("LoadImageFromBytes",l,e,n,_,(function(e){if(d.__bLoadingImage=!1,d._isBindViewer()){var t=d._imageBufferWrapper.getCurrentImageIndex();n&&t>=0&&d._innerRefreshUI(t)}if(xt.isFunction(u)){var r=e;if(xt.isArray(r)&&(r=r.length>0?r[0]:{}),n)setTimeout((function(){u(g,r)}),30);else try{u(g,r)}catch(i){xt.error(i.message)}}return d._canConsume()&&Wt.DWT.lcvrf(d),!0}),v):(p=!1,v()):(sP.checkProductKey(d,{Core:!0},!1),p=!1,v())}},{key:"_innerSendBlob",value:function(e,t,r,n,i,o,a){var s,u,c,l,d=this;return Xx.isServerInvalid(d)?d._waitForConnect().then((function(){d._innerSendBlob(e,t,r,n,i,o,a)})):n?(d._innerSendBlobByWS(e,t,r,o,a),!0):(d._resetErr(),!!d._isValid()&&(u=[d._httpUrl,"f/",e].join(""),c=ek(d._clientId,e,t,0,d._bScanForProxyRemote),c+="\r\n\r\n",l={method:"POST",url:u,processData:!1,data:c+=xt.base64.encodeArray(r),async:!1,onSuccess:function(e,t,n){var o=!1,a=!1;try{o=xt.isString(e)&&"text/json"===n.getResponseHeader("content-type")?xt.parse(e):e}catch(QG){}if(void 0!==o&&null!==o&&(rA(o)?(d._errorCode=o.exception,d._errorString=o.description):d._resetErr(),(s=o.result)&&xt.isArray(s)&&s.length>=1))if(i){var u,c=s[0];c&&xt.isObject(c)&&(u=c.imageInfos,0==d._errorCode&&xt.isString(u)&&d._handleOnBitmapChangedEvent({result:["c1",u]},{document:r.currentFileName,tag:r.currentTagName}),a=!0)}else{var l=s.join(",");0==d._errorCode&&l.length>0&&d._OnBitmapChanged(["c1",l,1,d._imageBufferWrapper.getCurrentImageIndex(),d._imageBufferWrapper.count()],null,{document:r.currentFileName,tag:r.currentTagName}),a=!0}a||(Cw(d),s="")},onError:function(){bw(d),s=""}},xt.mix(l,{headers:{"X-Requested-With":!1}}),Y.bFileSystem&&(l.crossDomain=!1),fC(l),0==d._errorCode?xt.isFunction(o)&&o():xt.isFunction(a)&&a(),s))}},{key:"_convertToBase64ByServerIdsWithUI",value:function(e,t,r,n,i,o,a){this._convertToBase64ByServerIdsWithUIAsync(e,r,t,n).then((function(e){xt.isFunction(o)&&wk(o,e)}),(function(){xt.isFunction(a)&&a()}))}},{key:"_OnPercentDone",value:function(e){var t,r,n,i,o,a=this,s=!1,u=!1,c=0;xt.isArray(e)&&e.length>2&&(r=e[0],c=e[1],n=e[2],e.length>3&&(i=e[3]),e.length>4&&(o=e[4]),e.length>5&&e[5],t=c,c<0?t=0:c>100&&(t=100),t=Math.floor(t),Dt.cancelFrom!=fj.HTTPUpload&&Dt.cancelFrom!=fj.HTTPDownload&&Dt.cancelFrom!=fj.Scan&&Dt.cancelFrom!=fj.HTTPPut||(u=o)),(a._bServerPercentDone||0==r)&&((c>0||0==c)&&(Dt.cancelFrom!=fj.HTTPUpload&&Dt.cancelFrom!=fj.HTTPDownload&&Dt.cancelFrom!=fj.FTPUpload&&Dt.cancelFrom!=fj.FTPDownload&&Dt.cancelFrom!=fj.HTTPPut||(s=!0)),a.IfShowProgressBar&&Dt.progressBarOnPercentDone(c,n,i,t,u,this._containerElement),1==s&&(xt.isFunction(a.__OnInternetTransferPercentage)&&a.__OnInternetTransferPercentage(t,!1),xt.isFunction(a.__OnInternetTransferPercentageEx)&&a.__OnInternetTransferPercentageEx(t,!1)),xt.isFunction(a.__OnPercentDone)&&a.__OnPercentDone())}},{key:"IfShowProgressBar",get:function(){return this._bIfShowProgressBar},set:function(e){this._resetErr(),xt.isBoolean(e)?this._bIfShowProgressBar=e:_w(this)}},{key:"IfShowCancelDialogWhenImageTransfer",get:function(){return this.__IfShowCancelDialogWhenImageTransfer},set:function(e){this._resetErr(),xt.isBoolean(e)?this.__IfShowCancelDialogWhenImageTransfer=e:_w(this)}},{key:"_getLogLevel",value:function(){return this._logLevel}},{key:"_setLogLevel",value:(v=GE(m.mark((function e(t){return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._logLevel=t,e.next=3,this._innerFunV2("LogLevel",mR(t));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return v.apply(this,arguments)})},{key:"MaxUploadImageSize",get:function(){return this.__maxUploadImageSize},set:function(e){var t=this;t._resetErr();var r=1*e;!xt.isNumber(r)||isNaN(r)?_w(t):t.__maxUploadImageSize=r}},{key:"HTTPRequestswithCredentials",get:function(){return this._resetErr(),this._bWithCredentials},set:function(e){this._resetErr(),xt.isBoolean(e)?this._bWithCredentials=e:_w(this)}},{key:"cancelableObj",get:function(){return this._cancelableObj},set:function(e){this._cancelableObj=e}},{key:"_getProfile",value:(_=GE(m.mark((function e(t){var r,n;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((r=this)._resetErr(),r._isValid()){e.next=4;break}throw{code:r._errorCode,message:r._errorString};case 4:return t&&(n=xt.stringify([t.strDevice])),e.abrupt("return",r._innerFunV2("GetCustomDSDataEx",n));case 6:case"end":return e.stop()}}),e,this)}))),function(e){return _.apply(this,arguments)})},{key:"_setProfile",value:(p=GE(m.mark((function e(t,r){var n,i;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((n=this)._resetErr(),n._isValid()){e.next=4;break}throw{code:n._errorCode,message:n._errorString};case 4:return i=t?xt.stringify([r,t.strDevice]):mR(r),e.abrupt("return",this._innerFunV2("SetCustomDSDataEx",i));case 6:case"end":return e.stop()}}),e,this)}))),function(e,t){return p.apply(this,arguments)})},{key:"_removeAllImagesAsync",value:(g=GE(m.mark((function e(t,r){var n,i,o,a,s,u;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((n=this)._resetErr(),n._isValid()){e.next=4;break}throw{code:n._errorCode,message:n._errorString};case 4:for(o=[],s=n._getHowManyImagesInBuffer(),a=s-1;a>=0;a--)(u=n._imageBufferWrapper.convertClientIndexToServerId(a))>-1&&o.push(u);if(0!=o.length){e.next=13;break}return e.next=10,n._innerFunV2("RemoveAllImages");case 10:i=e.sent,e.next=23;break;case 13:if(!r){e.next=19;break}return e.next=16,n._innerFunV2("RemoveAllImages",mR(o.join(",")));case 16:i=e.sent,e.next=22;break;case 19:return e.next=21,n._innerFunV2("RemoveAllImages");case 21:i=e.sent;case 22:(i||-1033==n._errorCode)&&n._OnBitmapChanged(["c1",o.join(","),3,n._imageBufferWrapper.getCurrentImageIndex(),n._imageBufferWrapper.count()]);case 23:return e.abrupt("return",i);case 24:case"end":return e.stop()}}),e,this)}))),function(e,t){return g.apply(this,arguments)})},{key:"__OnRecieveMsg",value:function(e,t){var n=this,i=null==t?void 0:t.cmd;if(e.event)return Dk(QE(r.prototype),"__OnRecieveMsg",this).call(this,e,t);if(rA(e)?(n._errorCode=e.exception,n._errorString=e.description):"StartScan"!=i&&"GetAddOnVersion"!=i&&(n._errorCode=0,n._errorString=""),"ReadBarcode"==i||"OCRRecognize"==i||e.request&&"OCRProRecognize"==e.request.method)return t.sFun?(t.sFun(e),!0):(t.fFun&&t.fFun(e),!0);if("SetCapabilities"==i||"GetSkewAngleFromBinary"==i||"UpdateImage"==i)return"exception"in e&&"0"!=e.exception?(e.result.errorCode&&e.result.errorString?(n._errorCode=e.result.errorCode,n._errorString=e.result.errorString):(n._errorCode=e.exception,n._errorString=e.description),t.fFun&&t.fFun(e.result),e=null,!0):(t.sFun&&t.sFun(e.result),e=null,!0);if(e.result&&e.result.length&&("1"==e.result[0]||1==e.result[0]||"ok"==e.result[0]))return(t.sFun||t.sFun)&&t.sFun(e.result),!0;if(!e.exception)return t.sFun&&t.sFun(e.result),e=null,!0;var o=!1;return t.fFun&&(o=t.fFun(n._errorString)),!o&&e.exception&&e.exception<0&&-2115!=e.exception&&xt.isFunction(n.__OnPrintMsg)&&n.__OnPrintMsg(n._errorString),!0}},{key:"_convertServerIdToGuid",value:function(e){return this._serverId2uidFromServer(e)}},{key:"_convertGuidToServerId",value:function(e){return this._uidFromServer2ServerId(e)}},{key:"_serverId2uidFromServer",value:function(e){return this._imageBufferWrapper._serverId2uidFromServer(e)}},{key:"_uidFromServer2ServerId",value:function(e){return this._imageBufferWrapper._uidFromServer2ServerId(e)}},{key:"_innerConvertToBlobWithUI",value:function(e,t,r,n,i,o){var a=this,s=arguments,u=function(e){if(Dt.needShowTwiceShowDialog=!1,xt.isFunction(o)){var t=[];xt.isArray(r)&&xt.each(r,(function(e){var r=a._imageBufferWrapper.convertServerIdToClientIndex(e);r>-1&&t.push(r)})),e&&(a._errorCode=e.code,a._errorString=e.message),o(t)}return!1};a._innerConvertToArrayBufferWithUIAsync(e,t,r,n).then((function(e){if(!e||e.byteLength<=0)return Xw(a),u();var n=a.__maxUploadImageSize;if(e.byteLength>n&&-1!=n)return xw(a),u();if(Dt.needShowTwiceShowDialog=!1,xt.isFunction(i)){var o=[];xt.isArray(r)&&xt.each(r,(function(e){var t=a._imageBufferWrapper.convertServerIdToClientIndex(e);t>-1&&o.push(t)}));var c=pk.getBlobTypeByImageType(t),l=new Blob([e],{type:c});try{i(l,o,s)}catch(d){}l=null}return!0}),u)}},{key:"convertToBlob",value:(h=GE(m.mark((function e(t,r,n){var i,o,a,s;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=Ck(i=this,r),Dt.cancelFrom=fj.ConvertToBlob,e.next=4,i._innerConvertToArrayBufferWithUIAsync("convertToBlob",t,o,n);case 4:return a=e.sent,s=pk.getBlobTypeByImageType(t),e.abrupt("return",new Blob([a],{type:s}));case 7:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return h.apply(this,arguments)})},{key:"_innerConvertToArrayBufferWithUIAsync",value:(f=GE(m.mark((function e(t,r,n,i,o){var a,s,u,c;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=this,c=null===(a=Dt.progressContext)||void 0===a?void 0:a.IfShowCancelDialogWhenImageTransfer,e.prev=2,s.IfShowProgressBar?Dt.showProgress(s,t,!1):Dt.hideProgress(),s._OnPercentDone([0,-1,QP.Encoding]),Dt.progressContext&&(Dt.progressContext.IfShowCancelDialogWhenImageTransfer=!1),e.next=8,this._innerConvertToArrayBufferAsync(r,n,i,o);case 8:u=e.sent;case 9:return e.prev=9,Dt.progressContext&&(Dt.progressContext.IfShowCancelDialogWhenImageTransfer=c),s.IfShowProgressBar&&Dt.closeProgress(null,t),e.finish(9);case 13:return e.abrupt("return",u);case 14:case"end":return e.stop()}}),e,this,[[2,,9,13]])}))),function(e,t,r,n,i){return f.apply(this,arguments)})},{key:"_innerConvertToBase64Async",value:(d=GE(m.mark((function e(t,r,n){var i,o,a,s,u,c,l,d,f;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=this,o=n,xt.isString(o)&&""!=o||(o="{}"),a=["[",t,',"',r.join(","),'",',o,",1]"].join(""),e.next=5,i._sendDataByHttpAsync("ConvertToBase64",a,"text",!0);case 5:if(s=e.sent,u=0,c="",l="",d=s&&s.result,0==i._errorCode){e.next=9;break}throw{code:i._errorCode,message:i._errorString};case 9:if(!d||!xt.isArray(d)||3!=d.length){e.next=17;break}return l=d[0],u=d[1],c=d[2],f=new Rj(null,u,c,l),e.abrupt("return",f);case 17:throw fw(i,-2366,"Converting images to a base64 string failed."),{code:i._errorCode,message:i._errorString};case 19:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return d.apply(this,arguments)})},{key:"_convertToBase64ByServerIdsWithUIAsync",value:(l=GE(m.mark((function e(t,r,n,i){var o,a,s;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=this,s=null===(o=Dt.progressContext)||void 0===o?void 0:o.IfShowCancelDialogWhenImageTransfer,e.prev=2,a.IfShowProgressBar?Dt.showProgress(a,t,!1):Dt.hideProgress(),a._OnPercentDone([0,-1,QP.Encoding]),Dt.progressContext&&(Dt.progressContext.IfShowCancelDialogWhenImageTransfer=a.IfShowCancelDialogWhenImageTransfer),e.next=8,this._innerConvertToBase64Async(r,n,i);case 8:return e.abrupt("return",e.sent);case 9:return e.prev=9,Dt.progressContext&&(Dt.progressContext.IfShowCancelDialogWhenImageTransfer=s),a.IfShowProgressBar&&Dt.closeProgress(null,t),e.finish(9);case 13:case"end":return e.stop()}}),e,this,[[2,,9,13]])}))),function(e,t,r,n){return l.apply(this,arguments)})},{key:"_convertToBlobForUpload",value:function(e,t,r,n,i,o,a){var s=this,u=arguments;if(Wt.DWT.ConnectWithSocket){var c=r,l=",";xt.isString(c)&&""!=c||(c="",l="");var d=["[",e,',"',t.join(","),'"',l,c,"]"].join("");return Dt.cancelFrom=fj.ConvertToBlob,Dt.progressContext&&(Dt.progressContext.IfShowCancelDialogWhenImageTransfer=!1),s._sendData("ConvertToBlob",d,!0,(function(e){s._resetErr();var t=e;if(t){if(t instanceof Blob||vR(t))return void i(t,"",u);rA(t)&&(s._errorCode=t.exception,s._errorString=t.description)}}),(function(e){s._errorCode=e.code,s._errorString=e.message,o(e)})),!0}s._innerConvertToArrayBufferAsync(e,t,r,"arraybuffer").then((function(e){var t=s._strHttpContentTypeFieldValue,r=new Blob([e],{type:t});if(Wt.DWT.IfAddMD5InUploadHeader){var n=new Pj.ArrayBuffer;n.append(e),xt.isFunction(i)&&i(r,n.end(),u)}else xt.isFunction(i)&&i(r,"",u);r=null}),(function(e){o(e.code,e.message)}))}},{key:"dispose",value:function(){return this.__unload()}},{key:"_innerDisposeWSClient",value:function(){return this._isValid()?this._sendData("dispose",null,!0,(function(){}),(function(){})):Dt.Promise.reject()}},{key:"__unload",value:(c=GE(m.mark((function e(){var t,r;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=this)._bReady||Dt.page.bUnload){e.next=10;break}if(!t._wsClient){e.next=10;break}return e.prev=3,e.next=6,t._innerDisposeWSClient();case 6:e.next=10;break;case 8:e.prev=8,e.t0=e.catch(3);case 10:if(!t._wsClient){e.next=24;break}return t._wsClient.removeEvent("close",t._clientId),t._wsClient.removeEvent("error",t._clientId),t._wsClient.removeEvent("timeout",t._clientId),e.prev=14,e.next=17,t._wsClient.dispose();case 17:e.next=22;break;case 19:e.prev=19,e.t1=e.catch(14),r=e.t1;case 22:delete t._wsClient,t._wsClient=null;case 24:if(this._imageBufferWrapper.dispose(),this._bReady=Lb,this._destroy=Bb,!r){e.next=29;break}throw r;case 29:case"end":return e.stop()}}),e,this,[[3,8],[14,19]])}))),function(){return c.apply(this,arguments)})},{key:"_getImages",value:(u=GE(m.mark((function e(t,r,n,i){var o,a,s,u;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((o=this)._checkIndices(r)){e.next=3;break}throw{code:this._errorCode,message:this._errorString};case 3:if(i!=wj.URL){e.next=9;break}if(!(r.length>1)){e.next=7;break}throw fw(this,-2619,"Only single index selection is allowed when enumImageFormatType is set to url."),{code:this._errorCode,message:this._errorString};case 7:e.next=13;break;case 9:if(n!=Wt.DWT.EnumDWT_ImageType.IT_BMP&&n!=Wt.DWT.EnumDWT_ImageType.IT_JPG&&n!=Wt.DWT.EnumDWT_ImageType.IT_PNG){e.next=13;break}if(!(r.length>1)){e.next=13;break}throw gE(this),{code:this._errorCode,message:this._errorString};case 13:if(i!=wj.URL){e.next=17;break}return e.abrupt("return",this._imageBufferWrapper.getImageUrl(r[0]));case 17:if(Dt.cancelFrom=fj.Other,a=Ck(o,r),i!=wj.Blob){e.next=27;break}return e.next=22,this._innerConvertToArrayBufferWithUIAsync(t,n,a);case 22:return s=e.sent,u=pk.getBlobTypeByImageType(n),e.abrupt("return",new Blob([s],{type:u}));case 27:if(i!=wj.Base64){e.next=31;break}return e.next=30,this._convertToBase64ByServerIdsWithUIAsync(t,n,a);case 30:return e.abrupt("return",e.sent);case 31:throw hE(this),{code:this._errorCode,message:this._errorString};case 33:case"end":return e.stop()}}),e,this)}))),function(e,t,r,n){return u.apply(this,arguments)})},{key:"_LicensePromptExpired",value:function(){var e=this,t=e.__licenseInfo.bTrial,r="";e.__licenseInfo&&e.__licenseInfo.ExpireDate&&(r=e.__licenseInfo.ExpireDate);var n=hP(r);n<=0&&(t||GC(e._getErrorString()),xt.isFunction(Wt.OnLicenseExpiredWarning)&&Wt.OnLicenseExpiredWarning(r,n,t))}},{key:"__saveToViewerAfterUpdate",value:function(e,t){var r=this,n=this._imageBufferWrapper.getIndexByUid(e),i=this._imageBufferWrapper.convertClientIndexToServerId(n),o=dR.getUrlByAct(this._imageBufferWrapper.BaseUrl,i,2);return new Dt.Promise((function(e,a){fC({method:"GET",xhrFields:{withCredentials:!0},url:o,onSuccess:function(o){var a,s=r._imageBufferWrapper.getMetadataByIndex(n);s||(s={}),s.width=t.width,s.height=t.height,a=Wt.navInfoSync.bMobile?r._imageBufferWrapper.getMinImageUrl(n,Math.round(s.controlWidth*devicePixelRatio),Math.round(s.controlHeight*devicePixelRatio)):r._imageBufferWrapper.getMinImageUrl(n,s.controlWidth,s.controlHeight);var u=r._imageBufferWrapper.getImageIdMap(i);if(u){u.ticks=Date.now(),u.imageUrl=r._imageBufferWrapper.getImageUrl(n),u.minImageUrl=a,u.width=t.width,u.height=t.height;var c=xt.clone(u);c.imageId=i,r._imageBufferWrapper.UpdateImage(c,s)}e()},onError:function(){e(),PR("save")}})}))}},{key:"RunCommandAsync",value:(a=GE(m.mark((function e(t){var r,n,i,o,a;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this,t&&xt.isString(t.command)&&t.parameter){e.next=4;break}throw Zw(r),{code:r._errorCode,message:r._errorString};case 4:if("Invert"!=t.command){e.next=6;break}return e.abrupt("return",r._invert(t.parameter.index));case 6:if(n=t.parameter.index,!xt.isNumber(n)){e.next=13;break}if(!(isNaN(n)||!xt.isNumber(n)||n<0||n>=r._imageBufferWrapper.count())){e.next=11;break}throw Gw(r),{code:r._errorCode,message:r._errorString};case 11:e.next=15;break;case 13:throw pw(r),{code:r._errorCode,message:r._errorString};case 15:return i=r._imageBufferWrapper.convertClientIndexToServerId(n),t.parameter.index=i,o=["[",xt.stringify(t),"]"].join(""),e.next=20,r._innerFunRawV3("runCommand",o);case 20:if(a=e.sent,!Y.bIE){e.next=25;break}if(!xt.isString(a)){e.next=24;break}return e.abrupt("return",xt.parse(a));case 24:return e.abrupt("return",a);case 25:return e.next=27,a.json();case 27:return e.abrupt("return",e.sent);case 28:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"_innerFunRawV3",value:(o=GE(m.mark((function e(t,r){var n,i,o;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o="fa/",(n=this)._resetErr(),n._isValid()){e.next=4;break}throw{code:n._errorCode,message:n._errorString};case 4:if(!Xx.isServerInvalid(n)){e.next=7;break}return e.abrupt("return",n._waitForConnect().then((function(){return n._innerFunRawV3(t,r)})));case 7:return i={method:"post",body:ek(n._clientId,t,r,0,n._bScanForProxyRemote),fetchRaw:!0},e.next=10,BE([n._httpUrl,o,t].join(""),i);case 10:return e.abrupt("return",e.sent);case 11:case"end":return e.stop()}}),e,this)}))),function(e,t){return o.apply(this,arguments)})},{key:"_invert",value:(i=GE(m.mark((function e(t){var r,n,i,o,a;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this,n=parseInt(t),r._resetErr(),r._isValid()){e.next=4;break}throw{code:r._errorCode,message:r._errorString};case 4:if(!isNaN(n)){e.next=7;break}throw pw(r),{code:r._errorCode,message:r._errorString};case 7:if(!(n<0||n>=r._imageBufferWrapper.count())){e.next=10;break}throw Gw(r),{code:r._errorCode,message:r._errorString};case 10:if(-1!=(i=r._imageBufferWrapper.convertClientIndexToServerId(n))){e.next=14;break}throw Gw(r),{code:r._errorCode,message:r._errorString};case 14:return e.next=16,r._innerFunV2("Invert",mR(i),!0);case 16:if(o=e.sent,!(a=1==o)){e.next=22;break}pk.refreshImageAfterInvokeFun(r,n),e.next=23;break;case 22:throw{code:r._errorCode,message:r._errorString};case 23:return e.abrupt("return",a);case 24:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})}],[{key:"create",value:(n=GE(m.mark((function e(t){var n;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new r(t),e.next=3,Xx.STwainConnectToServer(n);case 3:return e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)}))),function(e){return n.apply(this,arguments)})}]);var n,i,o,a,u,c,l,d,f,h,g,p,_,v,y,S,T,I}(gj);function kj(e){var t=e,r="",n=!1;if(t.__licenseInfo&&(t.__licenseInfo.ExpireDate&&(r=t.__licenseInfo.ExpireDate),n=t.__licenseInfo.bTrial),n&&!Wt.DWT.HideTrialMessage){var i=hP(r);i<=5&&(xt.isFunction(Wt.OnLicenseExpiredWarning)&&Wt.OnLicenseExpiredWarning(r,i,!0),Wt.DWT.HideTrialMessage=!0)}}function Fj(e,t,r){var n;if(!xt.isArray(e))return Vw(r),!1;if(0==e.length)return fw(r,-2350,"The indices cannot be empty."),!1;if(Wt.DWT.ConnectWithSocket)return!0;for(n=0;n<e.length;n++){var i=e[n];if(xt.isUndefined(i)||null===i)return jw(r),!1;if(i=parseInt(i),isNaN(i))return pw(r),!1;if(i<0||i>=t)return Bw(r),!1}return!0}var Oj={changeImageUISize:function(e,t,r){var n,i,o,a,s=t,u=r,c=Lb;n=Wb.one(e._containerElement),xt.isString(t)&&t.indexOf("%")>=0?(0==(o=Wb.css(n,"width"))&&(n[0].style.width="100%"),o=Wb.css(n,"width")*parseInt(t)/100,c=Bb):s=[(o=parseInt(t))+2,"px"].join(""),xt.isString(r)&&r.indexOf("%")>=0?(0==(a=Wb.css(n,"height"))&&(n[0].style.height="100%"),a=Wb.css(n,"height")*parseInt(r)/100,c=Bb):u=[(a=parseInt(r))+2,"px"].join(""),n&&(i=Wb.one(".dynamsoft-dwt-container-box",n))&&i.getEL()&&(i.style("width",s),i.style("height",u)),c?(e.__funResize||(e.__funResize=function(){if(e._ImgManager&&e._containerElement){var t=Oj.__innerGetUIViewRealSize(e._containerElement,e._width,e._height);return e._UIView.ChangeSize(t.width,t.height)}return Bb}),xt.removeEventListener(window,"resize",e.__funResize),xt.addEventListener(window,"resize",e.__funResize)):e.__funResize&&(xt.removeEventListener(window,"resize",e.__funResize),e.__funResize=Lb);var l=Oj.__innerGetUIViewRealSize(e._containerElement,o,a);return e._ImgManager?e._UIView.ChangeSize(l.width,l.height):Bb},__innerGetUIViewRealSize:function(e,t,r){var n,i=-1,o=-1;return n=Wb.one(e),xt.isString(t)&&t.indexOf("%")>=0&&(i=Wb.css(n,"width")*parseInt(t)/100),i<0&&t&&(i=parseInt(t)),xt.isString(r)&&r.indexOf("%")>=0&&(o=Wb.css(n,"height")*parseInt(r)/100),o<0&&r&&(o=parseInt(r)),{width:i,height:o}},bindUIViewEvents:function(e,t){var r=e;t.onSelected=function(e){if(!r._isNoViewer()){var t,n=e.length;n>0&&(r._ImgManager.SetSelectedImageCount(n),t=e[n-1],xt.isFunction(r.__OnRefreshUI)&&r.__OnRefreshUI(t))}},t.onRefreshUI=function(e){r._isNoViewer()||Oj.__innerRefreshFromUIView(r,e)},t.onResetCurrentIndex=function(e){if(!r._isNoViewer()){var t=r._ImgManager.getCurrentImageIndex();if(e>=0&&e<r._ImgManager.count()&&t!=e&&xt.isFunction(r.__OnIndexChangeDuringDragDrop))try{r.__OnIndexChangeDuringDragDrop(t,e)}catch(n){GC(n)}}},t.onMouseMove=function(e){if(!r._isNoViewer()){var t=e.index;if(e){var n=e.x,i=e.y;r.__MouseX=n,r.__MouseY=i}if(xt.isFunction(r.__OnMouseMove))try{r.__OnMouseMove(t)}catch(u){GC(u)}}},t.onMouseClick=function(e){if(!r._isNoViewer()){var t=e.index;if(e){var n=e.x,i=e.y;r.__MouseX=n,r.__MouseY=i}if(xt.isFunction(r.__OnMouseClick))try{r.__OnMouseClick(t)}catch(u){GC(u)}}},t.onMouseDoubleClick=function(e){if(!r._isNoViewer()){var t=e.index;if(xt.isFunction(r.__OnMouseDoubleClick))try{r.__OnMouseDoubleClick(t)}catch(n){GC(n)}}},t.onMouseRightClick=function(e){if(!r._isNoViewer()){var t=e.index;if(e){var n=e.x,i=e.y;r.__MouseX=n,r.__MouseY=i}if(xt.isFunction(r.__OnMouseRightClick))try{return r.__OnMouseRightClick(t)}catch(u){GC(u)}return Bb}},t.onImageAreaSelected=function(e){if(!r._isNoViewer()&&xt.isFunction(r.__OnImageAreaSelected))try{r.__OnImageAreaSelected(e.index,e.left,e.top,e.right,e.bottom,e.areaIndex)}catch(t){GC(t)}},t.onImageAreaDeSelected=function(e){if(!r._isNoViewer()&&xt.isFunction(r.__OnImageAreaDeSelected))try{r.__OnImageAreaDeSelected(e)}catch(t){GC(t)}},t.onBufferChanged=function(e){if(xt.isFunction(r.__OnBufferChanged))try{r.__OnBufferChanged(e)}catch(t){GC(t)}}},__innerRefreshFromUIView:function(e,t){var r=e;xt.isFunction(r.__OnRefreshUI)&&r.__OnRefreshUI(t)}};function Wj(e,t,r){t in e||Object.defineProperty(e,t,r)}var Nj=s((function e(r){t(this,e);var n=this;n._parent=r,Wj(n,"width",{get:function(){return this._parent._width},set:function(e){this.SetSize(e,!1)}}),Wj(n,"height",{get:function(){return this._parent._height},set:function(e){this.SetSize(!1,e)}})}),[{key:"SetSize",value:function(e,t){var r,n=this._parent,i=!1,o=!1;return!!n._isBindViewer()&&(xt.isString(e)&&e.length>0&&"%"===e.charAt(e.length-1)&&(i=e),!i&&e&&(r=parseInt(e))&&(i=r+"px"),xt.isString(t)&&t.length>0&&"%"===t.charAt(t.length-1)&&(o=t),!o&&t&&(r=parseInt(t))&&(o=r+"px"),i&&(n._width=i),o&&(n._height=o),Oj.changeImageUISize(n,i,o))}}]);function Mj(e){var t,r,n,i=e._config;Dt.dlgProgress||Dt.initProgress(e),i.bNoViewer?e._containerElement=null:(i.container?e._containerElement=i.container:i.containerId&&(e._containerElement=xt.get(i.containerId)),e._width=i.width,e._height=i.height,t=Wb.one(e._containerElement)),function(e,t){var r={Stwain:e},n=Lb;if(t){var i,o=e._width,a=e._height;i=Wb.one(e._containerElement),xt.isString(o)&&o.indexOf("%")>=0?(o=Wb.css(i,"width")*parseInt(o)/100,n=Bb):o=parseInt(o),xt.isString(a)&&a.indexOf("%")>=0?(a=Wb.css(i,"height")*parseInt(a)/100,n=Bb):a=parseInt(a),r={Stwain:e,Container:t,Width:o,Height:a}}Oj.bindUIViewEvents(e,r),e._UIView?e._UIView._Init(r):e._UIView=new Dt.UI.ImageUIView(e,r),e.Width<=0&&(e.Width=270),e.Height<=0&&(e.Height=350),n&&Oj.changeImageUISize(e,e._width,e._height)}(e,t),e._isBindViewer()&&(r=e,n=e._config||{},r.__OnImageAreaDeSelected=n.onImageAreaDeSelected||"",r.__OnImageAreaSelected=n.onImageAreaSelected||"",r.__OnMouseClick=n.onMouseClick||"",r.__OnMouseDoubleClick=n.onMouseDoubleClick||"",r.__OnMouseMove=n.onMouseMove||"",r.__OnMouseRightClick=n.onMouseRightClick||"",r.__OnTopImageInTheViewChanged=n.onTopImageInTheViewChanged||"",r.__OnBufferChanged=n.onBufferChanged||"",e.__OnMouseClick=i.onMouseClick||"",e.__OnThumbnailMouseClick="",e.__OnKeyDown=i.onKeyDown||"",e.__OnMouseWheel=i.onMouseWheel||"",e.__OnMouseDoubleClick=i.onMouseDoubleClick||"",e.__OnMouseRightClick=i.onMouseRightClick||"",e.__OnMouseMove=i.onMouseMove||"",e.__OnImageAreaSelected=i.onImageAreaSelected||"",e.__OnImageAreaDeSelected=i.onImageAreaDeSelected||"",e.__OnRefreshUI=i.onRefreshUI||"",e.__OnBufferChanged=i.onBufferChanged||"",e.__MouseX=0,e.__MouseY=0,e.__style=new Nj(e),e.__fSelectionRectAspectRatio=0)}function Lj(e,t){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.add(e)}function Bj(e,t,r){return t.has(e),r}var Uj=new WeakSet,Vj=new WeakSet,Gj=new WeakSet,jj=new WeakSet,Hj=function(e){function r(e){var n,i,o,a;return t(this,r),i=this,a=[e],o=QE(o=r),Lj(n=YE(i,function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(QG){return!1}}()?Reflect.construct(o,a||[],QE(i).constructor):o.apply(i,a)),jj),Lj(n,Gj),Lj(n,Vj),Lj(n,Uj),n}return qE(r,e),s(r,[{key:"_getWSContextData",value:function(){return{document:this._getCurrentDocumentName(),tag:this._getCurrentDefaultTagName(),bNeedClearTag:!1}}},{key:"_getErrorString",value:function(){var e=this;return-2207==e._errorCode&&e._bMustUpgradeService&&Sw(e),0!=e._errorCode?e._errorString:"Successful."}},{key:"_getWebTwainId",value:function(){return this._id}},{key:"_isTwainServiceType",value:function(){return!0}},{key:"_isPC",value:function(){return Y.bWin||Y.bMac||Y.bLinux}},{key:"_serviceSyncMethodNotSupport",value:function(e){var t=this;return fw(t,-2605,'The synchronized method "'+e+'" is not supported under the current settings.'),{code:t._errorCode,message:t._getErrorString()}}},{key:"_serviceAsyncMethodNotSupport",value:function(e){var t=this;return fw(t,-2606,'The asynchronized method "'+e+'" is not supported under the current settings.'),{code:t._errorCode,message:t._getErrorString()}}},{key:"_serviceNotSupportAsync",value:function(e){var t=this;return fw(t,-2397,e+" doesn't work under current settings."),Wb.Promise.reject({code:t._errorCode,message:t._getErrorString()})}},{key:"_nouiNotSupport",value:function(e,t){var r=this;return fw(r,-2210,"You cannot call this method on this WebTwain instance because it does not use the default viewer."),xt.isFunction(t)&&t(r._errorCode,r._getErrorString()),!1}},{key:"_innerFunRaw",value:function(e,t,r,n,i,o,a){var s,u,c,l,d=this,f="f/",h=r;if(h&&(f="fa/"),Wt.DWT.ConnectWithSocket)this._sendData(e,t,!1,o,a);else{if(d._resetErr(),!d._isValid())return!!h&&void 0;var g=Xx.isServerInvalid(d);if(h&&g)return d._waitForConnect().then((function(){return d._innerFunRaw(e,t,h,n,i,o,a)}));if(!h&&g)return uE(d),!1;if(c={method:"POST",url:s=[d._httpUrl,f,e].join(""),data:u=ek(d._clientId,e,t,0,d._bScanForProxyRemote),async:h,onSuccess:function(e,t,r){var n=!1;try{n=xt.isString(e)&&"text/json"===r.getResponseHeader("content-type")?xt.parse(e):e}catch(QG){}n?(rA(n)?(d._errorCode=n.exception,d._errorString=n.description):d._resetErr(),l=i?n:n.result):(Cw(d),l=""),xt.isFunction(o)&&o(l),h&&(l=null)},onError:function(){bw(d),l="",!Dt.page.bUnload&&xt.isFunction(a)&&a()}},!h&&n)Y.bIE?(c.dataType="arraybuffer",c.onSuccess=function(e,t,r){var n,i,a,s=!1;if(r.responseHeadersString&&-1!=r.responseHeadersString.indexOf("text/json")&&(s=!0),n=r.responseData,d._resetErr(),l=!1,n&&(i=new Uint8Array(n),s?n=String.fromCharCode.apply(null,i):(l=new Blob([i],{type:d._strHttpContentTypeFieldValue}),(a=new Pj.ArrayBuffer).append(i),l.md5=a.end())),!n||s){var u,c=!1;if((u=s?n:r.responseText).length>0){if("{"==u.charAt(0))try{c=xt.parse(u),s=!0}catch(f){xt.log(u)}s?rA(c)?(d._errorCode=c.exception,d._errorString=c.description,l=!1):l=!0:(i=new Uint8Array(u),l=new Blob([i],{type:d._strHttpContentTypeFieldValue}),(a=new Pj.ArrayBuffer).append(i),l.md5=a.end())}}xt.isFunction(o)&&o(l)}):(h||(c.dataType="text",c.contentType="text/plain; charset=x-user-defined",c.mimeType="text/plain; charset=x-user-defined"),c.onSuccess=function(e,t,r){var n,i,a;if(d._resetErr(),(i=(n=r.responseText).length)>0){var s,u=!1;if("{"==n.charAt(0))try{s=xt.parse(n),u=!0}catch(h){xt.log(n)}if(u)rA(s)?(d._errorCode=s.exception,d._errorString=s.description,l=!1):l=!0;else{a=new Uint8Array(i);for(var c=0;c<i;c++)a[c]=n.charCodeAt(c);l=new Blob([a],{type:d._strHttpContentTypeFieldValue});var f=new Pj.ArrayBuffer;f.append(a),l.md5=f.end()}}else l="";xt.isFunction(o)&&o(l)});else if(h&&n){c={method:"POST",body:u},Y.bIE?c.dataType="arraybuffer":c.fetchRaw=!0;var p=BE(s,c);return Y.bIE||(p=p.then((function(e){var t=e.headers.get("content-type");return t.indexOf("image/")>=0||t.indexOf("application/octet-stream")>=0?e.arrayBuffer():e.json()}))),p=p.then((function(e){if(d._resetErr(),vR(e))return xt.isFunction(o)&&o(e),void(e=null);if(xt.isObject(e)){var t=e;if(rA(t))d._errorCode=t.exception,d._errorString=t.description,xt.isFunction(a)&&a();else{var r="";t.result&&(r=t.result),xt.isFunction(o)&&o(r)}}else bw(d),!Dt.page.bUnload&&xt.isFunction(a)&&a()}),(function(e){bw(d),!Dt.page.bUnload&&xt.isFunction(a)&&a()})),!0}if(h||xt.mix(c,{headers:{"X-Requested-With":!1}}),Y.bFileSystem&&(c.crossDomain=!1),fC(c),!h)return l}}},{key:"_innerSendCmd",value:function(e,t){this._innerFunRaw(e,t,!0,!1,!0)}},{key:"_innerFun",value:function(e,t){var r;return r=this._innerFunRaw(e,t,!1,!1,!1),xt.isArray(r)?r[0]:r}},{key:"__OnRecieveMsg",value:function(e,t){var n=this,i=null==t?void 0:t.cmd;if(e.event)return Dk(QE(r.prototype),"__OnRecieveMsg",this).call(this,e,t);if(Wt.DWT.ConnectWithSocket)return Dk(QE(r.prototype),"__OnRecieveMsg",this).call(this,e,t);if(rA(e)?(n._errorCode=e.exception,n._errorString=e.description):"StartScan"!=i&&"GetAddOnVersion"!=i&&(n._errorCode=0,n._errorString=""),"ReadBarcode"==i||"OCRRecognize"==i||e.request&&"OCRProRecognize"==e.request.method)return t.sFun?t.sFun(e):t.fFun&&t.fFun(e),!0;if("ActiveUI"==i||"VersionInfo"==i||"ConvertToBase64"==i||"SaveSelectedImagesToBase64Binary"==i||"ConvertToBlob"==i||"BeginSaveMem"==i)return t.sFun&&xt.isArray(e.result)&&e.result.length>0?t.sFun(e.result):t.fFun&&t.fFun(e.result),!0;if("ShowFileDialog"==i||"SplitTiff"==i||"SplitPDF"==i||"EncodeAsBase64"==i||"ProductKey"==i||"GetSourceNames"==i||"GetSkewAngle"==i||"GetImageInfo"==i||"GetSkewAngleFromBinary"==i)return t.sFun?t.sFun(e.result):t.fFun&&t.fFun(e.result),!0;if("SetCapabilities"==i)return Dk(QE(r.prototype),"__OnRecieveMsg",this).call(this,e,t);if(e.result&&e.result.length&&("1"==e.result[0]||1==e.result[0]||"ok"==e.result[0]))(t.sFun||t.sFun)&&t.sFun(t.rawData?e:e.result);else{if(!e.exception)return t.sFun&&t.sFun(e.result),e=null,!0;var o=!1;t.fFun&&(o=t.fFun(n._errorString)),!o&&e.exception&&e.exception<0&&-2115!=e.exception&&xt.isFunction(n.__OnPrintMsg)&&n.__OnPrintMsg(n._errorString)}return!0}},{key:"OnRefreshUI",value:function(e,t,r,n){return this._innerRefreshUI(e,t,r,n)}},{key:"GetCurrentDocumentName",value:function(){return this._resetErr(),!!this._isValid()&&this._getCurrentDocumentName()}},{key:"RegisterEvent",value:function(e,t){return!!this.registerEvent(e,t)}},{key:"UnregisterEvent",value:function(e,t){return this.unregisterEvent(e,t)}},{key:"onEvent",value:function(e,t){this.registerEvent(e,t)}},{key:"on",value:function(e,t){this.registerEvent(e,t)}},{key:"_OnConsumed",value:function(e){}},{key:"_OnPostLoad",value:function(e,t){var r,n,i,o,a=this;void 0!==t&&void 0!==t.exception&&void 0!==t.description&&(a._errorCode=t.exception,a._errorString=t.description),xt.log("OnPostLoad Results:"),n=e[1].split(","),r=xt.base64.decode(n[0]),i=xt.base64.decode(n[1]),xt.log(r),xt.log(i),xt.log(n[2]),Yj(a,"On PostLoad"),(o=a._ImgManager.getCurrentImageIndex())>=0&&a._innerRefreshUI(o),xt.isFunction(a.__OnPostLoad)&&a.__OnPostLoad(r,i,n[2])}},{key:"_OnPostTransfer",value:function(e){var t=this;if(xt.log("On PostTransfer Results:"+e),Yj(t,"On PostTransfer"),xt.isFunction(t.__OnPostTransfer))try{t.__OnPostTransfer()}catch(r){GC(r)}}},{key:"_OnPreAllTransfersAsync",value:function(e){var t=this;if(xt.isFunction(t.__OnPreAllTransfersAsync)){var r={event:"beforeAcquire",result:{}};try{xt.isArray(e)&&e.length>1&&(r=xt.parse(e[1]))}catch(ij){}setTimeout((function(){try{t.__OnPreAllTransfersAsync(r)}catch(e){GC(e)}}),10)}}},{key:"_OnPostAllTransfers",value:function(e){var t=this;if(e.length>=2&&0==t._errorCode&&(t._errorCode=e[1],t._errorString=e[2]),xt.log("On PostAllTransfers Results:"+e),t.__bLoadingImage=!1,t.__bAcquireImageNow=!1,t.__closeRemoteScanUI(!0),xt.isFunction(t.__OnPostAllTransfers))try{t.__OnPostAllTransfers()}catch(r){GC(r)}}},{key:"_OnResult",value:function(e){var t=e[1];if(xt.isFunction(this.__OnResult))try{this.__OnResult(t)}catch(r){GC(r)}}},{key:"_OnTransferCancelled",value:function(e){var t=this;if(t._ImgManager.getCurrentImageIndex(),t._ImgManager.count(),t.__bLoadingImage=!1,t.__bAcquireImageNow=!1,xt.isFunction(t.__OnTransferCancelled))try{t.__OnTransferCancelled()}catch(r){GC(r)}}},{key:"_OnTransferError",value:function(e){if(xt.isFunction(this.__OnTransferError))try{this.__OnTransferError()}catch(t){GC(t)}}},{key:"_OnSourceUIClose",value:function(e){var t=this;if(t.__closeRemoteScanUI(!0),xt.isFunction(t.__OnSourceUIClose))try{t.__OnSourceUIClose()}catch(r){GC(r)}}},{key:"_OnPreTransfer",value:function(e){if(xt.isFunction(this.__OnPreTransfer))try{this.__OnPreTransfer()}catch(t){GC(t)}}},{key:"_OnPreAllTransfers",value:function(e){if(xt.isFunction(this.__OnPreAllTransfers))try{this.__OnPreAllTransfers()}catch(t){GC(t)}}},{key:"_OnGetFilePath",value:function(e){var t,r,n,o=this;if(t=e[1].split(","),xt.log("On GetFilePath Results:"+e),r=xt.base64.decode(t[3]),n=xt.base64.decode(t[4]),"-1032"==t[2]&&(t[2]="-1",r=n=""),xt.isFunction(o.__OnGetFilePath))try{o.__OnGetFilePath(1*t[0]>0,1*t[1],1*t[2],r,n)}catch(i){GC(i)}o.__bOpenFileNow=!1}},{key:"_OnDiskExceedLimit",value:function(){xt.isFunction(this.__OnDiskExceedLimit)&&this.__OnDiskExceedLimit()}},{key:"__GetLoadEventsNum",value:function(){var e=0;return xt.isFunction(this.__OnPostLoad)&&(e|=1),xt.isFunction(this.__OnGetFilePath)&&(e|=2),e}},{key:"_innerSend",value:function(e,t,r,n,i){var o=this;if(Wt.DWT.ConnectWithSocket||"SaveSelectedImagesToBytes"!=e&&"ConvertToBlob"!=e)return this._sendData(e,t,r,n,i);var a=wR(),s=ek(o._clientId,e,t,a,o._bScanForProxyRemote);return o._innerFunRaw(e,s,!0,!0,!0,n,i),Wb.Promise.resolve(!0)}},{key:"_convertToBlobByIndices",value:function(e,t,r,n,i,o){var a=this,s=!1,u=function(e){xt.isFunction(o)&&Ak(o,a,e,t,n),e=null};if(xt.isFunction(i)&&(s=!0),a._resetErr(),!a._isValid())return u(e),!!s&&void 0;var c=parseInt(t);if(!sP.checkProductKey(a,{Core:!0}))return u(e),!!s&&void 0;if(!a._checkIndices(e))return u(e),!!s&&void 0;if(c==Wt.DWT.EnumDWT_ImageType.IT_BMP||c==Wt.DWT.EnumDWT_ImageType.IT_JPG||c==Wt.DWT.EnumDWT_ImageType.IT_PNG||c==Wt.DWT.EnumDWT_ImageType.IT_J2K){if(e.length>1)return fw(a,-2372,"You cannot convert more than one image to binary when the format is BMP, JPG or PNG."),u(e),!!s&&void 0}else if(c!=Wt.DWT.EnumDWT_ImageType.IT_TIF&&c!=Wt.DWT.EnumDWT_ImageType.IT_PDF)return Hw(a),u(e),!!s&&void 0;var l=Ck(a,e);return 0==l.length?(pw(a),u(e),!!s&&void 0):s?(Dt.cancelFrom=fj.ConvertToBlob,void a._innerConvertToBlobWithUI("ConvertToBlob",c,l,r,(function(e,r){xt.isFunction(i)&&wk(i,e,r,t,n),e=r=null}),u)):Bj(a,Uj,zj).call(a,l,c,r)}},{key:"_getDefaultDevice",value:function(){var e=this;if(e._resetErr(),!e._isValid())return null;var t="",r=fR.TWAINSCANNER,n=e._innerFun("GetDefaultSourceName");if(n.length>0)try{var i=JSON.parse(n);r=i.type,t=xt.base64.decode(i.ProductName)}catch(o){t=""}var a=new gx;return a.name=t,a.deviceType=r,a.isSystemDefaultPrinter=!1,r==fR.TWAINX64SCANNER&&t.length>0?a.displayName="Twain64-"+t:r==fR.WIASCANNER&&t.length>0?a.displayName="WIA-"+t:r==fR.ESCLSCANNER&&t.length>0?a.displayName="ESCL-"+t:r==fR.ICASCANNER&&e.__serverPlatform==gC.enumMac&&t.length>0?a.displayName="ICA-"+t:a.displayName=t,a}},{key:"_getDefaultDeviceAsync",value:(f=GE(m.mark((function e(){var t,r,n,i,o,s;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((t=this)._resetErr(),t._isValid()){e.next=4;break}return e.abrupt("return",null);case 4:return r="",n=fR.TWAINSCANNER,e.next=8,t._sendDataByHttpAsync("GetDefaultSourceName");case 8:if((i=e.sent).length>0)try{o=JSON.parse(i),n=o.type,r=xt.base64.decode(o.ProductName)}catch(a){r=""}return(s=new gx).name=r,s.deviceType=n,s.isSystemDefaultPrinter=!1,n==fR.TWAINX64SCANNER&&r.length>0?s.displayName="Twain64-"+r:n==fR.ICASCANNER&&t.__serverPlatform==gC.enumMac&&r.length>0?s.displayName="ICA-"+r:s.displayName=r,e.abrupt("return",s);case 16:case"end":return e.stop()}}),e,this)}))),function(){return f.apply(this,arguments)})},{key:"_getSources",value:function(e,t,r){return px(this,this._innerFun("GetSources",mR(e,null!=t&&t,null!=r&&r)))}},{key:"_getSourceCountAsync",value:(d=GE(m.mark((function e(t){var r,n,i,o,a,s,u,c;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((r=this)._resetErr(),r._isValid()){e.next=4;break}return e.abrupt("return",Wb.Promise.reject({code:r._errorCode,message:r._errorString}));case 4:return Bj(r,Gj,Kj).call(r),DR("GetSourceCountAsync",r),n=[],e.prev=7,t&&(r._driverType=t),i=Lb,o=Lb,a=Lb,s=Lb,r._bRemoteMode?r.__serverPlatform==gC.enumWindow?a=!0:r.__serverPlatform==gC.enumLinux?o=!0:r.__serverPlatform==gC.enumMac?i=!0:r.__serverPlatform==gC.enumAndroid&&(s=!0):(i=Y.bMac,o=Y.bLinux,a=Y.bWin,s=Y.bAndroid),u=_k(r._driverType,a,o,i,s),c=Bb,e.next=15,this._getDevices(u,c,void 0);case 15:n=e.sent,e.next=21;break;case 18:throw e.prev=18,e.t0=e.catch(7),e.t0;case 21:return e.prev=21,PR("GetSourceCountAsync"),e.finish(21);case 24:return e.abrupt("return",r._setDevices(n));case 25:case"end":return e.stop()}}),e,this,[[7,18,21,24]])}))),function(e){return d.apply(this,arguments)})},{key:"_setDevices",value:function(e){var t,r=this;return r.__devices=e,t=e.length,r.__sourceCount=t,t<=0?(r.__defaultSourceName="",r.__sourceCount=0,0):t}},{key:"_getSourceNameByIndex",value:function(e){var t=this.__devices.length;return e<0||e>=t?"":this.__devices[e].displayName}},{key:"_dwtConvertToBlobSync",value:function(e,t,r,n,i,o){var a=this,s=r,u=",";xt.isString(s)&&""!=s||(s="",u="");var c=["[",e,',"',t.join(","),'"',u,s,"]"].join(""),l=a._innerFunRaw("ConvertToBlob",c,!1,!0,!1),d="";if(0==a._errorCode){l&&"md5"in l&&(d=l.md5);var f=!0;return xt.isFunction(n)&&(f=n(l,d,o)),f}return xt.isFunction(i)&&Ek(i,a),!1}},{key:"_getSourceCountSync",value:function(){var e,t=this,r=Lb,n=Lb,i=Lb,o=Lb;if(t._bRemoteMode?t.__serverPlatform==gC.enumWindow?i=!0:t.__serverPlatform==gC.enumLinux?n=!0:t.__serverPlatform==gC.enumMac?r=!0:t.__serverPlatform==gC.enumAndroid&&(o=!0):(r=Y.bMac,n=Y.bLinux,i=Y.bWin,o=Y.bAndroid),e=_k(this._driverType,i,n,r,o),t._resetErr(),!t._isValid())return 0;if(!sP.checkProductKey(t,{Core:!0}))return 0;Bj(t,Gj,Kj).call(t);var a=Bb,s=t._getSources(e,a,void 0);return t._setDevices(s)}},{key:"_OnActiveUI",value:(l=GE(m.mark((function e(t){var n;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this,t&&t.length>2&&(n.__strProductName=t[2]),e.next=4,Dk(QE(r.prototype),"_OnActiveUI",this).call(this,t);case 4:return e.next=6,n._setConvertModeAsync(n._pdfConvertMode).catch((function(){}));case 6:case"end":return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)})},{key:"_OnReady",value:(c=GE(m.mark((function e(){var t,n,i,o,a;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return dw((t=this)._serverInfo.server)&&(Dx.item("DWT_port",t._serverInfo.port),Dx.item("DWT_ssl",t._serverInfo.ssl?"true":"false")),t._bNoMask||DR("OnReady",t),e.prev=3,e.next=6,Dk(QE(r.prototype),"_OnReady",this).call(this);case 6:if(!lw()){e.next=12;break}if(t._uuidForActiveUI){e.next=12;break}return e.next=10,Wt.DWT.lgcuid(Wt.DWT.EnumInstance.dwt_desktop,"");case 10:n=e.sent,t._uuidForActiveUI=n;case 12:return e.next=14,t._innerActiveUI(t._uuidForActiveUI);case 14:return i=e.sent,e.next=17,t._OnActiveUI(i);case 17:if(SD("Changing Map..."),(o=t._id)&&!Wt.DWT.WebTwainIdMap[o]&&(Wt.DWT.WebTwainIdMap[o]=t),Mj(t),a=!1,t._bRemoteMode||(a=Dt.attachAddon(t)),Wt.DWT.IfDisableDefaultSettings){e.next=29;break}return SD("Configuring the WebTwain instance..."),e.next=27,Qj(t);case 27:e.next=32;break;case 29:if(!a){e.next=32;break}return e.next=32,new Wb.Promise((function(e){setTimeout(e,300)}));case 32:e.next=39;break;case 34:throw e.prev=34,e.t0=e.catch(3),e.t0&&(t._errorCode=e.t0.code,t._errorString=e.t0.message),t.dispose(),e.t0;case 39:return e.prev=39,t._bNoMask||PR("OnReady"),e.finish(39);case 42:case"end":return e.stop()}}),e,this,[[3,34,39,42]])}))),function(){return c.apply(this,arguments)})},{key:"_OnWSClose",value:function(e){Dk(QE(r.prototype),"_OnWSClose",this).call(this,e),Dt.detect.bOK=!1,this.__bAcquireImageNow=!1}},{key:"_OnWSTimeout",value:function(e){Dk(QE(r.prototype),"_OnWSTimeout",this).call(this,e),Dt.detect.bOK=!1}},{key:"_setConvertModeAsync",value:function(e){var t,r=this,n=1*e;return isNaN(n)?(PE(r),Wb.Promise.reject({code:r._errorCode,message:r._errorString})):r._checkConvertModeInner(n)?(t=this._mixSavedPdfReaderOptions({convertMode:n,renderOptions:{renderAnnotations:!!r._pdfOptions.renderOptions.renderAnnotations}}),r._resetPdfOptionsWhenSetConvertMode(t),Bj(r,jj,Jj).call(r,t,n)):Wb.Promise.reject({code:r._errorCode,message:r._errorString})}},{key:"_OnReconnected",value:(u=GE(m.mark((function e(){var t;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this,e.next=3,Bj(t,jj,Jj).call(t,t._pdfOptions);case 3:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"_getConvertMode",value:function(){return this._pdfConvertMode}},{key:"_setConvertMode",value:function(e){var t,r=this,n=1*e;if(isNaN(n))return PE(r),!1;if(!r._checkConvertModeInner(n))return!1;t=this._mixSavedPdfReaderOptions({convertMode:n,renderOptions:{renderAnnotations:!!r._pdfOptions.renderOptions.renderAnnotations}}),r._resetPdfOptionsWhenSetConvertMode(t);var i=r._setReaderOptions(t,!1);return i&&(r._pdfConvertMode=n,r._pdfOptions.convertMode=t.convertMode,r._pdfOptions.renderOptions.renderAnnotations=t.renderOptions.renderAnnotations,r._pdfOptions.convertMode==TD.CM_IMAGEONLY&&r._pdfConvertMode==TD.CM_RENDERALL||r._pdfOptions.convertMode==TD.CM_IMAGEONLY&&r._pdfConvertMode==TD.CM_RENDERALLWITHANNOTATION)?(r._pdfConvertMode=TD.CM_IMAGEONLY,Mw(r),!1):i}},{key:"_checkConvertModeInner",value:function(e){var t=this;return!!sP.checkProductKey(t,{Core:!0})&&(t._resetErr(),!!t._isValid()&&(e==TD.CM_RENDERALL||e==TD.CM_IMAGEONLY||e==TD.CM_AUTO||e==TD.CM_RENDERALLWITHANNOTATION||(PE(t),!1)))}},{key:"_resetPdfOptionsWhenSetConvertMode",value:function(e){var t=e.convertMode;t==TD.CM_IMAGEONLY||sP.hasPDFRProductKey(this)?e.convertMode=t:e.convertMode=TD.CM_IMAGEONLY,e.convertMode==TD.CM_IMAGEONLY||e.convertMode==TD.CM_RENDERALL?e.renderOptions.renderAnnotations=!1:e.convertMode==TD.CM_RENDERALLWITHANNOTATION&&(e.renderOptions.renderAnnotations=!0)}},{key:"_checkPDFPasswordValue",value:function(e){if(!xt.isUndefined(e)){if(!xt.isString(e))return fw(this,-2852,"The password is not a string."),!1;if(e.length>32)return function(e){fw(e,-2851,"The password must not exceed 32 characters in length.")}(this),!1}return!0}},{key:"_mixSavedPdfReaderOptions",value:function(e){var t;return t=xt.clone(this._pdfOptions),e||(e={}),e.convertMode&&(t.convertMode=e.convertMode),xt.isString(e.password)?t.password=e.password:xt.isNumber(e.password)&&(t.password=""+e.password),e.renderOptions&&(t.renderOptions=xt.mix(this._pdfOptions.renderOptions,e.renderOptions)),t}},{key:"_setReaderOptions",value:function(e,t){var r,n,i=this,o=-1;if(i._resetErr(),e&&e.renderOptions){var a=e.renderOptions.resolution,s=e.renderOptions.maxWidth,u=e.renderOptions.maxHeight,c=e.renderOptions.renderGrayscale;if(!xt.isUndefined(a)&&(!Wt.Lib.isNumber(a)||a<=0))return fw(i,-2830,"The PDF resolution must be a positive number."),!1;if(!xt.isUndefined(s)&&(!Wt.Lib.isNumber(s)||s<0))return function(e){fw(e,-2831,"The PDF max width must be a positive number.")}(i),!1;if(!xt.isUndefined(u)&&(!Wt.Lib.isNumber(u)||u<0))return function(e){fw(e,-2832,"The PDF max height must be a positive number.")}(i),!1;if(!xt.isUndefined(c)&&!Wt.Lib.isBoolean(c))return function(e){fw(e,-2833,"The PDF render grayscale must be a boolean.")}(i),!1}if(t){r={},e||(e={}),e.convertMode?r.convertMode=e.convertMode:r.convertMode=TD.CM_AUTO,o=r.convertMode,xt.isString(e.password)?r.password=e.password:xt.isNumber(e.password)?r.password=""+e.password:r.password="",r.renderOptions=xt.mix({renderAnnotations:!1,resolution:200,maxWidth:0,maxHeight:0,renderGrayscale:!1},e.renderOptions);var l=r.renderOptions.renderAnnotations;xt.isBoolean(l)||xt.isString(l)&&(r.renderOptions.renderAnnotations="true"==l.toLowerCase());var d=r.renderOptions.renderGrayscale;if(xt.isBoolean(d)||xt.isString(d)&&(r.renderOptions.renderGrayscale="true"==d.toLowerCase()),xt.isNumber(r.convertMode)){if(!i._checkConvertModeInner(r.convertMode))return!1;sP.hasPDFRProductKey(i)||(r.convertMode=TD.CM_IMAGEONLY),r.convertMode==TD.CM_IMAGEONLY?r.renderOptions.renderAnnotations=!1:r.convertMode==TD.CM_RENDERALLWITHANNOTATION&&(r.renderOptions.renderAnnotations=!0)}}else{if(xt.isUndefined(e))return function(e){fw(e,-2834,"The PDF reader options is invalid.")}(i),!1;if(r=e,xt.isString(e.password)||xt.isUndefined(e.password));else{if(!xt.isNumber(e.password))return function(e){fw(e,-2829,"The type of the PDF password must be a string.")}(i),!1;e.password=""+e.password}}var f=i._getPdfDllname();n=["[",xt.stringify(r),',"',f,'"',"]"].join("");var h=i._innerFun("SetPDFReaderOptions",n);return h&&t&&(i._pdfOptions=xt.clone(r),xt.isNumber(r.convertMode)&&(r.convertMode==TD.CM_RENDERALL&&r.renderOptions.renderAnnotations&&(r.convertMode=TD.CM_RENDERALLWITHANNOTATION),i._pdfConvertMode=r.convertMode,i._pdfOptions.convertMode==TD.CM_IMAGEONLY&&o==TD.CM_RENDERALL||i._pdfOptions.convertMode==TD.CM_IMAGEONLY&&o==TD.CM_RENDERALLWITHANNOTATION))?(i._pdfConvertMode=TD.CM_IMAGEONLY,Mw(i),!1):h}},{key:"_getPdfDllname",value:function(){var e=this,t=!1,r=!1;return e._bRemoteMode?e.__serverPlatform==gC.enumWindow||(e.__serverPlatform==gC.enumLinux?r=!0:e.__serverPlatform==gC.enumMac&&(t=!0)):(t=Y.bMac,r=Y.bLinux,Y.bWin),t?e._b64bit?"libDynamicPdfCorex64_"+zC.PdfVersion+".dylib":"libDynamicPdfCore_"+zC.PdfVersion+".dylib":r?"libDynamicPdfCore_"+zC.PdfVersion+".so":e._b64bit?"DynamicPdfCorex64_"+zC.PdfVersion+".dll":"DynamicPdfCore_"+zC.PdfVersion+".dll"}},{key:"_unload_viewer",value:function(){}},{key:"__innerDeleteInMap",value:function(){return this._id,delete Wt.DWT.WebTwainIdMap[this._id],Bb}},{key:"__unload",value:(a=GE(m.mark((function e(){var t,r,n,i;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this,r=xt.clone(Wt.DWT.licenseException),t.__closeRemoteScanUI(!0),!t._destroy&&!t._destroying){e.next=5;break}return e.abrupt("return");case 5:if(t._destroying=!0,this.__innerDeleteInMap(),t.__addon&&t.__addon.Camera&&t.__addon.Camera._viewer&&(""!=t.__addon.Camera.getStatus()&&t.__addon.Camera.closeSource().catch((function(){})),t.__addon.Camera._viewer.dispose(),t.__addon.Camera._viewer=null),t._unload_viewer(),t._containerElement=null,t._ImgManager&&t._ImgManager.clear(),!t._bReady||Dt.page.bUnload){e.next=20;break}if(!t._wsClient){e.next=20;break}return e.prev=13,e.next=16,t._innerDisposeWSClient();case 16:e.next=20;break;case 18:e.prev=18,e.t0=e.catch(13);case 20:if(!t._wsClient){e.next=34;break}return t._wsClient.removeEvent("close",t._clientId),t._wsClient.removeEvent("error",t._clientId),t._wsClient.removeEvent("timeout",t._clientId),e.prev=24,e.next=27,t._wsClient.dispose();case 27:e.next=32;break;case 29:e.prev=29,e.t1=e.catch(24),n=e.t1;case 32:delete t._wsClient,t._wsClient=null;case 34:if(t._bReady=!1,Wt.DWT.lremoveDWTObj(t),t.__bAcquireImageNow=!1,t._destroying=!1,t._destroy=!0,(i=Wt.DWT.licenseException).code=r.code,i.message=r.message,i.fromLTS=r.fromLTS,!n){e.next=45;break}throw n;case 45:case"end":return e.stop()}}),e,this,[[13,18],[24,29]])}))),function(){return a.apply(this,arguments)})},{key:"_setIfShowUI",value:function(e){this._resetErr(),this._isValid()&&(xt.isBoolean(e)?this._innerFun("IfShowUI",mR(e)):_w(self))}},{key:"_setIfShowFileDialog",value:function(e){this._resetErr(),this._isValid()&&(xt.isBoolean(e)?this._innerFun("IfShowFileDialog",mR(e)):_w(self))}},{key:"_getDevicesAsync",value:(o=GE(m.mark((function e(t,r,n,i){var o,a,s,u,c;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=this,a=[],!r||xt.isNumber(r)){e.next=4;break}return Zw(o),e.abrupt("return",Wb.Promise.reject({code:o._errorCode,message:o._errorString}));case 4:if(s=o._bRemoteMode?SR:Y.bAndroid?IR:SR,u=null!=r?r:s,o._resetErr(),o._isValid()){e.next=8;break}return e.abrupt("return",Wb.Promise.reject({code:o._errorCode,message:o._errorString}));case 8:return DR(t,o),e.prev=9,e.next=12,o._getDevices(u,n,i);case 12:c=e.sent,xt.isArray(c)&&c.length>0&&(a=a.concat(c)),e.next=19;break;case 16:throw e.prev=16,e.t0=e.catch(9),e.t0;case 19:return e.prev=19,PR(t),e.finish(19);case 22:return a.length>0&&this._setDevices(a),e.abrupt("return",a);case 24:case"end":return e.stop()}}),e,this,[[9,16,19,22]])}))),function(e,t,r,n){return o.apply(this,arguments)})},{key:"_openSourceAsync",value:function(e){var t=this;return t._resetErr(),t._isValid()?(t._bRemoteMode&&t._initRemoteDiv(),t._innerFunV2("OpenSource").then((function(e){return t.__closeRemoteScanUI(!0),e}),(function(e){return t.__closeRemoteScanUI(!0),Wb.Promise.reject(e)}))):Wb.Promise.reject({code:t._errorCode,message:t._errorString})}},{key:"_closeSourceAsync",value:function(e){var t=this;return t._resetErr(),t._isValid()?t._innerFunV2("CloseSource").then((function(){return t._curDevice=null,!0})):Wb.Promise.reject({code:t._errorCode,message:t._errorString})}},{key:"_selectSourceAsync",value:function(e,t,r){var n=this;return n._resetErr(),n._isValid()?n._getDevicesAsync(e,t).then((function(t){var i,o,a=document,s=t?t.length:0;Wb.dialog.selectsourcedlg&&(Wb.dialog.selectsourcedlg.close(),document.body.removeChild(Wb.dialog.selectsourcedlg),Wb.dialog.selectsourcedlg=!1);var u,c,l,d,f=-1;for((o=a.createElement("dialog")).className="dynamsoft-dialog-selectsource",Y.bIE&&(o.style.width="300px"),o.setAttribute("closed","closed"),(u=[]).push('<ul id="dynamsoft-dialog-selectsource-sourcelist-ul">'),i=0;i<s;i++){var h="",g=n._getSourceNameByIndex(i);(""==n.__defaultSourceName&&0==i||n.__defaultSourceName==g)&&(h=" dynamsoft-dialog-selectsource-sourcelist-li-selected",f=i),u.push('<li class="dynamsoft-dialog-selectsource-item'+h+'" sourceindex='+i+">"+g+"</li>")}u.push("</ul>"),u=u.join(""),xt.isArray(r)&&r.length>=3?(c=r[0],l=r[1],d=r[2]):(c="Select Source:",l="Select",d="Cancel");var p=["<p>",c,"</p>",'<div id="dynamsoft-dialog-selectsource-sourcelist">',u,"</div>",'<div><input type="button" value="',l,'" class="dynamsoft-dialog-selectsource-button-select">','<input type="button" value="',d,'" class="dynamsoft-dialog-selectsource-button-cancel"></div>'].join("");return o.innerHTML=p,Wb.dialog.selectsourcedlg=o,a.body.appendChild(Wb.dialog.selectsourcedlg),xt.each(xt.sizzle(".dynamsoft-dialog-selectsource-item"),(function(e,t){xt.addEventListener(e,"click",(function(e){for(var t=e.target,r=t.attributes.sourceindex.value,n=t.parentElement.children,i=0;i<n.length;i++)n[i].className="dynamsoft-dialog-selectsource-item";t.className="dynamsoft-dialog-selectsource-item dynamsoft-dialog-selectsource-sourcelist-li-selected",xt.get("dynamsoft-dialog-selectsource-sourcelist-ul").setAttribute("selectedSourceIndex",r)}))})),xt.get("dynamsoft-dialog-selectsource-sourcelist-ul").setAttribute("selectedSourceIndex",f.toString()),Wb.dialog.setup(Wb.dialog.selectsourcedlg),Wb.dialog.selectsourcedlg&&Wb.dialog.selectsourcedlg.showModal(),"CSS1Compat"==a.compatMode?a.documentElement.scrollTop:a.body.scrollTop,new Wb.Promise((function(t,r){xt.removeEventListener(Wb.one(".dynamsoft-dialog-selectsource-button-select")[0],"click"),xt.removeEventListener(Wb.one(".dynamsoft-dialog-selectsource-button-cancel")[0],"click"),s>0&&xt.addEventListener(Wb.one(".dynamsoft-dialog-selectsource-button-select")[0],"click",(function(){var r=parseInt(xt.get("dynamsoft-dialog-selectsource-sourcelist-ul").getAttribute("selectedSourceIndex"));r<0||n._selectSourceByIndexAsync(e,r).then((function(){Wb.dialog.selectsourcedlg&&(Wb.dialog.selectsourcedlg.close(),document.body.removeChild(Wb.dialog.selectsourcedlg),Wb.dialog.selectsourcedlg=!1),t(r)}))})),xt.addEventListener(Wb.one(".dynamsoft-dialog-selectsource-button-cancel")[0],"click",(function(){Wb.dialog.selectsourcedlg&&(Wb.dialog.selectsourcedlg.close(),document.body.removeChild(Wb.dialog.selectsourcedlg),Wb.dialog.selectsourcedlg=!1);var e={};fE(e),r({code:e._errorCode,message:e._errorString})}))}))})):Wb.Promise.reject({code:n._errorCode,message:n._errorString})}},{key:"_dwtGetCapabilities",value:function(e,t,r){var n=this,i=null,a=function(){xt.isFunction(r)&&r(n._errorCode,n._errorString)};if(e){if(!xt.isArray(e))return Zw(n),void a();if(0==e.length)return void(xt.isFunction(t)&&t([]));if(!1===function(e,t){var r,n,i,o;for(o=0;o<t.length;o++){if(r=t[o],n=!1,i=!1,xt.isString(r)){var a=r;r=parseInt(r),(xt.isNaN(r)||r!=a)&&(n=!0)}if(0==n&&xt.isNumber(r)?(r<1||r>65535)&&(i=!0):n=!0,n)return Zw(e),!1;if(i)return RE(e),!1}return!0}(n,e))return void a();i=mR(e)}n._sendDataByHttpAsync("GetCapabilities",i).then((function(e){try{var r,i;e.length>0&&(i=e[0]),xt.isString(i)?(i=Dt.removeNonPrintableChar(i),i=xt.replaceAll(i,"\\\\","\\\\"),0==(r=JSON.parse(i)).errorCode?xt.isFunction(t)&&t(r.response):(n._errorCode=r.errorCode,n._errorString=r.errorString,a())):(SE(n),a())}catch(o){n._errorCode=-2302,n._errorString=o,a()}}),a)}},{key:"_dwtSetCapabilities",value:function(e,t,r){var n=this;if(!xt.isObject(e)||xt.isArray(e))return Zw(n),xt.isFunction(r)&&r(n._errorCode,n._getErrorString()),!1;var i=["[",xt.stringify(e),"]"].join("");return n._innerSend("SetCapabilities",i,0,(function(e){xt.isFunction(t)&&t(e)}),r),!0}},{key:"_selectDeviceAsync",value:(i=GE(m.mark((function e(t,n,i){var o,a;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=this,DR(t,this),e.prev=2,e.next=5,Dk(QE(r.prototype),"_innerSelectDeviceAsync",this).call(this,n,i);case 5:(a=e.sent)&&(o._curDevice=n,o._bSelectedSourceByServer=!1),e.next=12;break;case 9:throw e.prev=9,e.t0=e.catch(2),e.t0;case 12:return e.prev=12,PR(t),e.finish(12);case 15:return e.abrupt("return",a);case 16:case"end":return e.stop()}}),e,this,[[2,9,12,15]])}))),function(e,t,r){return i.apply(this,arguments)})},{key:"_selectSourceByIndexAsync",value:(n=GE(m.mark((function e(t,r){var n,i,o;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=1*r,(n=this)._resetErr(),n._isValid()){e.next=4;break}return e.abrupt("return",Wb.Promise.reject({code:n._errorCode,message:n._errorString}));case 4:if(!xt.isNaN(i)){e.next=7;break}return pw(n),e.abrupt("return",Wb.Promise.reject({code:n._errorCode,message:n._errorString}));case 7:if(n.__devices){e.next=10;break}return e.next=10,n._getDevicesAsync(t,null);case 10:if(!(i<0||i>=n.__devices.length)){e.next=13;break}return Gw(n),e.abrupt("return",Wb.Promise.reject({code:n._errorCode,message:n._errorString}));case 13:return o=n.__devices[i],e.abrupt("return",n._selectDeviceAsync(t,o));case 15:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"_removeAllImages",value:function(e){var t=this,r=!0;if(t._resetErr(),!t._isValid())return!1;var n,i=[];for(n=t._getHowManyImagesInBuffer()-1;n>=0;n--){var o=t._imageBufferWrapper.convertClientIndexToServerId(n);o>-1&&i.push(o)}if(i.length>0){if(t._OnBitmapChanged(["c1",i.join(","),3,t._ImgManager.getCurrentImageIndex(),t._ImgManager.count()]),r=t._innerFunRaw("RemoveAllImages",mR(i.join(",")),!1,!1,!1,(function(){}),(function(){})),xt.isArray(r))return r[0]}else r=!0;return r}},{key:"_removeImage",value:function(e,t){var r,n=this,i=parseInt(t);if(!Ik(n,i))return!1;var o=n._ImgManager.convertClientIndexToServerId(i);return-1==o?(Gw(n),!1):(((r=n._innerFun("RemoveImage",mR(o)))||-1033==n._errorCode)&&n._OnBitmapChanged(["c1",""+o,3,n._ImgManager.getCurrentImageIndex(),n._ImgManager.count()]),r)}},{key:"__innerAcquireOrLoadImageAsync",value:function(e,t,r,n){var i=this;return new Wb.Promise((function(r,n){var o="LoadImage"==e||"LoadImageEx"==e||"GenerateURLForUploadData"==e,a=o||"LoadDibFromClipboard"==e;o?Dt.showProgress(i,e,!1):DR(e,i),i._innerSend(e,t,!0,(function(t){if(i.__bLoadingImage=!1,i.__bOpenFileNow=!1,i.__closeRemoteScanUI(!0),o){if(Dt.closeProgress(null,e),i._isBindViewer()){var n=i._ImgManager.getCurrentImageIndex();n>=0&&i._innerRefreshUI(n)}}else PR(e);a&&i._canConsume()&&Wt.DWT.lcvrf(i),xt.isFunction(r)&&r(t)}),(function(t){o?Dt.closeProgress(null,""):PR(e),i.__bLoadingImage=!1,i.__bAcquireImageNow=!1,i.__bOpenFileNow=!1,i.__closeRemoteScanUI(!0);var r=i._ImgManager.getCurrentImageIndex();r>=0&&i._innerRefreshUI(r),nA(i._errorCode)&&Mw(i),xt.isFunction(n)&&n({code:i._errorCode,message:i._getErrorString()}),o?Dt.closeProgress(null,e):PR(e),t&&xt.error(t)}))}))}},{key:"_innerLoadImageFromBinary",value:function(e,t,r,n,i,o){var a,s,u=this,c=t;if(!sP.checkProductKey(u,{Core:!0}))return xt.isFunction(o)&&o(u._errorCode,u._getErrorString()),!1;if(!e||""==e)return kw(u),xt.isFunction(o)&&o(u._errorCode,u._getErrorString()),!1;if(xt.isString(e))return Zw(u),xt.isFunction(o)&&o(u._errorCode,u._getErrorString()),!1;if(e instanceof Blob)s=e.size;else if(vR(e))s=e.byteLength;else if(e instanceof Array)s=e.length;else{var l=e;s=l.size||l.byteLength||l.length}if(!s||""==s)return Zw(u),xt.isFunction(o)&&o(u._errorCode,u._getErrorString()),!1;var d=e.currentFileName;d||(d=u._getCurrentDocumentName());var f,h=e.currentTagName;if(h||!xt.isUndefined(e.bNeedClearCurrentTagName)&&e.bNeedClearCurrentTagName||(h=u._getCurrentDefaultTagName()),e instanceof FileList){if(1==e.length)return e[0].currentFileName=d,e[0].currentTagName=h,u._innerLoadImageFromBinary(e[0],c,r,i,o);if(e.length>1){var g;for(xt.asyncQueue.stop(),g=0;g<e.length;g++)e[g].currentFileName=d,e[g].currentTagName=h,g==e.length-1?xt.asyncQueue.pushToDo(u,"_innerLoadImageFromBinary",[e[g],c,r,i,o]):xt.asyncQueue.pushToDo(u,"_innerLoadImageFromBinary",[e[g],c,r,null,o]);return xt.asyncQueue.start(),!0}return kw(u),xt.isFunction(o)&&o(u._errorCode,u._getErrorString()),!1}if(window.ReadableStream&&e instanceof ReadableStream?a=new Response(e):window.Response&&e instanceof Response&&(a=e),a)a.arrayBuffer().then((function(t){var a;(a=new Blob([t])).currentFileName=e.currentFileName,a.currentTagName=e.currentTagName;var s=n,c=0;r&&(c=u.__GetLoadEventsNum()),u.__LoadImageFromBytesV1(a,-1,"",c,s,i,o)}));else{var p=e;n&&vR(p)&&((p=new Blob([e])).currentFileName=e.currentFileName,p.currentTagName=e.currentTagName);var _=-1,m=n,v=Wt.DWT.EnumDWT_ImageType;xt.isString(p.type)&&("application/pdf"==p.type?_=v.IT_PDF:"image/png"==p.type?_=v.IT_PNG:"image/jpeg"==p.type||"image/jpg"==p.type?_=v.IT_JPG:"image/bmp"==p.type?_=v.IT_BMP:"image/tiff"==p.type||"image/tif"==p.type?_=v.IT_TIF:"image/jp2"==p.type&&(_=v.IT_J2K));var y=0;r&&(y=u.__GetLoadEventsNum()),f=u.__LoadImageFromBytesV1(p,_,"",y,m,i,o)}return!!n||f}},{key:"__LoadImageFromBytes",value:function(e,t,r,n,i,o,a,s){var u=this.__LoadImageFromBytesV2(e,t,r,n,a,s,!1,0,i,o);return n?u:0==this._errorCode}},{key:"__LoadImageFromBytesV1",value:function(e,t,r,n,i,o,a){var s=this.__LoadImageFromBytesV2(e,t,r,i,0,0,!1,n,o,a);return i?s:0==this._errorCode}},{key:"_isMobileMode",value:function(){return!1}},{key:"ErrorCode",get:function(){return this._errorCode}},{key:"ErrorString",get:function(){return this._getErrorString()}},{key:"HowManyImagesInBuffer",get:function(){return this._getHowManyImagesInBuffer()}}]);var n,i,o,a,u,c,l,d,f}(xj);function zj(e,t,r){var n=this;return n._dwtConvertToBlobSync(t,e,r,(function(e){if(!e||e.size<=0)return Xw(n),!1;var t=n.__maxUploadImageSize;return e.size>t&&-1!=t?(xw(n),!1):e}),(function(e){return!1}))}function Kj(){this.__defaultSourceName="",this.__sourceCount=0}function Jj(e,t){var r=this,n=r._getPdfDllname(),i=["[",xt.stringify(e),',"',n,'"',"]"].join("");return r._innerFunV2("SetPDFReaderOptions",i).then((function(){if(xt.isNumber(t)&&(r._pdfConvertMode=t),r._pdfOptions.convertMode=e.convertMode,r._pdfOptions.renderOptions.renderAnnotations=e.renderOptions.renderAnnotations,r._pdfOptions.convertMode==TD.CM_IMAGEONLY&&r._pdfConvertMode==TD.CM_RENDERALL||r._pdfOptions.convertMode==TD.CM_IMAGEONLY&&r._pdfConvertMode==TD.CM_RENDERALLWITHANNOTATION)throw r._pdfConvertMode=TD.CM_IMAGEONLY,Mw(r),{code:r._errorCode,message:r._errorString};return!0}))}var Yj=function(e,t){if(lR.bDiscardBlankImage){var r=e._ImgManager.getCurrentImageIndex();e.IsBlankImage(r)&&e.RemoveImage(r);var n=["Blank Discard (",t,"): ",e.ErrorString].join("");xt.isFunction(e.__OnPrintMsg)&&e.__OnPrintMsg(n)}};function Qj(e){return Xj.apply(this,arguments)}function Xj(){return(Xj=GE(m.mark((function e(t){var r,n,i,o;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t,!Wt.DWT.ConnectWithSocket){e.next=6;break}return e.next=4,new Wb.Promise((function(e,t){r._sendData("IfDisableSourceAfterAcquire","[1]",!1,e,t)}));case 4:e.next=8;break;case 6:return e.next=8,t._innerFunV2("IfDisableSourceAfterAcquire","[1]");case 8:n=lk.TWAIN,i=!1,o=!1,r._bRemoteMode?r.__serverPlatform==gC.enumWindow||(r.__serverPlatform==gC.enumLinux?o=!0:r.__serverPlatform==gC.enumMac&&(i=!0)):(i=Y.bMac,o=Y.bLinux,Y.bWin),i?n=lk.TWAIN_AND_ICA:o&&(n=lk.SANE),t._driverType=n,t._bRemoteMode&&(t._setIfShowUI(!1),t._setIfShowFileDialog(!1));case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function qj(e,t){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.add(e)}function Zj(e,t,r){return t.has(e),r}var $j=new WeakSet,eH=new WeakSet,tH=new WeakSet,rH=new WeakSet,nH=new WeakSet,iH=function(e){function r(){var e;t(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return e=function(e,t,r){return t=QE(t),YE(e,function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(QG){return!1}}()?Reflect.construct(t,r||[],QE(e).constructor):t.apply(e,r))}(this,r,[].concat(i)),qj(e,nH),qj(e,rH),qj(e,tH),qj(e,eH),qj(e,$j),e}return qE(r,e),s(r,[{key:"SaveAsGIF",value:function(e,t,r,n){var i=this,o=!1;if(xt.isFunction(r)&&(o=!0),i._resetErr(),!i._isValid())return xt.isFunction(n)&&Ek(n,i),!!o&&void 0;if(!(sP.checkProductKey(i,{Core:!0})||Y.bWin&&sP.checkProductKey(i,{Webcam:!0},!0)))return sP.checkProductKey(i,{Core:!0},!1),xt.isFunction(n)&&n(i._errorCode,i._getErrorString()),!!o&&void 0;var a,s=pk.replaceLocalFilename(e);if(!yk(i,t,n))return!!o&&void 0;if(-1==(a=i._ImgManager.convertClientIndexToServerId(t)))return Gw(i),xt.isFunction(n)&&Ek(n,i),!!o&&void 0;var u=i.__GetLoadEventsNum(),c=i.__innerSaveImage("SaveAsGIF",mR(s,a,u),r,n);return o?void 0:c}},{key:"SaveSelectedImagesToBase64Binary",value:function(e,t){var r=this,n=!1;if(xt.isFunction(e)&&(n=!0),r._resetErr(),!r._isValid())return xt.isFunction(t)&&Ek(t,r),!!n&&void 0;if(!(sP.checkProductKey(r,{Core:!0})||Y.bWin&&sP.checkProductKey(r,{Webcam:!0},!0)))return sP.checkProductKey(r,{Core:!0},!1),xt.isFunction(t)&&t(r._errorCode,r._getErrorString()),!!n&&void 0;var i=Sk(r);return 0==i.length?(mw(r),xt.isFunction(t)&&Ek(t,r),!!n&&void 0):n?void r._innerSend("SaveSelectedImagesToBase64Binary",mR(i.join(",")),!0,e,t):r._innerFun("SaveSelectedImagesToBase64Binary",mR(i.join(",")))}},{key:"ShowFileDialog",value:function(e,t,r,n,i,o,a,s){var u=this;if(u._resetErr(),!u._isValid())return!1;var c,l=pk.replaceLocalFilename(i);return c=u.__GetLoadEventsNum(),u._innerSend("ShowFileDialog",mR(e,t,r,n,l,o,a,s,c),!0),!0}},{key:"FTPDownload",value:function(e,t,r,n){var i=this,o=!1;if(xt.isFunction(r)&&(o=!0),i._resetErr(),!i._isValid())return xt.isFunction(n)&&Ek(n,i),!!o&&void 0;if(!e)return Zw(i),xt.isFunction(n)&&Ek(n,i),!!o&&void 0;var a=pk.getImageType(t);return Zj(i,nH,cH).call(i,"FTPDownload",mR(e,t),a,r,n)}},{key:"FTPDownloadEx",value:function(e,t,r,n,i){var o=this,a=!1;return xt.isFunction(n)&&(a=!0),o._resetErr(),o._isValid()?e?Zj(o,nH,cH).call(o,"FTPDownloadEx",mR(e,t,r),r,n,i):(Zw(o),xt.isFunction(i)&&Ek(i,o),!!a&&void 0):(xt.isFunction(i)&&Ek(i,o),!!a&&void 0)}},{key:"FTPUpload",value:function(e,t,r,n,i){var o=this,a=!1;if(xt.isFunction(n)&&(a=!0),o._resetErr(),!o._isValid())return xt.isFunction(i)&&Ek(i,o),!!a&&void 0;var s=o._ImgManager.convertClientIndexToServerId(t);if(!yk(o,t,i))return!!a&&void 0;if(-1==s)return Gw(o),xt.isFunction(i)&&Ek(i,o),!!a&&void 0;var u=o.__innerFTPUpload("FTPUpload",mR(e,s,r),n,i);return a?void 0:u}},{key:"FTPUploadEx",value:function(e,t,r,n,i,o){var a,s=this,u=!1;if(xt.isFunction(i)&&(u=!0),s._resetErr(),!s._isValid())return xt.isFunction(o)&&Ek(o,s),!!u&&void 0;if(!yk(s,t,o))return!!u&&void 0;if(-1==(a=s._ImgManager.convertClientIndexToServerId(t)))return Gw(s),xt.isFunction(o)&&Ek(o,s),!!u&&void 0;var c=s.__innerFTPUpload("FTPUploadEx",mR(e,a,r,n),i,o);return u?void 0:c}},{key:"FTPUploadAllAsMultiPageTIFF",value:function(e,t,r,n){var i=this,o=!1;if(xt.isFunction(r)&&(o=!0),i._resetErr(),!i._isValid())return xt.isFunction(n)&&Ek(n,i),!!o&&void 0;var a=[];mk(i,a);var s=i.__innerFTPUpload("FTPUploadAsMultiPageTIFF",mR(e,t,a.join(",")),r,n);return o?void 0:s}},{key:"FTPUploadAllAsPDF",value:function(e,t,r,n){var i=this,o=!1;if(xt.isFunction(r)&&(o=!0),i._resetErr(),!i._isValid())return xt.isFunction(n)&&Ek(n,i),!!o&&void 0;var a=[];mk(i,a);var s=i.__innerFTPUpload("FTPUploadAsMultiPagePDF",mR(e,t,a.join(",")),r,n);return o?void 0:s}},{key:"FTPUploadAsMultiPagePDF",value:function(e,t,r,n){var i=this,o=!1;if(xt.isFunction(r)&&(o=!0),i._resetErr(),!i._isValid())return xt.isFunction(n)&&Ek(n,i),!!o&&void 0;var a=Sk(i),s=i.__innerFTPUpload("FTPUploadAsMultiPagePDF",mR(e,t,a.join(",")),r,n);return o?void 0:s}},{key:"FTPUploadAsMultiPageTIFF",value:function(e,t,r,n){var i=this,o=!1;if(xt.isFunction(r)&&(o=!0),i._resetErr(),!i._isValid())return xt.isFunction(n)&&Ek(n,i),!!o&&void 0;var a=Sk(i),s=i.__innerFTPUpload("FTPUploadAsMultiPageTIFF",mR(e,t,a.join(",")),r,n);return o?void 0:s}},{key:"HTTPDownloadDirectly",value:function(e,t,r,n,i){var o,a=this,s=!1;if(xt.isFunction(n)&&(s=!0),a._resetErr(),!a._isValid())return xt.isFunction(i)&&Ek(i,a),!!s&&void 0;if(!sP.checkProductKey(a,{Core:!0}))return xt.isFunction(i)&&Ek(i,a),!!s&&void 0;var u,c,l=a._GetHttpHeadersAndClear(),d=pk.combineUrl(a,e,t);if(void 0===d)return kw(a),xt.isFunction(i)&&Ek(i,a),!!s&&void 0;if(!r||""==r)return function(e,t){fw(e,-2309,"The LocalFile is empty in the name HTTPDownloadDirectly Function.")}(a),xt.isFunction(i)&&Ek(i,a),!!s&&void 0;if(u=pk.getImageType(r),!sP.checkPDFProductKeyWhenNeeds(a,u))return xt.isFunction(i)&&Ek(i,a),!!s&&void 0;Dt.cancelFrom=fj.HTTPDownload,c=pk.replaceLocalFilename(r),a.IfShowProgressBar?Dt.showProgress(a,"HTTPDownloadDirectly",!1):Dt.hideProgress();var f=null===(o=Dt.progressContext)||void 0===o?void 0:o.IfShowCancelDialogWhenImageTransfer,h=function(){return a.IfShowProgressBar&&Dt.closeProgress(null,"HTTPDownloadDirectly"),xt.isFunction(n)&&n(),!0},g=function(){return Dt.progressContext&&(Dt.progressContext.IfShowCancelDialogWhenImageTransfer=f),a.IfShowProgressBar&&Dt.closeProgress(null,"HTTPDownloadDirectly"),xt.isFunction(i)&&Ek(i,a),!1};a._OnPercentDone([0,-1,QP.Downloading,"http"]),Dt.progressContext&&(Dt.progressContext.IfShowCancelDialogWhenImageTransfer=!0);var p=pk.loadHttpBlob(a,"get",d,s,(function(e){Dt.progressContext&&(Dt.progressContext.IfShowCancelDialogWhenImageTransfer=f),a._OnPercentDone([0,-1,QP.Loading]);var t=a.__GetLoadEventsNum();return a.__LoadImageFromBytesV1(e,3,c,t,s,h,g)}),g,(function(e){var t=0===e.total?100:Math.round(100*e.loaded/e.total);[e.loaded," / ",e.total].join(""),t>=100&&e.loaded<e.total&&(t=99),a._OnPercentDone([0,t,"","http"])}),l);return s?void 0:!!p}},{key:"HTTPUploadThroughPostDirectly",value:function(e,t,r,n,i,o){var a=this,s=!1,u=function(){xt.isFunction(o)&&Ek(o,a,a.__HTTPPostResponseString)};if(xt.isFunction(i)&&(s=!0),a._resetErr(),a.__HTTPPostResponseString="",!a._isValid())return u(),!!s&&void 0;var c=pk.combineUrl(a,e,r);if(!t)return Fw(a),u(),!!s&&void 0;if(!e)return Iw(a),u(),!!s&&void 0;var l=this.IfShowProgressBar;return a._innerUploadDirectly(c,t,n,l,!1,0,!0,!1,i,u)}},{key:"_innerUploadDirectly",value:function(e,t,r,n,i,o,a,s,u,c){var l,d,f=this,h=f._GetHttpHeadersAndClear(),g="HTTPUploadThroughPostDirectly",p=!1;if(xt.isFunction(u)&&(p=!0),void 0===e||!1===e||""===e)return kw(f),xt.isFunction(c)&&Ek(c,f),!!p&&void 0;if(!sP.checkProductKey(f,{Core:!0}))return xt.isFunction(c)&&Ek(c,f),!!p&&void 0;Dt.cancelFrom=fj.HTTPUpload;var _=function(e,t,r){return 0!=e&&t&&(f._errorCode=e,f._errorString=t),r&&(f.__HTTPPostResponseString=r),Dt.needShowTwiceShowDialog=!1,n&&Dt.closeProgress(null,g),xt.isFunction(c)&&Ek(c,f),!1};return Dt.needShowTwiceShowDialog=!0,n?Dt.showProgress(f,g,!1):Dt.hideProgress(),(l=pk.replaceLocalFilename(t))&&""!=l?s&&s.bCancel?(s.st=2,fE(f),_(f._errorCode,f._errorString),!!p&&void 0):(d=Zj(f,eH,aH).call(f,l,p,i,(function(t){if(Dt.needShowTwiceShowDialog=!1,s&&s.bCancel)return s.st=2,fE(f),_(f._errorCode,f._errorString),!1;if(t&&(!n||n&&Dt.dlgRef>0||0==p)){t instanceof File?t.fileName=r:t.name=r,n&&Cj(f.__IfShowCancelDialogWhenImageTransfer);var i=new Ej,c=f._createHttpUploaderConfig(),l=new Aj;return f.__remoteFilename&&""!=f.__remoteFilename&&(l.remoteFilename=f.__remoteFilename),c.objUploadStatus=s,l.url=e,l.method=g,l.content=t,t=null,l.contentType=f._strHttpContentTypeFieldValue,l.headers=h,l.bAsync=p,l.httpFormData=dH(f.httpFormFields),l.retry=o,l.bOnlyResponseEmptyIsOK=a,l.blockSize=f._moduleSize,i.httpPostUpload(c,l,(function(e){return n&&Dt.closeProgress(null,g),xt.isFunction(u)&&wk(u,e),!0}),_)}return Fw(f),_(f._errorCode,f._errorString),!1}),_),p?void 0:!!d):(Fw(f),_(f._errorCode,f._errorString),!!p&&void 0)}},{key:"_innerUploadFilesDirectly",value:function(e,t,r,n,i,o,a,s,u){var c,l=this,d=l._GetHttpHeadersAndClear(),f="HTTPUploadThroughPostDirectly",h=!1,g=[];if(xt.isFunction(s)&&(h=!0),!1===e||""===e)return kw(l),xt.isFunction(u)&&u({code:l._errorCode,message:l._getErrorString(),files:t}),!1;if(!sP.checkProductKey(l,{Core:!0}))return xt.isFunction(u)&&u({code:l._errorCode,message:l._getErrorString(),files:t}),!1;Dt.cancelFrom=fj.HTTPUpload;var p=function(e,r,i){return 0!=e&&r&&(l._errorCode=e,l._errorString=r),i&&(l.__HTTPPostResponseString=i),Dt.needShowTwiceShowDialog=!1,n&&Dt.closeProgress(null,f),xt.isFunction(u)&&u({code:l._errorCode,message:l._errorString,response:i,files:t}),!1};Dt.needShowTwiceShowDialog=!0,n?Dt.showProgress(l,f,!1):Dt.hideProgress(),xt.each(t,(function(e){var t=pk.replaceLocalFilename(e);if(!t||""==t)return Fw(l),p(l._errorCode,l._errorString),!1;g.push(t)}));var _=[],m=g.length,v=0;return xt.each(g,(function(t,u){c=Zj(l,eH,aH).call(l,t,h,i,(function(t){if(Dt.needShowTwiceShowDialog=!1,!t||n&&!(n&&Dt.dlgRef>0)&&0!=h)return n&&Dt.closeProgress(null,f),ww(l),xt.isFunction(p)&&p(l._errorCode,l._errorString),!1;var i=Sj(r,u+1);if(t instanceof File?t.fileName=i:t.name=i,_[u]=t,t=null,++v==m){n&&Cj(l.__IfShowCancelDialogWhenImageTransfer);var c=l._createHttpUploaderConfig(),g=new Aj;l.__remoteFilename&&""!=l.__remoteFilename&&(g.remoteFilename=l.__remoteFilename),g.url=e,g.method=f,g.content=_,_=null,g.contentType=l._strHttpContentTypeFieldValue,g.headers=d,g.bAsync=h,g.httpFormData=dH(l.httpFormFields),g.retry=o,g.bOnlyResponseEmptyIsOK=a,g.blockSize=l._moduleSize;var y=bj(c,g,(function(e){return n&&Dt.closeProgress(null,f),xt.isFunction(s)&&wk(s,e),!0}),(function(e,t,r){return n&&Dt.closeProgress(null,f),xt.isFunction(p)&&p(e,t,r),!1}));return h?void 0:y}}),(function(){return n&&Dt.closeProgress(null,f),xt.isFunction(p)&&p(),!1}))})),h?void 0:!!c}},{key:"_createHttpUploaderConfig",value:function(){var e=this,t=new Dj;return t.IfShowProgressBar=e.IfShowProgressBar,t.IfShowCancelDialogWhenImageTransfer=e.__IfShowCancelDialogWhenImageTransfer,t.MaxUploadImageSize=e.MaxUploadImageSize,t.HTTPRequestswithCredentials=e.HTTPRequestswithCredentials,t.onPercent=function(t){e._OnPercentDone(t)},t.onHttpUploadStatus=function(t){xt.isFunction(e.__OnHttpUploadStatus)&&e.__OnHttpUploadStatus(t)},t}},{key:"SetUploadSegment",value:function(e,t){var r=this;return r._resetErr(),!!r._isValid()&&(!xt.isNumber(e)||e<0?(fw(r,-2367,"Invalid value for the parameter segmentUploadThreshold."),!1):!xt.isNumber(t)||t<=0?(function(e){fw(e,-2368,"Invalid value for the parameter moduleSize.")}(r),!1):(r._segementUploadThreshold=1024*e*1024,r._moduleSize=1024*t,!0))}},{key:"ConvertToBase64",value:function(e,t,r,n){var i,o=this,a=arguments,s=!1;if(xt.isFunction(r)&&(s=!0),o._resetErr(),!o._isValid())return xt.isFunction(n)&&Ak(n,o,e,t,a),!!s&&void 0;var u=parseInt(t);if(!sP.checkProductKey(o,{Core:!0}))return xt.isFunction(n)&&Ak(n,o,e,t,a),!!s&&void 0;if(!o._checkIndices(e))return xt.isFunction(n)&&Ak(n,o,e,t,a),!!s&&void 0;if(u==Wt.DWT.EnumDWT_ImageType.IT_BMP||u==Wt.DWT.EnumDWT_ImageType.IT_JPG||u==Wt.DWT.EnumDWT_ImageType.IT_PNG){if(e.length>1)return fw(o,-2361,"You cannot convert more than one image to base64 string when the format is BMP, JPG or PNG."),xt.isFunction(n)&&Ak(n,o,e,t,a),!!s&&void 0}else if(u!=Wt.DWT.EnumDWT_ImageType.IT_TIF&&u!=Wt.DWT.EnumDWT_ImageType.IT_PDF)return Hw(o),xt.isFunction(n)&&Ak(n,o,e,t,a),!!s&&void 0;if(0==(i=Ck(o,e)).length)return pw(o),xt.isFunction(n)&&Ak(n,o,e,t,a),!!s&&void 0;Dt.cancelFrom=fj.ConvertToBlob,o._convertToBase64ByServerIdsWithUI("ConvertToBase64",i,u,!1,3,(function(e){var n=[];xt.isArray(i)&&xt.each(i,(function(e){var t=o._ImgManager.convertServerIdToClientIndex(e);t>-1&&n.push(t)})),xt.isFunction(r)&&wk(r,e,n,t,a)}),(function(){var e=[];xt.isArray(i)&&xt.each(i,(function(t){var r=o._ImgManager.convertServerIdToClientIndex(t);r>-1&&e.push(r)})),xt.isFunction(n)&&Ak(n,o,e,t,a)}))}},{key:"ClearAllHTTPFormField",value:function(){var e=this;return e._resetErr(),!!e._isValid()&&(e.httpFormFields={},!0)}},{key:"SetHTTPFormField",value:function(e,t,r){var n=this;if(n._resetErr(),!n._isValid())return!1;var i=e;return xt.isString(i)||(i=""+i),t instanceof Blob&&(t.name=r),n.httpFormFields[i]=t,!0}},{key:"HTTPDownloadThroughPost",value:function(e,t,r,n,i,o){var a,s,u=this,c=u._GetHttpHeadersAndClear(),l=pk.combineUrl(u,e,t),d=!1;if(xt.isFunction(n)&&(d=!0),void 0===l)return kw(u),xt.isFunction(i)&&Ek(i,u,""),!!d&&void 0;if(!sP.checkProductKey(u,{Core:!0}))return xt.isFunction(i)&&Ek(i,u,""),!!d&&void 0;if(!sP.checkPDFProductKeyWhenNeeds(u,r))return xt.isFunction(i)&&Ek(i,u,""),!!d&&void 0;Dt.cancelFrom=fj.HTTPDownload,u.IfShowProgressBar?Dt.showProgress(u,"HttpDownloadThroughPost",!1):Dt.hideProgress(),u._OnPercentDone([0,-1,QP.Downloading,"http"]);var f=null===(a=Dt.progressContext)||void 0===a?void 0:a.IfShowCancelDialogWhenImageTransfer,h=function(){return u.IfShowProgressBar&&Dt.closeProgress(null,"HttpDownloadThroughPost"),xt.isFunction(n)&&n(),!0},g=function(){return Dt.progressContext&&(Dt.progressContext.IfShowCancelDialogWhenImageTransfer=f),u.IfShowProgressBar&&Dt.closeProgress(null,"HttpDownloadThroughPost"),xt.isFunction(i)&&Ek(i,u,u.__HTTPPostResponseString),!1};return Dt.progressContext&&(Dt.progressContext.IfShowCancelDialogWhenImageTransfer=!0),s=pk.loadHttpBlob(u,"post",l,d,(function(e){Dt.progressContext&&(Dt.progressContext.IfShowCancelDialogWhenImageTransfer=f),u._OnPercentDone([0,-1,QP.Loading]);var t=r;t!=Wt.DWT.EnumDWT_ImageType.IT_BMP&&t!=Wt.DWT.EnumDWT_ImageType.IT_JPG&&t!=Wt.DWT.EnumDWT_ImageType.IT_TIF&&t!=Wt.DWT.EnumDWT_ImageType.IT_PNG&&t!=Wt.DWT.EnumDWT_ImageType.IT_PDF&&t!=Wt.DWT.EnumDWT_ImageType.IT_J2K&&(t=-1);var n=u.__GetLoadEventsNum();return u.__LoadImageFromBytesV1(e,t,"",n,d,h,g)}),g,(function(e){var t=0===e.total?100:Math.round(100*e.loaded/e.total);[e.loaded," / ",e.total].join(""),t>=100&&e.loaded<e.total&&(t=99),u._OnPercentDone([0,t,"","http"])}),c),d?void 0:!!s}},{key:"HTTPDownloadThroughGet",value:function(e,t,r,n,i){return this._innerHTTPDownloadThroughGet("HTTPDownload",e,t,r,n,i)}},{key:"HTTPUploadThroughPut",value:function(e,t,r,n,i){var o=pk.getImageType(r);return this.HTTPUploadThroughPutEx(e,t,r,o,n,i)}},{key:"HTTPUploadThroughPutEx",value:function(e,t,r,n,i,o){var a=this,s=a._GetHttpHeadersAndClear(),u="HTTPUploadThroughPutEx",c=pk.combineUrl(a,e,r),l=!1,d=[],f=!1,h=this.IfShowProgressBar;if(xt.isFunction(i)&&(l=!0),void 0===c)return kw(a),xt.isFunction(o)&&Ak(o,a,"",[t],r,n),!!l&&void 0;Dt.cancelFrom=fj.HTTPPut;var g,p=function(){Dt.needShowTwiceShowDialog=!1,h&&Dt.closeProgress(null,u),xt.isFunction(o)&&Ak(o,a,a.__HTTPPostResponseString,d,r,n)};switch(Dt.needShowTwiceShowDialog=!0,h?Dt.showProgress(a,u,!1):Dt.hideProgress(),t){case-1:for(var _=0;_<a._ImgManager.count();_++)d.push(_);break;case-2:d=a._ImgManager.getSelectedClientIndexArray();break;default:if(d.push(t),!(t>=0))return Gw(a),p(),!!l&&void 0}if(""===e)return Iw(a),p(),!!l&&void 0;var m=[];xt.isArray(d)&&xt.each(d,(function(e){var t=a._ImgManager.convertClientIndexToServerId(e);-1!=t&&m.push(t)}));a._OnPercentDone([0,-1,QP.Encoding,"http"]);var v=function(e,t,o){if(Wt.DWT.IfAddMD5InUploadHeader&&t&&""!=t&&(s["dwt-md5"]=t),Dt.needShowTwiceShowDialog=!1,e&&(!h||h&&Dt.dlgRef>0||0==l)){var d=a.__maxUploadImageSize;return e.size>d&&-1!=d?(xw(a),p(),!!l&&void 0):(g=function(e){var t=0===e.total?100:Math.round(100*e.loaded/e.total);[e.loaded," / ",e.total].join(""),t>=100&&e.loaded<e.total&&(t=99),a._OnPercentDone([0,t,"","http"])},a._OnPercentDone([0,-1,QP.Uploading,"http"]),h&&Cj(a.__IfShowCancelDialogWhenImageTransfer),Dt.cancelFrom=fj.HTTPPut,f=pk.httpPutImage(a,c,e,l,(function(e){if(e&&(a.__HTTPPostResponseString=e),h&&Dt.closeProgress(null,u),xt.isFunction(i)){var t=[];xt.isArray(m)&&xt.each(m,(function(e){var r=a._ImgManager.convertServerIdToClientIndex(e);r>-1&&t.push(r)})),wk(i,a.__HTTPPostResponseString,t,r,n)}return!0}),p,g),e=null,l?void 0:!!f)}return e=null,h&&Dt.closeProgress(null,u),!!l&&void 0};if(!l)return a._dwtConvertToBlobSync(n,m,false,v,p);a._convertToBlobForUpload(n,m,false,4,v,p)}},{key:"HTTPUploadAllThroughPutAsMultiPageTIFF",value:function(e,t,r,n){return this.HTTPUploadThroughPutEx(e,-1,t,2,r,n)}},{key:"HTTPUploadThroughPutAsMultiPageTIFF",value:function(e,t,r,n){return this.HTTPUploadThroughPutEx(e,-2,t,2,r,n)}},{key:"HTTPUploadAllThroughPutAsPDF",value:function(e,t,r,n){return this.HTTPUploadThroughPutEx(e,-1,t,4,r,n)}},{key:"HTTPUploadThroughPutAsMultiPagePDF",value:function(e,t,r,n){return this.HTTPUploadThroughPutEx(e,-2,t,4,r,n)}},{key:"GetSelectedImagesSize",value:function(e){var t=this;if(t._resetErr(),!t._isValid())return!1;var r=Sk(t);return t._innerFun("GetSelectedImagesSize",mR(e,r.join(",")))}},{key:"SetHTTPHeader",value:function(e,t){var r=this;if(r._resetErr(),!r._isValid())return!1;var n,i,o=e;if(r.__httpHeaderMap||(r.__httpHeaderMap={}),!o||!xt.isString(o))return xt.isUndefined(o)?fw(r,-2356,"The header name cannot be undefined."):""===o?function(e){fw(e,-2354,"The header name cannot be empty.")}(r):null===o?function(e){fw(e,-2355,"The header name cannot be null.")}(r):function(e){fw(e,-2357,"The header name you entered is invalid.")}(r),!1;for(n=["if-none-match","if-range","range","accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","date","dnt","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","user-agent","via"],o=o.toLowerCase(),i=0;i<n.length;i++)if(n[i]==o)return Uw(r),!1;return xt.isUndefined(t)||null===t||""===t?(e in r.__httpHeaderMap&&delete r.__httpHeaderMap[e],!0):(xt.isNumber(t)&&(t=""+t),r.__httpHeaderMap[e]=t,!0)}},{key:"ConvertToBlob",value:function(e,t,r,n,i){var o=arguments;return this._convertToBlobByIndices(e,t,!1,o,r,n)}},{key:"_asyncUploadFilesCmd",value:function(e,t,r,n,i,o,a,s,u,c,l,d){var f=this,h=parseInt(i),g="HTTPUpload",p=e,_=[];f.__HTTPPostResponseString="",Dt.cancelFrom=fj.HTTPUpload;var m=function(e,r,n){var i=[];if(xt.isArray(t)&&xt.each(t,(function(e){var t=f._ImgManager.convertServerIdToClientIndex(e);t>-1&&i.push(t)})),0!=e&&r&&(f._errorCode=e,f._errorString=r),n&&(f.__HTTPPostResponseString=n),f._bServerPercentDone=!0,Dt.needShowTwiceShowDialog=!1,s&&Dt.closeProgress(null,g),_.slice(0),_=null,xt.isFunction(d))try{d({code:f._errorCode,message:f._errorString,response:n,indices:i})}catch(o){}};Dt.needShowTwiceShowDialog=!0,s?Dt.showProgress(f,g,!1):Dt.hideProgress();var v=t.length,y=0,S=0,T="";f._bServerPercentDone=!1,f._OnPercentDone([0,-1,QP.Encoding,"http"]),xt.each(t,(function(e,i){f._convertToBlobForUpload(h,[e],a,4,(function(e,a,d){if(!e||e.size<=0)return Pw(f),m(f._errorCode,f._errorString);var h=f.__maxUploadImageSize;if(e.size>h&&-1!=h)return xw(f),m(f._errorCode,f._errorString);var I=Sj(o,i+1);if(S=(y+1)/v*100,T=[y+1,"/",v].join(""),f._OnPercentDone([0,S,T,"http",I]),e.name=I,_.push(e),++y>=v){Wt.DWT.IfAddMD5InUploadHeader&&a&&""!=a&&(r["dwt-md5"]=a);var b=f._createHttpUploaderConfig(),C=new Aj;f.__remoteFilename&&""!=f.__remoteFilename&&(C.remoteFilename=f.__remoteFilename),C.url=p,C.method=g,C.content=_,C.contentType=f._strHttpContentTypeFieldValue,C.headers=r,C.httpFormData=n,C.retry=u,C.bOnlyResponseEmptyIsOK=c,C.blockSize=f._moduleSize,bj(b,C,(function(e){f.__HTTPPostResponseString=b.HTTPPostResponse,function(e){if(f._bServerPercentDone=!0,Dt.needShowTwiceShowDialog=!1,s&&Dt.closeProgress(null,g),_.slice(0),_=null,xt.isFunction(l)){var r=[];xt.isArray(t)&&xt.each(t,(function(e){var t=f._ImgManager.convertServerIdToClientIndex(e);t>-1&&r.push(t)})),wk(l,e,r)}}(e)}),m)}e=null}),m,[e,i])}))}},{key:"_getVersionInfoAsync",value:function(){return sw.versionInfoFromServer?Wb.Promise.resolve(sw.versionInfoFromServer):this._innerFunV2("VersionInfo")}},{key:"__innerLoadImage",value:function(e,t,r,n,i,o,a){var s=this,u=!1;if((xt.isFunction(o)||Wt.DWT.ConnectWithSocket)&&(u=!0),!sP.checkProductKey(s,{Core:!0}))return xt.isFunction(a)&&a({code:s._errorCode,message:s._getErrorString()}),!!u&&void 0;if(!sP.checkPDFProductKeyWhenNeeds(s,r))return xt.isFunction(a)&&a({code:s._errorCode,message:s._getErrorString()}),!!u&&void 0;if(u){if(s._bRemoteMode&&s._getIfShowFileDialog())return lE(s),void(xt.isFunction(a)&&a({code:s._errorCode,message:s._getErrorString()}));var c=s.IfShowCancelDialogWhenImageTransfer;return s.IfShowCancelDialogWhenImageTransfer=!1,void s.__innerAcquireOrLoadImageAsync(e,t,n,!0).then((function(){s.IfShowCancelDialogWhenImageTransfer=c,xt.isFunction(o)&&o()}),(function(e){s.IfShowCancelDialogWhenImageTransfer=c,s._errorCode=e.code,s._errorString=e.message,xt.isFunction(a)&&a(e)}))}if(s._bRemoteMode&&s._getIfShowFileDialog())return lE(s),!1;var l=s._getCurrentDocumentName(),d=s._getCurrentDefaultTagName();return s.__innerLoadImageFun(e,t,i,l,d)}},{key:"__innerLoadImageFun",value:function(e,t,r,n,i){var o,a=this,s=!0;if(o=a._innerFunRaw(e,t,!1,!1,!0),a.__bOpenFileNow=!1,0!=a._errorCode)return!1;if(xt.isArray(o.result)&&o.result.length>0){if(r){var u;if("FTPDownload"==e||"FTPDownloadEx"==e)u=JSON.stringify(o.result);else{var c=o.result[0];xt.isObject(c)?u=c.imageInfos:-1!=c||"LoadImage"!=e&&"LoadImageEx"!=e&&"LoadImageFromBase64Binary"!=e&&"LoadDibFromClipboard"!=e||(s=!1)}xt.isString(u)&&a._handleOnBitmapChangedEvent({result:["c1",u]},{document:n,tag:i})}else{var l=o.result.join(",");a._OnBitmapChanged(["c1",l,1,a._ImgManager.getCurrentImageIndex(),a._ImgManager.count()],null,{document:n,tag:i})}if(s)return a._canConsume()&&Wt.DWT.lcvrf(a),!0}return nA(a._errorCode)&&Mw(a),!1}},{key:"__innerSaveImage",value:function(e,t,r,n){var i,o=this,a=!1;if(xt.isFunction(r)&&(a=!0),a&&o._OnPercentDone([0,-1,QP.Encoding]),o._bRemoteMode||(Wt.DWT.IfAlwaysFocusOnPopupWindow?o._OnPageFocus(!0):o._OnPageBlur(!0)),0==a)return o._bRemoteMode?o._serviceSyncMethodNotSupport(e):this._innerFun(e,t);if(o._bRemoteMode&&o._getIfShowFileDialog())return lE(o),void(xt.isFunction(n)&&n(o._errorCode,o._getErrorString()));var s=null===(i=Dt.progressContext)||void 0===i?void 0:i.IfShowCancelDialogWhenImageTransfer;o.IfShowProgressBar?Dt.showProgress(o,e,!1):Dt.hideProgress(),Dt.progressContext&&(Dt.progressContext.IfShowCancelDialogWhenImageTransfer=!1),o._innerSend(e,t,!0,(function(){Dt.progressContext&&(Dt.progressContext.IfShowCancelDialogWhenImageTransfer=s),Dt.closeProgress(null,e),xt.isFunction(r)&&r()}),(function(t){return Dt.progressContext&&(Dt.progressContext.IfShowCancelDialogWhenImageTransfer=s),xt.isFunction(n)&&n(o._errorCode,o._getErrorString()),Dt.closeProgress(null,e),t&&xt.error(t),!1}))}},{key:"__captureImage",value:function(e,t,r,n){var i=this.__GetLoadEventsNum();return this.__LoadImageFromBytesV2(e,t,"",!0,0,0,!0,i,r,n)}},{key:"_getIfShowFileDialog",value:function(){return this._resetErr(),this._isValid()?this._innerFun("IfShowFileDialog"):Lb}},{key:"SaveAsBMP",value:function(e,t,r,n){var i=this,o=!1;if((xt.isFunction(r)||Y.bAndroid)&&(o=!0),i._resetErr(),!i._isValid())return xt.isFunction(n)&&Ek(n,i),!!o&&void 0;if(!(sP.checkProductKey(i,{Core:!0})||Y.bWin&&sP.checkProductKey(i,{Webcam:!0},!0)))return sP.checkProductKey(i,{Core:!0},!1),xt.isFunction(n)&&Ek(n,i),!!o&&void 0;var a,s=pk.replaceLocalFilename(e);if(!yk(i,t,n))return!!o&&void 0;if(Y.bAndroid){if(0==i._ImgManager.count())return mw(i),void(xt.isFunction(n)&&Ek(n,i));var u=[];return u.push(t),void i._saveImages("SaveAsBMP",s,u,dx.IT_BMP).then((function(){xt.isFunction(r)&&r()})).catch((function(e){xt.isFunction(n)&&n(e.code,e.message)}))}if(-1==(a=i._ImgManager.convertClientIndexToServerId(t)))return Gw(i),xt.isFunction(n)&&Ek(n,i),!!o&&void 0;var c=i.__GetLoadEventsNum(),l=i.__innerSaveImage("SaveAsBMP",mR(s,a,c),r,n);return o?void 0:l}},{key:"SaveAsJPEG",value:function(e,t,r,n){var i=this,o=!1;if((xt.isFunction(r)||Y.bAndroid)&&(o=!0),i._resetErr(),!i._isValid())return xt.isFunction(n)&&Ek(n,i),!!o&&void 0;if(!(sP.checkProductKey(i,{Core:!0})||Y.bWin&&sP.checkProductKey(i,{Webcam:!0},!0)))return sP.checkProductKey(i,{Core:!0},!1),xt.isFunction(n)&&Ek(n,i),!!o&&void 0;if(!yk(i,t,n))return!!o&&void 0;var a,s=pk.replaceLocalFilename(e);if(Y.bAndroid){if(0==i._ImgManager.count())return mw(i),void(xt.isFunction(n)&&Ek(n,i));var u=[];return u.push(t),void i._saveImages("SaveAsJPEG",s,u,dx.IT_JPG).then((function(){xt.isFunction(r)&&r()})).catch((function(e){xt.isFunction(n)&&n(e.code,e.message)}))}if(-1==(a=i._ImgManager.convertClientIndexToServerId(t)))return Gw(i),xt.isFunction(n)&&Ek(n,i),!!o&&void 0;var c=i.__GetLoadEventsNum(),l=i.__innerSaveImage("SaveAsJPEG",mR(s,a,c),r,n);return o?void 0:l}},{key:"SaveAsPDF",value:function(e,t,r,n){var i=this,o=!1;if((xt.isFunction(r)||Y.bAndroid)&&(o=!0),i._resetErr(),!i._isValid())return xt.isFunction(n)&&Ek(n,i),!!o&&void 0;if(!(sP.checkProductKey(i,{Core:!0})||Y.bWin&&sP.checkProductKey(i,{Webcam:!0},!0)))return sP.checkProductKey(i,{Core:!0},!1),xt.isFunction(n)&&Ek(n,i),!!o&&void 0;if(!yk(i,t,n))return!!o&&void 0;var a,s=pk.replaceLocalFilename(e);if(Y.bAndroid){if(0==i._ImgManager.count())return mw(i),void(xt.isFunction(n)&&Ek(n,i));var u=[];return u.push(t),void i._saveImages("SaveAsPDF",s,u,dx.IT_PDF).then((function(){xt.isFunction(r)&&r()})).catch((function(e){xt.isFunction(n)&&n(e.code,e.message)}))}if(-1==(a=i._ImgManager.convertClientIndexToServerId(t)))return Gw(i),xt.isFunction(n)&&Ek(n,i),!!o&&void 0;var c=i.__GetLoadEventsNum(),l=i.__innerSaveImage("SaveAsPDF",mR(s,a,c),r,n);return o?void 0:l}},{key:"SaveAsPNG",value:function(e,t,r,n){var i=this,o=!1;if((xt.isFunction(r)||Y.bAndroid)&&(o=!0),i._resetErr(),!i._isValid())return xt.isFunction(n)&&Ek(n,i),!!o&&void 0;if(!(sP.checkProductKey(i,{Core:!0})||Y.bWin&&sP.checkProductKey(i,{Webcam:!0},!0)))return sP.checkProductKey(i,{Core:!0},!1),xt.isFunction(n)&&Ek(n,i),!!o&&void 0;if(!yk(i,t,n))return!!o&&void 0;var a,s=pk.replaceLocalFilename(e);if(Y.bAndroid){if(0==i._ImgManager.count())return mw(i),void(xt.isFunction(n)&&Ek(n,i));var u=[];return u.push(t),void i._saveImages("SaveAsPNG",s,u,dx.IT_PNG).then((function(){xt.isFunction(r)&&r()})).catch((function(e){xt.isFunction(n)&&n(e.code,e.message)}))}if(-1==(a=i._ImgManager.convertClientIndexToServerId(t)))return Gw(i),xt.isFunction(n)&&Ek(n,i),!!o&&void 0;var c=i.__GetLoadEventsNum(),l=i.__innerSaveImage("SaveAsPNG",mR(s,a,c),r,n);return o?void 0:l}},{key:"SaveAsTIFF",value:function(e,t,r,n){var i=this,o=!1;if((xt.isFunction(r)||Y.bAndroid)&&(o=!0),i._resetErr(),!i._isValid())return xt.isFunction(n)&&Ek(n,i),!!o&&void 0;if(!(sP.checkProductKey(i,{Core:!0})||Y.bWin&&sP.checkProductKey(i,{Webcam:!0},!0)))return sP.checkProductKey(i,{Core:!0},!1),xt.isFunction(n)&&Ek(n,i),!!o&&void 0;if(!yk(i,t,n))return!!o&&void 0;var a,s=pk.replaceLocalFilename(e);if(Y.bAndroid){if(0==i._ImgManager.count())return mw(i),void(xt.isFunction(n)&&Ek(n,i));var u=[];return u.push(t),void i._saveImages("SaveAsTIFF",s,u,dx.IT_TIF).then((function(){xt.isFunction(r)&&r()})).catch((function(e){xt.isFunction(n)&&n(e.code,e.message)}))}if(-1==(a=i._ImgManager.convertClientIndexToServerId(t)))return Gw(i),xt.isFunction(n)&&Ek(n,i),!!o&&void 0;var c=i.__GetLoadEventsNum(),l=i.__innerSaveImage("SaveAsTIFF",mR(s,a,c),r,n);return o?void 0:l}},{key:"SaveSelectedImagesAsMultiPagePDF",value:function(e,t,r){var n=this,i=!1;if((xt.isFunction(t)||Y.bAndroid)&&(i=!0),n._resetErr(),!n._isValid())return xt.isFunction(r)&&Ek(r,n),!!i&&void 0;if(!(sP.checkProductKey(n,{Core:!0})||Y.bWin&&sP.checkProductKey(n,{Webcam:!0},!0)))return sP.checkProductKey(n,{Core:!0},!1),xt.isFunction(r)&&Ek(r,n),!!i&&void 0;var o=pk.replaceLocalFilename(e);if(!Y.bAndroid){var a=Sk(n);if(0==a.length)return mw(n),xt.isFunction(r)&&Ek(r,n),!!i&&void 0;var s=n.__GetLoadEventsNum(),u=n.__innerSaveImage("SaveSelectedImagesAsMultiPagePDF",mR(o,a.join(","),s),t,r);return i?void 0:u}if(0==n._ImgManager.count())return mw(n),void(xt.isFunction(r)&&Ek(r,n));var c=Tk(n);n._saveImages("SaveSelectedImagesAsMultiPagePDF",o,c,dx.IT_PDF).then((function(){xt.isFunction(t)&&t()})).catch((function(e){xt.isFunction(r)&&r(e.code,e.message)}))}},{key:"SaveSelectedImagesAsMultiPageTIFF",value:function(e,t,r){var n=this,i=!1;if((xt.isFunction(t)||Y.bAndroid)&&(i=!0),n._resetErr(),!n._isValid())return xt.isFunction(r)&&Ek(r,n),!!i&&void 0;if(!(sP.checkProductKey(n,{Core:!0})||Y.bWin&&sP.checkProductKey(n,{Webcam:!0},!0)))return sP.checkProductKey(n,{Core:!0},!1),xt.isFunction(r)&&Ek(r,n),!!i&&void 0;var o=pk.replaceLocalFilename(e);if(!Y.bAndroid){var a=Sk(n);if(0==a.length)return mw(n),xt.isFunction(r)&&Ek(r,n),!!i&&void 0;var s=n.__GetLoadEventsNum(),u=n.__innerSaveImage("SaveSelectedImagesAsMultiPageTIFF",mR(o,a.join(","),s),t,r);return i?void 0:u}if(0==n._ImgManager.count())return mw(n),void(xt.isFunction(r)&&Ek(r,n));var c=Tk(n);n._saveImages("SaveSelectedImagesAsMultiPageTIFF",o,c,dx.IT_TIF).then((function(){xt.isFunction(t)&&t()})).catch((function(e){xt.isFunction(r)&&r(e.code,e.message)}))}},{key:"SaveAllAsMultiPageTIFF",value:function(e,t,r){var n=this,i=!1;if((xt.isFunction(t)||Y.bAndroid)&&(i=!0),n._resetErr(),!n._isValid())return xt.isFunction(r)&&Ek(r,n),!!i&&void 0;if(!(sP.checkProductKey(n,{Core:!0})||Y.bWin&&sP.checkProductKey(n,{Webcam:!0},!0)))return sP.checkProductKey(n,{Core:!0},!1),xt.isFunction(r)&&Ek(r,n),!!i&&void 0;if(!vk(n,r))return!!i&&void 0;var o=[],a=pk.replaceLocalFilename(e);if(!Y.bAndroid){if(mk(n,o),0==o.length)return mw(n),xt.isFunction(r)&&Ek(r,n),!!i&&void 0;var s=n.__GetLoadEventsNum(),u=n.__innerSaveImage("SaveSelectedImagesAsMultiPageTIFF",mR(a,o.join(","),s),t,r);return i?void 0:u}if(0==n._ImgManager.count())return mw(n),void(xt.isFunction(r)&&Ek(r,n));for(var c=[],l=0;l<this._ImgManager.count();l++)c.push(l);n._saveImages("SaveAllAsMultiPageTIFF",a,c,dx.IT_TIF).then((function(){xt.isFunction(t)&&t()})).catch((function(e){xt.isFunction(r)&&r(e.code,e.message)}))}},{key:"SaveAllAsPDF",value:function(e,t,r){var n=this,i=!1;if((xt.isFunction(t)||Y.bAndroid)&&(i=!0),n._resetErr(),!n._isValid())return xt.isFunction(r)&&Ek(r,n),!!i&&void 0;if(!(sP.checkProductKey(n,{Core:!0})||Y.bWin&&sP.checkProductKey(n,{Webcam:!0},!0)))return sP.checkProductKey(n,{Core:!0},!1),xt.isFunction(r)&&Ek(r,n),!!i&&void 0;if(!vk(n,r))return!!i&&void 0;var o=[],a=pk.replaceLocalFilename(e);if(!Y.bAndroid){if(mk(n,o),0==o.length)return mw(n),xt.isFunction(r)&&Ek(r,n),!!i&&void 0;var s=n.__GetLoadEventsNum(),u=n.__innerSaveImage("SaveSelectedImagesAsMultiPagePDF",mR(a,o.join(","),s),t,r);return i?void 0:u}if(0==n._ImgManager.count())return mw(n),void(xt.isFunction(r)&&Ek(r,n));for(var c=[],l=0;l<this._ImgManager.count();l++)c.push(l);n._saveImages("SaveAllAsPDF",a,c,dx.IT_PDF).then((function(){xt.isFunction(t)&&t()})).catch((function(e){xt.isFunction(r)&&r(e.code,e.message)}))}},{key:"HTTPUpload",value:function(e,t,r,n,i,o,a){var s=this,u=null!=i?i:"RemoteFile",c=s._GetHttpHeadersAndClear(),l=o,d=a;if(s._resetErr(),arguments.length<=3)return l=t,d=r,void this._innerFormFieldHTTPUpload(e,c,l,d);if(xt.isFunction(arguments[4])&&xt.isFunction(arguments[5])&&(u="RemoteFile",l=arguments[4],arguments.length>5&&(d=arguments[5])),s._isValid()){var f,h=arguments,g=function(e){xt.isFunction(d)&&Ak(d,s,s.__HTTPPostResponseString,e,h)};if(xt.isUndefined(e)||""===e)return kw(s),void(g&&g(t));if(!xt.isString(e))return Kw(s),void(g&&g(t));if(s._checkIndices(t)){var p=Ck(s,t);if(0==p.length)return pw(s),void(g&&g(t));if(xt.isUndefined(r))return Hw(s),void(g&&g(t));if(r==Wt.DWT.EnumDWT_ImageType.IT_BMP||r==Wt.DWT.EnumDWT_ImageType.IT_JPG||r==Wt.DWT.EnumDWT_ImageType.IT_PNG){if(p.length>1)return Lw(s),void g(t)}else if(r!=Wt.DWT.EnumDWT_ImageType.IT_TIF&&r!=Wt.DWT.EnumDWT_ImageType.IT_PDF)return Hw(s),void g(t);if(xt.isUndefined(n)||n!=Wt.DWT.EnumDWT_UploadDataFormat.Binary&&n!=Wt.DWT.EnumDWT_UploadDataFormat.Base64)return zw(s),void g(t);f={method:"HTTPUpload",url:e,serverIds:p,headers:c,formData:dH(s.httpFormFields),enumImageType:r,saveSetup:!1,dataFormat:n,fileName:u,retry:0,bOnlyResponseEmptyIsOK:!0,objUploadFileStatus:!1,asyncSuccessFunc:function(e,t){xt.isFunction(l)&&wk(l,s.__HTTPPostResponseString,t,h)},asyncFailureFunc:g},this._asyncUploadCmd(f)}else g&&g(t)}else xt.isFunction(d)&&Ek(d,s,"")}},{key:"_innerFormFieldHTTPUpload",value:function(e,t,r,n){var i,o=this,a="HTTPUpload",s=e,u=o.IfShowProgressBar;if(o._isValid()){if(xt.isUndefined(s)||""===s)return kw(o),void(xt.isFunction(n)&&Ek(n,o,""));if(!xt.isString(s))return Kw(o),void(xt.isFunction(n)&&Ek(n,o,""));0!=s.indexOf("http://")&&0!=s.indexOf("https://")&&(s=Dt.detect.ssl?"https://"+s:"http://"+s),o.__HTTPPostResponseString="",Dt.cancelFrom=fj.HTTPUpload,i=function(e,t,r){0!=e&&t&&(o._errorCode=e,o._errorString=t),r&&(o.__HTTPPostResponseString=r),Dt.needShowTwiceShowDialog=!1,Dt.closeProgress(null,a),xt.isFunction(n)&&Ek(n,o,o.__HTTPPostResponseString)},u?Dt.showProgress(o,a,!1):Dt.hideProgress(),Dt.needShowTwiceShowDialog=!0,o._OnPercentDone([0,-1,QP.Uploading,"http"]);var c=o._createHttpUploaderConfig(),l=new Aj;o.__remoteFilename&&""!=o.__remoteFilename&&(l.remoteFilename=o.__remoteFilename),l.url=s,l.method=a,l.content=[],l.headers=t,l.httpFormData=dH(o.httpFormFields),l.blockSize=o._moduleSize,(new Ej).httpPostUpload(c,l,(function(t){Dt.needShowTwiceShowDialog=!1,Dt.closeProgress(null,a),xt.isFunction(r)&&wk(r,t,e,[e,r,n])}),i)}else xt.isFunction(n)&&Ek(n,o,"")}},{key:"HTTPUploadThroughPost",value:function(e,t,r,n,i,o,a){var s=this,u=!1;if(xt.isFunction(i)&&(u=!0),s._resetErr(),!s._isValid())return!!u&&void 0;var c=pk.getImageType(n),l=arguments,d=!1,f=function(e){return xt.isFunction(o)&&Ak(o,s,s.__HTTPPostResponseString,e,l),!1};return xt.isString(n)&&""!=n?(i&&xt.isFunction(i)&&(d=function(e,t){return wk(i,s.__HTTPPostResponseString,t,l),!0}),lH(s,t,c,f)?Zj(s,$j,oH).call(s,e,t,r,n,c,d,f,a):!!u&&void 0):(Pw(s),f(),!!u&&void 0)}},{key:"HTTPUploadThroughPostEx",value:function(e,t,r,n,i,o,a,s){var u=this,c=!1;if(xt.isFunction(o)&&(c=!0),u._resetErr(),!u._isValid())return xt.isFunction(a)&&Ak(a,u,""),!!c&&void 0;var l=arguments,d=!1,f=function(e){xt.isFunction(a)&&Ak(a,u,u.__HTTPPostResponseString,e,l)};return xt.isString(n)&&""!=n?(o&&xt.isFunction(o)&&(d=function(e,t){wk(o,u.__HTTPPostResponseString,t,l)}),lH(u,t,i,f)?Zj(u,$j,oH).call(u,e,t,r,n,i,d,f,s):!!c&&void 0):(Pw(u),f(),!!c&&void 0)}},{key:"HTTPUploadAllThroughPostAsMultiPageTIFF",value:function(e,t,r,n,i,o){var a=this,s=!1;if(xt.isFunction(n)&&(s=!0),a._resetErr(),!a._isValid())return xt.isFunction(i)&&Ak(i,a,""),!!s&&void 0;var u=arguments,c=!1,l=function(e){xt.isFunction(i)&&Ak(i,a,a.__HTTPPostResponseString,e,u)};return xt.isString(r)&&""!=r?(s&&(c=function(e,t){wk(n,a.__HTTPPostResponseString,t,u)}),Zj(a,$j,oH).call(a,e,-1,t,r,2,c,l,o)):(Pw(a),l(),!!s&&void 0)}},{key:"HTTPUploadAllThroughPostAsPDF",value:function(e,t,r,n,i,o){var a=this,s=!1;if(xt.isFunction(n)&&(s=!0),a._resetErr(),!a._isValid())return xt.isFunction(i)&&Ek(i,a,""),!!s&&void 0;var u=arguments,c=!1,l=function(e){return xt.isFunction(i)&&Ak(i,a,a.__HTTPPostResponseString,e,u),!1};return xt.isString(r)&&""!=r?(s&&(c=function(e,t){wk(n,a.__HTTPPostResponseString,t,u)}),Zj(a,$j,oH).call(a,e,-1,t,r,4,c,l,o)):(Pw(a),l())}},{key:"HTTPUploadThroughPostAsMultiPagePDF",value:function(e,t,r,n,i,o){var a=this,s=!1;if(xt.isFunction(n)&&(s=!0),a._resetErr(),!a._isValid())return xt.isFunction(i)&&Ek(i,a,""),!!s&&void 0;var u=arguments,c=!1,l=function(e){xt.isFunction(i)&&Ak(i,a,a.__HTTPPostResponseString,e,u)};return xt.isString(r)&&""!=r?(s&&(c=function(e,t){wk(n,a.__HTTPPostResponseString,t,u)}),Zj(a,$j,oH).call(a,e,-2,t,r,4,c,l,o)):(Pw(a),l(),!!s&&void 0)}},{key:"HTTPUploadThroughPostAsMultiPageTIFF",value:function(e,t,r,n,i,o){var a=this,s=!1;if(xt.isFunction(n)&&(s=!0),a._resetErr(),!a._isValid())return xt.isFunction(i)&&Ek(i,a,""),!!s&&void 0;var u=arguments,c=!1,l=function(e){xt.isFunction(i)&&Ak(i,a,a.__HTTPPostResponseString,e,u)};return xt.isString(r)&&""!=r?(s&&(c=function(e,t){wk(n,a.__HTTPPostResponseString,t,u)}),Zj(a,$j,oH).call(a,e,-2,t,r,2,c,l,o)):(Pw(a),l(),!!s&&void 0)}},{key:"_innerHTTPDownloadThroughGet",value:function(e,t,r,n,i,o){var a,s,u=this,c=u._GetHttpHeadersAndClear(),l=u.IfShowProgressBar,d=pk.combineUrl(u,t,r),f=!1;if(xt.isFunction(i)&&(f=!0),void 0===d)return kw(u),xt.isFunction(o)&&Ek(o,u),!!f&&void 0;if(!sP.checkProductKey(u,{Core:!0}))return xt.isFunction(o)&&Ek(o,u),!!f&&void 0;if(!sP.checkPDFProductKeyWhenNeeds(u,n))return xt.isFunction(o)&&Ek(o,u),!!f&&void 0;Dt.cancelFrom=fj.HTTPDownload;var h=null===(a=Dt.progressContext)||void 0===a?void 0:a.IfShowCancelDialogWhenImageTransfer,g=u._getCurrentDocumentName(),p=u._getCurrentDefaultTagName();return xt.log("_innerHTTPDownloadThroughGet.currentFileName:"+g+", tag="+p),l&&f?(u.__IfShowCancelDialogWhenImageTransfer&&(Dt.progressContext.__cancelBeforObjectCreated=!0),Dt.showProgress(u,e,u.__IfShowCancelDialogWhenImageTransfer)):f&&Dt.hideProgress(),u._OnPercentDone([0,-1,QP.Downloading,"http"]),s=pk.loadHttpBlob(u,"get",d,f,(function(t){Dt.progressContext&&(Dt.progressContext.IfShowCancelDialogWhenImageTransfer=h),l&&f&&Cj(!1),u._OnPercentDone([0,-1,QP.Loading]);var r=n;r!=Wt.DWT.EnumDWT_ImageType.IT_BMP&&r!=Wt.DWT.EnumDWT_ImageType.IT_JPG&&r!=Wt.DWT.EnumDWT_ImageType.IT_TIF&&r!=Wt.DWT.EnumDWT_ImageType.IT_PNG&&r!=Wt.DWT.EnumDWT_ImageType.IT_PDF&&r!=Wt.DWT.EnumDWT_ImageType.IT_J2K&&(r=-1),t.currentFileName=g,t.currentTagName=p;var a=u.__GetLoadEventsNum();return u.__LoadImageFromBytesV1(t,r,"",a,f,(function(){return l&&f&&Dt.closeProgress(null,e),xt.isFunction(i)&&i(),!0}),(function(){return l&&f&&Dt.closeProgress(null,e),xt.isFunction(o)&&Ek(o,u),!1}))}),(function(){return Dt.progressContext&&(Dt.progressContext.IfShowCancelDialogWhenImageTransfer=h),l&&f&&Dt.closeProgress(null,e),xt.isFunction(o)&&Ek(o,u),!1}),(function(e){var t=0===e.total?100:Math.round(100*e.loaded/e.total);[e.loaded," / ",e.total].join(""),t>=100&&e.loaded<e.total&&(t=99),u._OnPercentDone([0,t,"","http"])}),c),f?void 0:!!s}},{key:"LoadImage",value:function(e,t,r){var n=this,i=!1;if(xt.isFunction(t)&&(i=!0),n._resetErr(),!n._isValid())return xt.isFunction(r)&&Ek(r,n),!!i&&void 0;var o,a,s,u=pk.replaceLocalFilename(e),c=pk.getImageType(u);t&&xt.isFunction(t)&&(a=function(e){t()}),r&&xt.isFunction(r)&&(s=function(e){r(e.code,e.message)}),o=n.__GetLoadEventsNum(),""==u&&(n.__bOpenFileNow=!0);var l=n._getCurrentDocumentName(),d=n._getCurrentDefaultTagName();return n.__innerLoadImage("LoadImage",mR(u,o,1,l,d),c,!0,1,a,s)}},{key:"LoadImageEx",value:function(e,t,r,n){var i=this,o=!1;if(xt.isFunction(r)&&(o=!0),i._resetErr(),!i._isValid())return xt.isFunction(n)&&Ek(n,i),!!o&&void 0;var a,s,u,c=pk.replaceLocalFilename(e),l=t;if(r&&xt.isFunction(r)&&(s=function(e){r()}),n&&xt.isFunction(n)&&(u=function(e){n(e.code,e.message)}),!Y.bAndroid){l==Wt.DWT.EnumDWT_ImageType.IT_ALL&&(l=-1),a=i.__GetLoadEventsNum(),""==c&&(i.__bOpenFileNow=!0);var d=i._getCurrentDocumentName(),f=i._getCurrentDefaultTagName();return i.__innerLoadImage("LoadImageEx",mR(c,l,a,1,d,f),l,!0,1,s,u)}var h=Wb.one(".d-loadImage");if(0==h.length){var g=document.createElement("input");g._stwain=i,g.setAttribute("type","file"),g.setAttribute("multiple","multiple"),g.style="position:absolute;top:-2px;left:-2px;width:1px;height:1px;",g.className="d-loadImage",t==Wt.DWT.EnumDWT_ImageType.IT_BMP?g.setAttribute("accept","image/bmp"):t==Wt.DWT.EnumDWT_ImageType.IT_JPG?g.setAttribute("accept","image/jpeg"):t==Wt.DWT.EnumDWT_ImageType.IT_TIF?g.setAttribute("accept","image/tiff"):t==Wt.DWT.EnumDWT_ImageType.IT_PNG?g.setAttribute("accept","image/png"):t==Wt.DWT.EnumDWT_ImageType.IT_PDF?g.setAttribute("accept",".pdf"):t==Wt.DWT.EnumDWT_ImageType.IT_J2K?g.setAttribute("accept",".jp2,.j2k,.j2c"):lR.bMobile?g.setAttribute("accept","image/jpeg,image/png,image/tiff,image/tif"):g.setAttribute("accept","image/*,.pdf,.jp2,.j2k,.j2c"),g.ondoubleclick=function(){this.files.length>0&&this._stwain.LoadImageFromBinary(this.files,s,u),this.value="",this._stwain=null,g&&g.parentElement.removeChild(g)},g.onchange=function(){this.files.length>0&&this._stwain.LoadImageFromBinary(this.files,s,u),this.value="",this._stwain=null,g&&g.parentElement.removeChild(g)},document.body.appendChild(g),g.click()}else t==Wt.DWT.EnumDWT_ImageType.IT_BMP?h[0].setAttribute("accept","image/bmp"):t==Wt.DWT.EnumDWT_ImageType.IT_JPG?h[0].setAttribute("accept","image/jpeg"):t==Wt.DWT.EnumDWT_ImageType.IT_TIF?h[0].setAttribute("accept","image/tiff"):t==Wt.DWT.EnumDWT_ImageType.IT_PNG?h[0].setAttribute("accept","image/png"):t==Wt.DWT.EnumDWT_ImageType.IT_PDF?h[0].setAttribute("accept",".pdf"):t==Wt.DWT.EnumDWT_ImageType.IT_J2K?h[0].setAttribute("accept",".jp2,.j2k,.j2c"):lR.bMobile?h[0].setAttribute("accept","image/jpeg,image/png,image/tiff,image/tif"):h[0].setAttribute("accept","image/*,.pdf,.jp2,.j2k,.j2c"),h[0].value="",h[0]._stwain=i,h[0].click()}},{key:"HTTPDownload",value:function(e,t,r,n){var i=this,o=!1;if(xt.isFunction(r)&&(o=!0),i._resetErr(),!i._isValid())return xt.isFunction(n)&&Ek(n,i),!!o&&void 0;var a=pk.getImageType(t);return i._innerHTTPDownloadThroughGet("HTTPDownload",e,t,a,r,n)}},{key:"HTTPDownloadEx",value:function(e,t,r,n,i){var o=this,a=!1;return xt.isFunction(n)&&(a=!0),o._resetErr(),o._isValid()?o._innerHTTPDownloadThroughGet("HTTPDownloadEx",e,t,r,n,i):(xt.isFunction(i)&&Ek(i,o),!!a&&void 0)}},{key:"getFormateDate",value:function(){var e=new Date,t=e.getFullYear(),r=e.getMonth()+1,n=e.getDate(),i=e.getHours(),o=e.getMinutes(),a=e.getSeconds();return r<=9&&(r="0"+r),n<=9&&(n="0"+n),i<=9&&(i="0"+i),o<=9&&(o="0"+o),a<=9&&(a="0"+a),{currentTime_title:t+"-"+r+"-"+n+" "+i+":"+o+":"+a,currentTime_info:r+"/"+n+"/"+t+" "+i+":"+o+":"+a}}},{key:"__shareImagesInner",value:function(e,t,r,n){var i=navigator;i.canShare&&i.canShare({files:e})&&i.share({files:e,title:t,text:this.getFormateDate().currentTime_info}).then((function(){xt.isFunction(r)&&r()})).catch((function(e){xt.isFunction(n)&&n(e)}))}},{key:"ShareImages",value:(n=GE(m.mark((function e(t,r,n){var i,o,a,s,u,c,l,d,f;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this,!Y.bAndroid){e.next=39;break}if(n!=dx.IT_ALL&&n!=dx.IT_MULTIPAGE_PDF&&n!=dx.IT_MULTIPAGE_TIF){e.next=5;break}throw mE(i),{code:i._errorCode,message:i._errorString};case 5:if(o=r.sort((function(e,t){return e-t})),!(o.length>0)){e.next=37;break}if(a="IMAGE File",n==dx.IT_PDF&&(a="PDF File"),s=Tj(t,n),xt.isUndefined(s)&&(s=t),n!=dx.IT_PDF&&n!=dx.IT_TIF){e.next=15;break}return e.abrupt("return",new Wb.Promise((function(e,t){i.ConvertToBlob(o,n,(function(r,n,o){var u=[new File([r],s,{type:r.type})];i.__shareImagesInner(u,a,(function(){e()}),(function(e){t({code:0!=e.code?e.code:2201,message:e.message})}))}),(function(){t({code:i._errorCode,message:i._errorString})}))})));case 15:u=[],c=s,e.t0=n,e.next=e.t0===dx.IT_BMP?20:e.t0===dx.IT_JPG?22:e.t0===dx.IT_PNG?24:26;break;case 20:return l=".bmp",e.abrupt("break",27);case 22:return l=".jpg",e.abrupt("break",27);case 24:return l=".png",e.abrupt("break",27);case 26:l=".jpg";case 27:s&&s.lastIndexOf(".")>0&&(c=s.substring(0,s.lastIndexOf(".")),l=s.substring(s.lastIndexOf("."),s.length)),d=m.mark((function e(t){return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Wb.Promise((function(e,r){i.ConvertToBlob([o[t]],n,(function(r,n,i){0==t?u.push(new File([r],c+l,{type:r.type})):u.push(new File([r],c+t+l,{type:r.type})),e()}),(function(){r({code:i._errorCode,message:i._errorString})}))}));case 2:case"end":return e.stop()}}),e)})),f=0;case 31:if(!(f<o.length)){e.next=36;break}return e.delegateYield(d(f),"t1",33);case 33:f++,e.next=31;break;case 36:i.__shareImagesInner(u,a);case 37:e.next=41;break;case 39:throw fw(i,-2617,"ShareImages is only supported on Android devices."),{code:i._errorCode,message:i._errorString};case 41:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return n.apply(this,arguments)})},{key:"Addon",get:function(){return this.__addon}},{key:"LoadDibFromClipboard",value:function(e,t){var r,n,i,o=this,a=!1;return xt.isFunction(e)&&(a=!0),o._resetErr(),o._isValid()?o._bRemoteMode?(fw(o,-2609,"LoadDibFromClipboard is not supported when Object is created by CreateRemoteScanObjectAsync."),xt.isFunction(t)&&Ek(t,o),!!a&&void 0):(e&&xt.isFunction(e)&&(r=function(t){e()}),t&&xt.isFunction(t)&&(n=function(e){t(e.code,e.message)}),i=o.__GetLoadEventsNum(),o.__innerLoadImage("LoadDibFromClipboard",mR(i,1),-1,!0,1,r,n)):(xt.isFunction(t)&&Ek(t,o),!!a&&void 0)}},{key:"__innerGetBarcodeResultAsyncFunction",value:function(e){var t=Dt.NewBarcodeResult();return e&&(t._errorCode=e.exception,t._errorString=e.description,t._resultlist=e.result,t._Count=e.result.length),t}},{key:"__innerGetOCRResultAsyncFunction",value:function(e){var t=Dt.NewOCRResult(this);return e&&(t._errorCode=e.exception,t._errorString=e.description,t._resultlist=e.result),t}},{key:"__innerFTPUpload",value:function(e,t,r,n){return Dt.cancelFrom=fj.FTPUpload,Zj(this,rH,uH).call(this,e,t,!0,r,n)}},{key:"_GetHttpHeadersAndClear",value:function(){var e=this.__httpHeaderMap;return this.__httpHeaderMap={},e||(e={}),e}},{key:"_asyncUploadCmd",value:function(e){var t,n=this,i=e.url,o=e.asyncSuccessFunc,a=e.asyncFailureFunc,s=n.IfShowCancelDialogWhenImageTransfer,u=null===(t=Dt.progressContext)||void 0===t?void 0:t.IfShowCancelDialogWhenImageTransfer,c=e.method,l=e.serverIds,d=e.headers,f=e.formData,h=e.enumImageType,g=e.dataFormat,p=e.fileName,_=e.saveSetup,m=e.retry,v=e.bOnlyResponseEmptyIsOK,y=e.objUploadFileStatus,S=function(e,t,r){n.IfShowCancelDialogWhenImageTransfer=s,Dt.progressContext&&(Dt.progressContext.IfShowCancelDialogWhenImageTransfer=u);var i=[];if(xt.isArray(l)&&xt.each(l,(function(e){var t=n._ImgManager.convertServerIdToClientIndex(e);t>-1&&i.push(t)})),0!=e&&t&&(n._errorCode=e,n._errorString=t),r&&(n.__HTTPPostResponseString=r),xt.isFunction(a))try{a(i)}catch(o){}return!1};return xt.isNumber(m)&&m>0||(m=0),0!=n._errorCode?S(n._errorCode,n._errorString,n.__HTTPPostResponseString):(n.__HTTPPostResponseString="",n.IfShowCancelDialogWhenImageTransfer=!0,Dt.progressContext.IfShowCancelDialogWhenImageTransfer=n.IfShowCancelDialogWhenImageTransfer,r._innerHTTPUpload(n,c,i,d,f,l,h,g,p,_,m,v,y,(function(e){if(n.IfShowCancelDialogWhenImageTransfer=s,Dt.progressContext&&(Dt.progressContext.IfShowCancelDialogWhenImageTransfer=u),xt.isFunction(o)){var t=[];xt.isArray(l)&&xt.each(l,(function(e){var r=n._ImgManager.convertServerIdToClientIndex(e);r>-1&&t.push(r)}));try{wk(o,e,t)}catch(r){}e=null}return!0}),S))}}],[{key:"_innerHTTPUpload",value:function(e,t,r,n,i,o,a,s,u,c,l,d,f,h,g){var p=parseInt(a),_=parseInt(s),m=u,v=r,y=e._segementUploadThreshold;if(xt.isUndefined(a))return Hw(e),xt.isFunction(g)&&g(e._errorCode,e._errorString,""),!1;e._resetErr(),Dt.cancelFrom=fj.HTTPUpload;var S,T=function(r,n,i){return 0!=r&&n&&(e._errorCode=r,e._errorString=n),i&&(e.__HTTPPostResponseString=i),Dt.needShowTwiceShowDialog=!1,e.IfShowProgressBar&&Dt.closeProgress(null,t),xt.isFunction(g)&&g(e._errorCode,e._errorString,e.__HTTPPostResponseString),!1},I=e._createHttpUploaderConfig();if(I.objUploadStatus=f,m=Tj(m,p),Dt.needShowTwiceShowDialog=!0,e.IfShowProgressBar?(Dt.showProgress(e,t,!1),Dt.progressContext&&(Dt.progressContext._onPercent=function(e){var t,r,n=0;e&&(t=e.loaded,r=e.total,(n=Math.floor(t/r*100))>100&&(n=100));Dt.progressBarOnPercentDone(-1,"Transferring...","",n,"")})):Dt.hideProgress(),_==Wt.DWT.EnumDWT_UploadDataFormat.Binary){if(f&&f.bCancel)return f.st=2,fE(e),T(e._errorCode,e._errorString);e._OnPercentDone([0,-1,QP.Encoding,"http"]),e._convertToBlobForUpload(p,o,c,4,(function(r,o,a){if(S=function(r){return Dt.needShowTwiceShowDialog=!1,e.IfShowProgressBar&&Dt.closeProgress(null,t),xt.isFunction(h)&&wk(h,r),!0},f&&f.bCancel)return f.st=2,fE(e),T(e._errorCode,e._errorString);if(!r||r.size<=0)return Pw(e),T(e._errorCode,e._errorString);var s=e.__maxUploadImageSize;if(r.size>s&&-1!=s)return xw(e),T(e._errorCode,e._errorString);if(0!=e._errorCode)return T(e._errorCode,e._errorString);if(Wt.DWT.IfAddMD5InUploadHeader&&o&&""!=o&&(n["dwt-md5"]=o),y>0&&r.size>y){e._OnPercentDone([0,-1,QP.Uploading,"http",m]);var u=new Ej,c=new Aj;return e.__remoteFilename&&""!=e.__remoteFilename&&(c.remoteFilename=e.__remoteFilename),c.url=v,c.method=t,c.content=r,r=null,c.contentType=e._strHttpContentTypeFieldValue,c.headers=n,c.fileName=m,c.httpFormData=i,c.retry=l,c.bOnlyResponseEmptyIsOK=d,c.blockSize=e._moduleSize,u.httpPostUploadFragment(I,c,S,T)}var g=new Ej,p=new Aj;e.__remoteFilename&&""!=e.__remoteFilename&&(p.remoteFilename=e.__remoteFilename),p.url=v,p.method=t,p.content=r,r=null,p.contentType=e._strHttpContentTypeFieldValue,p.headers=n,p.fileName=m,p.httpFormData=i,p.retry=l,p.bOnlyResponseEmptyIsOK=d,p.blockSize=e._moduleSize,I.objUploadStatus=f,g.httpPostUpload(I,p,S,T)}),T)}else _==Wt.DWT.EnumDWT_UploadDataFormat.Base64&&e._convertToBase64ByServerIdsWithUI(t,o,p,c,4,(function(r){var o;if(!r||r.getLength()<=0)return Pw(e),T(e._errorCode,e._errorString);if(S=function(){return Dt.needShowTwiceShowDialog=!1,e.IfShowProgressBar&&Dt.closeProgress(null,t),xt.isFunction(h)&&wk(h,r),!0},y>0&&r.getLength()>y){o=r.getMD5(),Wt.DWT.IfAddMD5InUploadHeader&&(n["dwt-md5"]=o),e._OnPercentDone([0,-1,QP.Uploading,"http"]);var a=new Aj;e.__remoteFilename&&""!=e.__remoteFilename&&(a.remoteFilename=e.__remoteFilename),a.url=v,a.method=t,a.content=r.getData(0,r.getLength()),a.headers=n,a.fileName=m,a.httpFormData=i,a.retry=l,a.bOnlyResponseEmptyIsOK=d,a.blockSize=e._moduleSize,a.offset=0,(new Ej).httpPostUploadFragment(I,a,S,T)}else{var s;if(o=r.getMD5(),Wt.DWT.IfAddMD5InUploadHeader&&(n["dwt-md5"]=o),!(s=r.getData(0,r.getLength()))||""==s)return Pw(e),T(e._errorCode,e._errorString);var u=new Aj;e.__remoteFilename&&""!=e.__remoteFilename&&(u.remoteFilename=e.__remoteFilename),u.url=v,u.method=t,u.content=s,u.headers=n,u.fileName=m,u.httpFormData=i,u.retry=l,u.bOnlyResponseEmptyIsOK=d,u.blockSize=e._moduleSize,(new Ej).httpPostUpload(I,u,S,T)}}),T)}}]);var n}(Hj);function oH(e,t,r,n,i,o,a,s){var u,c,l=this,d="HTTPUploadThroughPostEx",f=l._GetHttpHeadersAndClear(),h=pk.combineUrl(l,e,r),g=[],p=function(e){xt.isFunction(a)&&a(e)},_=!1;if(xt.isFunction(o)&&(_=!0),l.__HTTPPostResponseString="",xt.isNumber(t)){if(t<-2)return Gw(l),p(t),!!_&&void 0}else if(!xt.isArray(t))return Gw(l),p(t),!!_&&void 0;if(!xt.isString(n)||""==n)return Pw(l),p(),!!_&&void 0;if(xt.isUndefined(i))return Hw(l),p(t),!!_&&void 0;if(i==Wt.DWT.EnumDWT_ImageType.IT_BMP||i==Wt.DWT.EnumDWT_ImageType.IT_JPG||i==Wt.DWT.EnumDWT_ImageType.IT_PNG||i==Wt.DWT.EnumDWT_ImageType.IT_J2K){if(-1==t&&l._ImgManager.count()>1||xt.isArray(t)&&t.length>1)return Lw(l),p(t),!!_&&void 0;xt.isArray(t)?g.push(t[0]):-1==t?g.push(0):g.push(t)}else{if(i!=Wt.DWT.EnumDWT_ImageType.IT_TIF&&i!=Wt.DWT.EnumDWT_ImageType.IT_PDF)return Hw(l),p(t),!!_&&void 0;if(-1==t){if(0==l._ImgManager.count())return mw(l),p(),!!_&&void 0;for(c=0;c<l._ImgManager.count();c++)g.push(c)}else if(-2==t)g=l._ImgManager.getSelectedClientIndexArray();else if(xt.isArray(t))for(c=0;c<t.length;c++)g.push(t[c]);else g.push(t)}if(""===e)return Iw(l),p(g),!!_&&void 0;if(xt.isUndefined(h)||""===h)return kw(l),p(g),!!_&&void 0;if(!xt.isString(h))return Kw(l),p(g),!!_&&void 0;if(0!=h.indexOf("http://")&&0!=h.indexOf("https://")&&(h=Dt.detect.ssl?"https://"+h:"http://"+h),!l._checkIndices(g)&&-1!=g)return p(g),!!_&&void 0;var m=[];if(xt.isArray(g)&&xt.each(g,(function(e){var t=l._ImgManager.convertClientIndexToServerId(e);-1!=t&&m.push(t)})),l._resetErr(),!l._isValid())return p(g),!!_&&void 0;if(!_){Dt.cancelFrom=fj.HTTPUpload;var v=this.IfShowProgressBar,y=function(e,t,r){return 0!=e&&t&&(l._errorCode=e,l._errorString=t),r&&(l.__HTTPPostResponseString=r),Dt.needShowTwiceShowDialog=!1,v&&Dt.closeProgress(null,d),p(g),!1};return Dt.needShowTwiceShowDialog=!0,v?Dt.showProgress(l,d,!1):Dt.hideProgress(),l._OnPercentDone([0,-1,QP.Encoding,"http"]),l._dwtConvertToBlobSync(i,m,false,(function(e,t){if(Dt.needShowTwiceShowDialog=!1,e){var r=l.__maxUploadImageSize;if(e.size>r&&-1!=r)return xw(l),y(l._errorCode,l._errorString),!1;Wt.DWT.IfAddMD5InUploadHeader&&t&&""!=t&&(f["dwt-md5"]=t),e instanceof File?e.fileName=n:e.name=n,v&&Cj(l.__IfShowCancelDialogWhenImageTransfer);var i=l._createHttpUploaderConfig(),o=new Aj;return l.__remoteFilename&&""!=l.__remoteFilename&&(o.remoteFilename=l.__remoteFilename),o.url=h,o.method=d,o.content=e,o.contentType=l._strHttpContentTypeFieldValue,o.headers=f,o.bAsync=!1,o.httpFormData=dH(l.httpFormFields),o.blockSize=l._moduleSize,(new Ej).httpPostUpload(i,o,(function(e){return v&&Dt.closeProgress(null,d),e}),y)}var a={};return ww(a),y(a._errorCode,a._errorString),!1}),y)}u={method:"HTTPUploadThroughPostEx",url:h,serverIds:m,headers:f,formData:dH(l.httpFormFields),enumImageType:i,saveSetup:false,fileName:n,retry:0,bOnlyResponseEmptyIsOK:!0,objUploadFileStatus:!1,dataFormat:Wt.DWT.EnumDWT_UploadDataFormat.Binary,asyncSuccessFunc:o,asyncFailureFunc:p},this._asyncUploadCmd(u)}function aH(e,t,r,n,i){var o=this;if(t)return o._innerFunRaw("SaveSelectedImagesToBytes",mR(0,0,e,r),t,true,!0,(function(e){if(xt.isFunction(n)){var t=new Blob([e],{type:o._strHttpContentTypeFieldValue});n(t),t=null}}),i),!0;var a=o._innerFunRaw("SaveSelectedImagesToBytes",mR(0,0,e,r),t,true,!1);if(0==o._errorCode){var s=n(a);return a=null,s}return a=null,i(),!1}function sH(){return this._resetErr(),!!this._isValid()&&(this._innerSend("SetCancel",null,!0),!0)}function uH(e,t,r,n,i){var o=this;if(!xt.isFunction(n))return this._innerFun(e,t);o.IfShowProgressBar?(Dt.showProgress(o,e,r),r&&Dt.progressContext&&Dt.progressContext.on("cancel",(function(){Zj(o,tH,sH).call(o)}))):Dt.hideProgress(),this._innerSend(e,t,!0,(function(){Dt.closeProgress(null,e),xt.isFunction(n)&&n()}),(function(t){xt.isFunction(i)&&i(o._errorCode,o._getErrorString()),Dt.closeProgress(null,e),t&&xt.error(t)}))}function cH(e,t,r,n,i){var o,a=this,s=!1;if(xt.isFunction(n)&&(s=!0),!sP.checkProductKey(a,{Core:!0}))return xt.isFunction(i)&&Ek(i,a),!!s&&void 0;if(!sP.checkPDFProductKeyWhenNeeds(a,r))return xt.isFunction(i)&&Ek(i,a),!!s&&void 0;if(Dt.cancelFrom=fj.FTPDownload,!s){var u=a._getCurrentDocumentName(),c=a._getCurrentDefaultTagName();(o=a.__innerLoadImageFun(e,t,1,u,c))&&a._canConsume()&&Wt.DWT.lcvrf(a);var l=a._ImgManager.getCurrentImageIndex();return l>=0&&a._innerRefreshUI(l),o}Zj(a,rH,uH).call(a,e,t,!0,(function(){var e=a._ImgManager.getCurrentImageIndex();e>=0&&a._innerRefreshUI(e),a._canConsume()&&Wt.DWT.lcvrf(a),xt.isFunction(n)&&n()}),i)}function lH(e,t,r,n){if(0==e._ImgManager.count())return mw(e),xt.isFunction(n)&&n(t),!1;if(xt.isNumber(t)){if(isNaN(t)||t<-2||t>=e._ImgManager.count())return Gw(e),xt.isFunction(n)&&n(t),!1}else{if(!xt.isArray(t))return Gw(e),xt.isFunction(n)&&n(t),!1;var i;for(i=0;i<t.length;i++){var o=t[i];if(isNaN(o)||!xt.isNumber(o)||o<0||o>=e._ImgManager.count())return Bw(e),xt.isFunction(n)&&n(t),!1}}if(r==Wt.DWT.EnumDWT_ImageType.IT_BMP||r==Wt.DWT.EnumDWT_ImageType.IT_JPG||r==Wt.DWT.EnumDWT_ImageType.IT_PNG||r==Wt.DWT.EnumDWT_ImageType.IT_J2K)(-1==t&&e._ImgManager.count()>1||xt.isArray(t)&&t.length>1)&&(Lw(e),xt.isFunction(n)&&n(t));else if(r!=Wt.DWT.EnumDWT_ImageType.IT_TIF&&r!=Wt.DWT.EnumDWT_ImageType.IT_PDF)return Hw(e),xt.isFunction(n)&&n(t),!1;return!0}function dH(e){var t;return e&&(t=new FormData,xt.each(e,(function(e,r){if(e instanceof Blob){var n=e.name;t.append(r,e,n)}else t.append(r,e)}))),t}var fH,hH=function(e){function r(){return t(this,r),e=this,i=arguments,n=QE(n=r),YE(e,function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(QG){return!1}}()?Reflect.construct(n,i||[],QE(e).constructor):n.apply(e,i));var e,n,i}return qE(r,e),s(r,[{key:"Viewer",get:function(){return this._viewer}},{key:"BindViewer",value:function(e){var t=this,r=e;return Wt.DWT.UseDefaultViewer?(xt.isString(e)&&(r=xt.get(e),xt.show(r)),t._config.container!=r&&(t._config.container=r,Mj(t)),t._UIView.BindView(e)):(fw(t,-2439,"You cannot call the method bindViewer() when Dynamsoft.DWT.UseDefaultViewer is set to false."),!1)}},{key:"UnbindViewer",value:function(){return this._innerUnbindViewer(!1)}},{key:"AddText",value:function(e,t,r,n,i,o,a,s){var u=this,c=parseInt(e);if(!Ik(u,c))return!1;var l=Nb.RGB2BGR(i),d=Nb.RGB2BGR(o),f=u._ImgManager.convertClientIndexToServerId(c);return-1==f?(Gw(u),!1):u._innerFun("AddText",mR(f,t,r,n,l,d,a,s))}},{key:"CreateTextFont",value:function(e,t,r,n,i,o,a,s,u,c,l,d,f,h){return this._resetErr(),!!this._isValid()&&this._innerFun("CreateTextFont",mR(e,t,r,n,i,o,a,s,u,c,l,d,f,h))}},{key:"CopyToClipboard",value:function(e){var t=parseInt(e);return!!Ik(this,t)&&gH(this,"CopyToClipboard",t,null,null,!1,!1)}},{key:"CopyToClipboardAsync",value:function(e){var t=this;if(t._resetErr(),!t._isValid())return Wb.Promise.reject({code:t._errorCode,message:t._errorString});var r=parseInt(e);return isNaN(r)?(pw(t),Wb.Promise.reject({code:t._errorCode,message:t._errorString})):r<0||r>=t._ImgManager.count()?(Gw(t),Wb.Promise.reject({code:t._errorCode,message:t._errorString})):function(e,t,r){var n=e._ImgManager.convertClientIndexToServerId(r);return-1==n?(Gw(e),Wb.Promise.reject({code:e._errorCode,message:e._errorString})):e._innerFunV2("CopyToClipboard",mR(n))}(t,0,r)}},{key:"getView",value:function(){return this._UIView}},{key:"Erase",value:function(e,t,r,n,i,o,a){var s=this;if(!xt.isFunction(o)){var u,c=parseInt(e);if(!Ik(s,c,a))return!1;var l=s._ImgManager.convertClientIndexToServerId(c);return-1==l?(Gw(s),xt.isFunction(a)&&a(s._errorCode,s._getErrorString()),!1):(s.getView().ClearSelectedAreas(),(u=1==s._innerFun("Erase",mR(l,t,r,n,i)))?xt.isFunction(o)&&o():xt.isFunction(a)&&a(s._errorCode,s._getErrorString()),u)}s.EraseAsync(e,t,r,n,i).then(o,(function(e){s._wrappeAsyncFailed(s,e,a)}))}},{key:"EraseAsync",value:function(e,t,r,n,i){var o=this;if(o._resetErr(),!o._isValid())return Wb.Promise.reject({code:o._errorCode,message:o._errorString});var a=parseInt(e);if(isNaN(a))return pw(o),Wb.Promise.reject({code:o._errorCode,message:o._errorString});if(a<0||a>=o._ImgManager.count())return Gw(o),Wb.Promise.reject({code:o._errorCode,message:o._errorString});var s=o._ImgManager.convertClientIndexToServerId(a);return-1==s?(Gw(o),Wb.Promise.reject({code:o._errorCode,message:o._errorString})):(o.getView().ClearSelectedAreas(),o._innerFunV2("Erase",mR(s,t,r,n,i),!0).then((function(e){if(1!=e)throw{code:o._errorCode,message:o._errorString}})))}},{key:"GetImageBitDepth",value:function(e){var t=this,r=parseInt(e);if(!Ik(t,r))return!1;var n=t._ImgManager.convertClientIndexToServerId(r);return-1==n?(Gw(t),!1):t._innerFun("GetImageBitDepth",mR(n))}},{key:"GetImageWidth",value:function(e){var t=this;if(t._resetErr(),!t._isValid())return!1;var r=parseInt(e);if(isNaN(r))return pw(t),-1;if(r<0||r>=t._ImgManager.count())return Gw(t),-1;var n=t._ImgManager.convertClientIndexToServerId(r);return-1==n?(Gw(t),-1):t._innerFun("GetImageWidth",mR(n))}},{key:"GetImageHeight",value:function(e){var t=this;if(t._resetErr(),!t._isValid())return!1;var r=parseInt(e);if(isNaN(r))return pw(t),-1;if(r<0||r>=t._ImgManager.count())return Gw(t),-1;var n=t._ImgManager.convertClientIndexToServerId(r);return-1==n?(Gw(t),-1):t._innerFun("GetImageHeight",mR(n))}},{key:"GetImageSize",value:function(e,t,r){var n=this;if(n._resetErr(),!n._isValid())return!1;var i=parseInt(e);if(isNaN(i))return pw(n),-1;if(i<0||i>=n._ImgManager.count())return Gw(n),-1;var o=n._ImgManager.convertClientIndexToServerId(i);return-1==o?(Gw(n),-1):n._innerFun("GetImageSize",mR(o,t,r))}},{key:"GetImageSizeWithSpecifiedType",value:function(e,t){var r=this;if(r._resetErr(),!r._isValid())return!1;var n=parseInt(e);if(isNaN(n))return pw(r),-1;if(n<0||n>=r._ImgManager.count())return Gw(r),-1;var i=r._ImgManager.convertClientIndexToServerId(n);return-1==i?(Gw(r),-1):r._innerFun("GetImageSizeWithSpecifiedType",mR(i,t))}},{key:"GetImageXResolution",value:function(e){var t=this,r=parseInt(e);if(!Ik(t,r))return!1;var n=t._ImgManager.convertClientIndexToServerId(r);return-1==n?(Gw(t),!1):t._innerFun("GetImageXResolution",mR(n))}},{key:"GetImageYResolution",value:function(e){var t=this,r=parseInt(e);if(!Ik(t,r))return!1;var n=t._ImgManager.convertClientIndexToServerId(r);return-1==n?(Gw(t),!1):t._innerFun("GetImageYResolution",mR(n))}},{key:"SelectAllImages",value:function(){var e,t=this,r=t._getHowManyImagesInBuffer(),n=[];if(t._resetErr(),!t._isValid())return!1;for(e=0;e<r;e++)n.push(e);return t._ImgManager.setSelectedClientIndexArray(n),n}},{key:"SelectImages",value:function(e){var t=this;return t._resetErr(),!!t._isValid()&&t._ImgManager.setSelectedClientIndexArray(e)}},{key:"GetSkewAngle",value:function(e,t,r){var n,i=this;if(!xt.isFunction(t)){var o=parseInt(e);return!!Ik(i,o,r)&&(n=gH(i,"GetSkewAngle",o,t,r,!0,!1),0==i._errorCode?(pk.refreshImageAfterInvokeFun(i,o),n):0)}i.GetSkewAngleAsync(e).then(t,(function(e){i._wrappeAsyncFailed(i,e,r)}))}},{key:"GetSkewAngleAsync",value:function(e){var t=this;if(t._resetErr(),!t._isValid())return Wb.Promise.reject({code:t._errorCode,message:t._errorString});var r=parseInt(e);if(isNaN(r))return pw(t),Wb.Promise.reject({code:t._errorCode,message:t._errorString});if(r<0||r>=t._ImgManager.count())return Gw(t),Wb.Promise.reject({code:t._errorCode,message:t._errorString});var n=t._ImgManager.convertClientIndexToServerId(r);return-1==n?(Gw(t),Wb.Promise.reject({code:t._errorCode,message:t._errorString})):t._innerFunV2("GetSkewAngle",mR(n),!0).then((function(e){var n=e;return xt.isArray(e)&&(n=e.length>0?e[0]:0),pk.refreshImageAfterInvokeFun(t,r),n}))}},{key:"GetSkewAngleEx",value:function(e,t,r,n,i){var o=this,a=parseInt(e);if(!Ik(o,a))return!1;var s=o._ImgManager.convertClientIndexToServerId(a);return-1==s?(Gw(o),!1):o._innerFun("GetSkewAngleEx",mR(s,t,r,n,i))}},{key:"GetSkewAngleFromBinaryAsync",value:function(e,t,r,n){var i=this;if(i._resetErr(),!i._isValid())return Wb.Promise.reject({code:i._errorCode,message:i._errorString});var o=this._imageBufferWrapper.getCustomDataByIndex(e),a=this._imageBufferWrapper.getMetadataByIndex(e),s=this._ImgManager.convertClientIndexToServerId(e),u={imageId:s,serverId:s,bufferLen:t.size,imageType:dx.IT_BMP,width:a.width,height:a.height,bit:a.bitDepth,xres:a.resolutionX,yres:a.resolutionY,uidFromServer:o.uidFromServer},c=xt.stringify([xt.stringify(u)]);return this._innerSendBlob("GetSkewAngleFromBinary",c,t,!0,!0,r,n)}},{key:"IsBlankImageEx",value:function(e,t,r,n,i,o){var a,s=this;if(!Ik(s,a=parseInt(e)))return!1;var u=s._ImgManager.convertClientIndexToServerId(a);return-1==u?(Gw(s),!1):s._innerFun("IsBlankImageEx",mR(u,t,r,n,i,o))}},{key:"MirrorAsync",value:function(e){var t=this;if(t._resetErr(),!t._isValid())return Wb.Promise.reject({code:t._errorCode,message:t._errorString});var r=parseInt(e);if(isNaN(r))return pw(t),Wb.Promise.reject({code:t._errorCode,message:t._errorString});if(r<0||r>=t._ImgManager.count())return Gw(t),Wb.Promise.reject({code:t._errorCode,message:t._errorString});var n=t._ImgManager.convertClientIndexToServerId(r);return-1==n?(Gw(t),Wb.Promise.reject({code:t._errorCode,message:t._errorString})):t._innerFunV2("Mirror",mR(n),!0).then((function(e){if(1!=e)throw{code:t._errorCode,message:t._errorString};pk.refreshImageAfterInvokeFun(t,r),t.getView().ClearSelectedAreas()}))}},{key:"Mirror",value:function(e,t,r){var n=this;if(!xt.isFunction(t)){var i=parseInt(e);return!!Ik(n,i,r)&&gH(n,"Mirror",i,t,r,!1,!0)}n.MirrorAsync(e).then(t,(function(e){n._wrappeAsyncFailed(n,e,r)}))}},{key:"RemoveAllImages",value:function(){return this._removeAllImages("RemoveAllImages")}},{key:"RemoveAllImagesAsync",value:function(){return this._removeAllImagesAsync("RemoveAllImagesAsync",!0)}},{key:"RemoveImageAsync",value:function(e){var t=this;if(t._resetErr(),!t._isValid())return Wb.Promise.reject({code:t._errorCode,message:t._errorString});var r=parseInt(e);if(isNaN(r))return pw(t),Wb.Promise.reject({code:t._errorCode,message:t._errorString});if(r<0||r>=t._ImgManager.count())return Gw(t),Wb.Promise.reject({code:t._errorCode,message:t._errorString});var n=t._ImgManager.convertClientIndexToServerId(r);return-1==n?(Gw(t),Wb.Promise.reject({code:t._errorCode,message:t._errorString})):t._innerFunV2("RemoveImage",mR(n),!0).then((function(e){return!(!e&&-1033!=t._errorCode)&&(t._OnBitmapChanged(["c1",""+n,3,t._ImgManager.getCurrentImageIndex(),t._ImgManager.count()]),!0)}))}},{key:"Rotate",value:function(e,t,r,n,i){return this.RotateEx(e,t,r,-1,n,i)}},{key:"_wrappeAsyncFailed",value:function(e,t,r){t&&(e._errorCode=t.code,e._errorString=t.message),xt.isFunction(r)&&r(e._errorCode,e._getErrorString())}},{key:"RotateEx",value:function(e,t,r,n,i,o){var a=this;if(!xt.isFunction(i)){if(a._resetErr(),!a._isValid())return!1;var s,u=parseInt(e);if(isNaN(u))return pw(a),xt.isFunction(o)&&o(a._errorCode,a._getErrorString()),!1;if(u<0||u>=a._ImgManager.count())return Gw(a),xt.isFunction(o)&&o(a._errorCode,a._getErrorString()),!1;var c=a._ImgManager.convertClientIndexToServerId(u);return-1==c?(Gw(a),xt.isFunction(o)&&o(a._errorCode,a._getErrorString()),!1):((s=1==a._innerFun("RotateEx",mR(c,t,r,n)))?(pk.refreshImageAfterInvokeFun(a,u),a.getView().ClearSelectedAreas(),xt.isFunction(i)&&i()):xt.isFunction(o)&&o(a._errorCode,a._getErrorString()),s)}a.RotateExAsync(e,t,r,n).then(i,(function(e){a._wrappeAsyncFailed(a,e,o)}))}},{key:"RotateLeft",value:function(e,t,r){return this.RotateEx(e,-90,!0,-1,t,r)}},{key:"RotateRight",value:function(e,t,r){return this.RotateEx(e,90,!0,-1,t,r)}},{key:"RotateAsync",value:function(e,t,r){return this.RotateExAsync(e,t,r,-1)}},{key:"RotateExAsync",value:function(e,t,r,n){var i=this;if(i._resetErr(),!i._isValid())return Wb.Promise.reject({code:i._errorCode,message:i._errorString});var o=parseInt(e);if(isNaN(o))return pw(i),Wb.Promise.reject({code:i._errorCode,message:i._errorString});if(o<0||o>=i._ImgManager.count())return Gw(i),Wb.Promise.reject({code:i._errorCode,message:i._errorString});var a=i._ImgManager.convertClientIndexToServerId(o);return-1==a?(Gw(i),Wb.Promise.reject({code:i._errorCode,message:i._errorString})):i._innerFunV2("RotateEx",mR(a,t,r,n),!0).then((function(e){if(1!=e&&1!=e)throw{code:i._errorCode,message:i._errorString};pk.refreshImageAfterInvokeFun(i,o),i.getView().ClearSelectedAreas()}))}},{key:"RotateLeftAsync",value:function(e){return this.RotateExAsync(e,-90,!0,-1)}},{key:"RotateRightAsync",value:function(e){return this.RotateExAsync(e,90,!0,-1)}},{key:"ChangeImageSize",value:function(e,t,r,n,i,o){var a=this;if(!xt.isFunction(i)){var s,u=parseInt(e),c=1*t,l=1*r;if(!Ik(a,u,o))return!1;if(c<=0||l<=0)return Rw(a),xt.isFunction(o)&&o(a._errorCode,a._getErrorString()),!1;var d=a._ImgManager.convertClientIndexToServerId(u);return-1==d?(Gw(a),xt.isFunction(o)&&o(a._errorCode,a._getErrorString()),!1):((s=1==a._innerFun("ChangeImageSize",mR(d,c,l,n)))?(pk.refreshImageAfterInvokeFun(a,u),xt.isFunction(i)&&i()):xt.isFunction(o)&&o(a._errorCode,a._getErrorString()),s)}a.ChangeImageSizeAsync(e,t,r,n).then(i,(function(e){a._wrappeAsyncFailed(a,e,o)}))}},{key:"ChangeImageSizeAsync",value:function(e,t,r,n){var i=this,o=parseInt(e),a=1*t,s=1*r;if(i._resetErr(),!i._isValid())return Wb.Promise.reject({code:i._errorCode,message:i._errorString});if(isNaN(o))return pw(i),Wb.Promise.reject({code:i._errorCode,message:i._errorString});if(o<0||o>=i._ImgManager.count())return Gw(i),Wb.Promise.reject({code:i._errorCode,message:i._errorString});if(a<=0||s<=0)return Rw(i),Wb.Promise.reject({code:i._errorCode,message:i._errorString});var u=i._ImgManager.convertClientIndexToServerId(o);return-1==u?(Gw(i),Wb.Promise.reject({code:i._errorCode,message:i._errorString})):i._innerFunV2("ChangeImageSize",mR(u,a,s,n),!0).then((function(e){if(1!=e)throw{code:i._errorCode,message:i._errorString};pk.refreshImageAfterInvokeFun(i,o)}))}},{key:"Flip",value:function(e,t,r){var n=this;if(!xt.isFunction(t)){var i=parseInt(e);return!!Ik(n,i,r)&&gH(n,"Flip",i,t,r,!1,!0)}n.FlipAsync(e).then(t,(function(e){n._wrappeAsyncFailed(n,e,r)}))}},{key:"FlipAsync",value:function(e){var t=this;if(t._resetErr(),!t._isValid())return Wb.Promise.reject({code:t._errorCode,message:t._errorString});var r=parseInt(e);if(isNaN(r))return pw(t),Wb.Promise.reject({code:t._errorCode,message:t._errorString});if(r<0||r>=t._ImgManager.count())return Gw(t),Wb.Promise.reject({code:t._errorCode,message:t._errorString});var n=t._ImgManager.convertClientIndexToServerId(r);return-1==n?(Gw(t),Wb.Promise.reject({code:t._errorCode,message:t._errorString})):t._innerFunV2("Flip",mR(n),!0).then((function(e){if(1!=e)throw{code:t._errorCode,message:t._errorString};pk.refreshImageAfterInvokeFun(t,r),t.getView().ClearSelectedAreas()}))}},{key:"OutputSelectedAreaAsync",value:(a=GE(m.mark((function e(t,r,n,i){var o,a,s,u,c,l,d,f,h,g,p,_,v,y;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s="OutputSelectedArea",(a=this)._resetErr(),a._isValid()){e.next=4;break}throw{code:a._errorCode,message:a._errorString};case 4:if(u=0,c=0,l=0,d=0,!isNaN(t)){e.next=8;break}throw pw(a),{code:a._errorCode,message:a._errorString};case 8:if(n==dx.IT_BMP||n==dx.IT_JPG||n==dx.IT_TIF||n==dx.IT_PNG||n==dx.IT_PDF){e.next=11;break}throw Zw(a),{code:a._errorCode,message:a._errorString};case 11:if(i==wj.Blob||i==wj.Base64){e.next=14;break}throw Zw(a),{code:a._errorCode,message:a._errorString};case 14:if(!(t<0||t>=a._ImgManager.count())){e.next=17;break}throw Gw(a),{code:a._errorCode,message:a._errorString};case 17:if(-1!=(f=a._ImgManager.convertClientIndexToServerId(t))){e.next=21;break}throw Gw(a),{code:a._errorCode,message:a._errorString};case 21:return h=i==wj.Base64,g=h?"text":"arraybuffer",r&&(Dt.isNumber(r.x)&&(u=r.x),Dt.isNumber(r.y)&&(c=r.y),Dt.isNumber(r.width)&&(l=r.width),Dt.isNumber(r.height)&&(d=r.height)),_=xt.stringify([{index:f,left:u,top:c,width:l,height:d}]),v="["+_+","+n+","+i+"]",y=null===(o=Dt.progressContext)||void 0===o?void 0:o.IfShowCancelDialogWhenImageTransfer,e.prev=27,a.IfShowProgressBar?Dt.showProgress(a,s,!1):Dt.hideProgress(),h?a._OnPercentDone([0,-1,QP.ConvertingToBase64]):a._OnPercentDone([0,-1,QP.ConvertingToBlob]),Dt.progressContext&&(Dt.progressContext.IfShowCancelDialogWhenImageTransfer=!1),e.next=33,a._sendDataByHttpAsync(s,v,g,!0);case 33:p=e.sent;case 34:return e.prev=34,Dt.progressContext&&(Dt.progressContext.IfShowCancelDialogWhenImageTransfer=y),a.IfShowProgressBar&&Dt.closeProgress(null,s),e.finish(34);case 38:if(!h){e.next=51;break}if(!p){e.next=48;break}if(!rA(p)){e.next=44;break}return a._errorCode=p.exception,a._errorString=p.description,e.abrupt("return","");case 44:if(!(xt.isArray(p.result)&&p.result.length>0&&xt.isString(p.result[0]))){e.next=46;break}return e.abrupt("return",p.result[0]);case 46:e.next=49;break;case 48:return e.abrupt("return","");case 49:e.next=52;break;case 51:return e.abrupt("return",new Blob([p],{type:Ax(n)}));case 52:case"end":return e.stop()}}),e,this,[[27,,34,38]])}))),function(e,t,r,n){return a.apply(this,arguments)})},{key:"Crop",value:function(e,t,r,n,i,o,a){var s=this;if(!xt.isFunction(o)){var u,c=parseInt(e);if(!Ik(s,c,a))return!1;var l,d,f=s._ImgManager.convertClientIndexToServerId(c);return-1==f?(Gw(s),xt.isFunction(a)&&a(s._errorCode,s._getErrorString()),!1):(u=1==s._innerFun("Crop",mR(f,t,r,n,i)),l=s._errorCode,d=s._getErrorString(),s.getView().ClearSelectedAreas(),s._errorCode=l,s._errorString=d,u?(pk.refreshImageAfterInvokeFun(s,c),xt.isFunction(o)&&o()):xt.isFunction(a)&&a(l,d),u)}s.CropAsync(e,t,r,n,i).then(o,(function(e){s._wrappeAsyncFailed(s,e,a)}))}},{key:"CropAsync",value:function(e,t,r,n,i){var o=this;if(o._resetErr(),!o._isValid())return Wb.Promise.reject({code:o._errorCode,message:o._errorString});var a=parseInt(e);if(isNaN(a))return pw(o),Wb.Promise.reject({code:o._errorCode,message:o._errorString});if(a<0||a>=o._ImgManager.count())return Gw(o),Wb.Promise.reject({code:o._errorCode,message:o._errorString});var s=o._ImgManager.convertClientIndexToServerId(a);return-1==s?(Gw(o),Wb.Promise.reject({code:o._errorCode,message:o._errorString})):o._innerFunV2("Crop",mR(s,t,r,n,i),!0).then((function(e){var t,r;if(t=o._errorCode,r=o._getErrorString(),o.getView().ClearSelectedAreas(),o._errorCode=t,o._errorString=r,1!=e)throw{code:o._errorCode,message:o._errorString};return pk.refreshImageAfterInvokeFun(o,a),!0}))}},{key:"CropToClipboard",value:function(e,t,r,n,i){var o,a=this,s=parseInt(e);if(!Ik(a,s))return!1;var u=a._ImgManager.convertClientIndexToServerId(s);return-1==u?(Gw(a),!1):(a.getView().ClearSelectedAreas(),(o=1==a._innerFun("CropToClipboard",mR(u,t,r,n,i)))&&pk.refreshImageAfterInvokeFun(a,s),o)}},{key:"CutFrameToClipboard",value:function(e,t,r,n,i){var o,a=this,s=parseInt(e);if(!Ik(a,s))return!1;var u=a._ImgManager.convertClientIndexToServerId(s);return-1==u?(Gw(a),!1):(a.getView().ClearSelectedAreas(),(o=1==a._innerFun("CutFrameToClipboard",mR(u,t,r,n,i)))&&pk.refreshImageAfterInvokeFun(a,s),o)}},{key:"CutToClipboard",value:function(e){var t,r=this,n=parseInt(e);if(!Ik(r,n))return!1;var i=r._ImgManager.convertClientIndexToServerId(n);return-1==i?(Gw(r),!1):((t=1==r._innerFun("CutToClipboard",mR(i)))&&r._OnBitmapChanged(["c1",""+i,3,r._ImgManager.getCurrentImageIndex(),r._ImgManager.count()]),t)}},{key:"CutFrameToClipboardAsync",value:function(e,t,r,n,i){var o=this;if(o._resetErr(),!o._isValid())return Wb.Promise.reject({code:o._errorCode,message:o._errorString});var a=parseInt(e);if(isNaN(a))return pw(o),Wb.Promise.reject({code:o._errorCode,message:o._errorString});if(a<0||a>=o._ImgManager.count())return Gw(o),Wb.Promise.reject({code:o._errorCode,message:o._errorString});var s=o._ImgManager.convertClientIndexToServerId(a);return-1==s?(Gw(o),Wb.Promise.reject({code:o._errorCode,message:o._errorString})):o._innerFunV2("CutFrameToClipboard",mR(s,t,r,n,i)).then((function(e){var t=1==e;if(!t)throw{code:o._errorCode,message:o._errorString};return pk.refreshImageAfterInvokeFun(o,a),t}))}},{key:"CropToClipboardAsync",value:function(e,t,r,n,i){var o=this;if(o._resetErr(),!o._isValid())return Wb.Promise.reject({code:o._errorCode,message:o._errorString});var a=parseInt(e);if(isNaN(a))return pw(o),Wb.Promise.reject({code:o._errorCode,message:o._errorString});if(a<0||a>=o._ImgManager.count())return Gw(o),Wb.Promise.reject({code:o._errorCode,message:o._errorString});var s=o._ImgManager.convertClientIndexToServerId(a);return-1==s?(Gw(o),Wb.Promise.reject({code:o._errorCode,message:o._errorString})):o._innerFunV2("CropToClipboard",mR(s,t,r,n,i)).then((function(e){var t=1==e;if(!t)throw{code:o._errorCode,message:o._errorString};return pk.refreshImageAfterInvokeFun(o,a),t}))}},{key:"CutToClipboardAsync",value:function(e){var t=this;if(t._resetErr(),!t._isValid())return Wb.Promise.reject({code:t._errorCode,message:t._errorString});var r=parseInt(e);if(isNaN(r))return pw(t),Wb.Promise.reject({code:t._errorCode,message:t._errorString});if(r<0||r>=t._ImgManager.count())return Gw(t),Wb.Promise.reject({code:t._errorCode,message:t._errorString});var n=t._ImgManager.convertClientIndexToServerId(r);return-1==n?(Gw(t),Wb.Promise.reject({code:t._errorCode,message:t._errorString})):t._innerFunV2("CutToClipboard",mR(n)).then((function(e){var r=1==e;if(!r)throw{code:t._errorCode,message:t._errorString};return t._OnBitmapChanged(["c1",""+n,3,t._ImgManager.getCurrentImageIndex(),t._ImgManager.count()]),r}))}},{key:"SetDPI",value:function(e,t,r,n,i,o,a){var s,u=this,c=!1;xt.isFunction(o)&&(c=!0);var l=parseInt(e);if(!Ik(u,l,a))return!!c&&void 0;var d=u._ImgManager.convertClientIndexToServerId(l);return-1==d?(Gw(u),xt.isFunction(a)&&a(u._errorCode,u._getErrorString()),!!c&&void 0):((s=1==u._innerFun("SetDPI",mR(d,t,r,n,i)))?xt.isFunction(o)&&o():xt.isFunction(a)&&a(u._errorCode,u._getErrorString()),c?void 0:s)}},{key:"MoveImage",value:function(e,t){var r=this;if(r._resetErr(),!r._isValid())return!1;var n=parseInt(e),i=parseInt(t);return isNaN(n)||isNaN(i)?(pw(r),!1):n<0||n>=r._ImgManager.count()||i<0||i>=r._ImgManager.count()?(Gw(r),!1):r._ImgManager.moveImage(n,i)}},{key:"SwitchImage",value:function(e,t){var r=this;if(r._resetErr(),!r._isValid())return!1;var n=parseInt(e),i=parseInt(t);return isNaN(n)||isNaN(i)?(pw(r),!1):n<0||n>=r._ImgManager.count()||i<0||i>=r._ImgManager.count()?(Gw(r),!1):r._ImgManager.switchImage(n,i)}},{key:"CloseWorkingProcess",value:function(){var e=this;return e._resetErr(),!!e._isValid()&&e._innerFun("CloseWorkerProcess")}},{key:"RemoveAllSelectedImages",value:function(){var e=this;if(e._resetErr(),!e._isValid())return!1;var t=!0,r=e._ImgManager.getCurrentImageIndex(),n=e._ImgManager.getSelectedClientIndexArray(),i=[];if(xt.isArray(n)&&xt.each(n,(function(t){var r=e._ImgManager.convertClientIndexToServerId(t);-1!=r&&i.push(r)})),0==i.length&&r>=0){var o=e._ImgManager.convertClientIndexToServerId(r);i.push(o)}return i.length>0&&(t=e._innerFun("RemoveAllSelectedImages",mR(i.join(",")))),t&&xt.each(i,(function(t){e._OnBitmapChanged(["c1",""+t,3,e._ImgManager.getCurrentImageIndex(),e._ImgManager.count()])})),t}},{key:"RemoveAllSelectedImagesAsync",value:function(){var e=this;if(e._resetErr(),!e._isValid())return Wb.Promise.reject({code:e._errorCode,message:e._errorString});var t=e._ImgManager.getCurrentImageIndex(),r=e._ImgManager.getSelectedClientIndexArray(),n=[];if(xt.isArray(r)&&xt.each(r,(function(t){var r=e._ImgManager.convertClientIndexToServerId(t);-1!=r&&n.push(r)})),0==n.length&&t>=0){var i=e._ImgManager.convertClientIndexToServerId(t);n.push(i)}return n.length>0?e._innerFunV2("RemoveAllSelectedImages",mR(n.join(","),!0)).then((function(t){t&&xt.each(n,(function(t){e._OnBitmapChanged(["c1",""+t,3,e._ImgManager.getCurrentImageIndex(),e._ImgManager.count()])}))})):Wb.Promise.resolve()}},{key:"TagImages",value:function(e,t){var r=this;if(r._resetErr(),!r._isValid())return!1;var n=!0,i=r._ImgManager.count();return xt.isArray(e)?xt.isString(t)&&""!=t?(xt.each(e,(function(e){if(isNaN(e)||e<0||e>=i)return Gw(r),n=!1})),n?r._ImgManager.addImageTag(e,t):n):(fw(r,-2394,"Invalid tag name."),!1):(Vw(r),!1)}},{key:"ClearImageTags",value:function(e){var t=this;return t._resetErr(),!!t._isValid()&&(-1==e||e>=t._getHowManyImagesInBuffer()?(Gw(t),!1):t._ImgManager.removeImageTag(e))}},{key:"SetDefaultTag",value:function(e){var t=this;return t._resetErr(),!!t._isValid()&&t._ImgManager.setDefaultTag(e)}},{key:"FilterImagesByTag",value:function(e,t,r){var n,i=this,o=!1;if(xt.isFunction(t)&&(o=!0),i._resetErr(),!i._isValid())return!!o&&void 0;xt.isFunction(r)&&(n=function(){r({code:i._errorCode,message:i._errorString})});var a=i._ImgManager.showImagesByFilter(e,t,n);return o?void 0:a}},{key:"ClearFilter",value:function(){var e=this;return e._resetErr(),!!e._isValid()&&e._ImgManager.clearFilter()}},{key:"CreateDocument",value:function(e){var t=this;return t._resetErr(),!!t._isValid()&&(e&&""!=e?xt.isString(e)?t._ImgManager.CreateFile(e):(nE(t),!1):(xt.isNumber(e)?nE(t):rE(t),!1))}},{key:"OpenDocument",value:function(e){var t=this;return t._resetErr(),!!t._isValid()&&(e&&""!=e?xt.isString(e)?t._ImgManager.OpenFile(e):(nE(t),!1):(xt.isNumber(e)?nE(t):rE(t),!1))}},{key:"RemoveDocument",value:function(e){var t=this;if(t._resetErr(),!t._isValid())return!1;var r=t._ImgManager.GetServerIdsByFileName(e);return r.length>0&&t._innerFun("RemoveAllSelectedImages",mR(r.join(","))),t._ImgManager.RemoveFile(e)}},{key:"RenameDocument",value:function(e,t){var r=this;return r._resetErr(),!!r._isValid()&&(xt.isString(e)&&xt.isString(t)?e&&""!=e&&t&&""!=t?r._ImgManager.RenameFile(e,t):(rE(r),!1):(nE(r),!1))}},{key:"GetDocumentInfoList",value:function(){var e=this;return e._resetErr(),!!e._isValid()&&e._ImgManager.GetFileInfoList()}},{key:"MoveToDocumentAsync",value:(o=GE(m.mark((function e(t,r,n,i){var o,a,s,u,c,l,d,f,h,g;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((o=this)._resetErr(),o._isValid()){e.next=4;break}throw{code:o._errorCode,message:o._errorString};case 4:if(!xt.isUndefined(t)&&0!=t.length){e.next=7;break}throw OE(o),{code:o._errorCode,message:o._errorString};case 7:if(!xt.isUndefined(r)&&0!=r.length){e.next=10;break}throw WE(o),{code:o._errorCode,message:o._errorString};case 10:a=o._ImgManager.GetFileInfoList(),c=0;case 12:if(!(c<a.length)){e.next=20;break}if(a[c].name!=t){e.next=17;break}return s=a[c],e.abrupt("break",20);case 17:c++,e.next=12;break;case 20:l=0;case 21:if(!(l<a.length)){e.next=29;break}if(a[l].name!=r){e.next=26;break}return u=a[l],e.abrupt("break",29);case 26:l++,e.next=21;break;case 29:if(!xt.isUndefined(s)){e.next=32;break}throw OE(o),{code:o._errorCode,message:o._errorString};case 32:if(!xt.isUndefined(u)){e.next=35;break}throw WE(o),{code:o._errorCode,message:o._errorString};case 35:if(d=[],!xt.isUndefined(n)){e.next=40;break}if(s.imageIds.length>0)for(h=0;h<s.imageIds.length;h++)d.push(h);e.next=60;break;case 40:if(!xt.isArray(n)){e.next=53;break}if(o._checkIndices(n,s.imageIds.length)){e.next=43;break}throw{code:o._errorCode,message:o._errorString};case 43:if(d=n,xt.isUndefined(i)){e.next=51;break}if(!xt.isNumber(i)){e.next=49;break}i<0?f=0:u.imageIds.length>i&&(f=i),e.next=51;break;case 49:throw Zw(o),{code:o._errorCode,message:o._errorString};case 51:e.next=60;break;case 53:if(!xt.isNumber(n)){e.next=58;break}if(s.imageIds.length>0)for(g=0;g<s.imageIds.length;g++)d.push(g);n<0?f=0:u.imageIds.length>n&&(f=n),e.next=60;break;case 58:throw Zw(o),{code:o._errorCode,message:o._errorString};case 60:return e.abrupt("return",new Wb.Promise((function(e,n){0==d.length||o._ImgManager.MoveImageToFile(t,d,r,f)?e():n({code:o._errorCode,message:o._errorString})})));case 61:case"end":return e.stop()}}),e,this)}))),function(e,t,r,n){return o.apply(this,arguments)})},{key:"CopyToDocumentAsync",value:(i=GE(m.mark((function e(t,r,n,i){var o,a,s,u,c,l,d,f;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((o=this)._resetErr(),o._isValid()){e.next=4;break}throw{code:o._errorCode,message:o._errorString};case 4:if(!xt.isUndefined(t)&&0!=t.length){e.next=7;break}throw OE(o),{code:o._errorCode,message:o._errorString};case 7:if(!xt.isUndefined(r)&&0!=r.length){e.next=10;break}throw WE(o),{code:o._errorCode,message:o._errorString};case 10:a=o._ImgManager.GetFileInfoList(),c=0;case 12:if(!(c<a.length)){e.next=20;break}if(a[c].name!=t){e.next=17;break}return s=a[c],e.abrupt("break",20);case 17:c++,e.next=12;break;case 20:l=0;case 21:if(!(l<a.length)){e.next=29;break}if(a[l].name!=r){e.next=26;break}return u=a[l],e.abrupt("break",29);case 26:l++,e.next=21;break;case 29:if(!xt.isUndefined(s)){e.next=32;break}throw OE(o),{code:o._errorCode,message:o._errorString};case 32:if(!xt.isUndefined(u)){e.next=35;break}throw WE(o),{code:o._errorCode,message:o._errorString};case 35:if(d=[],!xt.isUndefined(n)){e.next=40;break}s.imageIds.length>0&&xt.isArray(s.imageIds)&&xt.each(s.imageIds,(function(e){var t=o._uidFromServer2ServerId(e);-1!=t&&d.push(t)})),e.next=60;break;case 40:if(!xt.isArray(n)){e.next=53;break}if(o._checkIndices(n,s.imageIds.length)){e.next=43;break}throw{code:o._errorCode,message:o._errorString};case 43:if(xt.each(n,(function(e){var t=o._uidFromServer2ServerId(s.imageIds[e]);-1!=t&&d.push(t)})),xt.isUndefined(i)){e.next=51;break}if(!xt.isNumber(i)){e.next=49;break}i<0?f=0:u.imageIds.length>i&&(f=i),e.next=51;break;case 49:throw Zw(o),{code:o._errorCode,message:o._errorString};case 51:e.next=60;break;case 53:if(!xt.isNumber(n)){e.next=58;break}s.imageIds.length>0&&xt.isArray(s.imageIds)&&xt.each(s.imageIds,(function(e){var t=o._uidFromServer2ServerId(e);-1!=t&&d.push(t)})),n<0?f=0:u.imageIds.length>n&&(f=n),e.next=60;break;case 58:throw Zw(o),{code:o._errorCode,message:o._errorString};case 60:return e.abrupt("return",new Wb.Promise((function(e,t){var n="copyToDocument",i=u.imageIds.length;if(0==d.length)e();else{o.IfShowProgressBar?UE(!1):Dt.hideProgress();var a=o.IfShowCancelDialogWhenImageTransfer;Dt.cancelFrom=fj.LoadImage,o.IfShowCancelDialogWhenImageTransfer=!1,Dt.progressContext&&(Dt.progressContext.IfShowCancelDialogWhenImageTransfer=!1),Dt.cancelFrom=fj.Other,o._innerConvertToBlobWithUI(n,Wt.DWT.EnumDWT_ImageType.IT_PDF,d,!1,(function(s,u){var c;s.currentFileName=r,s.currentTagName="",s.bNeedClearCurrentTagName=!0,o.IfShowProgressBar?(UE(!1),Dt.showProgress(o,n,!1),Dt.progressContext&&(Dt.progressContext.IfShowCancelDialogWhenImageTransfer=!1)):Dt.hideProgress(),Dt.cancelFrom=fj.LoadImage,o.Addon&&o.Addon.PDF&&(c=o.Addon.PDF.GetReaderOptions(),o.Addon.PDF.SetReaderOptions({convertMode:Wt.DWT.EnumDWT_ConvertMode.CM_IMAGEONLY})),o._innerLoadImageFromBinary(s,0,!0,!0,(function(){if(o.Addon&&o.Addon.PDF&&c&&o.Addon.PDF.SetReaderOptions(c),o.IfShowCancelDialogWhenImageTransfer=a,o.IfShowProgressBar&&Dt.closeProgress(null,n),xt.isUndefined(f))e();else{for(var s=[],u=0;u<d.length;u++)s.push(i+u);0==s.length||o._ImgManager.MoveImageToFile(r,s,r,f)?e():t({code:o._errorCode,message:o._errorString})}}),(function(){o.Addon&&o.Addon.PDF&&c&&o.Addon.PDF.SetReaderOptions(c),o.IfShowCancelDialogWhenImageTransfer=a,o.IfShowProgressBar&&Dt.closeProgress(null,n),t({code:o._errorCode,message:o._errorString})}))}),(function(){o.IfShowCancelDialogWhenImageTransfer=a,t({code:o._errorCode,message:o._errorString})}))}})));case 61:case"end":return e.stop()}}),e,this)}))),function(e,t,r,n){return i.apply(this,arguments)})},{key:"Invert",value:function(e,t,r){var n=this,i=!1;if(xt.isFunction(t)&&(i=!0),!i){var o=parseInt(e);return!!Ik(n,o,r)&&gH(n,"Invert",o,t,r,!1,!0)}n.InvertAsync(e).then(t,(function(e){n._wrappeAsyncFailed(n,e,r)}))}},{key:"InvertAsync",value:function(e){return this._invert(e)}},{key:"RenameTag",value:function(e,t){var r=this;return r._resetErr(),!!r._isValid()&&(xt.isUndefined(e)?(kw(r),!1):0==e.length?(fw(r,-2517,"Old tag name is required."),!1):xt.isUndefined(t)||0==t.length?(function(e){fw(e,-2518,"New tag name is required.")}(r),!1):r._ImgManager.renameTag(e,t))}},{key:"RemoveTag",value:function(e,t){var r=this;return r._resetErr(),!!r._isValid()&&(xt.isUndefined(e)||0==e.length?(kw(r),!1):xt.isUndefined(t)||xt.isArray(t)?r._ImgManager.removeTag(e,t):(Vw(r),!1))}},{key:"GetTagList",value:function(){var e=this;return e._resetErr(),!!e._isValid()&&e._ImgManager.getTagList()}},{key:"GetTagListByIndex",value:function(e){var t=this;if(t._resetErr(),!t._isValid())return[];var r=parseInt(e);return isNaN(r)?(pw(t),[]):r<0||r>=t._ImgManager.count()||-1==t._ImgManager.convertClientIndexToServerId(r)?(Gw(t),[]):t._ImgManager.getTagListByIndex(r)}},{key:"GetImageBitDepthAsync",value:function(e){var t=this;if(t._resetErr(),!t._isValid())return Wb.Promise.reject({code:t._errorCode,message:t._errorString});var r=parseInt(e);if(isNaN(r))return pw(t),Wb.Promise.reject({code:t._errorCode,message:t._errorString});if(r<0||r>=t._ImgManager.count())return Gw(t),Wb.Promise.reject({code:t._errorCode,message:t._errorString});var n=t._ImgManager.convertClientIndexToServerId(r);return-1==n?(Gw(t),Wb.Promise.reject({code:t._errorCode,message:t._errorString})):t._innerFunV2("GetImageBitDepth",mR(n))}},{key:"GetImageWidthAsync",value:function(e){var t=this;if(t._resetErr(),!t._isValid())return Wb.Promise.reject({code:t._errorCode,message:t._errorString});var r=parseInt(e);if(isNaN(r))return pw(t),Wb.Promise.reject({code:t._errorCode,message:t._errorString});if(r<0||r>=t._ImgManager.count())return Gw(t),Wb.Promise.reject({code:t._errorCode,message:t._errorString});var n=t._ImgManager.convertClientIndexToServerId(r);return-1==n?(Gw(t),Wb.Promise.reject({code:t._errorCode,message:t._errorString})):t._innerFunV2("GetImageWidth",mR(n))}},{key:"GetImageHeightAsync",value:function(e){var t=this;if(t._resetErr(),!t._isValid())return Wb.Promise.reject({code:t._errorCode,message:t._errorString});var r=parseInt(e);if(isNaN(r))return pw(t),Wb.Promise.reject({code:t._errorCode,message:t._errorString});if(r<0||r>=t._ImgManager.count())return Gw(t),Wb.Promise.reject({code:t._errorCode,message:t._errorString});var n=t._ImgManager.convertClientIndexToServerId(r);return-1==n?(Gw(t),Wb.Promise.reject({code:t._errorCode,message:t._errorString})):t._innerFunV2("GetImageHeight",mR(n))}},{key:"GetImageSizeAsync",value:function(e,t,r){var n=this;if(n._resetErr(),!n._isValid())return Wb.Promise.reject({code:n._errorCode,message:n._errorString});var i=parseInt(e);if(isNaN(i))return pw(n),Wb.Promise.reject({code:n._errorCode,message:n._errorString});if(i<0||i>=n._ImgManager.count())return Gw(n),Wb.Promise.reject({code:n._errorCode,message:n._errorString});var o=n._ImgManager.convertClientIndexToServerId(i);return-1==o?(Gw(n),Wb.Promise.reject({code:n._errorCode,message:n._errorString})):n._innerFunV2("GetImageSize",mR(o,t,r))}},{key:"GetImageSizeWithSpecifiedTypeAsync",value:function(e,t){var r=this;if(r._resetErr(),!r._isValid())return Wb.Promise.reject({code:r._errorCode,message:r._errorString});var n=parseInt(e);if(isNaN(n))return pw(r),Wb.Promise.reject({code:r._errorCode,message:r._errorString});if(n<0||n>=r._ImgManager.count())return Gw(r),Wb.Promise.reject({code:r._errorCode,message:r._errorString});var i=r._ImgManager.convertClientIndexToServerId(n);return-1==i?(Gw(r),Wb.Promise.reject({code:r._errorCode,message:r._errorString})):r._innerFunV2("GetImageSizeWithSpecifiedType",mR(i,t))}},{key:"GetImageXResolutionAsync",value:function(e){var t=this;if(t._resetErr(),!t._isValid())return Wb.Promise.reject({code:t._errorCode,message:t._errorString});var r=parseInt(e);if(isNaN(r))return pw(t),Wb.Promise.reject({code:t._errorCode,message:t._errorString});if(r<0||r>=t._ImgManager.count())return Gw(t),Wb.Promise.reject({code:t._errorCode,message:t._errorString});var n=t._ImgManager.convertClientIndexToServerId(r);return-1==n?(Gw(t),Wb.Promise.reject({code:t._errorCode,message:t._errorString})):t._innerFunV2("GetImageXResolution",mR(n))}},{key:"GetImageYResolutionAsync",value:function(e){var t=this;if(t._resetErr(),!t._isValid())return Wb.Promise.reject({code:t._errorCode,message:t._errorString});var r=parseInt(e);if(isNaN(r))return pw(t),Wb.Promise.reject({code:t._errorCode,message:t._errorString});if(r<0||r>=t._ImgManager.count())return Gw(t),Wb.Promise.reject({code:t._errorCode,message:t._errorString});var n=t._ImgManager.convertClientIndexToServerId(r);return-1==n?(Gw(t),Wb.Promise.reject({code:t._errorCode,message:t._errorString})):t._innerFunV2("GetImageYResolution",mR(n))}},{key:"ChangeBrightnessAsync",value:function(e,t){var r=this,n=parseInt(e);if(!r._isValid())return Wb.Promise.reject({code:r._errorCode,message:r._errorString});if(t<-1e3||t>1e3)return _w(r),Wb.Promise.reject({code:r._errorCode,message:r._errorString});var i=r._ImgManager.convertClientIndexToServerId(n);return-1==i?(Gw(r),Wb.Promise.reject({code:r._errorCode,message:r._errorString})):r._innerFunV2("ChangeBrightness",mR(i,t))}},{key:"ChangeContrastAsnyc",value:function(e,t){var r=this,n=parseInt(e);if(!r._isValid())return Wb.Promise.reject({code:r._errorCode,message:r._errorString});if(t<-1e3||t>1e3)return _w(r),Wb.Promise.reject({code:r._errorCode,message:r._errorString});var i=r._ImgManager.convertClientIndexToServerId(n);return-1==i?(Gw(r),Wb.Promise.reject({code:r._errorCode,message:r._errorString})):r._innerFunV2("ChangeContrast",mR(i,t))}},{key:"GetImageAsync",value:function(e,t,r,n,i){var o=this;if(o._resetErr(),!o._isValid())return Wb.Promise.reject({code:o._errorCode,message:o._errorString});var a=parseInt(e);if(isNaN(a))return pw(o),Wb.Promise.reject({code:o._errorCode,message:o._errorString});if(a<0||a>=o._ImgManager.count())return Gw(o),Wb.Promise.reject({code:o._errorCode,message:o._errorString});var s,u=o._ImgManager.convertClientIndexToServerId(a);return-1==u?(Gw(o),Wb.Promise.reject({code:o._errorCode,message:o._errorString})):(xt.isNumber(t)?s=mR(u,t):xt.isNumber(r)&&xt.isNumber(n)?s=mR(u,r,n):xt.isNumber(i)&&(s=mR(u,-1,-1,i)),o._sendDataByHttpAsync("GetImageByIndex",s,"blob"))}},{key:"GetImageInfoAsync",value:function(e){var t=this;if(t._resetErr(),!t._isValid())return Wb.Promise.reject({code:t._errorCode,message:t._errorString});var r=parseInt(e);if(isNaN(r))return pw(t),Wb.Promise.reject({code:t._errorCode,message:t._errorString});if(r<0||r>=t._ImgManager.count())return Gw(t),Wb.Promise.reject({code:t._errorCode,message:t._errorString});var n=t._ImgManager.convertClientIndexToServerId(r);return-1==n?(Gw(t),Wb.Promise.reject({code:t._errorCode,message:t._errorString})):t._innerFunV2("GetImageInfo",mR(n)).then((function(e){var t=0,r=0,n=e;if(xt.isArray(e)&&1==e.length&&(n=e[0]),xt.isString(n)){var i=n.split(",");t=parseInt(i[0]),r=parseInt(i[1])}return{width:t,height:r}}))}},{key:"IfShowUI",get:function(){return this._resetErr(),this._isValid()?this._innerFun("IfShowUI"):Lb},set:function(e){this._setIfShowUI(e)}},{key:"IfShowFileDialog",get:function(){return this._getIfShowFileDialog()},set:function(e){this._setIfShowFileDialog(e)}},{key:"checkErrorString",value:function(){var e=this._errorCode;if(-2115===e)return!0;if(-2003===e&&!Wt.DWT.IfHttpPostErrorNoWindow){var t=window.open("","ErrorMessage","height=500,width=750,top=0,left=0,toolbar=no,menubar=no,scrollbars=no, resizable=no,location=no, status=no");null==t||t.document.writeln(this.__HTTPPostResponseString)}return 0===e}},{key:"OverlayRectangle",value:function(e,t,r,n,i,o,a){var s,u=this;return u._resetErr(),!!u._isValid()&&(u._isNoViewer()?u._nouiNotSupport("OverlayRectangle"):t>n||r>i||t==n&&r==i?(fw(u,-2375,"The left or top or right or bottom you entered is invalid."),!1):(s=xt.isNumber(o)?Nb.getColor(o):o,u._UIView.OverlayRectangle(e,t,r,n,i,s,a)))}},{key:"SetViewMode",value:function(e,t){var r=this;if(r._resetErr(),!r._isValid())return!1;if(r._isNoViewer())return r._nouiNotSupport("SetViewMode");if(xt.isString(e)||xt.isString(t)||e<-1&&t<-1)return _w(r),Lb;var n=Math.floor(e),i=Math.floor(t);return r._UIView.SetViewMode(n,i),!0}},{key:"ShowImageEditor",value:function(e,t,r,n){var i=this;return i._resetErr(),!!i._isValid()&&(i._isNoViewer()?i._nouiNotSupport("ShowImageEditor"):Xx.isServerInvalid(i)?Lb:i._UIView.GetWebViewer().webViewer.imageEditor?i.ShowImageEditorEx(-1,-1,-1,-1,3):e&&t&&r?i.ShowImageEditorEx(-1,-1,t,r,0,!0,e,n):i.ShowImageEditorEx(-1,-1,-1,-1,0,!1))}},{key:"ShowImageEditorEx",value:function(e,t,r,n,i,o,a,s){var u=this;return u._resetErr(),!!u._isValid()&&(u._isNoViewer()?u._nouiNotSupport("ShowImageEditorEx"):u._UIView.ShowImageEditorEx(e,t,r,n,i,o,a,s))}},{key:"SetSelectedImageArea",value:function(e,t,r,n,i){var o=this;if(o._resetErr(),!o._isValid())return!1;if(o._isNoViewer())return o._nouiNotSupport("SetSelectedImageArea");var a=parseInt(e);return isNaN(a)||a<0||a>=o._ImgManager.count()?(Gw(o),!1):!Xx.isServerInvalid(o)&&o._UIView.SetSelectedImageArea(t,r,n,i)}},{key:"first",value:function(){var e=this,t=e._ImgManager.count();return e._resetErr(),!!e._isValid()&&(e._isNoViewer()?e._nouiNotSupport("first"):(t>0&&(e._UIView.Go(0),Oj.__innerRefreshFromUIView(e,e._ImgManager.getCurrentImageIndex())),Bb))}},{key:"previous",value:function(){var e=this,t=e._ImgManager.count();return e._resetErr(),!!e._isValid()&&(e._isNoViewer()?e._nouiNotSupport("previous"):(t>0&&(e._UIView.__Previous(),Oj.__innerRefreshFromUIView(e,e._ImgManager.getCurrentImageIndex())),Bb))}},{key:"next",value:function(){var e=this,t=e._ImgManager.count();return e._resetErr(),!!e._isValid()&&(e._isNoViewer()?e._nouiNotSupport("next"):(t>0&&(e._UIView.__Next(),Oj.__innerRefreshFromUIView(e,e._ImgManager.getCurrentImageIndex())),Bb))}},{key:"last",value:function(){var e=this,t=e._ImgManager.count();return e._resetErr(),!!e._isValid()&&(e._isNoViewer()?e._nouiNotSupport("last"):(t>0&&(e._UIView.Go(t-1),Oj.__innerRefreshFromUIView(e,e._ImgManager.getCurrentImageIndex())),Bb))}},{key:"_isBindViewer",value:function(){return!(!this._viewer||!this._viewer.webViewer)&&this._viewer.webViewer.bindViewUI}},{key:"_isNoViewer",value:function(){return!this._isBindViewer()}},{key:"_innerUnbindViewer",value:function(e){var t=this;t.__funResize&&(xt.removeEventListener(window,"resize",t.__funResize),t.__funResize=Lb),t._viewer&&(e?t._viewer.webViewer.dispose():t._viewer.unbind()),t._config.container=null}},{key:"_unload_viewer",value:function(){var e=this;if(e._isBindViewer())e._innerUnbindViewer(!0);else{var t,r=null===(t=e._containerElement)||void 0===t?void 0:t.id;r&&delete Wt.DWT.ContainerMap[r]}e._ImgManager&&(e._ImgManager.dispose(),e._ImgManager=null),e._UIView&&(e._UIView.dispose(),e._UIView=null),e._viewer=null}},{key:"_innerRefreshUI",value:function(e,t,r,n,i){var o=this;return 4==i&&o._isBindViewer()&&(0==o._ImgManager.bImageJustChangedInEditor?o._ImgManager.bImageChangedInViewer=!0:(o._ImgManager.bImageJustChangedInEditor=!1,o._ImgManager.bImageChangedInViewer=!1)),r&&o._ImgManager.refresh(e,o._ImgManager.count(),!0,n),xt.isFunction(o.__OnRefreshUI)&&o.__OnRefreshUI(o._ImgManager.getCurrentImageIndex(),o._ImgManager.count()),!0}},{key:"updateImage",value:(n=GE(m.mark((function e(t,r){var n,i,o,a;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this,fx.Auto,!xt.isUndefined(t)&&0!=t.length){e.next=6;break}throw fw(i,-2853,"The imageId cannot be empty."),{code:i._errorCode,message:i._errorString};case 6:if(xt.isString(t)){e.next=9;break}throw qw(i),{code:i._errorCode,message:i._errorString};case 9:if(-1!=(o=i._uidFromServer2ServerId(t))){e.next=13;break}throw xE(i),{code:i._errorCode,message:i._errorString};case 13:if(!xt.isUndefined(r)){e.next=18;break}throw kE(i),{code:i._errorCode,message:i._errorString};case 18:if(r instanceof Blob){e.next=21;break}throw FE(i),{code:i._errorCode,message:i._errorString};case 21:return e.next=23,pH(r);case 23:return a=e.sent,e.next=26,i._updateImage(o,a);case 26:null===(n=i._UIView.GetWebViewer())||void 0===n||null===(n=n.webViewer)||void 0===n||n.resetImageEditorButton();case 27:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})}],[{key:"ProcessGetBlobByQueue",value:function(){if(r._getblob_queue.length>0&&!r._processing_getblob_queue){r._processing_getblob_queue=!0;var e=r._getblob_queue.shift(),t=e[0],n=e[1],i=e[2];t._convertToBlobForUpload(Wt.DWT.EnumDWT_ImageType.IT_PNG,[n],!1,4,(function(e,n,o){var a=o[1][0],s=t._ImgManager.getImageIdMap(a);if(s){var u={imageId:a,serverId:a,uidFromServer:s.uidFromServer,uuid:s.uuid,imageUrl:URL.createObjectURL(e),minImageUrl:URL.createObjectURL(e)};e=null,t._ImgManager.UpdateImage(u,i)}r._processing_getblob_queue=!1,setTimeout(r.ProcessGetBlobByQueue,0)}),(function(e){r._processing_getblob_queue=!1,setTimeout(r.ProcessGetBlobByQueue,0)}))}}},{key:"_getContainer",value:function(e){return e._containerElement}},{key:"_setContainer",value:function(e,t){return e._containerElement=t}},{key:"_closeImageEditorUI",value:function(e){if(xt.isFunction(e.__CloseImageEditorUI))try{e.__CloseImageEditorUI()}catch(t){GC(t)}}}]);var n,i,o,a}(iH);function gH(e,t,r,n,i,o,a){var s,u=e._ImgManager.convertClientIndexToServerId(r);if(-1==u)return Gw(e),xt.isFunction(i)&&i(e._errorCode,e._errorString),!1;if(s=e._innerFun(t,mR(u)),o)return s;var c=1==s;return c?(a&&(pk.refreshImageAfterInvokeFun(e,r),e.getView().ClearSelectedAreas()),xt.isFunction(n)&&n()):xt.isFunction(i)&&i(e._errorCode,e._errorString),c}function pH(e){return xt.isFunction(e.arrayBuffer)?e.arrayBuffer():new Dt.Promise((function(t,r){if(Wt.navInfoSync.bIE||Wt.navInfoSync.bSafari){var n=new FileReader;n.onload=function(){t(n.result)},n.onerror=function(e){r(e)},n.readAsArrayBuffer(e)}else{var i;fw(i={},-2856,"Cannot convert blob to array buffer."),r({code:i._errorCode,message:i._errorString})}}))}Mb(hH,"_processing_getblob_queue",!1),Mb(hH,"_getblob_queue",[]),function(e){e.normal=0,e.balance=1}(fH||(fH={}));var _H="data:image/gif;base64,R0lGODlhZABkAKUAAPyOFPzKjPyuVPzmxPy+dPyeNPzarPz27PzSnPy2ZPymRPzGhPyWJPzu3PzixPzOnPyyZPzChPyiRPzevPz+/PzWrPy6dPyqVPzOlPyyXPzq1PzCfPyiPPzetPz69PzWpPy6bPyqTPyaLPySHPzKlPyuXPzmzPy+fPyePPzatPz29PzSpPy2bPymTPzGjPyWLPzy5P///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh+QQJCQAxACwAAAAAZABkAAAG/sCYcEgsGo/IpHLJbDqf0Kh0Sq1ar9hslXI4aEwHFUVLLicpjUBrBACMFKTG2Ewne1Khtl4fSnnqgFYUFSJ7hgAiFXOBjE8mDIeHIyaNlUweGZGRGX+WnkYTL5qHIhOfp0MubKN7Iy6oUhQwDSYmDTBPHiyshyydsEwUJgslCiIFCgkPcpcJvIYJv8BJBy4okW8r0kceIM97LIvTRw0Cq5ojBNtGqt9uC08qGisnBA9g4loHAt8jESpKJhT6VqqJMALn3AiYsE7QAneIFCVRkelbiYZFKDhooanAinxWHFyDKABXEhMJ0VFiAkMBqwITQE6hEAGinhRKBg3UlEim/pENzwQcyAKDn00AJ3wKucMxUogKGIsc2DlqhIMsGjgcBRBC6dI0Cla9IaHBKxEHKTWRyGKCqjsUZpeqOFArTFwiK9JGIsDW7TcOd7FU0HuIL5asWwVELfPo2wOiELYuCHzFQ4FnIzRkoYCBsCYGVz3lZZVuMRQNLiGyGOrpQORRClZuHv2tgAPKWNBA0KvgdhkPJzzrYfDBNB0uKwowYDCCQYETMHA78RDB7x6P42J4MFFhhQPWgA4YKJGWAQgHxrObkdXhhAAOHDK4wKd+GgUKHu5Lr8+/v///AAYo4IAEAgODBhNoYFKBdVCgAQkKMDdCcwq40EB6DDoBAwbW/rUhwgMLZlhFA7vxMkICmolIxQEhCLeHUCpK4YEzNvkiIhomOGACDKYNdhQDFWR4wAMCiMKAAA+AZ8QBFR2VgZIBwsACJHswwEKIRAi0FSKmDEjBLtiEYwQFJGzZBgb7eWICabIN4QEBZiKFISxAsRLBkmBumQCU/pXASwZL0rjlagMaNQqgRbwZpzoDnsDLnRmVaSYJaVoygGeTHKHlVgV5mWcvMjG5JQR8/icllcOBgCURKaDqDgM4MXgAAgJAciQCpbopqDs2ZugBDDnaYhwMF7jYxggwxihFAxm4OAIEKSq77AMdIoJBA9JW4UEDLkQ4IYUWzpmtEgcmuOq4/uimq+66/qHhwAQfVDABGOxGodECFyjnBgMoZBAAM/UuAcMJl6HDAQniZiuMVt9AAHDAQ1AwAcPuCIAtxENo0JRNECTs664QjUApxg7EycHFp/x64XpNbjVCAJVS4cAGJQhggR9kaFCtRecCsqmHk2mxgqtbFdAmIw5Y94EWNcUJAKyWeFDnISF4fIQFTrcRZCUw+BmJCNFagXXWWzdSFE9HUzG1mQwYYIkKYx+iQK5RPGAsKyKEVkkK1r2SRdJOh4ByIx48ZEgJdEfhwcYuJ/UJBSu0UIAIEriQuBQVxFnAALBsR68ZBzBuEwExC0hBBzt31LMRKqRAAAEpAESgYgfU2sSB3kscsOueBXqQnDshxOTECocsXeDpokeCImWv7QFBhlxUEIIIEx7LgAgQoBeF13sgeqMJD7gAAgEurPAwFHYb8hjGT4iqB6nsPyELkSWAWHr8+Oev//789+8/u0EAACH5BAkJADEALAAAAABkAGQAAAb+wJhwSCwaj8ikcslsOp/QqHRKrVqv2Kx2y+0uPY1JJ+XQeLxob2OhYAAAjNaika5fKYPL6M0HjC4DFHaDUSYofYgAKCaEjUweAomJAmeOlkYOe5J9Iw6Xn0MEm4kEoJ8UCqOICoKmUB4aJiYNrU4UHKp9HLWuSwcBAhwoBQolFZVMFC25fC28vUceFQWSIyEOz0gWzG8W0EoeLm6jIilNmdyeUBQNsg3IXhXjqhyMX5G5lK8uF8IKJ3S8HKDGjQU8JA5wjeKgzkmDEprejECBrYsLbm/KJXOgJ9Gfik5g4EtUwJ4WSBjfLDiIpEGENm8YKIgQ0NaKiKRYVtGgEGP+Ahi2NExIkWKChmy+QKgKUROLA4IYBTQddCCEqpJbBhxKKQCoowMXVC3aokFCSgAsDljycELVhalWUKZ0gTQNBQPzEI2IUJdKBZxiB3xSsQHwm65dPFhlNmKDzkEwXIjowwAC3CxPmbXwCspDCgICLrBYoRYNhRRQPba4bImChwMHPPTVYoLFZEQcInD+tjbFAgglSrAgYeIxb0KvYcA4MPu48+fQo0ufTr269evYs1t3DaOBdxiytXOB8VnBixEiJJwwsFt8lQEl8vJhUEKweyoUKvTcxMFA8/tG5HdbLiJU8B+AQzSwXy4csDYdBTBoAMOBF521gHYutcBBCBv+OCgEDANiVEB70lHgQAs4tRBIEvKcBUcF1x1QgiQllHbEAi6+EcF16HjUkBHb5OiNdRiMgkESSgl5HQmjkJAEji7uxaNhfvxYRItnMQCjdQeM1IcANhoBoosjXodHKn2oOBuUKV2YXQMnhCBBCAAxoWBKDYoHoYQHCshNgQciKER+CybCgYGCRuFAfJLQZ2WiIVVAgAQijPCCBARUQCKktnjQ3XfhcSrqqKSWauqpqBbhqSwTppqMCScoUIAIBRTQAgm0uGqEBw5AQCUcAAWaKAUPpLaJAiClSsEKL2AkwaOknmZsLkyl2oCXGFkgrHb5/aoKAx7aQcG2T3gwY47+ALgAigoYXCBHuFIc4G0urDThGmyhTqHCYm+gYJ8WDqD7RgHhHjABBhFYAEIEGEwQ5hMBJFICuUoYIDAAIpi06wolTFtACSsYF80yej1sRQUXZ3wEOyHIhwgDTAXqAZqImFzFBBcTvOsEhW6CwgSBioIbxUnAcLEEB5loFp7JKqHBVhkhelLP3IAgJrbcXGDzEb3uEUIKIktBAQnzbjLCv0NEIPCOnXqQ7xYN0JwSBM+Mia4Im4JCrMtXPfpA2aOM8IBzB5wAeEYrPENBAhcDkADRaHhAAN+IFBCymCQLvNlzKjygwK8jCJACUnderAC8l7CDweecQKBpXWU1zoFdBiWCYUIFKZgQ22xxN346qR6EdbEAKpQqtMCllDrB4dVMYCoF/LoYAuTVpUD5t+acKnmOJ4QtKAwgMD8CC3mPWvj180WwdakeIICi2S0g4P2o7KwgAE6hr5ArKEEAACH5BAkJADAALAAAAABkAGQAhfyOFPzKjPyuVPzmxPyeNPzarPy+dPz27PzSnPymRPy2ZPzGhPyWJPzu3PzixPzOnPyiRPzevPzChPz+/PzWrPyqVPy6dPzOlPyyXPzq1PyiPPzetPzCfPz69PzWpPyqTPy6bPyaLPySHPzKlPyuXPzmzPyePPzatPy+fPz29PzSpPymTPy2bPzGjPyWLPzy5P///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAb+QJhwSCwaj8ikcslsOp/QqHRKrVqv2Kx2y+16v+CweAydRCyVjyUyIbujkwYGQK9jGu23Xtkg1f8AJA17hEYdLSKAdSItHYWPMA0Jin8Jg5CEA4mUdCIlmIQRnH8OoGUvJSUHeVAlm5yepkwTLyMaIrgMCQWrT5KjAJaySh0OK5QiGBmsS4evgCIBjsNHZhrAApdNfZyCVRPTYS/HwAAszEq0JM8iguhNcQYrGiwO71oj5XQMEWURIAIqrLk36wSDPyIWhNsy4Zo+ACgIisngEGG/Lg0OPqxwoFCAZ3a8OAA5StieDhY4aViYxdXDYNreTDDACQJLLC806hPQkdD+A5IAQHiZ8OGhCAkSxZFDmOELBaCAQjR91KCCRhEJ2Hw5oKAcI1AHEKBA8QAPmAkZKowSAaInqAlJtcRhobNOiBYvqOkxY0FAghUCUMTUK/NAhgYp4hJezLix48eQI0ueTLmy5cuYM397kaFEhheKNS+Z4ICDAA0mNAjgYE/0lA4oQigSEQLFTdd8BJTLhrvJCxZQF7HI2zvJBA/B/zBQEVov3OYHILwM5jZyBw8QQkDwcLuIg+l0SklOseBVwhRL8oEfMdmB7D8ELiahCd6A5AkXKD1IigI8APuRTfCAfkkF4B97kkXwnl3yIfEdeOJFdoAE5klQ3REHTPJSAhf+PnZddtt1R8QEKtQ1ynLNUQNOir8lB4AIwxW3RAO6YTOYjEd0YMCCf9QmIo5EFCOBABBoAIEAEjjwI5BF0JJKCaAxKeWUVFZp5ZVYPgHOCy8kluURL5yAAgYkCICBAWWN8VwHHcAFSgoPJGDiiyZIEGUXHTSgAgYmMMCABiBEcKceHZSgITAhULBkFAdcIN1sHyi61wmP6sPAA4s68ducPbaQ4hUlVPRQCB58ikQHfujDSKZXZOgfAARESEUHC0yXqKlwGPgqABiwikQJJoAnAHFgvFCpf7HMKgGyJ4hBAacvcVBFA0X5ZwGuTsy0ax0QYAtDCTy+tBIYB8yxLaz+Nzox0qsMZFqMCi20oIKSS7yg1rkhfDLFusj+SIstDOCSiwYjDFoEjecCkC8VA7jwKgESdUCBqIpowB2GqW4bQrrbHDqdAgR18AC0yu1nSErnjjvFASC8ylw1Jb7kQqlGjOAiMBhYcUK45ZjUpAPBTmdCa0RkQMC5DUrRQcsvMXDBPSnQVx9L2u66gq9INHAsMCx0KEQGPOvjwo0NhF0OAxR4S4ShXmFArBEIbIuAESTejBAKXk/RAAhhi0CABOglwcK2LOT4gNmzWZA3FSkUYEECIYjAQAgfJLlkta9WcKoKR59t4Rd5luCAAyWYxcRS/q1g3AAKBFfBCVi7kbFpfyQ0U0ILkIcQAgH0OODlYhxsK20THXAGZeyhbJt0cS9Q/JAGb8sooN2LmCzlC+a+pED0QJaw9SgQTEVlHB8kJ8IKplv5ggS3zKaBnV/CUOgICiRAAAEJKDBCCcj3NsEBDThMA3qBiSAAACH5BAkJAC8ALAAAAABkAGQAhfyOFPzKjPyuVPzmxPyeNPy+dPzarPz27PzSnPymRPy2ZPzGhPyWJPzu3PzOnPyiRPzChPzixPz+/PzWrPyqVPy6dPzOlPyyXPzq1PyiPPzCfPzevPz69PzWpPyqTPy6bPyaLPySHPzKlPyuXPzmzPyePPy+fPzatPz29PzSpPymTPy2bPzGjPyWLPzy5P///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAb+wJdwSCwaj8ikcslsOp/QqHRKrVqv2Kx2y+16v+CweEwum4sS1yYg2rgk53gzIgDYQ5SIfI9sJOyAAAkNfIVCEgWBgSZwhnsNKoqAKoSOchh/koIYlnKQmoKVnU4SHByNUoghmoyjTRwRDiwBKSSoUA0PkoOuTC4VBKsAIRkWKFN0gHh6vUouI5ohEAepaiIBbreppdpeHB+gww7dcQ0LCSUFtmERBOEAKtSFB3WADwNgEg7vw5yFKZJWkMPCYQE/ABsMXZAEYuAVDiwOJiwETlEJh1YkpBAGKoSoPScktfpCIsM7AfL4cFgRiMLHLhJEMAAFYgNGMhIiFKgwISX+GBQaOAICkYJDszIHHCQQFmLEBqNHy0g4QGJDhAYHbkbdyrWr169gw4odS7as2bNow3BwgcEF1LRVOJwoQCHBgwQUCpx4C7fJ1BPBopXoqRWuBAwrhEZbgaEw1QEkfH5t4EFxRw8v0TQokAGE5wcFGhR2hKLeQUAjJA9BkcKdJAIpVPfiUMAyvxAF+AopaPvOAt29NoA4zXDiEAkTZr5r0WF0HBQmeh80wZfyacxRG5gkLimDKAknpAcKccK5mQjcoxmXYJD4AvNlEKTXlGLISu4rgFuKOF9RAPsVnfaBfo6I0J8iLBwHAXcQEGgIQAcCUt8h4Z1GHnxkoBfhMMz+CGHdQS5lt92B3hGBXAv8MIchGSgkEqEJkvEWTgi/cSXcgQQYRwRrrikC2zFc0dZfCBUQKMFmnXmWQWgrxnEABfN5IFsRLpAQAQkujPXhQSF44E9fSByW2G2MNSmWBChMUIJtIQyWFZhOyEVXAhngpZeDcCpxAFsuTJnnn4AGKuigUJRyAgsfrLDABG+MUYoLDTTgliMSkGCCcoooEAGQXhyQQgEjJKDCBRA8pVIKI2oCwjQwRTACpoAQ8EFmY3AgAoq3KYBnFBykMFw4GXSIkwOwvhMCdVqcUKwmJdBKUgnpMdAcFgek+s6AZHBgQn8jZHmFBdzVRMYBy3Kp4xT+B0TCHbJiTPCimS+Q0ONp3Y6x4IEe7LrEjdzxIkaA82WgrxIn/Eqcv0uU0kAEKaRw1SlMsHRgCQMn0U56FHjrzAkCCBWCACf4KcS2+FaMhAuZEFeByC808EG5ADAwqxIQ9odtFYhwx0AKGLmggnjwaGxEAxFOAG/LBvOTmp6m8YNSmAvNl8CXVlgANAAgCGuErVffIcJA/BIXgggmKwGdeAwggNGW1zl7NncXCH3FASIkrUwGey1RIXfkJeGCAl2X2EUDJqhQAggElOCBBXIfAVF/LDhIG8x2MHCBs1hMNcAGG5DA6RLf9FekEr2+KkkICYjQeCcoSJzeCiynsYFdBgJkUIIABUzQQNlnCDkfu0yUYoopR4uhT3/jDBqB3fxkTegBUROnAMtwXXxajoQe4sDVISSf/QsQUR5z5N/bd4IKyzKgQt7lE+GpAnXhpUBs7YcJKQYH8F6/IUEAACH5BAkJADAALAAAAABkAGQAhfyOFPzKjPyuVPzmxPy+dPyeNPzarPz27Py2ZPymRPzSnPzGhPyWJPzu3PzixPzOnPyyZPzChPyiRPzevPz+/Py6dPyqVPzOlPyyXPzq1PzCfPyiPPzetPz69Py6bPyqTPzWrPyaLPySHPzKlPyuXPzmzPy+fPyePPzatPz29Py2bPymTPzSpPzGjPyWLPzy5P///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAb+QJhwSCwaj8ikcslsOp/QqHRKrVqv2Kx2y+16v+CweEwum5EUynkd7Uwuo0mHTVemTCEAIGRK1f9FFyJ6eiIjUhQdBygBJgQLIA0daoBPFAWEhCeUTm4qDJmFJCAHnJVKBy6hAAwHTwcLeauEDCoNp0yXq5tOLxWDs6EfGbhLI8CFh00HHsHBw6bFRAd4enyuuQHOzirYXB0ZICgN0VEHb3FzTS+y26sMIOVWvgUMLgUt8lBpUC3uzgLUZWmAKRQGb2QObPjn7FaWDghmGdLnxUE7hqFYaMlwMROJF2ZAgMK4SoMWFKpmJSBW5gEykoRUaOEwctVKMw9qwtTjQQv+wWAQEIoRuTPTAi0UTMxiwIJilxIdYYLY0gGCThcBnHbp8KGoHgYgtxx4IGBDAggG6LDwCkCFQKQvSmQoRUdh0RATtErbR5SkiAhv92LpkBOjiApCBWMZqzPY4bCKvxk4sS1EgMSRs1AYKyCECwagQyRoQS6zGAoZULB4AKKEH9OwY8ueTbu27duyOzRAYQJDAgwmxgXGHYVCgxYFQ+ErTbz4BAHuBOS1xM82BQ7JtxWYroTCCwcXTDxw8EJvsRIpGYYo0X0CBmQMMHCH3YHETgzDh6DITqgAB9koNPYPAyggwY4zIUAWGUReITAcBRq4o4F5dWQggVc3FXHACu7+rIBZMRNEpd4ERmSw0DYbsBSZAenB5EJaRZjozgkqKhagVwzAOE0C7iTwIS4heoWXERC6YwKFdGTAY1EZFnFgMAnSB0GD+cGw3ywFFBjbjTDBkwQF7tUU33ymHWAfTCRUKYR3DoygwQjkIVlJCQIiyF4TaciJC5j8BbOdnriBacFLoYhgAZnN4dnAAn0CsBygicKgGwe9/RbcC2pGqummnHbq6aeghlpcnqJa8p0CLWjwwASSkKFbBhmUd8oLCghA6AYBZAApniAgkIAEG6ygwp11NGCVYxY4sOuXDRBA6B6XLUtFA0tWxoG0RVDgQLWzfLTGC2f+E4JDWbxgwT/+BGBrSWEYEZApFC7944IDZrwAHUknDPBQo7OooG4TEzzrTj5YZCCwSgqCQcEDRXnwmhUoHLzKBsSGQUEERXl7RcQYUYyInEllnPAUJUgcSgLkMnFACRMowAIHJfxIBAUjFNXNYiLOAsG7QnTggAonIHOCB3IwEfBOC/DcRAUMiaAREx2MwO8JF7wrI0khaInFT9Hp1UEEJgMAWHcthJ3JzkiBwK8eTSrBsTsi/KdEBueO+A0HXa0iggoD6HVA3v98IDOYOWcyURfe4SHC4gwUwAJdTIDQ4jYvLsFnZSMoTYXPE0xQApJFkjSh5RlU0GcIGCibWQcqwORWEz4HUAFdBhioAMnDkaUQEUkOWpLCCy8coDkgFDBNUgX/mnaMYQGUOgRUGK3n/JqtM+TB8IkesDYhG4wsKpjc2oSo8xSUAMGzIkBQAvabJsIB0CGEcIIKciTf3AHeT69/qUEAACH5BAkJADAALAAAAABkAGQAhfyOFPzKjPyuVPzmxPy+dPzarPyeNPz27PzSnPy2ZPymRPzGhPyWJPzu3PzixPzOnPyyZPzChPzevPyiRPz+/PzWrPy6dPzOlPyyXPzq1PzCfPzetPyiPPz69PzWpPy6bPyqTPyaLPySHPzKlPyuXPzmzPy+fPzatPyePPz29PzSpPy2bPymTPzGjPyWLPzy5P///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAb+QJhwSCwaj0gk5dDYPBaRx6ZxoCSv2Kx2yx2mThYDYExGfU6prnrN5r5WIbKcHFq92vg8m1ICzf9kLCVWeoWGRnwTgIsACoOHkIYHAoyMAgeRmXgPlZUPmqBdL3GdiyF3oalXDyKliyKfqrJFFBiujBiEs7MvLLeLLKhYFMS6u2olHL+AHCVXFC8lJw8PFQ4NxsdZJSjLfyjOSC8qGKRjDCAB2Npayd5zzUgZAgyvCifZ7EYvCu9yCsKGUHAgphODB/n0CbTlbwyEbIluicCnEAmnhrCMHFjR6haLBqAodMjQoEPCfea8nTIiod4vEQE6ZDrQwqUBFSeLXPSWkVb+gncfI1Fo0fGcBC0HSLy7ZKSDi3cMHERK4VIOiZwCSyj6pcBBvgYNcUIqwQxkFj5+SolwlJCsvxFY1WRgFhDLm5R/6tQl4vbdhbhdOhSUswIwkQMbLCiDZ+EEpiQvGlYwvIWCh6IAGJjtsiSDhCcLpGSogkXwuxBShUrAwGHChwwKKUR4h2HvoRePKw7AaxBhxVkdZv8SYPu3phckMDMyANv4rgYClP/hcNT5sQYmeJ9b8cj6sQ4lIgwGECKBBNLe2RE7kCHDC5Pp48ufT7++/fv48+vfn17kAfj8aQKNBAGY8IEJI2zwAmUBnlWBAE/J4QIJHsjUYB4paFDVHwz+RJDbhWq88FMpdmxxgAMbOFCcfR0Q5YoILViYBAUFgGBACAYIQNF+DWhnymZHdPBAhGQcJCN+wv2iwRUlaBdCOPh10M0yKBxZRAuMtKBfBj4yEkJzRyi1CAn6ObChK1ElwRAgGJR5ZilpIoHlIlrmx6VKYBrRJCBP6ielN1UmISSRY7jwgJX2aeDNks8UIMCNKAhQAIPO9fhLCEBC5oAEKjbYonSAwIgoiFgckACocohQIqlqZPhmkRp8yCoXFKgA4RwuCCDWrHu8sMEIBByY4IK86uEfgMUmq+yyzDbr7LPQRqveqNIicYAEF0SgwQgnZFotER2sFkJRISiAQBr+qXQQzQMqjEZpJiks8CoAqq6jyQEBTDnGPejq08ECpdR2nAWAMDCCrLtsMO8cdULy6SIM7HjMAWt2shIkBFWiAMKqnNDlHw0XQsEIpUA5y8ioAvLQIR0QUEoF2gS3DAj96tEBwZ2oELOiv4DAMRsdBFBKaruMvMxVkLRUiQErItGBA9kucIEE1B5RwcJ/RBDJARBUMkLVR5RQTkciGICByVc00M+LaBfSQFpziGBB00V04IGPIagA9hCsuFKYJhlAkJIBC9BNBAUeLy2xoCuUokCeW//6gQUPOLB33WtrfDkMDVT8R1fvqtFBCshyccItJ2gBTQvjxv1a6No07ndgFw2MgAEIIJCwQHf3UZB5JwqEnsLP9VGwWCkcwH4hJa6Q+S0Mc5YSsrQZpEyGCJBHS8EHpVigPIgvQICqCBAY3mwDFrzJgAXZP39ABQmQUkcFxH/r3wH4l/78/vz3T0QQACH5BAkJADAALAAAAABkAGQAhfyOFPzKjPyuVPzmxPy+dPzarPyeNPz27PzSnPy2ZPymRPzGhPyWJPzu3PzixPzOnPyyZPzChPzevPz+/PzWrPy6dPyqVPzOlPyyXPzq1PzCfPzetPyiPPz69PzWpPy6bPyqTPyaLPySHPzKlPyuXPzmzPy+fPzatPyePPz29PzSpPy2bPymTPzGjPyWLPzy5P///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAb+QJhwSCwaj8ikcslsOp9QZad08lBOpUN0y+1CDyoMx8UQhVAYldbLbnMnDpAIQK/TRSDJxM3vIzsUDHaDdQwUHX6JfRMUIYSPACEUe4qVXSUKkJAKJZaeUB0EmpoEiJ+nShkuo5AMGahsGRQBEREXFGtLCKyaKrBREx0nJCFlcyIMKCslpkgQvJAQv09wAnOaIgQNlEYc0I8c003CBt8CA9xEjt+DBuMlFA8PHg4pihMn5ewsr0Yo7IPCKZlQYgUHYwwMWDiRjg0cfQBZ5BqCAaAdDEoORBD0SESCbW5SWLBYR0NDFSTp+EJyQBQrCw3cFEhJx0AnIhk4AnSFZML+iGusEjR7I4AmABER0nWoQJKAvSMlvEETcYJNiXU0BcTEKfUbpz8RAIKYGEWFzpQoBhRhhJWVpIZDGoAAaMCBlwVAUzLYYATQ2VaHkmRoy4vBSi4mjN6hcGSCBBZ57YhgoUdJicisRIzwklixiAJJwGBAYcwFBxJqmJT4m3lzlwCYAbqQsOQAFQoeTgx4yiQDRGiGvARSzOGmpRdF2RX30uA3SQxkE/mMDWnFUGAJjIp4ADdRAxbfGKhl44A6Lw5bP00owPpR0jYdVqTc3l1Rhwft62SLzqVBcnYirFBfJcIoEBsHI/DWBhzgfSMCBun9MkEDD5BgAAMJWRBBCQP+vpFBJrwECJI4QkzwQgYllJDBiJUcsAAK1DHAgQodkojKBBksIMAYyITAQQIPsGjjkEO8UIIEJ5wgQQkKEunkk1BGKeWUVFZp5ZVYZvlGCjVq6UcHDrTwAQQftODAdV76QRAGIQBlBgYcpplIBwWYZwiacr5xAmGEhFBAlyUaKWSe30HDQoQ9NbAChgysMKiWEwTAzgg1vlDRRS/kCcMBXZ3X5FoqRCYCjXm+YB4hImSaRAedDWICnleWYJFxR4TySCl5ZmBRPz2ZNYhhgEZpKoCqJvECCYOQUGyaKYAIjQL8EWFiBYxW8EKwUU7QwqSATujAtZrG1SArh4brxXr+fA7iJ6zmjjMcYOy228SabZkBQZzytpFCmBWQ2YIEn+br0AHxCmzwwQgnrPDCDDfs8MMQRywxlPhoAAEGBKQ28R8SyCGZASoU7EYHDaQI7pMdqJDuURFEy0cDC4DAAQcCjCDyJxKsTAcDNltygMf6vUrkBHOxYgCifMTXEaVDnnBqHRFUchUkAiw7jQlP06FAJe8SshyJE1xaGLZO+PqITTaGHR7ZTTiwMghIw8IUNAIlcsB/kkVwsyIUZA0AAZasRgjcRB7gXEd2VUKQAMUwEEICLg/UwAgGiqDACI8qEeooIgjtyb5WMPOGA+PWwYID2HawESQiQBC3lRkUTQhgP1+MwGfnr1fJ6iieO0FyBCxgyIEJZ+b6jyYo8LoxDOVxnvjyzPPy/PKCa8IArRsjN0rV0AtxX34McNe9EAd8gJkIH0QesbYw3oFCC2wzjOMDC0TwQAbxj6///vz3v38QACH5BAkJADAALAAAAABkAGQAhfyOFPzKjPyuVPzmxPy+dPyeNPzarPz27Py2ZPymRPzSpPzGhPyWJPzu3PzixPzOnPyyZPzChPyiRPzevPz+/Py6dPyqVPzOlPyyXPzq1PzCfPyiPPzetPz69Py6bPyqTPzWpPyaLPySHPzKlPyuXPzmzPy+fPyePPzatPz29Py2bPymTPzGjPyWLPzy5PzWrP///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAb+QJhwSCwaj8ikcslsOp/QqHRKrUI7pcmk1LF6v9ZOxlNgmBmFSqYLbruRjQgDQK/TGZrGe/92YeyAdCIkLnyGYRWBigAVbIePThQXc4uADBcUkJpLDR+Vih96m6NGKJSfdgwopFMUHQcZEw4NBx2ZSx0LqIoLjqxMFA0KAiKpHigut0gHCLuBCAe/TR0vFsWKDBgOSgckzoAk0dJKFAstuxsoykXM33bQTi4vASwKa3wdLNe7IS/rQx0iuKvTawmFEipEFFMoIsEEX14ogDjnbkMJJKYGqsKloMAiBgsKgWmwYiAdBP+EdBoYasmLEJ9EsIDY6sE+dyIyHKEw4ub+JwYjUhJx4REVgwlfOpQ0SccEkg4evnmgSYSCiW8JhEI54NPdCqowXJDoameQyCQulu4ScdFKCaZ1Cpw10kDDKUsmRClxUHTtAy8c4NIpoDOJGBVlzhTwUEJrkZfuFniZIBgA4SYHsmwR5wQFTGcyvWSofGKuoRInvolQ4OXAXZaO2xzwBFovlQ7N4F4YZdOZii8UXrx2xsD2oxS0PxVo60UsUw2x3zhIXamFArBRKPAdKMA4JAoZMAwHcOIF9ikGPu/6wJxVBwUWToQIUWCFBtNggm/YJaDxOCEHDIACCrNEV8VBHpAFQAgRePcfKeAtsMIJBRRwwgcKNGDgg5r+UOBCA7RsyOGIJJZoIoQUiHjiHh5OcMECESwwwgTJrDiKCyYkEMI+IoSQgAn42ejGARf0pUiPF3AmZBsuRAVaBUEuOcUBEJgEj5RhaKBgJSJocJ6JWJiwwgYrmOAAWMGpN1AL/mB5kDeAiNBfSgf8IRgGStpYwn6LWGTEBFuuhdSSDViASndFEFAZHQQsmU+gAIiwwDrUVbYBoQk4s4JtkK6lIikTUGTUNkMsWkeeJaLgziqlmgoAqiSq+g2rQnSKighfjuPAeIGEQKoQfJJGqFqfJGBbIos2KuSjt7KwDqCViTCokA0IcKhxdVaGJ5YDBBvIBgMYkSZc/Xz6y0H+xMQ55xEB2VpWBLmS2IEDJnywwQdmntfOQCrAimUUDSQImgcO/ivFASMYGUiPI/hr8BQuaLBCCKcwEEKZDj9MhYccPMDCAiw8gIy5GkORIsklp6zyyiy37PLLMMcs88wcvvKhC7bQLAV4ERQVQgUToCyFGA3E26EDxNIRggJCR4KCAAVsgEFhHGaQHCAFcPAIBQrcxADV43SgwScCRPlFCgoDgIDRfBxQqSIhTLvHW98WvEkDkL5wCGWBXPZfA7uwZohrgQjA9h4uqBkIA1obUk6cckvTAbKLtHTIASxQUgDTHFIwgeJ1iBDUdwfIckDTQlBwwOkbd7S4CaifW0JlACp4EIB/Oz/9GQMfjJ7yC2+XV4ULE7wAAgpFq7wdICG0pzMuuT1z+MwNZKqIsc83kYEEi0gAdvbLXG2HBRmDL4Q+C7NgPhPOAVL2+kwEzEAxDBAMfzxamH3//vz37///AFxREAAAO2l6MlNnMjJPaEJTY1lvVkpORFI0dmF6ek1tK1ZrditmL1VXWmxseUxSc0NPYk4vVU5kVVRWeThHRmlpUWNqNWQ=",mH={loaderBarClassName:"ds-dwt-loaderBar",loaderBarBackgroundColor:"",loaderBarSource:Y.bIE?_H:Dt.loaderBarSource,loaderBarSourceIE:_H,loaderBarWidth:120,loaderBarHeight:120,errorMessages:{limitReachedForZoomIn:"Error: You have reached the limit for zooming in",limitReachedForZoomOut:"Error: You have reached the limit for zooming out",insufficientParas:"Error: Not enough parameters.",invalidAngle:"Error: The angle you entered is invalid.",invalidIndex:"Error: The index you entered is invalid.",invalidHeightOrWidth:"Error: The height or width you entered is invalid.",imageNotChanged:"Error: You have not changed the current image."},generalMessages:{checkingDWTVersion:"Checking WebTwain version ...",updatingDService:"Dynamsoft Service is updating ...",downloadingDWTModule:"Downloading the Dynamic Web TWAIN module.",refreshNeeded:"Please REFRESH your browser.",downloadNeeded:"Please download and install the Dynamic Web TWAIN.",DWTmoduleLoaded:"The Dynamic Web TWAIN module is loaded."},customProgressText:{upload:"Uploading...",download:"Downloading...",load:"Loading...",decode:"Processing...",decodeTIFF:"Processing tiff...",decodePDF:"Processing pdf...",encode:"Processing...",encodeTIFF:"Processing tiff...",encodePDF:"Processing pdf...",transfer:"Transferring...",canvasLoading:"Loading ..."},buttons:{titles:{previous:"Previous Image",next:"Next Image",print:"Print Image",scan:"Acquire new Image(s)",load:"Load local Image(s)",rotateleft:"Rotate Left",rotate:"Rotate",rotateright:"Rotate Right",deskew:"Deskew",crop:"Crop Selected Area",cut:"Cut Selected Area",changeimagesize:"Change Image Size",flip:"Flip Image",mirror:"Mirror Image",zoomin:"Zoom In",originalsize:"Show Original Size",zoomout:"Zoom Out",stretch:"Stretch Mode",fit:"Fit Window",fitw:"Fit Horizontally",fith:"Fit Vertically",hand:"Hand Mode",rectselect:"Select Mode",zoom:"Click to Zoom In",restore:"Restore Original Image",save:"Save Changes",close:"Close the Editor",removeall:"Remove All Images",removeselected:"Remove All Selected Images"},bShowAllButtons:!0,visibility:{scan:!0,load:!0,print:!0,removeall:!0,removeselected:!0,rotateleft:!0,rotate:!0,rotateright:!0,deskew:!0,crop:!0,cut:!0,changeimagesize:!0,flip:!0,mirror:!0,zoomin:!0,originalsize:!0,zoomout:!0,stretch:!0,fit:!0,fitw:!0,fith:!0,hand:!0,rectselect:!0,zoom:!0,restore:!0,save:!0,close:!0}},dialogText:{dlgRotateAnyAngle:["Angle :","Interpolation:","Keep size","  OK  ","Cancel"],dlgChangeImageSize:["New Height :","New Width :","Interpolation:","  OK  ","Cancel"],saveChangedImage:["You have changed the image, do you want to keep the change(s)?","  Yes  ","  No  "],selectSource:["Select Source:","Select","Cancel","There is no source available!"]}},vH=xt.mix({},mH);function yH(){var e;Wt.DWT&&(e=Wt.DWT.CustomizableDisplayInfo),e&&(xt.isString(e.loaderBarSource)&&""!=e.loaderBarSource?Dt.loaderBarSource=e.loaderBarSource:Y.bIE?(Dt.loaderBarSource=mH.loaderBarSourceIE,Dt.loaderBarSourceIE=mH.loaderBarSourceIE):Dt.loaderBarSource=mH.loaderBarSource,xt.isString(e.loaderBarClassName)&&""!=e.loaderBarClassName?Dt.loaderBarClassName=e.loaderBarClassName:Dt.loaderBarClassName=mH.loaderBarClassName,xt.isString(e.loaderBarBackgroundColor)?Dt.loaderBarBackgroundColor=e.loaderBarBackgroundColor:Dt.loaderBarBackgroundColor=mH.loaderBarBackgroundColor,e.loaderBarWidth?Dt.loaderBarWidth=e.loaderBarWidth:Dt.loaderBarWidth=mH.loaderBarWidth,e.loaderBarHeight?Dt.loaderBarHeight=e.loaderBarHeight:Dt.loaderBarHeight=mH.loaderBarHeight)}var SH=!0;function TH(e){var t=e,r=window;if(r.ShadowRoot)for(;t;){if(t instanceof r.ShadowRoot)return t;t=t.parentNode}return null}function IH(e){var t=window;return!!(t.ShadowRoot&&e instanceof t.ShadowRoot)}Dt._funsAfterConfigLoaded=[],Dt._safePromptCustomMsg=function(e){e&&e()};var bH=dR;Wt.DWT;var CH,wH,EH,AH,DH,PH,RH,xH,kH,FH,OH,WH,NH,MH,LH,BH,UH,VH,GH,jH,HH,zH,KH,JH,YH,QH,XH,qH={background:"#434246",topMenuBorder:"",innerBorder:"",promptToSaveChange:!0,buttons:vH.buttons,dialogText:vH.dialogText},ZH=function(){return s((function e(r,n){t(this,e);var i=this;i._stwain=r,i._ImgManager=r._ImgManager,i.zoomInStep=1.2,i.zoomOutStep=.8,i.MIN_ZOOM=.02,i.MAX_ZOOM=65,i.MAX_ROWS=128,i.MAX_COLUMNS=128,i.__MousewheelValue=0,this._Init(n)}),[{key:"_Init",value:function(e){var t=this;if(t.borderWidth=xt.isUndefined(e.borderWidth)?1:e.borderWidth,e.BackgroundColor?t.BackgroundColorByDefault=e.BackgroundColor:t.BackgroundColorByDefault="#FFFFFF",e.BackgroundColor=t.BackgroundColorByDefault,t.BackgroundFillColor=t.BackgroundColorByDefault,e.onTopImageInTheViewChanged=function(e){xt.isFunction(t._stwain.__OnTopImageInTheViewChanged)&&t._stwain.__OnTopImageInTheViewChanged(e.index,e.bByScrollBar)},e.onGetImageInfo=function(e){return{width:t._stwain.GetImageWidth(e),height:-1}},!t._stwain._viewer&&Wt.DWT.UseDefaultViewer){var r={viewerContainer:{},viewerEvents:{topPageChanged:function(e,r){t.__topPageChanged(e,r,t)},click:function(e){t.__click(e,t)},rightclick:function(e){t.__rightclick(e,t)},dblclick:function(e){t.__dblclick(e,t)},mousemove:function(e){t.__mousemove(e,t)},pageAreaSelected:function(e,r){t.__pageAreaSelected(e,r,t)},pageAreaUnselected:function(e){t.__pageAreaUnselected(e,t)},dragdone:function(e){t.__dragdone(e,t)},onDrop:function(e){t.__onDrop(e,t)},pageChange:function(e){t.__pageChange(e,t)},bufferChanged:function(e,r){t.__bufferChanged(t,e,r)},onBind:function(e){t.__onBindViewer(e)},onUnBind:function(e){t.__onUnBindViewer(e)},save:function(e,r,n,i){return t.__save(t,e,r,n,i)}},viewerError:{setError:function(e,r){t.__setError(e,r,t)}},imageEditorEvents:{acquire:function(e){t.__acquire(t,e)},loadImage:function(){t.__loadImage(t)},deskew:function(e,r){t.__deskew(t,e,r)},removeImage:function(){t.__remove(t)},removeAllImage:function(){t.__removeAll(t)},close:function(){t.__close(t)}},imageEditorServerCallback:{rotateRight:function(){t.__rotateRightForServer(t)},rotate:function(e,r,n){t.__rotateForServer(t,e,r,n)},rotateLeft:function(){t.__rotateLeftForServer(t)},deskew:function(e){t.__deskewForServer(t)},crop:function(e){t.__cropForServer(t,e)},erase:function(e){t.__eraseForServer(t,e)},changeImageSize:function(e,r,n){t.__changeImageSizeForServer(t,e,r,n)},flip:function(){t.__flipForServer(t)},mirror:function(){t.__mirrorForServer(t)},restore:function(e){t.__restoreForServer(t,e)},save:function(e){return t.__saveForServer(t,e)}},beforeImageEditorCreated:function(e){t.__beforeImageEditorCreated(e)}};e.Container&&(Wb.isNodeList(e.Container)||xt.isArray(e.Container)&&e.Container.length>0)&&(r.viewerContainer={container:e.Container[0],width:Nt(e.Width),height:Nt(e.Height)}),t._stwain._viewer=new Wt.DWTViewer(hj._getBuffer(t._ImgManager),r)}else e.Container&&(Wb.isNodeList(e.Container)||xt.isArray(e.Container)&&e.Container.length>0)&&t.__onBindViewer(e.Container[0]);t.__InitEvents(e)}},{key:"dispose",value:function(){this._stwain._viewer}},{key:"__InitEvents",value:function(e){var t=this;xt.isFunction(e.onTopImageInTheViewChanged)&&(t.onTopImageInTheViewChanged=e.onTopImageInTheViewChanged),xt.isFunction(e.onGetImageInfo)&&(t.onGetImageInfo=e.onGetImageInfo),xt.isFunction(e.onZoomChanged)&&(t.onZoomChanged=e.onZoomChanged),xt.isFunction(e.onMouseMove)&&(t.onMouseMove=e.onMouseMove),xt.isFunction(e.onMouseClick)&&(t.onMouseClick=e.onMouseClick),xt.isFunction(e.onMouseRightClick)&&(t.onMouseRightClick=e.onMouseRightClick),xt.isFunction(e.onMouseDoubleClick)&&(t.onMouseDoubleClick=e.onMouseDoubleClick),xt.isFunction(e.onImageAreaDeSelected)&&(t.onImageAreaDeSelected=e.onImageAreaDeSelected),xt.isFunction(e.onImageAreaSelected)&&(t.onImageAreaSelected=e.onImageAreaSelected),xt.isFunction(e.onBufferChanged)&&(t.onBufferChanged=e.onBufferChanged),xt.isFunction(e.onSelected)&&(t.onSelected=e.onSelected),xt.isFunction(e.onRefreshUI)&&(t.onRefreshUI=e.onRefreshUI),xt.isFunction(e.onResetCurrentIndex)&&(t.onResetCurrentIndex=e.onResetCurrentIndex)}},{key:"GetWebViewer",value:function(){return this._stwain._viewer}},{key:"SetSelectedImageArea",value:function(e,t,r,n){if(null!=this.GetWebViewer()){var i=[],o={};return o.left=e,o.top=t,o.right=r,o.bottom=n,i.push(o),this.GetWebViewer().setSelectedAreas(i)}return!1}},{key:"OverlayRectangle",value:function(e,t,r,n,i,o,a){var s=this;return!!s._stwain._isNoViewer()||null!=s.GetWebViewer()&&s.GetWebViewer().webViewer.overlayRectangle(e,t,r,n,i,o,a)}},{key:"ChangeImageViewSize",value:function(e,t){var r=this;return e>=0&&(r.GetWebViewer().width,r.GetWebViewer().width=e),t>=0&&(r.GetWebViewer().height,r.GetWebViewer().height=t),!0}},{key:"ChangeSize",value:function(e,t){var r=this;return r.GetWidth()!=e&&r.SetWidth(e),r.GetHeight()!=t&&r.SetHeight(t),!0}},{key:"GetWidth",value:function(){return this.GetWebViewer().width}},{key:"SetWidth",value:function(e){var t=e;return this._stwain._isNoViewer()||(this.GetWebViewer().width=t),!0}},{key:"GetHeight",value:function(){return this.GetWebViewer().height}},{key:"SetHeight",value:function(e){var t=e;return this._stwain._isNoViewer()||(this.GetWebViewer().height=t),!0}},{key:"SetViewMode",value:function(e,t){var r=this;return r._stwain._isNoViewer()?r._stwain._nouiNotSupport("SetViewMode"):r.GetWebViewer().setViewMode(e,t)}},{key:"SetIfFitWindowAndType",value:function(e){var t;if(null!=this.GetWebViewer()){switch(e){case 1:t="height";break;case 2:t="width";break;default:t="window"}this.GetWebViewer().fitWindow(t)}return!0}},{key:"GetAllowMultiSelect",value:function(){return!this._stwain._isNoViewer()&&this.GetWebViewer().selectionMode}},{key:"SetAllowMultiSelect",value:function(e){return this._stwain._isNoViewer()||(this.GetWebViewer().selectionMode=e?1:0),!0}},{key:"GetFitWindowType",value:function(){return this._stwain._isNoViewer(),0}},{key:"SetSelectionRectAspectRatio",value:function(e){return this.GetWebViewer().selectionRectAspectRatio=e,!0}},{key:"GetSelectionRectAspectRatio",value:function(){return this.GetWebViewer().selectionRectAspectRatio}},{key:"SetFitWindowType",value:function(e){return this._stwain._isNoViewer()||this.SetIfFitWindowAndType(e),!0}},{key:"GetIfFitWindow",value:function(){return this._stwain._isNoViewer(),!0}},{key:"SetIfFitWindow",value:function(e){var t=this;return t._stwain._isNoViewer()||(e?t.GetWebViewer().fitWindow("window"):t.GetWebViewer().zoom=1),!0}},{key:"GetImageMargin",value:function(){return this._stwain._isNoViewer()?0:this.GetWebViewer().pageMargin}},{key:"SetImageMargin",value:function(e){return this._stwain._isNoViewer()||(this.GetWebViewer().pageMargin=e),!0}},{key:"GetSelectionImageBorderColor",value:function(){return this.GetWebViewer().selectedPageBorder}},{key:"SetSelectionImageBorderColor",value:function(e){var t=e;return xt.isNumber(t)&&(t=Nb.getColor(t)),-1==t.indexOf("1px solid")&&(t="1px solid "+t),this.GetWebViewer().selectedPageBorder=t,!0}},{key:"GetZoom",value:function(){return this.GetWebViewer().zoom}},{key:"SetZoom",value:function(e,t,r){var n=this;return e<n.MIN_ZOOM&&(e=n.MIN_ZOOM),e>n.MAX_ZOOM&&(e=n.MAX_ZOOM),null!=n.GetWebViewer()&&(n.GetWebViewer().zoom=e),!0}},{key:"ZoomIn",value:function(e,t){var r=this,n=r._ImgManager.getImageIdMap(r._ImgManager.convertClientIndexToServerId(r._ImgManager.getCurrentImageIndex()));if(!n)return!1;var i=r.GetWebViewer().zoom,o=Math.floor(100*i*r.zoomInStep)+1;return 1<o&&o<2501?Nt(n.imageWidth*i)>15e3||Nt(n.imageHeight*i)>15e3?(dR.output(r,vH.errorMessages.limitReachedForZoomIn),alert(vH.errorMessages.limitReachedForZoomIn),!1):(r.SetZoom(o/100,e,t),!0):(dR.output(r,vH.errorMessages.limitReachedForZoomIn),alert(vH.errorMessages.limitReachedForZoomIn),!1)}},{key:"ZoomOut",value:function(){var e=this,t=e.GetWebViewer().zoom,r=Math.floor(100*t*e.zoomOutStep)-1;return 1<r&&r<6501?(e.SetZoom(r/100),!0):(dR.output(e,vH.errorMessages.limitReachedForZoomOut),alert(vH.errorMessages.limitReachedForZoomOut),!1)}},{key:"GetMouseShape",value:function(){return this._stwain._isNoViewer()?0:"crosshair"!=this.GetWebViewer().cursor}},{key:"SetMouseShape",value:function(e){return this._stwain._isNoViewer()||(this.GetWebViewer().cursor=e?"pointer":"crosshair"),!0}},{key:"GetShowPageNumber",value:function(){return!this._stwain._isNoViewer()&&this.GetWebViewer().showPageNumber}},{key:"SetShowPageNumber",value:function(e){return this._stwain._isNoViewer()||(this.GetWebViewer().showPageNumber=e),!0}},{key:"SetBackgroundFillColor",value:function(e){var t=e;return this.BackgroundFillColor=t,!0}},{key:"GetBackgroundColor",value:function(){return this.GetWebViewer().background}},{key:"SetBackgroundColor",value:function(e){var t=e;return this._stwain._isNoViewer()||(this.GetWebViewer().background=t),!0}},{key:"Go",value:function(e){return this.GetWebViewer().gotoPage(e)}},{key:"__Previous",value:function(){return this.Go(this._ImgManager.getCurrentImageIndex()-1),!0}},{key:"__Next",value:function(){return this.Go(this._ImgManager.getCurrentImageIndex()+1),!0}},{key:"__fireEvent",value:function(e,t){if(xt.isFunction(this[e]))try{return this[e](t)}catch(r){GC(r)}return!0}},{key:"GetIfAutoScroll",value:function(){return this.GetWebViewer().ifAutoScroll}},{key:"SetIfAutoScroll",value:function(e){return this.GetWebViewer().ifAutoScroll=e,!0}},{key:"BindView",value:function(e){var t,r=e;return xt.isString(e)?r=xt.get(e):xt.isDOM(r)&&(r.id&&""!=r.id||(r.id=["dwt_",xt.getRandom()].join(""))),(t=this.GetWebViewer().bind(r))&&this.GetWebViewer().show(),t}},{key:"GetIfShowVideoContainer",value:function(){var e=this,t=e.GetWebViewer();return xt.isUndefined(t)?(Wt.DWT.UseDefaultViewer?oE(e._stwain):iE(e._stwain),!1):t.webViewer.getIfShowVideoContainer()}},{key:"ShowVideoContainer",value:function(e){var t=this,r=t.GetWebViewer();return xt.isUndefined(r)?(Wt.DWT.UseDefaultViewer?oE(t._stwain):iE(t._stwain),!1):r.webViewer.showVideoContainer(e)}},{key:"UpdateVideoContainer",value:function(e){var t=this,r=t.GetWebViewer();return xt.isUndefined(r)?(Wt.DWT.UseDefaultViewer?oE(t._stwain):iE(t._stwain),!1):r.webViewer.updateVideoImage(e)}},{key:"ClearSelectedAreas",value:function(){var e=this.GetWebViewer();if(e)return e.clearSelectedAreas()}},{key:"OnCloseImageEditor",value:function(){return!!this.GetWebViewer().webViewer.imageEditor&&(this.GetWebViewer().createImageEditor().dispose(),!0)}},{key:"ShowImageEditorEx",value:function(e,t,r,n,i,o,a,s){var u=this;if(this._stwain._isNoViewer())return u._stwain._nouiNotSupport("ShowImageEditorEx");switch(i){case 0:case 1:case 2:break;case 3:if(u.OnCloseImageEditor())return!0}var c,l=document;if(hH._getContainer(u._stwain)==a&&(o=!1),a){var d=Wt.DWT.ContainerMap;if(d){var f,h=Object.keys(d);for(f=0;f<h.length;f++)if(h[f]==a.id){o=!1;break}}}if(o&&a&&(xt.isDOM(a)?c=a:IH(a)?(c=document.createElement("div"),a.appendChild(c)):(c=l.getElementById(a))&&"DIV"!=c.nodeName&&(o=!1)),o&&a&&xt.isDOM(a)){var g=TH(a);if(g){var p,_,m=Dt.timestamp;return(p=l.createElement("link")).href=[Wt.DWT.ResourcesPath,"/src/dynamsoft.webtwain.viewer.css",m].join(""),p.rel="stylesheet",p.async=!0,(_=l.createElement("link")).href=[Wt.DWT.ResourcesPath,"/src/dynamsoft.webtwain.css",m].join(""),_.rel="stylesheet",_.async=!0,xt.scriptOnload(p,(function(){xt.scriptOnload(_,(function(){return u.ShowImageEditor(c,o,r,n)})),g.appendChild(_)})),g.appendChild(p),!0}}return u.ShowImageEditor(c,o,r,n)}},{key:"ShowImageEditor",value:function(e,t,r,n){var i=this;return e&&r&&n?(qH.element=e,qH.width=r,qH.height=n):(qH.element=void 0,qH.width=void 0,qH.height=void 0),qH.border=i.GetWebViewer().border,qH.selectionRectAspectRatio=i.GetWebViewer().selectionRectAspectRatio,qH.workMode=fH.normal,i.GetWebViewer().createImageEditor(qH),0!=i._stwain.ErrorCode&&(i.GetWebViewer().webViewer.imageEditor&&i.GetWebViewer().webViewer.imageEditor.dispose(),i.GetWebViewer().createImageEditor(qH)),i.GetWebViewer().webViewer.imageEditor&&i.GetWebViewer().webViewer.imageEditor.show(),!0}},{key:"__beforeImageEditorCreated",value:function(e){var t=Wt.DWT.CustomizableDisplayInfo;if(!xt.isUndefined(t)){if(!xt.isUndefined(t.buttons)){var r=t.buttons.titles;xt.isUndefined(r)||(xt.isUndefined(r.previous)||(e.buttons.titles.previous=r.previous),xt.isUndefined(r.next)||(e.buttons.titles.next=r.next),xt.isUndefined(r.print)||(e.buttons.titles.print=r.print),xt.isUndefined(r.scan)||(e.buttons.titles.scan=r.scan),xt.isUndefined(r.load)||(e.buttons.titles.load=r.load),xt.isUndefined(r.rotateleft)||(e.buttons.titles.rotateleft=r.rotateleft),xt.isUndefined(r.rotate)||(e.buttons.titles.rotate=r.rotate),xt.isUndefined(r.rotateright)||(e.buttons.titles.rotateright=r.rotateright),xt.isUndefined(r.deskew)||(e.buttons.titles.deskew=r.deskew),xt.isUndefined(r.crop)||(e.buttons.titles.crop=r.crop),xt.isUndefined(r.cut)||(e.buttons.titles.cut=r.cut),xt.isUndefined(r.changeimagesize)||(e.buttons.titles.changeimagesize=r.changeimagesize),xt.isUndefined(r.flip)||(e.buttons.titles.flip=r.flip),xt.isUndefined(r.mirror)||(e.buttons.titles.mirror=r.mirror),xt.isUndefined(r.zoomin)||(e.buttons.titles.zoomin=r.zoomin),xt.isUndefined(r.originalsize)||(e.buttons.titles.originalsize=r.originalsize),xt.isUndefined(r.zoomout)||(e.buttons.titles.zoomout=r.zoomout),xt.isUndefined(r.stretch)||(e.buttons.titles.stretch=r.stretch),xt.isUndefined(r.fit)||(e.buttons.titles.fit=r.fit),xt.isUndefined(r.fitw)||(e.buttons.titles.fitw=r.fitw),xt.isUndefined(r.fith)||(e.buttons.titles.fith=r.fith),xt.isUndefined(r.hand)||(e.buttons.titles.hand=r.hand),xt.isUndefined(r.rectselect)||(e.buttons.titles.rectselect=r.rectselect),xt.isUndefined(r.zoom)||(e.buttons.titles.zoom=r.zoom),xt.isUndefined(r.restore)||(e.buttons.titles.restore=r.restore),xt.isUndefined(r.save)||(e.buttons.titles.save=r.save),xt.isUndefined(r.close)||(e.buttons.titles.close=r.close),xt.isUndefined(r.removeall)||(e.buttons.titles.removeall=r.removeall),xt.isUndefined(r.removeselected)||(e.buttons.titles.removeselected=r.removeselected));var n=t.buttons.bShowAllButtons;xt.isUndefined(n)||(e.buttons.bShowAllButtons=n);var i=t.buttons.visibility;xt.isUndefined(i)||(xt.isUndefined(i.scan)||(e.buttons.visibility.scan=i.scan),xt.isUndefined(i.load)||(e.buttons.visibility.load=i.load),xt.isUndefined(i.print)||(e.buttons.visibility.print=i.print),xt.isUndefined(i.removeall)||(e.buttons.visibility.removeall=i.removeall),xt.isUndefined(i.removeselected)||(e.buttons.visibility.removeselected=i.removeselected),xt.isUndefined(i.rotateleft)||(e.buttons.visibility.rotateleft=i.rotateleft),xt.isUndefined(i.rotate)||(e.buttons.visibility.rotate=i.rotate),xt.isUndefined(i.rotateright)||(e.buttons.visibility.rotateright=i.rotateright),xt.isUndefined(i.deskew)||(e.buttons.visibility.deskew=i.deskew),xt.isUndefined(i.crop)||(e.buttons.visibility.crop=i.crop),xt.isUndefined(i.cut)||(e.buttons.visibility.cut=i.cut),xt.isUndefined(i.changeimagesize)||(e.buttons.visibility.changeimagesize=i.changeimagesize),xt.isUndefined(i.flip)||(e.buttons.visibility.flip=i.flip),xt.isUndefined(i.mirror)||(e.buttons.visibility.mirror=i.mirror),xt.isUndefined(i.zoomin)||(e.buttons.visibility.zoomin=i.zoomin),xt.isUndefined(i.originalsize)||(e.buttons.visibility.originalsize=i.originalsize),xt.isUndefined(i.zoomout)||(e.buttons.visibility.zoomout=i.zoomout),xt.isUndefined(i.stretch)||(e.buttons.visibility.stretch=i.stretch),xt.isUndefined(i.fit)||(e.buttons.visibility.fit=i.fit),xt.isUndefined(i.fitw)||(e.buttons.visibility.fitw=i.fitw),xt.isUndefined(i.fith)||(e.buttons.visibility.fith=i.fith),xt.isUndefined(i.hand)||(e.buttons.visibility.hand=i.hand),xt.isUndefined(i.rectselect)||(e.buttons.visibility.rectselect=i.rectselect),xt.isUndefined(i.zoom)||(e.buttons.visibility.zoom=i.zoom))}var o=t.dialogText;xt.isUndefined(o)||(xt.isUndefined(o.dlgRotateAnyAngle)||(e.dialogText.dlgRotateAnyAngle=o.dlgRotateAnyAngle),xt.isUndefined(o.dlgChangeImageSize)||(e.dialogText.dlgChangeImageSize=o.dlgChangeImageSize),xt.isUndefined(o.saveChangedImage)||(e.dialogText.saveChangedImage=o.saveChangedImage),xt.isUndefined(o.selectSource)||(e.dialogText.selectSource=o.selectSource))}}},{key:"__topPageChanged",value:function(e,t,r){r.__fireEvent("onTopImageInTheViewChanged",{index:e,bByScrollBar:t})}},{key:"__click",value:function(e,t){var r=t;r.__fireEvent("onMouseClick",{e:e,x:e.imageX,y:e.imageY,index:r._ImgManager.getCurrentImageIndex()})}},{key:"__rightclick",value:function(e,t){var r=t;r.__fireEvent("onMouseRightClick",{e:e,x:e.imageX,y:e.imageY,index:r._ImgManager.getCurrentImageIndex()})}},{key:"__dblclick",value:function(e,t){var r=t;r.__fireEvent("onMouseDoubleClick",{e:e,x:e.imageX,y:e.imageY,index:r._ImgManager.getCurrentImageIndex()})}},{key:"__mousemove",value:function(e,t){var r=t;r.__fireEvent("onMouseMove",{e:e,x:e.imageX,y:e.imageY,index:r._ImgManager.getCurrentImageIndex()})}},{key:"__pageAreaSelected",value:function(e,t,r){var n=r,i=1;if(t&&t.length>0){var o=t[t.length-1];o.index&&(i=Nt(o.index)+1),n.__fireEvent("onImageAreaSelected",{index:e,left:Nt(o.x),top:Nt(o.y),right:Nt(o.x+o.width),bottom:Nt(o.y+o.height),areaIndex:i})}}},{key:"__pageAreaUnselected",value:function(e,t){t.__fireEvent("onImageAreaDeSelected",e)}},{key:"__dragdone",value:function(e,t){var r=t;xt.isFunction(r._stwain.__OnIndexChangeDragDropDone)&&r._stwain.__OnIndexChangeDragDropDone(e)}},{key:"__onDrop",value:function(e,t){var r=t;r.GetWebViewer().webViewer.acceptDrop&&r.__dropEvent(e,r)}},{key:"__dropEvent",value:function(e,t){var r,n,i=t,o=function(e){i._stwain._bIfShowProgressBar&&Dt.closeProgress(null),e&&dR.output(null,e+" was loaded successfully!")},a=function(e,t,r){i._stwain._bIfShowProgressBar&&Dt.closeProgress(null),i._stwain._errorCode=e,i._stwain._errorString=t,qR({code:e,message:t}),r&&dR.output(null,r+" failed to load. Error code: "+e+"Error String: "+t)};try{for(var s=e.dataTransfer.files,u=0;u<s.length;u++){if(0==(r=s[u]).type.length){var c=void 0,l=r.name.indexOf(".");switch(l>0&&(c=r.name.substring(l+1)),c){case"bmp":n=Wt.DWT.EnumDWT_ImageType.IT_BMP;break;case"jpg":case"jpeg":n=Wt.DWT.EnumDWT_ImageType.IT_JPG;break;case"tif":case"tiff":n=Wt.DWT.EnumDWT_ImageType.IT_TIF;break;case"png":n=Wt.DWT.EnumDWT_ImageType.IT_PNG;break;case"pdf":n=Wt.DWT.EnumDWT_ImageType.IT_PDF;break;case"jp2":case"j2k":case"j2c":n=Wt.DWT.EnumDWT_ImageType.IT_J2K;break;default:dR.output(null,r.name+" failed to load because the file type is not supported!"),n=-1,vw(i._stwain)}}else switch(r.type){case"image/bmp":n=Wt.DWT.EnumDWT_ImageType.IT_BMP;break;case"image/jpg":case"image/jpeg":n=Wt.DWT.EnumDWT_ImageType.IT_JPG;break;case"image/tif":case"image/tiff":n=Wt.DWT.EnumDWT_ImageType.IT_TIF;break;case"image/png":n=Wt.DWT.EnumDWT_ImageType.IT_PNG;break;case"application/pdf":n=Wt.DWT.EnumDWT_ImageType.IT_PDF;break;case"image/jp2":n=Wt.DWT.EnumDWT_ImageType.IT_J2K;break;default:dR.output(null,r.name+" failed to load because the file type is not supported!"),n=-1,vw(i._stwain)}-1!=n&&(i._stwain._bIfShowProgressBar?Dt.showProgress(i._stwain,"DropLoading",i._stwain.IfShowCancelDialogWhenImageTransfer):Dt.hideProgress(),i._stwain._OnPercentDone([0,-1,QP.Loading]),i._stwain.Addon&&i._stwain.Addon.PDF&&sP.checkProductKey(i._stwain,{PDFRasterizer:!0},!0),function(e){var t=new FileReader;t.readAsDataURL(e),t.onload=function(){var t=i._stwain.__GetLoadEventsNum();i._stwain.__LoadImageFromBytesV2(e,n,"",!0,0,e.size,!1,t,o,a)},t.onerror=function(e){Fw(i._stwain),i._stwain._errorString=this.error,a(i._stwain._errorCode,i._stwain._getErrorString())}}(s[u]))}}catch(g){xt.error(g.stack||g,"error"),setTimeout((function(){throw g}),0)}}},{key:"__pageChange",value:function(e,t){var r,n=t,i=n._ImgManager.count();xt.log("OnPagination"),i<=0?mw(n._stwain):1!=i&&(!/^\d+$/.test(e)||e<=0?alert(vH.errorMessages.invalidIndex):((r=Nt(e)-1)<0?r=0:r>=i&&(r=i-1),r!=n._ImgManager.getCurrentImageIndex()&&n.GetWebViewer().gotoPage(r)))}},{key:"__bufferChanged",value:function(e,t,r){var n,i=e,o=[],a=-1,s=[];t.operation&&(t.action=t.operation);for(var u=0;u<i._ImgManager.count();u++)(n=i._ImgManager.getCustomDataByIndex(u))&&n.serverId&&o.push(this._ImgManager._serverId2uidFromServer(n.serverId));if(t.imageIds=o,t.curIndex>=0&&(n=i._ImgManager.getCustomDataByIndex(t.curIndex))&&n.serverId&&(a=this._ImgManager._serverId2uidFromServer(n.serverId)),t.currentId=a,"modify"==t.operation&&""!=t.afterStatus.modifiedUid){var c=i._ImgManager.getIndexByUid(t.afterStatus.modifiedUid);c>=0&&(n=i._ImgManager.getCustomDataByIndex(c))&&n.serverId&&(t.modifiedId=this._ImgManager._serverId2uidFromServer(n.serverId))}if(t.afterStatus.selectedUids)for(var l=0;l<t.afterStatus.selectedUids.length;l++){var d=t.afterStatus.selectedUids[l];if(d&&-1!=d){var f=i._ImgManager.getIndexByUid(t.afterStatus.selectedUids[l]);f>=0&&(n=i._ImgManager.getCustomDataByIndex(f))&&n.serverId&&s.push(this._ImgManager._serverId2uidFromServer(n.serverId))}}t.selectedIds=s,xt.mix(t,{}),delete t.uids,delete t.currentUid,delete t.selectedUids,delete t.afterStatus,delete t.beforeStatus,delete t.operation,delete t.curIndex,delete t.docUid,i.__fireEvent("onBufferChanged",t)}},{key:"__setError",value:function(e,t,r){var n=r;n._stwain._errorCode=e,n._stwain._errorString=t}},{key:"__acquire",value:function(e,t){var r=e;try{var n,i=!1;1==Wt.DWT.IfConfineMaskWithinTheViewer&&(Wt.DWT.IfConfineMaskWithinTheViewer=!1,i=!0),n=xt.isArray(t)&&t.length>=3?t:vH.dialogText.selectSource,r._stwain._selectSourceAsync("SelectSourceAsync",null,n).then((function(){return r._stwain.AcquireImageAsync({IfShowUI:!0,IfCloseSourceAfterAcquire:!0})})).then((function(){i&&(Wt.DWT.IfConfineMaskWithinTheViewer=!0)})).catch((function(e){xt.log("User did not select a source"),i&&(Wt.DWT.IfConfineMaskWithinTheViewer=!0)}))}catch(u){}}},{key:"__loadImage",value:function(e){try{var t=e,r=null;Wt.DWT.IfConfineMaskWithinTheViewer&&(r=!0,Wt.DWT.IfConfineMaskWithinTheViewer=!1),t._stwain._containerElement=void 0,t._stwain.IfShowFileDialog=!0,t._stwain.Addon&&t._stwain.Addon.PDF&&sP.checkProductKey(t._stwain,{PDFRasterizer:!0},!0),t._stwain.LoadImageEx("",5,(function(){xt.log("Loaded an image successfully."),null!=r&&(Wt.DWT.IfConfineMaskWithinTheViewer=r)}),(function(e,t){xt.log("Loading failed with the error: "+t),null!=r&&(Wt.DWT.IfConfineMaskWithinTheViewer=r)}))}catch(n){}}},{key:"__print",value:function(e){var t=e;aE(t._stwain),t._ImgManager.getCurrentImageIndex()<0||t._ImgManager.PrintCurrentImage()}},{key:"__save",value:(e=GE(m.mark((function e(t,r,n,i,o){var a,s,u,c,l;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s="save",aE((a=t)._stwain),!(a._ImgManager.count()<=0||a._ImgManager.getCurrentImageIndex()<0)){e.next=4;break}return e.abrupt("return");case 4:return a._stwain._containerElement=void 0,u=a.__getViewerElement(a,o),DR(s,u),e.prev=7,c=this._ImgManager.getIndexByUid(r),l=this._ImgManager.convertClientIndexToServerId(c),e.next=12,a._stwain._updateImage(l,n,i);case 12:if(!e.sent){e.next=19;break}return e.next=16,a._stwain.__saveToViewerAfterUpdate(r,i);case 16:e.next=20;break;case 19:a._errorCode,a._errorString;case 20:e.next=24;break;case 22:e.prev=22,e.t0=e.catch(7);case 24:return e.prev=24,n=null,PR(s),e.finish(24);case 28:return e.abrupt("return",void 0);case 29:case"end":return e.stop()}}),e,this,[[7,22,24,28]])}))),function(t,r,n,i,o){return e.apply(this,arguments)})},{key:"__getViewerElement",value:function(e,t){var r,n=e;if(t)if(n.GetWebViewer().webViewer.imageEditor){var i=n.GetWebViewer().createImageEditor();r="dwt-viewer-imageEditor-fullScreen"==i.inner.containerElement.className?{_containerElement:document.body}:{_containerElement:i.inner.containerElement}}else r=n._stwain;else r=n._stwain;return r}},{key:"__deskew",value:function(e,t,r){var n=this,i="deskew";aE(n._stwain);var o=n._ImgManager.getCurrentImageIndex();if(n._ImgManager.count()<=0||o<0)bH.output(n,"No image in Buffer");else{var a=n.__getViewerElement(n,!0);DR(i,a),n._stwain.GetSkewAngleFromBinaryAsync(o,t,(function(e){r(e[0]),PR(i)}),(function(){PR(i)}))}}},{key:"__remove",value:function(e){var t=this;aE(t._stwain),t._ImgManager.count()<=0||t._ImgManager.getCurrentImageIndex()<0?bH.output(t,"No image in Buffer"):t._stwain.RemoveAllSelectedImages()}},{key:"__removeAll",value:function(e){var t=this;aE(t._stwain),t._ImgManager.count()<=0||t._ImgManager.getCurrentImageIndex()<0?bH.output(t,"No image in Buffer"):t._stwain.RemoveAllImages()}},{key:"__onBindViewer",value:function(e){e&&(hH._setContainer(this._stwain,e),e.id&&(Wt.DWT.ContainerMap[e.id]=this._stwain))}},{key:"__onUnBindViewer",value:function(e){if(e){var t=hH._getContainer(this._stwain);if(t&&(t.innerHTML=""),hH._setContainer(this._stwain,null),e.id){var r=Wt.DWT.ContainerMap;e.id in r&&delete Wt.DWT.ContainerMap[e.id]}}}},{key:"__close",value:function(e){aE(this._stwain),hH._closeImageEditorUI(this._stwain)}},{key:"__rotateRightForServer",value:function(e){var t=this;aE(t._stwain);var r=t._ImgManager.getCurrentImageIndex();t._ImgManager.count()<=0||r<0?bH.output(t,"No image in Buffer"):t._stwain.RotateRight(r)}},{key:"__rotateForServer",value:function(e,t,r,n){var i=this;aE(i._stwain);var o=i._ImgManager.getCurrentImageIndex();i._ImgManager.count()<=0||o<0?bH.output(i,"No image in Buffer"):i._stwain.RotateEx(o,t,n,r)}},{key:"__rotateLeftForServer",value:function(e){var t=this;aE(t._stwain);var r=t._ImgManager.getCurrentImageIndex();t._ImgManager.count()<=0||r<0?bH.output(t,"No image in Buffer"):t._stwain.RotateLeft(r)}},{key:"__deskewForServer",value:function(e){var t=this;aE(t._stwain);var r=t._ImgManager.getCurrentImageIndex();t._ImgManager.count()<=0||r<0?bH.output(t,"No image in Buffer"):t._stwain.GetSkewAngleAsync(r).then((function(e){t._stwain.RotateEx(r,e,!0,5,(function(){}),(function(){}))}))}},{key:"__cropForServer",value:function(e,t){var r=this;aE(r._stwain);var n=r._ImgManager.getCurrentImageIndex();if(r._ImgManager.count()<=0||n<0)bH.output(r,"No image in Buffer");else{var i=t.left,o=t.top,a=i+t.width,s=o+t.height;r._stwain.Crop(n,Nt(i),Nt(o),Nt(a),Nt(s))}}},{key:"__eraseForServer",value:function(e,t){var r=this;aE(r._stwain);var n=r._ImgManager.getCurrentImageIndex();if(r._ImgManager.count()<=0||n<0)bH.output(r,"No image in Buffer");else{var i=t.left,o=t.top,a=i+t.width,s=o+t.height;r._stwain.CutFrameToClipboard(n,Nt(i),Nt(o),Nt(a),Nt(s))}}},{key:"__changeImageSizeForServer",value:function(e,t,r,n){var i=this;aE(i._stwain);var o=i._ImgManager.getCurrentImageIndex();i._ImgManager.count()<=0||o<0?bH.output(i,"No image in Buffer"):i._stwain.ChangeImageSize(o,t,r,n)}},{key:"__flipForServer",value:function(e){var t=this;aE(t._stwain);var r=t._ImgManager.getCurrentImageIndex();t._ImgManager.count()<=0||r<0?bH.output(t,"No image in Buffer"):t._stwain.Flip(r)}},{key:"__mirrorForServer",value:function(e){var t=this;aE(t._stwain);var r=t._ImgManager.getCurrentImageIndex();t._ImgManager.count()<=0||r<0?bH.output(t,"No image in Buffer"):t._stwain.Mirror(r)}},{key:"__restoreForServer",value:function(e,t){var r=e;if(aE(r._stwain),r._ImgManager.count()<=0||r._ImgManager.getCurrentImageIndex()<0)bH.output(r,"No image in Buffer");else{var n=r._ImgManager.getIndexByUid(t);n>=0&&r.__RestoreImageInner(r,n)}}},{key:"__saveForServer",value:function(e,t){var r=e;return new Wb.Promise((function(e,n){aE(r._stwain),(r._ImgManager.count()<=0||r._ImgManager.getCurrentImageIndex()<0)&&(bH.output(r,"No image in Buffer"),e());var i=r._ImgManager.getIndexByUid(t);i>=0?r.__SaveImageInner(r,i,!0,(function(){e()})):e()}))}},{key:"__RestoreImageInner",value:function(e,t,r){var n=e,i=n._ImgManager.getImageIdMap(n._ImgManager.convertClientIndexToServerId(t));i&&n.__OnGetImageFromServerForEdit(i,t,1,(function(e,t,i){if(e){xt.log("__RestoreImageInner: "+[e.uuid].join(","));var o=xt.clone(e);o.imageId=e.serverId,n._ImgManager.UpdateImage(o,i)}if(-1==(e&&e.serverId))return r&&r(),!1;r&&r()}))}},{key:"__SaveImageInner",value:function(e,t,r,n){var i=e,o=i._ImgManager.getImageIdMap(i._ImgManager.convertClientIndexToServerId(t));return o&&i.__OnGetImageFromServerForEdit(o,t,2,(function(e,t,o){if(e){if(1==r&&(xt.log("__SaveImageInner: "+[e.uuid].join(",")),i._ImgManager.getCurrentImageIndex()==t)){var a=xt.clone(e);a.imageId=e.serverId,i._ImgManager.UpdateImage(a,o)}if(-1==e.serverId)return n&&n(),!1}return n&&n(),!0})),!0}},{key:"__OnGetImageFromServerForEdit",value:function(e,t,r,n){var i=this;if(n&&i._ImgManager.getBaseUrl){var o=i._ImgManager.convertClientIndexToServerId(t);if(-1==o)return!1;Wt.DWT.ConnectWithSocket?n():fC({method:"GET",xhrFields:{withCredentials:!0},url:dR.getUrlByAct(i._ImgManager.getBaseUrl,o,r),onSuccess:function(r){var a;e.ticks=Date.now(),a=Wt.navInfoSync.bMobile?dR.getImageUrl(i._ImgManager.getBaseUrl,o,Math.round(e.iImageControlWidth*devicePixelRatio),Math.round(e.iImageControlHeight*devicePixelRatio),e.ticks):dR.getImageUrl(i._ImgManager.getBaseUrl,o,Nt(e.iImageControlWidth),Nt(e.iImageControlHeight),e.ticks),e.imageUrl=dR.getImageUrl(i._ImgManager.getBaseUrl,o,-1,-1,e.ticks),e.minImageUrl=a;var s=i._ImgManager.GetMetaDataByIndex(t);if(s){var u=i._ImgManager.getImageIdMap(o);u&&u.width?s.width=u.width:s.width=i._stwain.GetImageWidth(t),u&&u.height?s.height=u.height:s.height=i._stwain.GetImageHeight(t)}n(e,t,s)},onError:function(){}})}return!0}}]);var e}(),$H=function(e){function r(e,n){var i;t(this,r),i=function(e,t,r){return t=QE(t),YE(e,function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(QG){return!1}}()?Reflect.construct(t,r||[],QE(e).constructor):t.apply(e,r))}(this,r,[n]);var o=i;return o._stwain=e,o.bImageJustChangedInEditor=!1,o.bImageChangedInViewer=!1,i}return qE(r,e),s(r,[{key:"getUidByIndex",value:function(e){return this._buffer.getUidByIndex(e)}},{key:"dispose",value:function(){return!0}},{key:"append",value:function(e,t,r,n,i){var o,a,s,u,c,l=this;(this._buffer.isActiveFile||!xt.isUndefined(i))&&n.currentFileName&&n.currentFileName.length>0?c=a=l.getCountByDocumentName(n.currentFileName):(a=l.count(),c=l.getCountByDocumentName(l.GetCurrentFileName())),s=l.getCurrentImageIndex();for(var d=a-1;d>=e;d--)u=l.convertClientIndexToServerId(d),l.removeByServerId(u,d);return a<e?(o=c,l._updateUIAfterAdd(o,t,r,n,!0)):(o=s>=a-1?0:s+1,u=l.convertClientIndexToServerId(o),l.removeByServerId(u,o),o==e-1?l._updateUIAfterAdd(o,t,r,n,!0):l._updateUIAfterAdd(o,t,r,n,!1))}},{key:"insertBefore",value:function(e,t,r,n,i){var o,a=1*e;return(a<0||a>t)&&(a=-1),a>=(o=this.count())&&(a=o),this._updateUIAfterAdd(a,r,n,i,!1)}},{key:"exists",value:function(e){return!xt.isUndefined(this.getImageIdMap(e))}},{key:"insert",value:function(e,t,r,n,i){var o,a=1*e;return(a<0||a>t)&&(a=-1),a>=(o=this.count())&&(a=o),this._updateUIAfterAdd(a,r,n,i,!1)}},{key:"moveImage",value:function(e,t,r){return this._buffer.moveImage(e,t)}},{key:"switchImage",value:function(e,t){return this._buffer.switchImage(e,t)}},{key:"setSelectedClientIndexArray",value:function(e){return this._buffer.selectImages(e)}},{key:"getSelectedClientIndexArray",value:function(e){return this._buffer.getSelectedImagesIndices()}},{key:"showImagesByFilter",value:function(e,t,r){return this._buffer.filterImagesByTag(e,t,r)}},{key:"clearFilter",value:function(){return this._buffer.clearFilter()}},{key:"removeImageTag",value:function(e){return this._buffer.removeImageTag(e)}},{key:"addImageTag",value:function(e,t){return this._buffer.tagImages(e,t)}},{key:"getCurrentTag",value:function(){var e;return 0==(e=this._buffer.getCurrentTag())?"":e}},{key:"renameTag",value:function(e,t){return this._buffer.renameTag(e,t)}},{key:"removeTag",value:function(e,t){return this._buffer.removeTag(e,t)}},{key:"getTagList",value:function(){return this._buffer.getTagList()}},{key:"getTagListByIndex",value:function(e){return this._buffer.getTagListByIndex(e)}},{key:"OpenFile",value:function(e){return this._buffer.openDocument(e)}},{key:"CreateFile",value:function(e){return this._buffer.createDocument(e)}},{key:"GetCurrentFileName",value:function(){return this._buffer.getCurrentFileName()}},{key:"RemoveFile",value:function(e){return this._buffer.removeDocument(e)}},{key:"RenameFile",value:function(e,t){return this._buffer.renameDocument(e,t)}},{key:"GetFileInfoList",value:function(){return this._buffer.getDocumentInfoList()}},{key:"MoveImageToFile",value:function(e,t,r,n){return this._buffer.moveImageToFile(e,t,r,n)}},{key:"GetServerIdsByFileName",value:function(e){var t,r=this,n=[];return(t=r.GetFileInfoList())?xt.each(t,(function(t){if(e==t.name){if(t.imageIds)for(var i=0;i<t.imageIds.length;i++){var o=t.imageIds[i];if(o&&-1!=o){var a=r._stwain._uidFromServer2ServerId(o);a>0&&n.push(a)}}return!1}})):n=[],n}},{key:"insertImage",value:function(e,t,r){this._buffer.insertImage(t,e,r)}},{key:"GetMetaDataByIndex",value:function(e){return this._buffer.getMetadataByUid(this._buffer.getUidByIndex(e))}},{key:"RefreshAllImages",value:function(e,t){for(var r,n,i,o=this,a=0;a<o.count();a++){r=o.convertClientIndexToServerId(a);var s=o.getImageIdMap(r);if(s){i=o.GetMetaDataByIndex(a),n=Wt.navInfoSync.bMobile?dR.getImageUrl(o._baseUrl,r,Math.round(e*devicePixelRatio),Math.round(t*devicePixelRatio),Date.now()):dR.getImageUrl(o._baseUrl,r,e,t,Date.now());var u=xt.clone(s);u.imageId=r,u.minImageUrl=n,o._buffer.updateImage(u,i)}}}},{key:"UpdateData",value:function(e,t){var r=e,n=this.getImageIdMap(r);if(n){var i=xt.clone(n);i.imageId=e,this._buffer.updateImage(i,t)}return!0}},{key:"UpdateImage",value:function(e,t){return this._buffer.updateImage(e,t),!0}},{key:"_setDataImageControl",value:function(e,t,r){var n,i,o,a,s=this;if(r)o=e;else if(o=(i=s.getCustomDataByIndex(e)).serverId,a=i.uidFromServer,o<=0)return!1;return(n=s.getImageIdMap(o))||((n=new xk).serverId=o,n.uidFromServer=a,s._serverIdMap[o]=n,s._uidMap[a]=n),null!=n&&(n.bIsDirty=!0),s.__GetImageAndAttach(n,o,!0,!1,!1,e,t),!0}},{key:"__AttachImages",value:function(){var e,t,r,n=this;t=n.count();for(var i=0;i<t;i++)(e=n.convertClientIndexToServerId(i))>=0&&(r=n.getImageIdMap(e))&&n.__GetImageAndAttach(r,e,!0,!1,!1,0)}},{key:"AddImage",value:function(e,t,r,n,i){var o,a=this,s=1*e;return!(t<=0)&&((o=new xk).bIsDirty=!0,o.serverId=t,o.uidFromServer=r,a._serverIdMap[t]=o,a._uidMap[r]=o,t>=0&&a.__GetImageAndAttach(o,t,!1,!0,i,s,n),!0)}},{key:"OnGetImageByURL",value:function(e,t,r,n,i,o,a,s){return t.imageUrl&&""!=t.imageUrl?(t.iImageControlWidth=r,t.iImageControlHeight=n,t.bAddImage=i,t.bAppendImage=o,t.index=a,this._attachImagesForControl(t,s),!0):this.OnGetImageFromServer(e,t,r,n,i,o,a,s)}},{key:"OnGetImageFromServer",value:function(e,t,r,n,i,o,a,s){var u,c,l=this,d=l._baseUrl;if(d){if(e<=0)return!1;t.bIsDirty&&(t.ticks=Date.now()),xt.isUndefined(r)&&(r=-1),xt.isUndefined(n)&&(n=-1),t.iImageControlWidth=r,t.iImageControlHeight=n,t.bAddImage=i,t.bAppendImage=o,t.index=a,Wt.DWT.ConnectWithSocket&&l._stwain._isBindViewer()?(l._attachImagesForControl(t,s),hH._getblob_queue.push([l._stwain,e,s]),hH.ProcessGetBlobByQueue()):(u=dR.getImageUrl(d,e,-1,-1,t.ticks),c=Wt.navInfoSync.bMobile?dR.getImageUrl(d,e,Math.round(r*devicePixelRatio),Math.round(n*devicePixelRatio),t.ticks):dR.getImageUrl(d,e,r,n,t.ticks),t.imageUrl=u,t.minImageUrl=c,l._attachImagesForControl(t,s))}return!0}},{key:"getBaseUrl",get:function(){return this._baseUrl}},{key:"_attachImagesForControl",value:function(e,t){var r,n,i=this;if((n=xt.clone(e)).imageId=n.serverId,n.bAddImage){if(r=t.currentFileName.length>0?i._buffer.addImage(n,t,t.currentFileName):i._buffer.addImage(n,t)){var o=Rk(r,1)[0],a=this.getImageIdMap(n.serverId);a&&(a.uuid=o);var s=this._buffer.getCustomDataByUid(o);s&&(s.serverId&&n&&n.serverId&&(s.serverId=n.serverId),s.uidFromServer&&(s.uidFromServer=n.uidFromServer))}}else i._buffer.updateImage(n,t);return!0}},{key:"_updateUIAfterAdd",value:function(e,t,r,n,i){return!(t<0)&&this.AddImage(e,t,r,n,i)}},{key:"__GetImageAndAttach",value:function(e,t,r,n,i,o,a){var s,u,c,l=this;l._stwain._isBindViewer()?(c=l._stwain.Viewer.height>=400?l._stwain.Viewer.height:400,u=l._stwain.Viewer.width>=400?l._stwain.Viewer.width:400):(u=-1,c=-1);var d;d=!!r||1==e.bIsDirty;var f=null===(s=l.getImageIdMap(t))||void 0===s?void 0:s.uuid;f&&-1!=f&&e.iImageControlWidth==u&&e.iImageControlHeight==c&&0==e.bIsDirty||l.__SetArrayControlLoadImage(t,e,u,c,d,n,i,o,a)}},{key:"__SetArrayControlLoadImage",value:function(e,t,r,n,i,o,a,s,u){i?this.OnGetImageFromServer(e,t,r,n,o,a,s,u):this.OnGetImageByURL(e,t,r,n,o,a,s,u)}},{key:"GetServerIdList",value:function(){var e,t,r,n=this,i=[];if(e=n._buffer.getDocumentContents(n._buffer.getCurrentDocument()))for(var o=0;o<e.length;o++)(t=e[o])&&-1!=t&&(r=n._buffer.getCustomDataByUid(t))&&i.push(r.serverId);return i}}])}(hj),ez=function(e){var t=e||window.event,r=!0;return xt.each(Wb.Events.registedObjs,(function(e){xt.each(Wb.Events.registedClass,(function(n){if(e instanceof n&&e.bFocus&&e.handlerKeyDown&&!(r=e.handlerKeyDown(t)))return!1}))})),r};function tz(e,t){for(var r in t)t.hasOwnProperty(r)&&!xt.isUndefined(t[r])&&(e.hasOwnProperty(r)&&!xt.isUndefined(e[r])||(e[r]=t[r]));return e}yD((function(){xt.addEventListener(document.documentElement,"keydown",ez)})),tz(Wt.DWT,zC),tz(Wt.DWT,KC),Wt.DWT.CertificateConfig?tz(Wt.DWT.CertificateConfig,QC):Wt.DWT.CertificateConfig=QC,Wt.DWT.RegisterEvent=function(e,t){return xt.isFunction(t)&&(Wt.DWT[e]=t),!0},function(e){e.CAP_NONE=0,e.CAP_XFERCOUNT=1,e.ICAP_COMPRESSION=256,e.ICAP_PIXELTYPE=257,e.ICAP_UNITS=258,e.ICAP_XFERMECH=259,e.CAP_AUTHOR=4096,e.CAP_CAPTION=4097,e.CAP_FEEDERENABLED=4098,e.CAP_FEEDERLOADED=4099,e.CAP_TIMEDATE=4100,e.CAP_SUPPORTEDCAPS=4101,e.CAP_EXTENDEDCAPS=4102,e.CAP_AUTOFEED=4103,e.CAP_CLEARPAGE=4104,e.CAP_FEEDPAGE=4105,e.CAP_REWINDPAGE=4106,e.CAP_INDICATORS=4107,e.CAP_SUPPORTEDCAPSEXT=4108,e.CAP_PAPERDETECTABLE=4109,e.CAP_UICONTROLLABLE=4110,e.CAP_DEVICEONLINE=4111,e.CAP_AUTOSCAN=4112,e.CAP_THUMBNAILSENABLED=4113,e.CAP_DUPLEX=4114,e.CAP_DUPLEXENABLED=4115,e.CAP_ENABLEDSUIONLY=4116,e.CAP_CUSTOMDSDATA=4117,e.CAP_ENDORSER=4118,e.CAP_ALARMS=4120,e.CAP_ALARMVOLUME=4121,e.CAP_AUTOMATICCAPTURE=4122,e.CAP_TIMEBEFOREFIRSTCAPTURE=4123,e.CAP_TIMEBETWEENCAPTURES=4124,e.CAP_CLEARBUFFERS=4125,e.CAP_MAXBATCHBUFFERS=4126,e.CAP_DEVICETIMEDATE=4127,e.CAP_POWERSUPPLY=4128,e.CAP_CAMERAPREVIEWUI=4129,e.CAP_SERIALNUMBER=4132,e.CAP_PRINTER=4134,e.CAP_PRINTERENABLED=4135,e.CAP_PRINTERINDEX=4136,e.CAP_PRINTERMODE=4137,e.CAP_PRINTERSTRING=4138,e.CAP_PRINTERSUFFIX=4139,e.CAP_LANGUAGE=4140,e.CAP_FEEDERALIGNMENT=4141,e.CAP_FEEDERORDER=4142,e.CAP_REACQUIREALLOWED=4144,e.CAP_BATTERYMINUTES=4146,e.CAP_BATTERYPERCENTAGE=4147,e.CAP_CAMERASIDE=4148,e.CAP_SEGMENTED=4149,e.CAP_CAMERAENABLED=4150,e.CAP_CAMERAORDER=4151,e.CAP_MICRENABLED=4152,e.CAP_FEEDERPREP=4153,e.CAP_FEEDERPOCKET=4154,e.CAP_AUTOMATICSENSEMEDIUM=4155,e.CAP_CUSTOMINTERFACEGUID=4156,e.ICAP_AUTOBRIGHT=4352,e.ICAP_BRIGHTNESS=4353,e.ICAP_CONTRAST=4355,e.ICAP_CUSTHALFTONE=4356,e.ICAP_EXPOSURETIME=4357,e.ICAP_FILTER=4358,e.ICAP_FLASHUSED=4359,e.ICAP_GAMMA=4360,e.ICAP_HALFTONES=4361,e.ICAP_HIGHLIGHT=4362,e.ICAP_IMAGEFILEFORMAT=4364,e.ICAP_LAMPSTATE=4365,e.ICAP_LIGHTSOURCE=4366,e.ICAP_ORIENTATION=4368,e.ICAP_PHYSICALWIDTH=4369,e.ICAP_PHYSICALHEIGHT=4370,e.ICAP_SHADOW=4371,e.ICAP_FRAMES=4372,e.ICAP_XNATIVERESOLUTION=4374,e.ICAP_YNATIVERESOLUTION=4375,e.ICAP_XRESOLUTION=4376,e.ICAP_YRESOLUTION=4377,e.ICAP_MAXFRAMES=4378,e.ICAP_TILES=4379,e.ICAP_BITORDER=4380,e.ICAP_CCITTKFACTOR=4381,e.ICAP_LIGHTPATH=4382,e.ICAP_PIXELFLAVOR=4383,e.ICAP_PLANARCHUNKY=4384,e.ICAP_ROTATION=4385,e.ICAP_SUPPORTEDSIZES=4386,e.ICAP_THRESHOLD=4387,e.ICAP_XSCALING=4388,e.ICAP_YSCALING=4389,e.ICAP_BITORDERCODES=4390,e.ICAP_PIXELFLAVORCODES=4391,e.ICAP_JPEGPIXELTYPE=4392,e.ICAP_TIMEFILL=4394,e.ICAP_BITDEPTH=4395,e.ICAP_BITDEPTHREDUCTION=4396,e.ICAP_UNDEFINEDIMAGESIZE=4397,e.ICAP_EXTIMAGEINFO=4399,e.ICAP_MINIMUMHEIGHT=4400,e.ICAP_MINIMUMWIDTH=4401,e.ICAP_AUTODISCARDBLANKPAGES=4404,e.ICAP_FLIPROTATION=4406,e.ICAP_BARCODEDETECTIONENABLED=4407,e.ICAP_SUPPORTEDBARCODETYPES=4408,e.ICAP_BARCODEMAXSEARCHPRIORITIES=4409,e.ICAP_BARCODESEARCHPRIORITIES=4410,e.ICAP_BARCODESEARCHMODE=4411,e.ICAP_BARCODEMAXRETRIES=4412,e.ICAP_BARCODETIMEOUT=4413,e.ICAP_ZOOMFACTOR=4414,e.ICAP_PATCHCODEDETECTIONENABLED=4415,e.ICAP_SUPPORTEDPATCHCODETYPES=4416,e.ICAP_PATCHCODEMAXSEARCHPRIORITIES=4417,e.ICAP_PATCHCODESEARCHPRIORITIES=4418,e.ICAP_PATCHCODESEARCHMODE=4419,e.ICAP_PATCHCODEMAXRETRIES=4420,e.ICAP_PATCHCODETIMEOUT=4421,e.ICAP_FLASHUSED2=4422,e.ICAP_IMAGEFILTER=4423,e.ICAP_NOISEFILTER=4424,e.ICAP_OVERSCAN=4425,e.ICAP_AUTOMATICBORDERDETECTION=4432,e.ICAP_AUTOMATICDESKEW=4433,e.ICAP_AUTOMATICROTATE=4434,e.ICAP_JPEGQUALITY=4435,e.ICAP_FEEDERTYPE=4436,e.ICAP_ICCPROFILE=4437,e.ICAP_AUTOSIZE=4438,e.ICAP_AUTOMATICCROPUSESFRAME=4439,e.ICAP_AUTOMATICLENGTHDETECTION=4440,e.ICAP_AUTOMATICCOLORENABLED=4441,e.ICAP_AUTOMATICCOLORNONCOLORPIXELTYPE=4442,e.ICAP_COLORMANAGEMENTENABLED=4443,e.ICAP_IMAGEMERGE=4444,e.ICAP_IMAGEMERGEHEIGHTTHRESHOLD=4445,e.ICAP_SUPPORTEDEXTIMAGEINFO=4446}(CH||(CH={})),function(e){e.TWLG_DAN=0,e.TWLG_DUT=1,e.TWLG_ENG=2,e.TWLG_FCF=3,e.TWLG_FIN=4,e.TWLG_FRN=5,e.TWLG_GER=6,e.TWLG_ICE=7,e.TWLG_ITN=8,e.TWLG_NOR=9,e.TWLG_POR=10,e.TWLG_SPA=11,e.TWLG_SWE=12,e.TWLG_USA=13,e.TWLG_USERLOCALE=-1,e.TWLG_AFRIKAANS=14,e.TWLG_ALBANIA=15,e.TWLG_ARABIC=16,e.TWLG_ARABIC_ALGERIA=17,e.TWLG_ARABIC_BAHRAIN=18,e.TWLG_ARABIC_EGYPT=19,e.TWLG_ARABIC_IRAQ=20,e.TWLG_ARABIC_JORDAN=21,e.TWLG_ARABIC_KUWAIT=22,e.TWLG_ARABIC_LEBANON=23,e.TWLG_ARABIC_LIBYA=24,e.TWLG_ARABIC_MOROCCO=25,e.TWLG_ARABIC_OMAN=26,e.TWLG_ARABIC_QATAR=27,e.TWLG_ARABIC_SAUDIARABIA=28,e.TWLG_ARABIC_SYRIA=29,e.TWLG_ARABIC_TUNISIA=30,e.TWLG_ARABIC_UAE=31,e.TWLG_ARABIC_YEMEN=32,e.TWLG_BASQUE=33,e.TWLG_BYELORUSSIAN=34,e.TWLG_BULGARIAN=35,e.TWLG_CATALAN=36,e.TWLG_CHINESE=37,e.TWLG_CHINESE_HONGKONG=38,e.TWLG_CHINESE_PRC=39,e.TWLG_CHINESE_SINGAPORE=40,e.TWLG_CHINESE_SIMPLIFIED=41,e.TWLG_CHINESE_TAIWAN=42,e.TWLG_CHINESE_TRADITIONAL=43,e.TWLG_CROATIA=44,e.TWLG_CZECH=45,e.TWLG_DANISH=0,e.TWLG_DUTCH=1,e.TWLG_DUTCH_BELGIAN=46,e.TWLG_ENGLISH=2,e.TWLG_ENGLISH_AUSTRALIAN=47,e.TWLG_ENGLISH_CANADIAN=48,e.TWLG_ENGLISH_IRELAND=49,e.TWLG_ENGLISH_NEWZEALAND=50,e.TWLG_ENGLISH_SOUTHAFRICA=51,e.TWLG_ENGLISH_UK=52,e.TWLG_ENGLISH_USA=13,e.TWLG_ESTONIAN=53,e.TWLG_FAEROESE=54,e.TWLG_FARSI=55,e.TWLG_FINNISH=4,e.TWLG_FRENCH=5,e.TWLG_FRENCH_BELGIAN=56,e.TWLG_FRENCH_CANADIAN=3,e.TWLG_FRENCH_LUXEMBOURG=57,e.TWLG_FRENCH_SWISS=58,e.TWLG_GERMAN=6,e.TWLG_GERMAN_AUSTRIAN=59,e.TWLG_GERMAN_LUXEMBOURG=60,e.TWLG_GERMAN_LIECHTENSTEIN=61,e.TWLG_GERMAN_SWISS=62,e.TWLG_GREEK=63,e.TWLG_HEBREW=64,e.TWLG_HUNGARIAN=65,e.TWLG_ICELANDIC=7,e.TWLG_INDONESIAN=66,e.TWLG_ITALIAN=8,e.TWLG_ITALIAN_SWISS=67,e.TWLG_JAPANESE=68,e.TWLG_KOREAN=69,e.TWLG_KOREAN_JOHAB=70,e.TWLG_LATVIAN=71,e.TWLG_LITHUANIAN=72,e.TWLG_NORWEGIAN=9,e.TWLG_NORWEGIAN_BOKMAL=73,e.TWLG_NORWEGIAN_NYNORSK=74,e.TWLG_POLISH=75,e.TWLG_PORTUGUESE=10,e.TWLG_PORTUGUESE_BRAZIL=76,e.TWLG_ROMANIAN=77,e.TWLG_RUSSIAN=78,e.TWLG_SERBIAN_LATIN=79,e.TWLG_SLOVAK=80,e.TWLG_SLOVENIAN=81,e.TWLG_SPANISH=11,e.TWLG_SPANISH_MEXICAN=82,e.TWLG_SPANISH_MODERN=83,e.TWLG_SWEDISH=12,e.TWLG_THAI=84,e.TWLG_TURKISH=85,e.TWLG_UKRANIAN=86,e.TWLG_ASSAMESE=87,e.TWLG_BENGALI=88,e.TWLG_BIHARI=89,e.TWLG_BODO=90,e.TWLG_DOGRI=91,e.TWLG_GUJARATI=92,e.TWLG_HARYANVI=93,e.TWLG_HINDI=94,e.TWLG_KANNADA=95,e.TWLG_KASHMIRI=96,e.TWLG_MALAYALAM=97,e.TWLG_MARATHI=98,e.TWLG_MARWARI=99,e.TWLG_MEGHALAYAN=100,e.TWLG_MIZO=101,e.TWLG_NAGA=102,e.TWLG_ORISSI=103,e.TWLG_PUNJABI=104,e.TWLG_PUSHTU=105,e.TWLG_SERBIAN_CYRILLIC=106,e.TWLG_SIKKIMI=107,e.TWLG_SWEDISH_FINLAND=108,e.TWLG_TAMIL=109,e.TWLG_TELUGU=110,e.TWLG_TRIPURI=111,e.TWLG_URDU=112,e.TWLG_VIETNAMESE=113}(wH||(wH={})),function(e){e.TWSS_NONE=0,e.TWSS_A4LETTER=1,e.TWSS_B5LETTER=2,e.TWSS_USLETTER=3,e.TWSS_USLEGAL=4,e.TWSS_A5=5,e.TWSS_B4=6,e.TWSS_B6=7,e.TWSS_USLEDGER=9,e.TWSS_USEXECUTIVE=10,e.TWSS_A3=11,e.TWSS_B3=12,e.TWSS_A6=13,e.TWSS_C4=14,e.TWSS_C5=15,e.TWSS_C6=16,e.TWSS_4A0=17,e.TWSS_2A0=18,e.TWSS_A0=19,e.TWSS_A1=20,e.TWSS_A2=21,e.TWSS_A4=1,e.TWSS_A7=22,e.TWSS_A8=23,e.TWSS_A9=24,e.TWSS_A10=25,e.TWSS_ISOB0=26,e.TWSS_ISOB1=27,e.TWSS_ISOB2=28,e.TWSS_ISOB3=12,e.TWSS_ISOB4=6,e.TWSS_ISOB5=29,e.TWSS_ISOB6=7,e.TWSS_ISOB7=30,e.TWSS_ISOB8=31,e.TWSS_ISOB9=32,e.TWSS_ISOB10=33,e.TWSS_JISB0=34,e.TWSS_JISB1=35,e.TWSS_JISB2=36,e.TWSS_JISB3=37,e.TWSS_JISB4=38,e.TWSS_JISB5=2,e.TWSS_JISB6=39,e.TWSS_JISB7=40,e.TWSS_JISB8=41,e.TWSS_JISB9=42,e.TWSS_JISB10=43,e.TWSS_C0=44,e.TWSS_C1=45,e.TWSS_C2=46,e.TWSS_C3=47,e.TWSS_C7=48,e.TWSS_C8=49,e.TWSS_C9=50,e.TWSS_C10=51,e.TWSS_USSTATEMENT=52,e.TWSS_BUSINESSCARD=53,e.TWSS_MAXSIZE=54}(EH||(EH={})),function(e){e.TWON_NONE=0,e.TWON_ARRAY=3,e.TWON_ENUMERATION=4,e.TWON_ONEVALUE=5,e.TWON_RANGE=6}(AH||(AH={})),function(e){e.TWTY_INT8=0,e.TWTY_INT16=1,e.TWTY_INT32=2,e.TWTY_UINT8=3,e.TWTY_UINT16=4,e.TWTY_int=5,e.TWTY_BOOL=6,e.TWTY_FIX32=7,e.TWTY_FRAME=8,e.TWTY_STR32=9,e.TWTY_STR64=10,e.TWTY_STR128=11,e.TWTY_STR255=12}(DH||(DH={})),function(e){e.TWFA_NONE=0,e.TWFA_LEFT=1,e.TWFA_CENTER=2,e.TWFA_RIGHT=3}(PH||(PH={})),function(e){e.TWFO_FIRSTPAGEFIRST=0,e.TWFO_LASTPAGEFIRST=1}(RH||(RH={})),function(e){e.TWPR_IMPRINTERTOPBEFORE=0,e.TWPR_IMPRINTERTOPAFTER=1,e.TWPR_IMPRINTERBOTTOMBEFORE=2,e.TWPR_IMPRINTERBOTTOMAFTER=3,e.TWPR_ENDORSERTOPBEFORE=4,e.TWPR_ENDORSERTOPAFTER=5,e.TWPR_ENDORSERBOTTOMBEFORE=6,e.TWPR_ENDORSERBOTTOMAFTER=7}(xH||(xH={})),function(e){e.TWPM_SINGLESTRING=0,e.TWPM_MULTISTRING=1,e.TWPM_COMPOUNDSTRING=2}(kH||(kH={})),function(e){e.TWBR_THRESHOLD=0,e.TWBR_HALFTONE=1,e.TWBR_CUSTHALFTONE=2,e.TWBR_DIFFUSION=3}(FH||(FH={})),function(e){e.TWBO_LSBFIRST=0,e.TWBO_MSBFIRST=1}(OH||(OH={})),function(e){e.TWFT_RED=0,e.TWFT_GREEN=1,e.TWFT_BLUE=2,e.TWFT_NONE=3,e.TWFT_WHITE=4,e.TWFT_CYAN=5,e.TWFT_MAGENTA=6,e.TWFT_YELLOW=7,e.TWFT_BLACK=8}(WH||(WH={})),function(e){e.TWFL_NONE=0,e.TWFL_OFF=1,e.TWFL_ON=2,e.TWFL_AUTO=3,e.TWFL_REDEYE=4}(NH||(NH={})),function(e){e.TWFR_BOOK=0,e.TWFR_FANFOLD=1}(MH||(MH={})),function(e){e.TWIF_NONE=0,e.TWIF_AUTO=1,e.TWIF_LOWPASS=2,e.TWIF_BANDPASS=3,e.TWIF_HIGHPASS=4,e.TWIF_TEXT=3,e.TWIF_FINELINE=4}(LH||(LH={})),function(e){e.TWLP_REFLECTIVE=0,e.TWLP_TRANSMISSIVE=1}(BH||(BH={})),function(e){e.TWLS_RED=0,e.TWLS_GREEN=1,e.TWLS_BLUE=2,e.TWLS_NONE=3,e.TWLS_WHITE=4,e.TWLS_UV=5,e.TWLS_IR=6}(UH||(UH={})),function(e){e.TWNF_NONE=0,e.TWNF_AUTO=1,e.TWNF_LONEPIXEL=2,e.TWNF_MAJORITYRULE=3}(VH||(VH={})),function(e){e.TWOR_ROT0=0,e.TWOR_ROT90=1,e.TWOR_ROT180=2,e.TWOR_ROT270=3,e.TWOR_PORTRAIT=0,e.TWOR_LANDSCAPE=3,e.TWOR_AUTO=4,e.TWOR_AUTOTEXT=5,e.TWOR_AUTOPICTURE=6}(GH||(GH={})),function(e){e.TWOV_NONE=0,e.TWOV_AUTO=1,e.TWOV_TOPBOTTOM=2,e.TWOV_LEFTRIGHT=3,e.TWOV_ALL=4}(jH||(jH={})),function(e){e.TWPF_CHOCOLATE=0,e.TWPF_VANILLA=1}(HH||(HH={})),function(e){e.TWPC_CHUNKY=0,e.TWPC_PLANAR=1}(zH||(zH={})),function(e){e.TWBP_DISABLE=-2,e.TWBP_AUTO=-1}(KH||(KH={})),function(e){e.Info=1,e.Error=2,e.NotInstalledError=3}(JH||(JH={})),function(e){e.Binary=0,e.Base64=1}(YH||(YH={})),function(e){e.TWPT_BW=0,e.TWPT_GRAY=1,e.TWPT_RGB=2,e.TWPT_PALLETE=3,e.TWPT_CMY=4,e.TWPT_CMYK=5,e.TWPT_YUV=6,e.TWPT_YUVK=7,e.TWPT_CIEXYZ=8,e.TWPT_LAB=9,e.TWPT_SRGB=10,e.TWPT_SCRGB=11,e.TWPT_INFRARED=16}(QH||(QH={})),function(e){e.TWUN_INCHES=0,e.TWUN_CENTIMETERS=1,e.TWUN_PICAS=2,e.TWUN_POINTS=3,e.TWUN_TWIPS=4,e.TWUN_PIXELS=5,e.TWUN_MILLIMETERS=6}(XH||(XH={})),xt.mix(Wt.DWT,{EnumDWT_DeviceType:fR,EnumDWT_Cap:CH,EnumDWT_CapLanguage:wH,EnumDWT_CapSupportedSizes:EH,EnumDWT_CapType:AH,EnumDWT_CapValueType:DH,EnumDWT_CapFeederAlignment:PH,EnumDWT_CapFeederOrder:RH,EnumDWT_CapPrinter:xH,EnumDWT_CapPrinterMode:kH,EnumDWT_CapBitdepthReduction:FH,EnumDWT_CapBitOrder:OH,EnumDWT_CapFilterType:WH,EnumDWT_CapFlash:NH,EnumDWT_CapFlipRotation:MH,EnumDWT_CapImageFilter:LH,EnumDWT_CapLightPath:BH,EnumDWT_CapLightSource:UH,EnumDWT_CapNoiseFilter:VH,EnumDWT_CapORientation:GH,EnumDWT_CapOverscan:jH,EnumDWT_CapPixelFlavor:HH,EnumDWT_CapPlanarChunky:zH,EnumDWT_ImageType:dx,EnumDWT_ImageFormatType:wj,EnumDWT_ResponseType:dj,EnumDWT_SourceMatchField:lx,EnumDWT_UploadDataFormat:YH,EnumDWT_WorkMode:fH,EnumDWT_ConvertMode:TD,EnumDWT_PixelType:QH,EnumDWT_UnitType:XH});var rz,nz,iz,oz,az,sz,uz=Wt.DWT;uz.EnumPDF_Page={Page_Default:0,Page_Custom:1,Page_A4:2,Page_A4_Reverse:3,Page_A3:4,Page_A3_Reverse:5,Page_Letter:6,Page_Letter_Reverse:7,Page_Legal:8,Page_Legal_Reverse:9},uz.EnumDWT_BorderStyle={TWBS_NONE:0,TWBS_SINGLEFLAT:1,TWBS_SINGLE3D:2},uz.EnumDWT_MessageType={TWQC_GET:1,TWQC_SET:2,TWQC_GETDEFAULT:4,TWQC_GETCURRENT:8,TWQC_RESET:16},uz.EnumDWT_TransferMode={TWSX_NATIVE:0,TWSX_FILE:1,TWSX_MEMORY:2},uz.EnumDWT_FileFormat={TWFF_TIFF:0,TWFF_PICT:1,TWFF_BMP:2,TWFF_XBM:3,TWFF_JFIF:4,TWFF_FPX:5,TWFF_TIFFMULTI:6,TWFF_PNG:7,TWFF_SPIFF:8,TWFF_EXIF:9,TWFF_PDF:10,TWFF_JP2:11,TWFF_JPN:12,TWFF_JPX:13,TWFF_DEJAVU:14,TWFF_PDFA:15,TWFF_PDFA2:16},uz.EnumDWT_TIFFCompressionType={TIFF_AUTO:0,TIFF_NONE:1,TIFF_RLE:2,TIFF_FAX3:3,TIFF_T4:3,TIFF_FAX4:4,TIFF_T6:4,TIFF_LZW:5,TIFF_JPEG:7,TIFF_PACKBITS:32773},uz.EnumDWT_InterpolationMethod={IM_NEARESTNEIGHBOUR:1,IM_BILINEAR:2,IM_BICUBIC:3,IM_BESTQUALITY:5},uz.EnumDWT_PDFCompressionType={PDF_AUTO:0,PDF_FAX3:1,PDF_FAX4:2,PDF_LZW:3,PDF_RLE:4,PDF_JPEG:5,PDF_JP2000:6,PDF_JBIG2:7},uz.EnumDWT_ShowMode={SW_ACTIVE:0,SW_MAX:1,SW_MIN:2,SW_CLOSE:3,SW_IFLIVE:4},uz.EnumDWT_DUPLEX={TWDX_NONE:0,TWDX_1PASSDUPLEX:1,TWDX_2PASSDUPLEX:2},uz.EnumDWT_MagType={TWMD_MICR:0,TWMD_RAW:1,TWMD_INVALID:2},uz.EnumDWT_DataSourceStatus={TWDSS_CLOSED:0,TWDSS_OPENED:1,TWDSS_ENABLED:2,TWDSS_ACQUIRING:3},function(e){e.enumFitWindow=0,e.enumFitWindowHeight=1,e.enumFitWindowWidth=2}(rz||(rz={})),uz.EnumDWT_FitWindowType={enumFitWindow:rz.enumFitWindow,enumFitWindowHeight:rz.enumFitWindowHeight,enumFitWindowWidth:rz.enumFitWindowWidth},uz.EnumDWT_PlatformType={enumUnknown:gC.enumUnknown,enumWindow:gC.enumWindow,enumMac:gC.enumMac,enumLinux:gC.enumLinux,enumEmbed:gC.enumEmbed,enumChromeOS:gC.enumChromeOS,enumHarmonyOS:gC.enumHarmonyOS,enumAndroid:gC.enumAndroid,enumiOS:gC.enumiOS},function(e){e.Default=0,e.Hand=1,e.Crosshair=2,e.Zoom=3,e.NWResize=4,e.EResize=5,e.NResize=6,e.Resize=7,e.Move=8}(nz||(nz={})),uz.EnumDWT_MouseShape={Default:nz.Default,Hand:nz.Hand,Crosshair:nz.Crosshair,Zoom:nz.Zoom,NWResize:nz.NWResize,EResize:nz.EResize,NResize:nz.NResize,Resize:nz.Resize,Move:nz.Move},uz.EnumDWT_Language={English:0,French:1,Arabic:2,Spanish:3,Portuguese:4,German:5,Italian:6,Russian:7,Chinese:8},uz.EnumDWT_InitMsg={Info:JH.Info,Error:JH.Error,NotInstalledError:JH.NotInstalledError},uz.EnumDWT_Driver={TWAIN:lk.TWAIN,ICA:lk.ICA,SANE:lk.SANE,TWAIN_AND_ICA:lk.TWAIN_AND_ICA,TWAIN_AND_TWAIN64:lk.TWAIN_AND_TWAIN64,TWAIN64:lk.TWAIN64},uz.EnumDWT_CompressionType={TWCP_NONE:0,TWCP_PACKBITS:1,TWCP_GROUP31D:2,TWCP_GROUP31DEOL:3,TWCP_GROUP32D:4,TWCP_GROUP4:5,TWCP_JPEG:6,TWCP_LZW:7,TWCP_JBIG:8,TWCP_PNG:9,TWCP_RLE4:10,TWCP_RLE8:11,TWCP_BITFIELDS:12,TWCP_ZIP:13,TWCP_JPEG2000:14},function(e){e.Single=0,e.Multiple=1}(iz||(iz={})),uz.EnumDWT_SelectionMode={Single:iz.Single,Multiple:iz.Multiple},uz.EnumDWT_ConfirmExitType={Cancel:0,Exit:1,SaveAndExit:2},uz.EnumDWT_WebsocketReadyState={CONNECTING:rx.CONNECTING,OPEN:rx.OPEN,CLOSING:rx.CLOSING,CLOSED:rx.CLOSED},function(e){e.TwainService=1}(oz||(oz={})),uz.EnumDWT_ServiceType={TwainService:oz.TwainService},function(e){e.default=0,e.standard=1,e.supported=2}(az||(az={})),uz.EnumDWT_ExtImageInfo={default:az.default,standard:az.standard,supported:az.supported};var cz=20230506,lz=function(){if(Wt.dcp){var e=Wt.dcp.dcpJSVer;if(xt.isNumber(e))return e>=cz}return!1};if(lz())lz=sz,cz=sz;else{var dz=ow.detect,fz={_checkService:function(e,t){dz.dcpStatus=dz.EnumDCP_DetectStatus.CheckingServiceVer,hz(null,"DSVersion").then(e,t)},_checkUpdateFile:function(e,t){hz(null,"CheckUpdateFile").then(e,t)},_updateService:function(e,t){hz(null,"UpdateService").then(e,t)},_getDSUpdateZipUrl:function(){var e,t,r="";return e="Win",Y.bMac?e="Mac":Y.bLinux&&(e="Linux"),t=Y.bFileSystem?"":"?t="+xt.now(),Y.bWin&&ow.b64bit&&(r="_x64"),[Wt.DWT.ResourcesPath,"/dist/serviceupdate/",e,"DSUpdate_",FC().join("."),r,".zip",t].join("")},getPorts:function(e,t){var r="GetPorts",n="dwasm2_"+NC();return gz(e,r,{id:xt.guid(),method:r,version:n,parameter:[t]},uw)},_getStatusString:function(e,t){var r,n,i="";return e==dz.EnumDCP_DetectStatus.Init?"Getting manager version":e==dz.EnumDCP_DetectStatus.Connected?(t&&(i=t),"Getting manager version succeeded and the version is "+i):e==dz.EnumDCP_DetectStatus.CheckingManagerVer?"Getting manager version":e==dz.EnumDCP_DetectStatus.CheckingServiceVer?"Getting service version":e==dz.EnumDCP_DetectStatus.NotInstalled?"Dynamsoft Service Not Installed":e==dz.EnumDCP_DetectStatus.UpdateSkipped?"Update skipped":e==dz.EnumDCP_DetectStatus.CheckedService?(t&&(i=t),"Getting service version succeeded and the version is "+i):e==dz.EnumDCP_DetectStatus.VerifyingZip?"Verifying the update package":e==dz.EnumDCP_DetectStatus.VerifiedZip?"Update package verified":e==dz.EnumDCP_DetectStatus.UpdatingService?"Updating the service":e==dz.EnumDCP_DetectStatus.UpdateSucceed?"Update succeeded":e==dz.EnumDCP_DetectStatus.UpdateFailed?(n=".",t&&t.length>0?("."==t.slice(t.length-1)&&(n=""),r=" with the error: "+t):r="","The update failed"+r+n):""},_sendStatusEvent:function(e,t){var r=!!e,n=window;xt.isFunction(n.OnGetServiceUpdateStatus)&&n.OnGetServiceUpdateStatus(r,dz.dcpStatus,fz._getStatusString(dz.dcpStatus,t))},_getErr:function(e){var t,r="";try{xt.isString(e)?(t=e.replace(/\0/g,""),t=xt.parse(t)):e&&(t=e),"description"in t&&(r=t.description)}catch(n){}return r},_funShowUpgradeDialogWhenUpdateFailed:function(e,t){return dz.bConnected=!0,dz.dcpStatus=dz.EnumDCP_DetectStatus.UpdateFailed,e&&e(),t&&t(),fz._sendStatusEvent(!0),!0},_funUpdateFailed:function(e,t,r,n){var i,o;return dz.bConnected=!0,dz.dcpStatus=dz.EnumDCP_DetectStatus.UpdateFailed,e&&e(),200==n?(i="The update failed.",o=fz._getStatusString(dz.dcpStatus,fz._getErr(r))):o=i="The update failed. The error code is "+n,t&&t(!0,i),fz._sendStatusEvent(!0,o),!0},getDSPath:function(e,t){return BC.getDSPath(t)},getLinuxHTML5DebPath:function(){return BC.getDSPath(".deb")},getLinuxHTML5RpmPath:function(){return BC.getDSPath(".rpm")},getBinaryFileInfo:function(e,t){var r="GetBinaryFileInfo",n={id:xt.guid(),method:r,version:"dwasm2_"+NC(),parameter:[]},i=xt.stringify(n),o=function(r,n,i){var o;r&&(o=xt.parse(r)),o?e(o):t(r,n,i)};if(Wt.DWT.ConnectWithSocket&&Y.bHTML5Edition){var a=cx.getWsUrl(Wt.DWT.Host,Y.bSSL?ow.SSLPort:ow.Port);return cx.postStringDataByWSUrl(a,i).then(o,t),!0}var s=[WC(),"/",r,"?type=1&dsver=",OC().join(""),"&ts=",xt.now()].join("");ZA.getHttpClientForDcp().request(i,s,{},500).then(o,t)}};xt.mix(ow,fz),Wt.dcp=ow,Wt.dcp.dcpJSVer=cz,lz=sz,cz=sz}function hz(e,t,r,n){var i;return i={id:xt.guid(),method:t,version:"dwasm2_"+NC(),parameter:[]},"VersionInfo"==t&&(i.version="dwasm2_"+sw.getVersionStrForCheck()),sP.isLongKey(r)&&(i.productKey=r),gz(e,t,i,uw,n)}function gz(e,t,r,n,i){return pz.apply(this,arguments)}function pz(){return pz=GE(m.mark((function e(t,r,n,i,o){var a,s,u,c,l,d,f,h,g;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=xt.stringify(n),ow.detect.bConnected=!1,s=[WC(),"/",r,"?type=1&dsver=",OC().join(""),"&ts=",xt.now()].join(""),c=Y.bSSL,l=c?ow.SSLPort:ow.Port,u=ZA.getHttpClient(t,l,c),d={},o&&!Y.bSSL&&(d.redirect="manual"),e.prev=8,e.next=11,u.request(a,s,d,i);case 11:f=e.sent,e.next=21;break;case 14:if(e.prev=14,e.t0=e.catch(8),!o||Y.bSSL){e.next=20;break}if((e.t0&&e.t0.code)!=rw.HTTPRedirected){e.next=20;break}throw EE();case 20:throw e.t0;case 21:if(f&&(h=xt.parse(f)),!(h&&"exception"in h&&"description"in h)){e.next=24;break}throw{code:h.exception,message:h.description};case 24:if(!h||!("result"in h)){e.next=30;break}if(!ow.detect.bConnected){e.next=27;break}return e.abrupt("return",h.result);case 27:return ow.detect.bConnected=!0,ow.detect.dcpStatus=ow.detect.EnumDCP_DetectStatus.Connected,e.abrupt("return",h.result);case 30:throw SE(g={}),tA(g);case 33:case"end":return e.stop()}}),e,null,[[8,14]])}))),pz.apply(this,arguments)}function _z(e){var t=Date.parse(e+"T00:00:00");return""!=e&&!isNaN(t)&&!!Wt.DWT.CheckCertExpired&&(new Date).getTime()>=t-864e5*Wt.DWT.CertificateConfig.UpdateDaysBeforeExpired}Wt.DWT.__innerCheckCertDate=function(e){_z(e)&&(xt.isFunction(Wt.OnCertExpired)&&Wt.OnCertExpired(e),setTimeout((function(){Wt.DWT.UpdateCert(Wt.DWT.CertificateConfig.URL,Wt.OnUpdateCertSuccess,Wt.OnUpdateCertFailure)}),5e3))},Wt.DWT.__innerUpdateCert=function(e,t,r,n){var i=[WC(),"/LoadZipFromBytes?type=",4,"&dsver=",OC().join(""),"&ts=",xt.now()].join("");ZA.getHttpClientForDcp(null,t).request(e,i,{},3e4).then(r,(function(e){xt.isFunction(n)&&n(e)}))},Wt.DWT.__innerReboot=function(e,t){var r=[WC(),"/admin?ts=",xt.now()].join(""),n='{"id":"'+(new Date).getTime().toString()+'","method":"Reboot","parameter":[],"version":"dwasm2_'+NC()+'"}';ZA.getHttpClientForDcp().request(n,r,{},3e4).then(e,t)},Wt.DWT.UpdateCert=function(e,t,r){xt.isString(e)&&""!=e?BE(e,{mode:"cors",dataType:"arraybuffer"}).then((function(e){Wt.DWT.__innerUpdateCert(e,!1,(function(e){var n;try{var i=Dt.parse(e);i.description&&(n={code:i.exception,message:i.description})}catch(c){var o;SE(o={}),o=tA(o)}n?Dt.isFunction(r)&&r(n):(Wt.DWT.CheckCertExpired=!1,xt.isFunction(t)&&t())}),(function(n){Y.bSSL?Wt.DWT.__innerUpdateCert(e,!0,t,r):xt.isFunction(r)&&r(n)}))}),r):xt.isFunction(r)&&r()};var mz={Errors:{FilePathSyntaxIncorrect:function(e){e._errorCode=-3123,e._errorString="The filename, directory name, or volume label syntax is incorrect."}},checkFilePath:function(e,t){return xt.isString(t)&&0!=t.length?xt.startsWith(t,"http://")||xt.startsWith(t,"https://")||xt.startsWith(t,"ftp://")?(Dt.File.Errors.FilePathSyntaxIncorrect(e),Lb):Bb:(Fw(e),Lb)}};mz.checkFolder=mz.checkFilePath,Dt.File=mz,Dt.showProgress=function(){},Dt.closeProgress=function(){};var vz,yz=document.location.protocol,Sz=location.hostname,Tz=Y.bSSL,Iz={detect:{ssl:Tz,dcpStatus:0,dcpCallbackType:0,arySTwains:[],bFirst:Bb,bOK:Lb,__dialog:Lb,cssLoaded:Lb,viewerScriptLoaded:Lb,bNoControlEvent:Lb,bNeedUpgradeEvent:Lb,bPromptJSOrServerOutdated:Lb,detectType:Tz?1:"http:"===yz||""===Sz?0:-1,tryTimes:0,ports:[{port:Wt.DWT.SSLPort,ssl:Bb},{port:Wt.DWT.Port,ssl:Lb}],cUrlIndex:0,urls:[],onNoControl:Lb,needUpgrade:Lb,OnDetectNext:Lb,OnCreatWS:Lb,bMaskShow:Lb},page:{bUnload:Lb}};function bz(){var e=QC;if(Wt.DWT.CertificateConfig){var t=Wt.DWT.CertificateConfig;xt.isString(t.URL)||(t.URL=e.URL),(!xt.isNumber(t.UpdateDaysBeforeExpired)||t.UpdateDaysBeforeExpired<=0)&&(t.UpdateDaysBeforeExpired=e.UpdateDaysBeforeExpired)}else Wt.DWT.CertificateConfig=e;(function(){var e;SH&&(vH=xt.mix({},mH),Wt.DWT&&(e=Wt.DWT.CustomizableDisplayInfo),e&&(e.errorMessages&&xt.mix(vH.errorMessages,e.errorMessages),e.generalMessages&&xt.mix(vH.generalMessages,e.generalMessages),e.customProgressText&&xt.mix(vH.customProgressText,e.customProgressText),e.buttons&&(e.buttons.titles&&xt.mix(vH.buttons.titles,e.buttons.titles),e.buttons.bShowAllButtons&&xt.mix(vH.buttons.bShowAllButtons,e.buttons.bShowAllButtons),e.buttons.visibility&&xt.mix(vH.buttons.visibility,e.buttons.visibility)),e.dialogText&&xt.mix(vH.dialogText,e.dialogText)),yH(),SH=!1)})(),xt.isString(Wt.DWT.ProductKey)&&(Wt.DWT.ProductKey=xt.trim(Wt.DWT.ProductKey)),Wt.navInfo&&(Y.bMac||Y.bWin)&&(Wt.navInfo.bEmbed=!1,Wt.navInfo.bArm64=!1,Wt.navInfo.bMips64=!1),Wt.DWT.Debug&&(xt.debug=!0)}function Cz(){return wz.apply(this,arguments)}function wz(){return wz=GE(m.mark((function e(){var t,r,n;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Dt.detect.cssLoaded){e.next=2;break}return e.abrupt("return",Dt.Promise.resolve());case 2:if(t=Wt.DWT.ResourcesPath,r="",Y.bFileSystem||(r=Dt.timestamp),n=[[t,"/src/dynamsoft.webtwain.css",r].join("")],aw.bHTML5Edition&&Wt.DWT.UseDefaultViewer&&n.push([t,"/src/dynamsoft.webtwain.viewer.css",r].join("")),!aw.bHTML5Edition||Y.bFileSystem){e.next=9;break}return e.next=9,Ez(n);case 9:return e.abrupt("return",new Dt.Promise((function(e,t){var r=!0;Y.bSafari?(xt.addAllCss(n,!1,(function(e){e||r&&(t({code:-2804,message:"Loading the WebTwain css files failed."}),r=!1)})),Dt.detect.cssLoaded=Bb,e()):xt.addAllCss(n,!1,(function(n){if(n)return Dt.detect.cssLoaded=Bb,void e();r&&(r=!1,t({code:-2804,message:"Loading the WebTwain css files failed."}))}))})));case 10:case"end":return e.stop()}}),e)}))),wz.apply(this,arguments)}function Ez(e){return Az.apply(this,arguments)}function Az(){return Az=GE(m.mark((function e(t){var r,n;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=!0,e.prev=1,n=0,n=0;case 4:if(!(n<t.length)){e.next=15;break}return e.next=7,Dt.fetch(t[n]);case 7:if(!(e.sent.indexOf("* Author: Dynamsoft Support Team")>0)){e.next=10;break}return e.abrupt("continue",12);case 10:return r=!1,e.abrupt("break",15);case 12:n++,e.next=4;break;case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(1),r=!1;case 20:if(r){e.next=22;break}throw{code:-2804,message:"Loading the WebTwain css files failed."};case 22:return e.abrupt("return",r);case 23:case"end":return e.stop()}}),e,null,[[1,17]])}))),Az.apply(this,arguments)}function Dz(){if(aw.loadResourcePath||!aw.loadingResourcePath)return vz&&vz(),void(vz=null);setTimeout(Dz,100)}function Pz(e){if(SD("Loading css..."),bz(),aw.loadResourcePath||aw.loadingResourcePath)return aw.loadResourcePath?Cz():aw.loadResourcePath||!aw.loadingResourcePath?Dt.Promise.resolve():(vz=null,new Dt.Promise((function(e){vz=e,setTimeout(Dz,100)})));aw.loadingResourcePath=!0,(Wt.DWT.Port>0||Wt.DWT.SSLPort>0)&&(Dt.detect.ports=[{port:Wt.DWT.Port,ssl:!1},{port:Wt.DWT.SSLPort,ssl:!0}],Dx.removeItem("DWT_port"),Dx.removeItem("DWT_ssl")),xt.each(Dt._funsAfterConfigLoaded,(function(e){try{xt.isFunction(e)&&e()}catch(t){}}));var t=xt.sizzle(".dynamsoft_waiting");if(t&&t.length>0){var r=t[0];r.parentNode&&r.parentNode.removeChild(r)}var n=Wt.DWT.ResourcesPath,i="";Y.bFileSystem||(i=Dt.timestamp);var o=Bb,a=[];return Y.bSafari&&(o=Lb),a.push([n,"/dynamsoft.webtwain.install.js",i].join("")),Wt.DWT.bNpm&&(a=[]),aw.bHTML5Edition&&Wt.DWT.UseDefaultViewer&&(SD("Loading the viewer script..."),a.push([n,"/src/dynamsoft.webtwain.viewer.js",i].join(""))),Wt.DWT.bChromeExtension&&(a=[]),Cz().then((function(){return 0==a.length?(Rz(),aw.loadResourcePath=!0,void(aw.loadingResourcePath=!1)):new Dt.Promise((function(e,t){xt.addScripts(a,o,!1,(function(r){var n=r;if(aw.bHTML5Edition&&Wt.DWT.UseDefaultViewer&&!xt.isFunction(Wt.DWTViewer)&&(n=!1),Y.bIE&&aw.bActiveXEdition&&(xt.isFunction(Wt.DWT._innerLoad)||(n=!1)),!n)return aw.loadingResourcePath=!1,void t({code:-2803,message:"Loading the WebTwain JavaScript source files failed."});Rz(),aw.loadResourcePath=!0,aw.loadingResourcePath=!1,Wt.DWT.OnWebTwainWillInit&&Wt.DWT.OnWebTwainWillInit(),e()}))}))}))}function Rz(){if(Dt.bNode||Y.bJSDom);else if(xt.isArray(Wt.aryAddonReadyFun)){for(var e=0,t=function(){var t=Wt.aryAddonReadyFun[e];if(xt.isFunction(t))try{t(Dt)}catch(QG){xt.log(QG.stack||QG,"error"),setTimeout((function(){throw QG}),0)}};e<Wt.aryAddonReadyFun.length;e++)t();Wt.aryAddonReadyFun=[]}}xt.mix(Dt,Iz),Dt.Addon_Events=[],Dt.Addon_Sendback_Events=[];var xz=[],kz=[];function Fz(){var e,t=xz.length;for(e=0;e<t;e++)xz[e]();xz.splice(0),kz.splice(0),Mz=0}function Oz(){if(Mz>0&&(new Date).getTime()-Mz>Nz){var e,t={code:-2802,message:"The file dynamsoft.webtwain.config.js timed out while loading."},r=Wt.DWT.Containers;r&&0!==r.length||(_E(e={}),t={code:e._errorCode,message:e._errorString}),function(e){var t,r=kz.length;for(t=0;t<r;t++)kz[t](e);xz.splice(0),kz.splice(0),Mz=0}(t)}else if(Wt.DWT.Containers||Wt.DWT.ProductKey||Wt.DWT.licenseServer||Wt.DWT.organizationID||Wt.DWT.handshakeCode||Wt.DWT.bNpm||0==Wt.DWT.AutoLoad){if(aw.dwtConfigLoading)return;if(aw.dwtConfigLoaded)return void Fz();aw.dwtConfigLoading=!0;var n=Y.bFileSystem,i=lR.basePath,o=Wt.DWT.ResourcesPath,a="";if(xt.isArray(Wt.DWT.Containers)||(Wt.DWT.Containers=[]),n||(void 0!==o&&""!=o||(o=i),o.length>0&&"/"==o.charAt(o.length-1)&&(o=o.substr(0,o.length-1)),a=Dt.timestamp,Wt.DWT.ResourcesPath=o),Y.bIE){var s=Y.IEVersion;if((""===s||s>=10)&&Wt.DWT.IfUseActiveXForIE10Plus){var u=Lb;Y.bHTML5Edition=u,aw.bHTML5Edition=u,aw.bActiveXEdition=!u,aw.bChromeEdition=aw.bHTML5Edition}}aw.bActiveXEdition?xt.addScript([o,"/src/dynamsoft.webtwain.activex.js",a].join(""),!0,!1,(function(){aw.dwtConfigLoaded=!0,aw.dwtConfigLoading=!1,Fz()})):(aw.dwtConfigLoaded=!0,aw.dwtConfigLoading=!1,Fz())}else setTimeout(Oz,100)}var Wz,Nz=3e3,Mz=0;function Lz(e){return SD("Loading the config script..."),aw.dwtConfigLoaded?Dt.Promise.resolve():(e&&(Nz=1e3*parseInt(e))<1&&(Nz=1),new Dt.Promise((function(e,t){xz.push(e),kz.push(t),yD((function(){Mz=(new Date).getTime(),setTimeout(Oz,100)}))})))}function Bz(){var e;(e=Wt.DWT.WebTwainIdMap)&&xt.each(e,(function(e,t){e&&e._OnPageBlur&&e._OnPageBlur()}))}if(aw.bActiveXEdition){var Uz=function(){var e,t,r,n,i;if(Wt.DWT.lunload(),Dt.closeAll&&Dt.closeAll(),n=Wt.DWT.ContainerMap)for(i=Object.keys(n),e=0;e<i.length;e++)(r=i[e])&&r in n&&(t=n[r])&&(t.__unload(),delete n[r]);if(n=Wt.DWT.WebTwainIdMap)for(i=Object.keys(n),e=0;e<i.length;e++)(r=i[e])&&r in n&&(t=n[r])&&(t.__unload(),delete n[r]);for(e=0;e<Dt.product.unloadQueue.length;e++){var o=Dt.product.unloadQueue[e];Dt.isFunction(o)&&o()}return Dt.product.unloadQueue.splice(0),Dt.detect.arySTwains.splice(0),Dt.Promise.resolve()},Vz=!1;Wt.DWT.Unload=function(){Uz();try{Wt.DWT.CloseDialog(),Dt._zdgb_xkz_dhk(),Dt.closeProgress(null,""),Dt.hideMask()}catch(e){}},Wt.DWT.Load=function(){if(!Dt.product.bDWTLoading)return Dt.product.bDWTLoading=!0,Dt.detect.axAutoLoadDone=!1,Lz().then(Pz).then(Uz).then((function(){return Wt.DWT._innerLoad()})).then((function(){Dt.product.bDWTLoading=!1,Dt.detect.axAutoLoadDone=!0}),(function(e){Dt.product.bDWTLoading=!1,Dt.detect.axAutoLoadDone=!1,XR(e)}))},Wt.DWT.ConnectToTheService=Wt.DWT.Load,Wt.DWT.CheckConnectToTheService=function(e,t,r,n){Dt.product.bActiveXEdition?Dt.isFunction(n)&&n():Dt.isFunction(r)&&r()},Wt.DWT.CreateDWTObject=function(e,t,r,n,i,o){return Dt._safePromptCustomMsg((function(){o&&o(pC.ErrStr_BROWSER_NOT_SUPPORT)})),Vz},Wt.DWT.CreateDWTObjectEx=function(e,t,r){return Dt._safePromptCustomMsg((function(){r&&r(pC.ErrStr_BROWSER_NOT_SUPPORT)})),Vz},Wt.DWT.CreateRemoteScanObjectAsync=function(){var e={};return fw(e,-2433,"The ActiveX edition does not support this method or property."),Dt.Promise.reject({code:e._errorCode,message:e._errorString})},Wt.DWT.DeleteDWTObject=function(e){return Vz}}function Gz(){return!(function(e){if(xt.isString(e)){if("localhost"==e||"127.0.0.1"==e)return!0;var t=e.split(".");if(4==t.length&&/^(([1-9]?\d|1\d{2}|2[0-4]\d|25[0-5])\.){3}([1-9]?\d|1\d{2}|2[0-4]\d|25[0-5])$/.test(e)){var r=parseInt(t[0]),n=parseInt(t[1]);if(127==r||10==r||169==r&&254==n||172==r&&n>=16&&n<=31||192==r&&168==n)return!0}}return!1}(location.hostname)||Y.bSSL||Y.bFileSystem||!((Y.bChrome||Y.bEdge)&&parseInt(Y.strBrowserVersion)>=94))}function jz(e,t,r,n){return Hz.apply(this,arguments)}function Hz(){return Hz=GE(m.mark((function e(t,r,n,i){var o,a;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r!=$E.GET_TASKID){e.next=4;break}return e.abrupt("return",i.taskId);case 4:if(r!=$E.ONMESSAGE_PROCESS_DATA){e.next=8;break}return e.abrupt("return",xt.parse(t));case 8:if(r!=$E.ONMESSAGE_GET_TASKID){e.next=13;break}if(!i||!i.client){e.next=11;break}return e.abrupt("return",i.client.getRequestTaskId());case 11:e.next=20;break;case 13:if(r!=$E.HANDLE_RAW_MESSAGE){e.next=20;break}if(o=null==i?void 0:i.userData){e.next=17;break}return e.abrupt("return",!1);case 17:return(a=t).indexOf("Version not found")>=0||a.indexOf("Function not found")>=0?xt.isFunction(o.fFun)&&o.fFun():xt.isFunction(o.sFun)&&o.sFun(a),e.abrupt("return",a);case 20:case"end":return e.stop()}}),e)}))),Hz.apply(this,arguments)}function zz(){aw.loadResourcePath?(SD(ID),Wz()):setTimeout(zz,100)}function Kz(){return aw.loadResourcePath?(SD(ID),Dt.Promise.resolve()):new Dt.Promise((function(e,t){Wz=e,setTimeout(zz,100)}))}function Jz(e){var t,r,n=e.WebTwainId,i=e.Host,o=e.Port,a=e.SSLPort;return r={},xt.isString(n)&&""!==n?r.id=n:r.id=n=ER(),xt.isDOM(e.Container)?(t=e.Container,xt.isString(t.id)&&""!==t.id||(t.id=["dwt_node_",xt.getRandom()].join("")),r.container=t,r.bNoViewer=!1):r.bNoViewer=!0,r.bNoViewer?(r.width=0,r.height=0):(xt.isUndefined(e.Width)?t.style.width?r.width=t.style.width:r.width=300:r.width=e.Width,xt.isUndefined(e.Height)?t.style.height?r.height=t.style.height:r.height=300:r.height=e.Height),r.dmService=e.dmService,xt.isString(i)&&""!=i||(i=JC()),r.host=i,o||(o=Wt.DWT.Port),r.port=o,a||(a=Wt.DWT.SSLPort),r.sslPort=a,r}function Yz(e,t,r){if(e){var n=null!=t?t:270,i=null!=r?r:350;n<=0&&(n=270),i<=0&&(i=350),Wb.one(e).before(Dt.install._strNonInstallDIV);var o=xt.get(Dt.install._divDWTNonInstallContainerID);o&&(o.style.width=n,o.style.height=i),xt.show(Dt.install._divDWTNonInstallContainerID)}}function Qz(e){var t=BC.getDSPath();if(""!=Dt.install._divDWTemessageContainer&&xt.hide(Dt.install._divDWTemessageContainer),Y.bMac)e?xt.isFunction(Wt.OnWebTwainNeedUpgradeCallback)&&Wt.OnWebTwainNeedUpgradeCallback(aw.name,{default:t},aw.bHTML5Edition,gC.enumMac,Y.bIE,Y.bSafari,Dt.detect.ssl,lR.strIEVersion):xt.isFunction(Wt.OnWebTwainNotFoundOnMacCallback)&&Wt.OnWebTwainNotFoundOnMacCallback(aw.name,t,aw.bHTML5Edition,Y.bIE,Y.bSafari,Dt.detect.ssl,lR.strIEVersion);else if(Y.bLinux||Wt.navInfo.bEmbed||Y.bChromeOS||lR.bMobile){var r,n,i=BC.getEnumPlatform();if(Wt.navInfo.bEmbed||Y.bAndroid||Y.bChromeOS||Y.bHarmonyOS?r=t:(r=BC.getLinuxHTML5DebPath(),n=BC.getLinuxHTML5RpmPath()),e){if(Y.bAndroid)xt.isFunction(Wt.OnWebTwainNeedUpgradeOnAndroidCallback)&&Wt.OnWebTwainNeedUpgradeOnAndroidCallback(aw.name,t,Dt.detect.ssl);else if(xt.isFunction(Wt.OnWebTwainNeedUpgradeCallback)){var o={default:r};Y.bLinux&&(o.deb=r,o.rpm=n),Wt.OnWebTwainNeedUpgradeCallback(aw.name,o,aw.bHTML5Edition,i,Y.bIE,Y.bSafari,Dt.detect.ssl,lR.strIEVersion)}}else Y.bAndroid?xt.isFunction(Wt.OnWebTwainNotFoundOnAndroidCallback)&&Wt.OnWebTwainNotFoundOnAndroidCallback(aw.name,t,Dt.detect.ssl,!1):xt.isFunction(Wt.OnWebTwainNotFoundOnLinuxCallback)&&Wt.OnWebTwainNotFoundOnLinuxCallback(aw.name,r,n,aw.bHTML5Edition,Y.bIE,Y.bSafari,Dt.detect.ssl,lR.strIEVersion,i)}else if(Y.bChrome||Y.bSafari||Y.bFirefox||Y.bOpera||Wt.DWT.IfUseActiveXForIE10Plus==G||!Wt.DWT.ActiveXInstallWithCAB&&Y.bIE)if(e){if(xt.isFunction(Wt.OnWebTwainNeedUpgradeCallback)){var a={default:t};Wt.OnWebTwainNeedUpgradeCallback(aw.name,a,aw.bHTML5Edition,gC.enumWindow,Y.bIE,Y.bSafari,Dt.detect.ssl,lR.strIEVersion)}}else xt.isFunction(Wt.OnWebTwainNotFoundOnWindowsCallback)&&Wt.OnWebTwainNotFoundOnWindowsCallback(aw.name,t,aw.bHTML5Edition,Y.bIE,Y.bSafari,Dt.detect.ssl,lR.strIEVersion)}Wt.DWT.GetWebTwain=Wt.DWT.GetWebTwainEx=function(e){var t=e,r=Wt.DWT.WebTwainIdMap;if(!t){var n=Object.keys(r);return n.length>0?r[t=n[0]]:void 0}if(t in r)return r[t];var i=Wt.DWT.ContainerMap;return t in i?i[t]:void 0},Wt.DWT.NeedCheckWebTwainBySocket=Gz,Wt.DWT.CheckWebTwainBySocket=function(e,t,r){var n,i,o,a=Dt.detect.urls;if(a&&a.length>0){var s=a[0];n=s.host||JC(),i=s.port,o=s.ssl}else dw(n=JC())?(o=!(!Y.bSSL||!Y.bSafari),n=sw.hostForCheckCert):o=Y.bSSL,i=o?Wt.DWT.SSLPort:Wt.DWT.Port;!function(e,t,r,n){var i,o=xt.now(),a=xt.guid(),s={id:a,method:"VersionInfo",version:[aw.getDWTPrefix(),sw.getVersionStrForCheck()].join("")},u=jz,c=cw;i={client:e,userData:{cmdId:a,cmd:null,sFun:t,fFun:r,rawData:!0},taskId:o},e.setRetry(0),e.request(xt.stringify(s),u,i,c).then((function(t){return e.dispose(),t}),(function(){xt.isFunction(n)&&n(),e.dispose()}))}(ZA.getWsClient(n,i,o,!0),e,t,r)},Wt.DWT.IsLocalServiceConnected=function(){return new Dt.Promise((function(e,t){var r,n=JC();xt.each(Dt.detect.ports,(function(e){Y.bSSL?e.ssl&&(r=e.port):e.ssl||(r=e.port)})),Wt.DWT.CheckConnectToTheService(n,r,(function(t,r,n){e(!0)}),(function(){t(!1)}))}))},Dt.detect.onNoControl=function(e,t,r,n){n&&n._bRemoteMode&&!n._bNotShowMessage?xt.isFunction(Wt.OnRemoteWebTwainNotFoundCallback)&&Wt.OnRemoteWebTwainNotFoundCallback(aw.name,n._serverInfo.server,n._serverInfo.port,n._serverInfo.ssl,lR.bMobile):(Yz(e,t,r),Qz(!1))};var Xz,qz=2,Zz=3,$z=!1;function eK(e,t){dw(e)&&(Dx.item("DWT_port",t),Dx.item("DWT_ssl",Y.bSSL?"true":"false"))}function tK(e,t,r,n,i){return rK.apply(this,arguments)}function rK(){return(rK=GE(m.mark((function e(t,r,n,i,o){var a,s,u,c,l,d,f,h,g,p,_,v,y,S,T,I,b,C,w,E,A,D,P,R,x,k,F;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Wt.DWT.OnWebTwainInitMessage&&(a=_C,Wt.DWT.OnWebTwainInitMessage(a,JH.Info)),u=!1,c=!1,l=!1,d=Wt.DWT.ConnectWithSocket,o&&(o.bRemoteServer&&(l=!0),o.bConnectWithSocket&&(d=!0),o.bCheckCert&&(c=!0)),f=xt.now(),h=['{"id":"',xt.guid(),'","method":"VersionInfo","version":"',aw.getDWTPrefix(),sw.getVersionStrForCheck(),'"}'].join(""),g=!d&&!Y.bSSL,e.prev=6,!d){e.next=18;break}return _=xt.now(),v=jz,y={client:p,userData:{cmdId:_,cmd:null,sFun:null,fFun:null,rawData:!0},taskId:_},(p=ZA.getWsClient(t,r,n)).setRetry(0),e.next=14,p.request(h,v,y,i);case 14:s=e.sent,u=!0,e.next=25;break;case 18:return S="fa/VersionInfo?v=1&ts="+f,T=ZA.getHttpClient(t,r,n),I={},g&&(I.redirect="manual"),e.next=24,T.request(h,S,I,i);case 24:s=e.sent;case 25:e.next=43;break;case 27:if(e.prev=27,e.t0=e.catch(6),xt.log(["check DWT Version failed",xt.stringify(e.t0)]),!u){e.next=33;break}e.next=43;break;case 33:if(!g){e.next=37;break}if((e.t0&&e.t0.code)!=rw.HTTPRedirected){e.next=37;break}throw EE();case 37:throw yE(b={}),Wt.DWT.OnWebTwainInitMessage&&Wt.DWT.OnWebTwainInitMessage(b._errorString,JH.Error),{code:b._errorCode,message:b._errorString};case 43:if(C="",w="",E={},A=!1,s&&(D=xt.parse(s)),!D||!("exception"in D)){e.next=50;break}rA(D)?(E._errorCode=D.exception,E._errorString=D.description):E._errorCode=rw.CommonError,e.next=92;break;case 50:if(!D||!("result"in D)){e.next=91;break}if(D=D.result,!(xt.isArray(D)&&D.length>0)){e.next=88;break}if(P=D[0],C=D.length>1?D[1]:"",R=D.length>2?D[2]:0,x=D.length>3?D[3]:"",w=D.length>4?D[4]:"",""!==C){e.next=85;break}if(k="The WebTwain version is: "+P,Wt.DWT.OnWebTwainInitMessage&&Wt.DWT.OnWebTwainInitMessage(k,JH.Info),"32"==R&&dw(t)&&(ow.b64bit=!1),dw(t)&&(Wt.DWT.li({instanceMode:Wt.DWT.EnumInstance.dwt_desktop},"")||""!=x&&(Wt.DWT.lsmid(x,""),Wt.DWT.lsmid2b(x))),(xt.isFunction(Wt.DWT.OnSSLCertInfo)||xt.isFunction(Wt.OnSSLCertInfo))&&(""!=w&&(F=Date.parse(w+"T00:00:00"),F=isNaN(F)?null:new Date(F)),$z||(xt.isFunction(Wt.DWT.OnSSLCertInfo)?Wt.DWT.OnSSLCertInfo(F):xt.isFunction(Wt.OnSSLCertInfo)&&Wt.OnSSLCertInfo(F)),$z=!0),!c){e.next=72;break}if(""!=w){e.next=69;break}throw{code:rw.SSLCertInvalid,message:"The Dynamsoft Service SSL certificate is invalid."};case 69:if(!_z(w)){e.next=72;break}throw{code:rw.SSLCertExpired,message:"The Dynamsoft Service SSL certificate has expired."};case 72:if(!xt.isString(P)||""==P){e.next=82;break}if(SD(PD),!l&&!kx(P,aw.getServerVersionInfo(!0))){e.next=78;break}return e.abrupt("return",{host:t,port:r,bSSL:n,version:P,certExpiredDate:F});case 78:SD(xD),Sw(E);case 80:e.next=83;break;case 82:A=!0;case 83:e.next=86;break;case 85:"Version not found"===C?Sw(E):IE(E,C);case 86:e.next=89;break;case 88:A=!0;case 89:e.next=92;break;case 91:A=!0;case 92:throw A&&SE(E),Wt.DWT.OnWebTwainInitMessage&&Wt.DWT.OnWebTwainInitMessage(E._errorString,JH.Error),{code:E._errorCode,message:E._errorString};case 95:case"end":return e.stop()}}),e,null,[[6,27]])})))).apply(this,arguments)}function nK(e,t,r){return iK.apply(this,arguments)}function iK(){return iK=GE(m.mark((function e(t,r,n){var i,o,a,s,u,c;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!aw.bDWTChecked){e.next=2;break}return e.abrupt("return");case 2:return a=Y.bSSL?n:r,i=Y.bSSL?n:r,o=Y.bSSL,e.prev=5,e.next=8,oK(t,i,o,Bb);case 8:s=e.sent,e.next=18;break;case 11:if(e.prev=11,e.t0=e.catch(5),e.t0.code!=rw.MustUpgrade){e.next=16;break}throw Qz(!0),e.t0;case 16:return e.next=18,cK(t,r,n);case 18:if(!Gz()||Wt.DWT.ConnectWithSocket){e.next=21;break}return e.next=21,dK(t,a);case 21:return u=s.host,c=s.port,Dt.detect.dcpStatus=qz,eK(u,c),e.next=26,uP(!1,!0);case 26:if(!lw()||!dw(t)){e.next=30;break}if(Wt.DWT.li({instanceMode:Wt.DWT.EnumInstance.dwt_desktop},"")){e.next=30;break}throw{code:-2827,message:"Failed to get Machine ID."};case 30:aw.bDWTChecked=!0;case 31:case"end":return e.stop()}}),e,null,[[5,11]])}))),iK.apply(this,arguments)}function oK(e,t,r,n){return aK.apply(this,arguments)}function aK(){return(aK=GE(m.mark((function e(t,r,n,i){var o;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return SD(DD),r||xt.each(Dt.detect.ports,(function(e){Y.bSSL?e.ssl&&(r=e.port):e.ssl||(r=e.port)})),e.prev=2,e.next=5,tK(t,r,n,i?cw:uw,{bConnectWithSocket:i});case 5:o=e.sent,e.next=12;break;case 8:throw e.prev=8,e.t0=e.catch(2),Dt.detect.dcpStatus=Zz,e.t0;case 12:return SD(RD),!sw.versionInfoFromServer&&dw(o.host)&&(sw.versionInfoFromServer=o.version),e.abrupt("return",o);case 15:case"end":return e.stop()}}),e,null,[[2,8]])})))).apply(this,arguments)}function sK(e,t,r,n,i){uK(e,t,{bRemoteServer:!0,bConnectWithSocket:r},n,i)}function uK(e,t,r,n,i){var o=0,a=e,s=t,u=Dt.detect.ssl,c=n,l=i;if(xt.isFunction(a)&&xt.isFunction(s))for(c=a,l=s,a=JC(),o=0;o<Dt.detect.ports.length;o++)if(Y.bSSL&&Dt.detect.ports[o].ssl||!Y.bSSL&&!Dt.detect.ports[o].ssl){s=Dt.detect.ports[o].port,u=Y.bSSL;break}a||(a=JC()),tK(a,s,u,uw,r).then((function(e){var t=e.host,r=e.port,n=e.version;xt.isFunction(c)&&c(t,r,n)}),(function(e){xt.isFunction(l)&&l(e)}))}function cK(e,t,r){return lK.apply(this,arguments)}function lK(){return lK=GE(m.mark((function e(t,r,n){var i,o,a,s,u,c,l;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=Y.bSSL?n:r,!Y.bSSL||Y.bSafari||Y.bMobile||Y.bAndroid){e.next=45;break}if(e.prev=2,!Wt.DWT.ConnectWithSocket&&1==Wt.DWT.IfCheckCORS){e.next=7;break}throw yE(o={}),{code:o._errorCode,message:o._errorString};case 7:return e.next=9,hK(t,i,!1);case 9:e.next=43;break;case 11:if(e.prev=11,e.t0=e.catch(2),(a=e.t0.code)!=rw.CORSErrorFromService&&a!=rw.SSLCertExpired&&a!=rw.SSLCertInvalid){e.next=18;break}throw e.t0;case 18:if(a!=rw.MustUpgrade){e.next=21;break}throw Qz(!0),e.t0;case 21:if(e.prev=21,1==Wt.DWT.IfCheckCert){e.next=26;break}throw yE(s={}),{code:s._errorCode,message:s._errorString};case 26:return e.next=28,tK(HC,r,!1,cw,{bConnectWithSocket:!0,bCheckCert:!0});case 28:e.sent,e.next=43;break;case 31:if(e.prev=31,e.t1=e.catch(21),(u=e.t1.code)!=rw.CORSErrorFromService&&u!=rw.SSLCertExpired&&u!=rw.SSLCertInvalid){e.next=38;break}throw e.t1;case 38:if(u!=rw.MustUpgrade){e.next=41;break}throw Qz(!0),e.t1;case 41:throw dw(t)?Qz(!1):xt.isFunction(Wt.OnRemoteWebTwainNotFoundCallback)&&Wt.OnRemoteWebTwainNotFoundCallback(aw.name,t,i,Y.bSSL,lR.bMobile),e.t1;case 43:case 52:e.next=66;break;case 45:if(e.prev=45,!Wt.DWT.ConnectWithSocket&&0!=Wt.DWT.IfCheckCORS){e.next=50;break}throw yE(c={}),{code:c._errorCode,message:c._errorString};case 50:return e.next=52,hK(t,i,!1);case 54:if(e.prev=54,e.t2=e.catch(45),(l=e.t2.code)!=rw.CORSErrorFromService&&l!=rw.SSLCertExpired&&l!=rw.SSLCertInvalid){e.next=61;break}throw e.t2;case 61:if(l!=rw.MustUpgrade){e.next=64;break}throw Qz(!0),e.t2;case 64:throw dw(t)?Qz(!1):xt.isFunction(Wt.OnRemoteWebTwainNotFoundCallback)&&Wt.OnRemoteWebTwainNotFoundCallback(aw.name,t,i,Y.bSSL,lR.bMobile),e.t2;case 66:throw AE();case 67:case"end":return e.stop()}}),e,null,[[2,11],[21,31],[45,54]])}))),lK.apply(this,arguments)}function dK(e,t){return fK.apply(this,arguments)}function fK(){return(fK=GE(m.mark((function e(t,r){return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",hK(t,r,!0));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function hK(e,t,r){return gK.apply(this,arguments)}function gK(){return(gK=GE(m.mark((function e(t,r,n){var i,o,a;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,Wt.DWT.ConnectWithSocket){e.next=5;break}return e.next=4,oK(t,r,Y.bSSL,Lb);case 4:i=e.sent;case 5:e.next=14;break;case 7:throw e.prev=7,e.t0=e.catch(0),o=e.t0,(a=e.t0.code)==rw.ResponseDataTypeError||a==rw.HTSTError||a==rw.CORSError||a==rw.SSLCertExpired||a==rw.SSLCertInvalid||a==rw.MustUpgrade||(a==rw.CORSErrorFromService?xt.isFunction(Wt.OnCorsConfigError)&&Wt.OnCorsConfigError(e.t0.message):dw(t)&&n&&Gz()&&(o={code:rw.CORSError,message:'The Connection from the insecure (HTTP) web page to the local "Dynamsoft Service" failed!'},a=o.code)),a==rw.CORSError&&xt.isFunction(Wt.OnHTTPCorsError)&&Wt.OnHTTPCorsError(o.message),o;case 14:return e.abrupt("return",i);case 15:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}function pK(e,t){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.add(e)}function _K(e,t,r){return t.has(e),r}!function(e){e.DoNotCheck=0,e.Check127=1,e.CheckLocalDynamsoftCert=2}(Xz||(Xz={}));var mK=new WeakSet,vK=new WeakSet,yK=new WeakSet,SK=function(e){function r(){var e;t(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return e=function(e,t,r){return t=QE(t),YE(e,function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(QG){return!1}}()?Reflect.construct(t,r||[],QE(e).constructor):t.apply(e,r))}(this,r,[].concat(i)),pK(e,yK),pK(e,vK),pK(e,mK),e}return qE(r,e),s(r,[{key:"SetCookie",value:function(e){return this._cookie=e,document.cookie=e,Bb}},{key:"LoadImageFromBase64Binary",value:function(e,t,r,n){var i=this,o=!1;if(xt.isFunction(r)&&(o=!0),i._resetErr(),!i._isValid())return xt.isFunction(n)&&Ek(n,i),!!o&&void 0;if(!e)return Zw(i),xt.isFunction(n)&&Ek(n,i),!!o&&void 0;var a,s,u,c,l,d=e,f="LoadImageFromBase64Binary",h=t,g=1;if(d instanceof Rj&&xt.isFunction(d.getLength)&&xt.isFunction(d.getData)&&(d=d.getData(0,d.getLength())),xt.isString(d))if(-1!=d.indexOf("data:image/bmp"))h=0;else if(-1!=d.indexOf("data:image/jpeg"))h=1;else if(-1!=d.indexOf("data:image/tif"))h=2;else if(-1!=d.indexOf("data:image/png"))h=3;else if(-1!=d.indexOf("data:application/pdf"))h=4;else if(-1!=d.indexOf("data:image/jp2"))h=14;else{var p=d.substr(0,64);u=xt.base64.decode(p,!0),c=Wt.DWT.EnumDWT_ImageType,l=u,(u instanceof ArrayBuffer||u instanceof Array)&&(l=new Uint8Array(u.slice(0,12))),h=function(e){return 37==e[0]&&80==e[1]&&68==e[2]&&70==e[3]}(l)?c.IT_PDF:function(e){return 73==e[0]&&73==e[1]&&42==e[2]&&0==e[3]||77==e[0]&&77==e[1]&&0==e[2]&&42==e[3]}(l)?c.IT_TIF:function(e){return 137==e[0]&&80==e[1]&&78==e[2]&&71==e[3]}(l)?c.IT_PNG:function(e){return 255==e[0]&&216==e[1]}(l)?c.IT_JPG:function(e){return 66==e[0]&&77==e[1]}(l)?c.IT_BMP:function(e){return 0==e[0]&&0==e[1]&&0==e[2]&&12==e[3]&&106==e[4]&&80==e[5]&&32==e[6]&&32==e[7]||255==e[0]&&79==e[1]&&255==e[2]&&81==e[3]}(l)?c.IT_J2K:c.IT_PNG}if(h!=Wt.DWT.EnumDWT_ImageType.IT_BMP&&h!=Wt.DWT.EnumDWT_ImageType.IT_JPG&&h!=Wt.DWT.EnumDWT_ImageType.IT_TIF&&h!=Wt.DWT.EnumDWT_ImageType.IT_PNG&&h!=Wt.DWT.EnumDWT_ImageType.IT_PDF&&h!=Wt.DWT.EnumDWT_ImageType.IT_J2K&&(h=-1),!sP.checkProductKey(i,{Core:!0}))return xt.isFunction(n)&&Ek(n,i),!!o&&void 0;if(!sP.checkPDFProductKeyWhenNeeds(i,h))return xt.isFunction(n)&&Ek(n,i),!!o&&void 0;if(xt.isString(d)&&-1!=d.indexOf("base64,")&&(d=d.substr(d.indexOf("base64,")+7)),s=i.__GetLoadEventsNum(),!o){var _=i._getCurrentDocumentName(),m=i._getCurrentDefaultTagName();return(a=i.__innerLoadImageFun(f,mR(d,h,s,g),g,_,m))&&i._canConsume()&&Wt.DWT.lcvrf(i),a}Dt.cancelFrom=fj.LoadImage,i.IfShowProgressBar?Dt.showProgress(i,f,i.__IfShowCancelDialogWhenImageTransfer):Dt.hideProgress(),i.__bLoadingImage=!0,g=0,i._innerSend(f,mR(d,h,s,g),!0,(function(){if(Dt.closeProgress(null,f),i.__bLoadingImage=!1,i._isBindViewer()){var e=i._ImgManager.getCurrentImageIndex();e>=0&&i._innerRefreshUI(e)}i._canConsume()&&Wt.DWT.lcvrf(i),r&&r(d,t)}),(function(){Dt.closeProgress(null,f),i.__bLoadingImage=!1,xt.isFunction(n)&&n(i._errorCode,i._getErrorString(),d,t)}))}},{key:"SaveSelectedImagesToBytes",value:function(e,t){return Tw(this),Lb}},{key:"LoadImageFromBytes",value:function(e,t,r){return Tw(this),Lb}},{key:"SetImageWidth",value:function(e,t,r,n){var i,o=this,a=!1;if(xt.isFunction(r)&&(a=!0),o._resetErr(),!o._isValid())return!!a&&void 0;var s=parseInt(e);if(isNaN(s))return pw(o),xt.isFunction(n)&&n(o._errorCode,o._getErrorString()),!!a&&void 0;if(s<0||s>=o._ImgManager.count())return Gw(o),xt.isFunction(n)&&n(o._errorCode,o._getErrorString()),!!a&&void 0;if(xt.isUndefined(t))return Zw(o),xt.isFunction(n)&&n(o._errorCode,o._getErrorString()),!!a&&void 0;var u=o._ImgManager.convertClientIndexToServerId(s);return-1==u?(Gw(o),xt.isFunction(n)&&n(o._errorCode,o._getErrorString()),!!a&&void 0):((i=1==o._innerFun("SetImageWidth",mR(u,t)))?xt.isFunction(r)&&r():xt.isFunction(n)&&n(o._errorCode,o._getErrorString()),a?void 0:i)}},{key:"HTTPDownloadStreamThroughPost",value:function(e,t){return Tw(this),Lb}},{key:"HTTPUploadStreamThroughPost",value:function(e,t,r,n,i){return Tw(this),Lb}},{key:"HTTPUploadThroughPutDirectly",value:function(e,t,r,n,i){return Tw(this),!1}},{key:"SetCustomDSDataEx",value:function(e){return this._resetErr(),!!this._isValid()&&this._innerFun("SetCustomDSDataEx",mR(e))}},{key:"SetCustomDSData",value:function(e){if(this._resetErr(),!this._isValid())return!1;var t=pk.replaceLocalFilename(e);return this._innerFun("SetCustomDSData",mR(t))}},{key:"GetCustomDSDataEx",value:function(){var e=this;return e._resetErr(),!!e._isValid()&&e._innerFun("GetCustomDSDataEx")}},{key:"GetCustomDSData",value:function(e){var t=this;if(t._resetErr(),!t._isValid())return!1;var r=pk.replaceLocalFilename(e);return t._innerFun("GetCustomDSData",mR(r))}},{key:"on",value:function(e,t){return this.registerEvent(e,t)}},{key:"off",value:function(e,t){return this.unregisterEvent(e,t)}},{key:"ConvertToBW",value:function(e,t,r){var n=this,i=!1;if(xt.isFunction(t)&&(i=!0),n._resetErr(),!n._isValid())return!!i&&void 0;if(!sP.checkProductKey(n,{Core:!0}))return xt.isFunction(r)&&r(n._errorCode,n._getErrorString()),!!i&&void 0;var o=parseInt(e);if(isNaN(o))return pw(n),xt.isFunction(r)&&r(n._errorCode,n._getErrorString()),!!i&&void 0;if(o<0||o>=n._ImgManager.count())return Gw(n),xt.isFunction(r)&&r(n._errorCode,n._getErrorString()),!!i&&void 0;var a=n.ChangeBitDepth(e,1,!0);return a?xt.isFunction(t)&&t():xt.isFunction(r)&&r(n._errorCode,n._getErrorString()),i?void 0:a}},{key:"LoadImageFromBinary",value:function(e,t,r){var n,i,o=this,a="LoadImageFromBinary",s=!1;xt.isFunction(t)&&(s=!0);var u=null===(n=Dt.progressContext)||void 0===n?void 0:n.IfShowCancelDialogWhenImageTransfer;return s&&(o.IfShowProgressBar?(Dt.showProgress(o,a,!1),Dt.progressContext&&(Dt.progressContext.IfShowCancelDialogWhenImageTransfer=!1)):Dt.hideProgress()),i=o._innerLoadImageFromBinary(e,0,!0,s,(function(){Dt.progressContext&&(Dt.progressContext.IfShowCancelDialogWhenImageTransfer=u),xt.isFunction(t)&&(o.IfShowProgressBar&&Dt.closeProgress(null,a),t())}),(function(e,n){Dt.progressContext&&(Dt.progressContext.IfShowCancelDialogWhenImageTransfer=u),xt.isFunction(t)&&o.IfShowProgressBar&&Dt.closeProgress(null,a),xt.isFunction(r)&&r(e,n)})),s?void 0:i}},{key:"EnableSourceUI",value:function(e,t){var r=this;return r._resetErr(),!!r._isValid()&&(r._innerSend("EnableSourceUI",null,!0,e,t),!0)}},{key:"GetIfShowVideoContainer",value:function(){return this._UIView.GetIfShowVideoContainer()}},{key:"ShowVideoContainer",value:function(e){return this._UIView.ShowVideoContainer(e)}},{key:"UpdateVideoContainer",value:function(e){return this._UIView.UpdateVideoContainer(e)}},{key:"ChangeBitDepth",value:function(e,t,r){var n,i=this;if(i._resetErr(),!i._isValid())return!1;if(n=parseInt(e),isNaN(n))return pw(i),!1;if(n<0||n>=i._ImgManager.count())return Gw(i),!1;var o=i._ImgManager.convertClientIndexToServerId(n);return-1==o?(Gw(i),!1):i._innerFun("ChangeBitDepth",mR(o,t,r))}},{key:"ConvertToGrayScale",value:function(e,t,r){var n,i=this,o=!1;if(xt.isFunction(t)&&(o=!0),i._resetErr(),!i._isValid())return!!o&&void 0;var a=parseInt(e);if(isNaN(a))return pw(i),xt.isFunction(r)&&r(i._errorCode,i._getErrorString()),!!o&&void 0;if(a<0||a>=i._ImgManager.count())return Gw(i),xt.isFunction(r)&&r(i._errorCode,i._getErrorString()),!!o&&void 0;var s=i._ImgManager.convertClientIndexToServerId(a);return-1==s?(Gw(i),xt.isFunction(r)&&r(i._errorCode,i._getErrorString()),!!o&&void 0):((n=1==i._innerFun("ConvertToGrayScale",mR(s)))?(pk.refreshImageAfterInvokeFun(i,a),xt.isFunction(t)&&t()):xt.isFunction(r)&&r(i._errorCode,i._getErrorString()),o?void 0:n)}},{key:"ClearTiffCustomTag",value:function(){var e=this;return e._resetErr(),!!e._isValid()&&(e._aryTiffTag.splice(0,e._aryTiffTag.length),e._innerFun("ClearTiffCustomTag"))}},{key:"SetTiffCustomTag",value:function(e,t,r){var n=this;if(n._resetErr(),!n._isValid())return!1;if(xt.isUndefined(e)||xt.isUndefined(t))return Zw(n),!1;var i,o=1*e;if(i=xt.isString(t)?xt.replaceAll(t,'"','\\"'):t,o<=0||o>2147483647)return fw(n,-2378,"Invalid value for the tiff tag code."),!1;var a,s=0,u=!1,c=n._aryTiffTag.length;for(s=0;s<c;s++)(a=n._aryTiffTag[s]).tag==o&&(a.Content=t,a.UseBase64Encoding=r,u=!0);return!u&&c>=32?(function(e){fw(e,-2428,"Tiff tag count has exceeded the limit.")}(n),!1):n._innerFun("SetTiffCustomTag",mR(o,i,r))}},{key:"IsBlankImage",value:function(e){var t,r=this;if(r._resetErr(),!r._isValid())return!1;if(t=parseInt(e),isNaN(t))return pw(r),!1;if(t<0||t>=r._ImgManager.count())return Gw(r),!1;var n=r._ImgManager.convertClientIndexToServerId(t);return-1==n?(Gw(r),!1):r._innerFun("IsBlankImage",mR(n,Lb))}},{key:"IsBlankImageExpress",value:function(e){var t=this;if(t._resetErr(),!t._isValid())return!1;var r=parseInt(e);if(isNaN(r))return pw(t),!1;if(r<0||r>=t._ImgManager.count())return Gw(t),!1;var n=t._ImgManager.convertClientIndexToServerId(r);return-1==n?(Gw(t),!1):t._innerFun("IsBlankImage",mR(n,Bb))}},{key:"SetOpenSourceTimeout",value:function(e){var t=this;return t._resetErr(),!!t._isValid()&&t._innerFun("SetOpenSourceTimeout",mR(e))}},{key:"GetImageURL",value:function(e,t,r,n,i){var o=this;if(o._resetErr(),!o._isValid())return!1;var a,s,u,c,l=e,d=parseInt(t),f=parseInt(r);if(n?(a="",s="dwt://"):(a=o._httpUrl,s="dwt/"),c=o._bScanForProxyRemote?sw.getVersionStrForCheck():aw.getServerVersionInfo(),u=[a,s,aw.getDWTPrefix(),c,"/img?id=",o._clientId],xt.isUndefined(l)||null===l)return jw(o),"";if(i)u.push("&index=-1&width=-1&height=-1&webcam="),u.push(i);else{if(l=parseInt(l),isNaN(l))return pw(o),"";if(l<-1||l>=o._ImgManager.count())return Gw(o),"";var h=o._ImgManager.convertClientIndexToServerId(l);if(-1==h)return"";u.push("&index="),u.push(h),d>0&&f>0?(u.push("&width="),u.push(d),u.push("&height="),u.push(f)):u.push("&width=-1&height=-1"),lR.bMobile&&u.push("&type=1&quality=85")}if(u.push("&t="),u.push((new Date).getTime()),u=u.join(""),Y.bFileSystem&&u.indexOf("dwt://")<0){var g=new Image;g.crossOrigin="anonymous",g.src=u,g=null}return u}},{key:"GetImagePartURL",value:function(e,t,r){var n=this;if(n._resetErr(),!n._isValid())return!1;var i=parseInt(e);return isNaN(i)?(pw(n),""):i<0||i>=n._ImgManager.count()?(Gw(n),""):this.GetImageURL(i,t,r,!0)}},{key:"SetLanguage",value:function(e){var t=this;return t._resetErr(),!!t._isValid()&&t._innerFun("SetLanguageForSecurity",mR(e))}},{key:"GetLicenseInfo",value:function(e,t){var r=this;r.__licenseInfo?xt.isFunction(e)&&e(r.__licenseInfo):r._innerFunRaw("GetLicenseInfo",mR(0),Bb,Lb,Bb,(function(n){n?n.exception?xt.isFunction(t)&&t(n.exception):(xt.isArray(n.result)&&n.result.length>0&&QR(r,n.result[0]),xt.isFunction(e)&&e(r.__licenseInfo)):xt.isFunction(t)&&t()}),t)}},{key:"SetProductKeyAsync",value:function(e){return this._setProductKeyAsync(e)}},{key:"GetVersionInfoAsync",value:function(){return Wb.Promise.resolve(sw.versionInfoFromServer)}},{key:"isUsingActiveX",value:function(){return!1}},{key:"SetLTSLicenseAsync",value:function(e){return this._setLTSLicenseAsync(e)}},{key:"Print",value:function(e){var t=this;return t._resetErr(),!!t._isValid()&&(t._isNoViewer()?t._nouiNotSupport("Print"):e?(t._innerSend("PrintEx",mR(!0),!0,(function(){}),(function(){})),!0):(t._ImagePrint.Print(),!0))}},{key:"PrintEx",value:function(e){var t=this;return t._resetErr(),!!t._isValid()&&!!t._checkIndices(e)&&(t._isNoViewer()?t._nouiNotSupport("Print"):(t._ImagePrint.PrintEx(e),!0))}},{key:"IsBlankImageAsync",value:(l=GE(m.mark((function e(t,r){var n,i,o,a;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this,BC.getEnumPlatform()==gC.enumWindow){e.next=5;break}throw fw(n,-2905,"This API is not supported on the current operating system. Please contact your system administrator."),{code:this._errorCode,message:this._getErrorString()};case 5:return o={minBlockHeight:20,maxBlockHeight:30},r&&(xt.isNumber(r.minBlockHeight)&&r.minBlockHeight>=0&&(o.minBlockHeight=r.minBlockHeight),xt.isNumber(r.maxBlockHeight)&&r.maxBlockHeight>=0&&(o.maxBlockHeight=r.maxBlockHeight)),i={command:"isBlankImage",parameter:{index:t,minHeight:o.minBlockHeight,maxHeight:o.maxBlockHeight}},e.next=10,n.RunCommandAsync(i);case 10:if(!((a=e.sent)&&Dt.isArray(a.result)&&a.result.length>0)){e.next=13;break}return e.abrupt("return",a.result[0]);case 13:return e.abrupt("return",!1);case 14:case"end":return e.stop()}}),e,this)}))),function(e,t){return l.apply(this,arguments)})},{key:"httpUploadBlob",value:function(e,t,r,n){var i=this,o="httpUploadBlob",a=t,s=r,u=null,c=null,l=dj.Text;if(i._resetErr(),!i._isValid())return Dt.Promise.reject({code:i._errorCode,message:i._errorString});if(xt.isUndefined(e)||""===e)return kw(i),Dt.Promise.reject({code:i._errorCode,message:i._errorString});if(!xt.isString(e))return Kw(i),Dt.Promise.reject({code:i._errorCode,message:i._errorString});if(!(a instanceof Blob))return Zw(i),Dt.Promise.reject({code:i._errorCode,message:i._errorString});var d=a.type.toLocaleLowerCase();if("image/jpeg"!=d&&"image/jpg"!=d&&"image/png"!=d&&"image/bmp"!=d&&"application/pdf"!=d&&"image/tiff"!=d&&"image/tif"!=d)return fw(i,-2845,"Only Blob of JPEG, PNG, BMP, TIFF and PDF image types can be uploaded."),Dt.Promise.reject({code:i._errorCode,message:i._errorString});n&&(u=new FormData,xt.each(n.formFields,(function(e,t){var r=e.name,n=e.value;xt.isString(r)&&(n instanceof Blob?u.append(r,n,e.fileName):u.append(r,n))})),c={},xt.each(n.headers,(function(e,t){xt.isString(e.name)&&(c[e.name]=e.value)})),n.responseType&&(l=n.responseType));var f=i._createHttpUploaderConfig(),h=new Ej,g=new Aj;return g.url=e,g.method=o,g.content=a,a=null,g.contentType=i._strHttpContentTypeFieldValue,g.headers=c,g.fileName=s,g.httpFormData=u,i.__remoteFilename&&""!=i.__remoteFilename&&(g.remoteFilename=i.__remoteFilename),g.retry=1,g.bOnlyResponseEmptyIsOK=!1,g.responseType=l,f.objUploadStatus=void 0,i.IfShowProgressBar&&Dt.showProgress(i,o,!1),new Dt.Promise((function(e,t){h.httpPostUpload(f,g,(function(t){i.IfShowProgressBar&&Dt.closeProgress(i,o,!1),e(t)}),(function(e,r){i.IfShowProgressBar&&Dt.closeProgress(i,o,!1),t({code:e,message:r})}))}))}},{key:"saveBlob",value:(c=GE(m.mark((function e(t,r){var n,i,o,a,s;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=t,(n=this)._resetErr(),n._isValid()){e.next=4;break}throw{code:n._errorCode,message:n._errorString};case 4:if(!xt.isString(t)&&null!==t&&void 0!==t){e.next=7;break}e.next=9;break;case 7:case 21:throw Zw(n),{code:n._errorCode,message:n._errorString};case 9:if(!(r instanceof Blob)){e.next=21;break}if("image/jpeg"!=(s=r.type.toLocaleLowerCase())&&"image/jpg"!=s&&"image/png"!=s&&"image/bmp"!=s&&"application/pdf"!=s&&"image/tiff"!=s&&"image/tif"!=s){e.next=14;break}e.next=16;break;case 14:throw fw(n,-2844,"Only Blob of JPEG, PNG, BMP, TIFF and PDF image types can be saved."),{code:n._errorCode,message:n._errorString};case 16:return e.next=18,pH(r);case 18:a=e.sent,e.next=23;break;case 23:return o||(o=""),o=pk.replaceLocalFilename(o),i=mR(o),e.next=28,new Dt.Promise((function(e,t){n._innerSendBlobByWS("SaveBlobToFile",i,a,(function(t){e(t)}),(function(e){t({code:n._errorCode,message:n._errorString})}))}));case 28:case"end":return e.stop()}}),e,this)}))),function(e,t){return c.apply(this,arguments)})},{key:"createLocalStorage",value:(u=GE(m.mark((function e(t){var r,n,i,o,a;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((r=this)._resetErr(),r._isValid()){e.next=4;break}throw{code:r._errorCode,message:r._errorString};case 4:if(i="CreateLocalStorage",o=null,!t){e.next=12;break}if(a=t.password,!1!==_K(this,vK,TK).call(this,a)){e.next=9;break}throw{code:r._errorCode,message:r._errorString};case 9:o=JSON.stringify([JSON.stringify(t)]),e.next=13;break;case 12:o='["{}"]';case 13:return e.next=15,new Dt.Promise((function(e,t){r._innerSend(i,o,!1,(function(n){if(xt.isArray(n)&&n.length>0){var i=n[0];i&&xt.isString(i.uid)&&e(i.uid)}else SE(r),t({code:r._errorCode,message:r._errorString})}),(function(){t({code:r._errorCode,message:r._errorString})}))}));case 15:return n=e.sent,e.abrupt("return",n);case 17:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"localStorageExist",value:(a=GE(m.mark((function e(t){var r,n,i;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n="LocalStorageExist",(r=this)._resetErr(),r._isValid()){e.next=4;break}throw{code:r._errorCode,message:r._errorString};case 4:if(0!=_K(r,yK,IK).call(r,t)){e.next=6;break}throw{code:r._errorCode,message:r._errorString};case 6:return e.next=8,new Dt.Promise((function(e,i){r._innerSend(n,mR(t),!1,(function(t){if(xt.isArray(t)&&t.length>0){var n=t[0];(xt.isBoolean(n)||xt.isNumber(n))&&e(!!n)}else SE(r),i({code:r._errorCode,message:r._errorString})}),(function(){i({code:r._errorCode,message:r._errorString})}))}));case 8:return i=e.sent,e.abrupt("return",i);case 10:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"saveToLocalStorage",value:(o=GE(m.mark((function e(t){var r,n,i,o;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n="SaveToLocalStorage",i=null,(r=this)._resetErr(),r._isValid()){e.next=4;break}throw{code:r._errorCode,message:r._errorString};case 4:if(xt.isObject(t)){e.next=7;break}throw Zw(r),{code:r._errorCode,message:r._errorString};case 7:if(!1!==_K(r,yK,IK).call(r,t.uid)&&!1!==_K(this,vK,TK).call(this,t.password)){e.next=9;break}throw{code:r._errorCode,message:r._errorString};case 9:if(!xt.isUndefined(t.indices)){e.next=13;break}t.indices=bk(r),e.next=19;break;case 13:if(!xt.isArray(t.indices)||0!=t.indices.length){e.next=16;break}e.next=19;break;case 16:if(r._checkIndices(t.indices)){e.next=18;break}throw{code:r._errorCode,message:r._errorString};case 18:t.indices=Ck(r,t.indices);case 19:return i=JSON.stringify([JSON.stringify(t)]),e.next=22,new Dt.Promise((function(e,t){r._innerSend(n,i,!1,(function(n){if(xt.isArray(n)&&n.length>0){var i=n[0];i&&i.imageIds&&e(i.imageIds)}else SE(r),t({code:r._errorCode,message:r._errorString})}),(function(){t({code:r._errorCode,message:r._errorString})}))}));case 22:return o=e.sent,e.abrupt("return",o);case 24:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"loadFromLocalStorage",value:(i=GE(m.mark((function e(t){var r,n,i,o,a;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n="LoadFromLocalStorage",i=null,(r=this)._resetErr(),r._isValid()){e.next=4;break}throw{code:r._errorCode,message:r._errorString};case 4:if(xt.isObject(t)){e.next=7;break}throw Zw(r),{code:r._errorCode,message:r._errorString};case 7:if(!1!==_K(r,yK,IK).call(r,t.uid)&&!1!==_K(this,vK,TK).call(this,t.password)){e.next=9;break}throw{code:r._errorCode,message:r._errorString};case 9:return(a=xt.clone(t)).documentName=r._getCurrentDocumentName(),a.tagName=r._getCurrentDefaultTagName(),i=JSON.stringify([JSON.stringify(a)]),Dt.showProgress(r,n,!1),Dt.progressBarOnPercentDone(-1,"Processing...","",0,""),e.next=17,new Dt.Promise((function(e,t){r._innerSend(n,i,!1,(function(i){var o;Dt.closeProgress(null,n),xt.isArray(i)&&i.length>0?(o=i[0])&&o.mapImageIds&&e(o.mapImageIds):(!1===o&&0!=r._errorCode||SE(r),t({code:r._errorCode,message:r._errorString}))}),(function(){Dt.closeProgress(null,n),t({code:r._errorCode,message:r._errorString})}))}));case 17:return o=e.sent,e.abrupt("return",o);case 19:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"removeLocalStorage",value:(n=GE(m.mark((function e(t){var r,n,i,o;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n="RemoveLocalStorage",i=null,(r=this)._resetErr(),r._isValid()){e.next=4;break}throw{code:r._errorCode,message:r._errorString};case 4:if(xt.isObject(t)){e.next=7;break}throw Zw(r),{code:r._errorCode,message:r._errorString};case 7:if(!1!==_K(r,yK,IK).call(r,t.uid)&&!1!==_K(this,vK,TK).call(this,t.password)){e.next=9;break}throw{code:r._errorCode,message:r._errorString};case 9:return t&&(i=JSON.stringify([JSON.stringify(t)])),e.next=12,new Dt.Promise((function(e,t){r._innerSend(n,i,!1,(function(n){if(xt.isArray(n)&&n.length>0){var i=n[0];(xt.isBoolean(i)||xt.isNumber(i))&&e(!!i)}else SE(r),t({code:r._errorCode,message:r._errorString})}),(function(){t({code:r._errorCode,message:r._errorString})}))}));case 12:return o=e.sent,e.abrupt("return",o);case 14:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})}]);var n,i,o,a,u,c,l}(hH);function TK(e){if(!xt.isUndefined(e)){if(!xt.isString(e))return fw(this,-2850,"The password is not a string."),!1;if(e.length>32)return function(e){fw(e,-2849,"The password must not exceed 32 characters in length.")}(this),!1}return!0}function IK(e){return xt.isUndefined(e)||""==e?(fw(this,-2846,"The uid cannot be empty."),!1):!!xt.isString(e)||(function(e){fw(e,-2847,"The uid is invalid.")}(this),!1)}var bK=0,CK=1,wK=1,EK=2;function AK(e,t,r,n){var i;r!==bK&&r!==CK?i=r:(i={},r&&(i.set=n==wK?function(r){var n=1*r;return!xt.isNumber(n)||isNaN(n)?(_w(e),Lb):(e._resetErr(),!!e._isValid()&&e._innerFun(t,mR(n)))}:n==EK?function(r){return xt.isBoolean(r)?(e._resetErr(),!!e._isValid()&&e._innerFun(t,mR(r))):(_w(e),Lb)}:function(r){return xt.isString(r)?(e._resetErr(),!!e._isValid()&&e._innerFun(t,mR(r))):(_w(e),Lb)})),i.get||(i.get=function(){return e._resetErr(),!!e._isValid()&&e._innerFun(t)}),t in e||Object.defineProperty(e,t,i)}function DK(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return PK(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?PK(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function PK(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function RK(e,t,r){return t.has(e),r}var xK=new WeakSet,kK=function(){return s((function e(r,n,i,o){t(this,e),function(e,t){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.add(e)}(this,xK),Mb(this,"serverUrl",void 0),this.serverUrl=r,this.bLocal=dw(r),this.clientId=null!=i?i:xt.guid(),this.bGlobal=n,this.serverName=o,this.bLicenseOK=!1}),[{key:"checkSource",value:function(e){if(!e)throw{code:-1003,message:"Source Manager unable to find the specified Source"}}},{key:"parseResultDefault",value:function(e){var t;if(xt.isObject(e)&&e.exception&&0!=e.exception)throw{code:e.exception,message:null!==(t=e.description)&&void 0!==t?t:"general error"};if(e&&xt.isArray(e.result)&&e.result.length>0){var r=e.result[e.result.length-1];try{return JSON.parse(r)}catch(QG){return r}}throw e}},{key:"_requestAsync",value:(r=GE(m.mark((function e(t,r,n){var i,o,a,s,u,c,l,d,f,h;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Wt.DWT.ConnectWithSocket){e.next=12;break}return e.next=3,RK(this,xK,FK).call(this);case 3:return i=e.sent,o=0,t&&(o=t.cmdId),a={client:i,userData:{command:t},taskId:o},s=LK,e.next=9,i.request(xt.stringify(t),s,a);case 9:return u=e.sent,xt.isString(u)&&(u=xt.parse(u)),e.abrupt("return",u);case 12:return c=[oD(),"/",t.method].join(""),r&&(d=r),f=(h=this).serverUrl?cx.getDDMUrl(h.serverUrl,h.bGlobal,[nD,t.method].join("")):cx.getModuleUrl(c),e.prev=16,e.next=19,BE(f,{method:"post",dataType:"json",body:xt.stringify(t),fetchRaw:null!=n&&n,timeout:d});case 19:l=e.sent,e.next=25;break;case 22:throw e.prev=22,e.t0=e.catch(16),e.t0;case 25:return e.abrupt("return",l);case 26:case"end":return e.stop()}}),e,this,[[16,22]])}))),function(e,t,n){return r.apply(this,arguments)})},{key:"_resetLicense",value:(e=GE(m.mark((function e(t,r,n){return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(t,r,n){return e.apply(this,arguments)})}]);var e,r}();function FK(){return OK.apply(this,arguments)}function OK(){return(OK=GE(m.mark((function e(){var t,r,n,i,o,a,s,u,c;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((t=this)._wsClient){e.next=10;break}return r=new KE,(n=this.serverUrl)?(i=Dt.detect.ssl,a="/",o=i?"ddm/18626/":"ddm/18625/",xt.endsWith(n,"/")&&(a=""),xt.startsWith(n,"https://")||xt.startsWith(n,"wss://")?(r.ssl=!0,s=xt.startsWith(n,"https://")?xt.replaceAll(n,"https://",""):xt.replaceAll(n,"wss://",""),n=s+a+o):xt.startsWith(n,"http://")||xt.startsWith(n,"ws://")?(r.ssl=!1,u=xt.startsWith(n,"http://")?xt.replaceAll(n,"http://",""):xt.replaceAll(n,"ws://",""),n=u+a+o):(r.ssl=Dt.detect.ssl,r.port=r.ssl?ow.SSLPort:ow.Port),r.server=n):(r.ssl=Dt.detect.ssl,r.server=JC(),r.port=r.ssl?ow.SSLPort:ow.Port),r.useWS=!0,r.protocol=ow.wsProtocol,c=QA.Instance.getClient(r),e.next=9,c.testConnection();case 9:t._wsClient=c;case 10:return e.abrupt("return",t._wsClient);case 11:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}Mb(kK,"logLevel",-1);var WK,NK=function(e){function r(){var e;t(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return e=function(e,t,r){return t=QE(t),YE(e,function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(QG){return!1}}()?Reflect.construct(t,r||[],QE(e).constructor):t.apply(e,r))}(this,r,[].concat(i)),Mb(e,"_bInited",!1),e}return qE(r,e),s(r,[{key:"getDynamsoftService",value:(n=GE(m.mark((function e(t,r,n,i){var o,a,s,u,c,l,d,f,h,g,p,_,v,y,S;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=null!==(o=n)&&void 0!==o&&o,i=null!==(a=i)&&void 0!==a?a:30,s={id:this.clientId,cmdId:xt.guid(),method:"SearchScanner",parameter:[1,"_privet._tcp.local.",!1,!0,n,i,t,r],version:iD},e.prev=5,e.next=8,this._requestAsync(s,3e4,!1);case 8:u=e.sent,this._bInited=!0,e.next=19;break;case 12:if(e.prev=12,e.t0=e.catch(5),!this.bLocal){e.next=18;break}throw dE(c={}),{code:c._errorCode,message:c._errorString};case 18:throw{code:-2604,message:"Failed to connect to the Proxy Service. Please make sure the Proxy Service is configured successfully, Dynamsoft Service is running, or the certificate is valid."};case 19:l=[],d=this.parseResultDefault(u),f=DK(d),e.prev=22,f.s();case 24:if((h=f.n()).done){e.next=40;break}if(!((g=h.value).service_type&&g.service_type==ux.ST_UNKNOWN||g.type&&"dynamsoft_private_cloud_scan"!=g.type&&"twaindirect"!=g.type)){e.next=30;break}return e.abrupt("continue",38);case 30:if(!g.service_type){e.next=38;break}e.t1=g.service_type,e.next=e.t1===ux.ST_DYNAMSOFT_SERVICE?34:38;break;case 34:return(p=g.modules)&&xt.isArray(p)&&xt.isString(p[0])&&(_=p[0].split(",")).length>=3&&_[0]>=1&&_[1]>=8&&_[2]>0&&(g.bGlobalFind=!0,v=MK(this.serverUrl,g),l.push(v)),g.bGlobalFind||(S=null!==(y=null==g?void 0:g.ty)&&void 0!==y?y:"",xt.warn(["The Dynamsoft Service on [",S,"] is old version."].join(""))),e.abrupt("break",38);case 38:e.next=24;break;case 40:e.next=45;break;case 42:e.prev=42,e.t2=e.catch(22),f.e(e.t2);case 45:return e.prev=45,f.f(),e.finish(45);case 48:return e.abrupt("return",l);case 49:case"end":return e.stop()}}),e,this,[[5,12],[22,42,45,48]])}))),function(e,t,r,i){return n.apply(this,arguments)})},{key:"dispose",value:function(){var e={id:this.clientId,cmdId:xt.guid(),method:"dispose",version:iD};this._requestAsync(e,500)}}]);var n}(kK);function MK(e,t){var r=new nx;return r.server=e,r.attrs=t,r}function LK(e,t,r,n){return BK.apply(this,arguments)}function BK(){return BK=GE(m.mark((function e(t,r,n,i){var o,a;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r!=$E.GET_TASKID){e.next=4;break}return e.abrupt("return",i.taskId);case 4:if(r!=$E.ONMESSAGE_PROCESS_DATA){e.next=8;break}return e.abrupt("return",xt.parse(t));case 8:if(r!=$E.ONMESSAGE_GET_TASKID){e.next=13;break}if(!i||!i.client){e.next=11;break}return e.abrupt("return",i.client.getRequestTaskId());case 11:e.next=20;break;case 13:if(r!=$E.HANDLE_RAW_MESSAGE){e.next=20;break}if(o=null==i?void 0:i.userData){e.next=17;break}return e.abrupt("return",!1);case 17:return(a=t).indexOf("Version not found")>=0||a.indexOf("Function not found")>=0?xt.isFunction(o.fFun)&&o.fFun():xt.isFunction(o.sFun)&&o.sFun(a),e.abrupt("return",a);case 20:case"end":return e.stop()}}),e)}))),BK.apply(this,arguments)}function UK(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return VK(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?VK(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function VK(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function GK(e,t){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.add(e)}function jK(e,t,r){return t.has(e),r}function HK(e){var t,r=ux.ST_UNKNOWN;return e==fR.ESCLSCANNER?r=ux.ST_ESCL:e==fR.WIFIDIRECTSCANNER?r=ux.ST_WIFI_DIRECT:((t=e)==fR.TWAINSCANNER||t==fR.WIATWAINSCANNER||t==fR.TWAINX64SCANNER||t==fR.ICASCANNER||t==fR.SANESCANNER)&&(r=ux.ST_DYNAMSOFT_SERVICE),r}!function(e){e.SAM_ANONYMOUS=0,e.SAM_PWD=1}(WK||(WK={}));var zK=new WeakSet,KK=new WeakSet,JK=function(e){function r(){var e;t(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return e=function(e,t,r){return t=QE(t),YE(e,function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(QG){return!1}}()?Reflect.construct(t,r||[],QE(e).constructor):t.apply(e,r))}(this,r,[].concat(i)),GK(e,KK),GK(e,zK),Mb(e,"_bInited",!1),Mb(e,"_currentDevice",void 0),e}return qE(r,e),s(r,[{key:"getSources",value:(d=GE(m.mark((function e(t,r,n){var i,o,a,s,u,c,l,d,f,h,g,p,_,v;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a="",s=!1,u=[],c=!1,((l=null!=t?t:IR)&fR.ESCLSCANNER)==fR.ESCLSCANNER&&(a="_uscan._tcp.local."),(l&fR.WIFIDIRECTSCANNER)==fR.WIFIDIRECTSCANNER&&(s=!0),0!=a.length||s){e.next=9;break}return e.abrupt("return",[]);case 9:return r=null!==(i=r)&&void 0!==i&&i,n=null!==(o=n)&&void 0!==o?o:30,d={id:this.clientId,cmdId:xt.guid(),method:"SearchScanner",parameter:[1,a,s,c,r,n],version:iD},e.next=14,this._requestAsync(d,3e4,!1);case 14:if(f=e.sent,this._bInited=!0,h=this.parseResultDefault(f),xt.isArray(h)){e.next=19;break}throw{code:-2612,message:"The devices must be an Array."};case 19:g=UK(h),e.prev=20,g.s();case 22:if((p=g.n()).done){e.next=48;break}if(!((_=p.value).service_type&&_.service_type==ux.ST_UNKNOWN||_.type&&"dynamsoft_private_cloud_scan"!=_.type&&"twaindirect"!=_.type)){e.next=28;break}return e.abrupt("continue",46);case 28:if(!_.service_type){e.next=46;break}e.t0=_.service_type,e.next=e.t0===ux.ST_DYNAMSOFT_SERVICE?32:e.t0===ux.ST_ESCL||e.t0===ux.ST_WIFI_DIRECT?33:46;break;case 32:return e.abrupt("break",46);case 33:return(v=new gx).name="",v.displayName="",v.deviceType=0,v.isSystemDefaultPrinter=!1,_.service_type==ux.ST_ESCL?v.deviceType=fR.ESCLSCANNER:_.service_type==ux.ST_WIFI_DIRECT&&(v.deviceType=fR.WIFIDIRECTSCANNER),v.name=_.ty,_.hostname&&_.hostname.length>_.ty.length&&(v.name=_.hostname),v.displayName=(_.service_type==ux.ST_ESCL?"eSCL-":"")+v.name,this.bGlobal||(_.url=this.serverUrl,this.serverName&&(v.displayName=v.displayName+" on ["+this.serverName+"]")),v.serviceInfo=MK(this.serverUrl,_),u.push(v),e.abrupt("break",46);case 46:e.next=22;break;case 48:e.next=53;break;case 50:e.prev=50,e.t1=e.catch(20),g.e(e.t1);case 53:return e.prev=53,g.f(),e.finish(53);case 56:return e.abrupt("return",u);case 57:case"end":return e.stop()}}),e,this,[[20,50,53,56]])}))),function(e,t,r){return d.apply(this,arguments)})},{key:"getCapabilitiesAsync",value:(l=GE(m.mark((function e(t){var r,n,i;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.checkSource(t),(t.deviceType&fR.ESCLSCANNER)!=fR.ESCLSCANNER&&(t.deviceType&fR.WIFIDIRECTSCANNER)!=fR.WIFIDIRECTSCANNER||(this._currentDevice=t),r=HK(t.deviceType),n={id:this.clientId,cmdId:xt.guid(),method:"SendRequestToScanner",parameter:["getCapabilities",xt.stringify({UUID:t.serviceInfo.attrs.UUID,service_type:r,ty:t.name})],version:iD},e.next=6,this._requestAsync(n,0);case 6:return i=e.sent,e.abrupt("return",this.parseResultDefault(i));case 8:case"end":return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)})},{key:"selectSourceAsync",value:(c=GE(m.mark((function e(t){var r;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getCapabilitiesAsync(t);case 2:if(!(r=e.sent)&&""!=r){e.next=5;break}return e.abrupt("return",!0);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"versionInfo",value:(u=GE(m.mark((function e(){var t,r;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={id:this.clientId,cmdId:xt.guid(),method:"VersionInfo",version:iD},e.next=3,this._requestAsync(t,5e3);case 3:return r=e.sent,this._bInited=!0,e.abrupt("return",r);case 6:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"getLicenseInfo",value:function(e,t,r){return this._resetLicense(e,t,r)}},{key:"getImageAsArrayBuffer",value:(a=GE(m.mark((function e(t,r){return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",jK(this,zK,YK).call(this,t,r));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t){return a.apply(this,arguments)})},{key:"getImageToDWT",value:(o=GE(m.mark((function e(t,r,n){return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",jK(this,zK,YK).call(this,t,r,n));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return o.apply(this,arguments)})},{key:"acquireImage",value:(i=GE(m.mark((function e(t,r,n){var i,o,a,s,u,c,l,d;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=null!==(i=t)&&void 0!==i?i:this._currentDevice,this.checkSource(t),this._currentDevice=t,o=HK(t.deviceType),a=["scan",xt.stringify({UUID:t.serviceInfo.attrs.UUID,service_type:o})],s=jK(this,KK,XK).call(this,r),a[2]=xt.stringify(s),u={id:this.clientId,cmdId:xt.guid(),method:"SendRequestToScanner",parameter:a,version:iD},c=0;case 10:if(!(c<5)){e.next=33;break}return e.prev=11,e.next=14,this._requestAsync(u,0);case 14:return d=e.sent,l=this.parseResultDefault(d),xt.isObject(l)&&(l.device=t,l.scanOptions=s),e.abrupt("break",33);case 20:if(e.prev=20,e.t0=e.catch(11),-1004!=e.t0.code&&-1001!=e.t0.code){e.next=29;break}if(!(c>=4)){e.next=25;break}throw e.t0;case 25:return e.next=27,new Dt.Promise((function(e,t){setTimeout(e,2e3)}));case 27:e.next=30;break;case 29:throw e.t0;case 30:c++,e.next=10;break;case 33:return e.abrupt("return",l);case 34:case"end":return e.stop()}}),e,this,[[11,20]])}))),function(e,t,r){return i.apply(this,arguments)})},{key:"_resetLicense",value:(n=GE(m.mark((function e(t,n,i){var o,a,s,u;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.longKeyOrShortkey=t,this.cu=n,qK(),o=null!=n?n:"",a={id:this.clientId,cmdId:xt.guid(),method:"GetLicenseInfo",parameter:[t,r.logLevel,o,i],version:iD},e.prev=5,e.next=8,this._requestAsync(a,1e4);case 8:return s=e.sent,this._bInited=!0,e.abrupt("return",this.parseResultDefault(s));case 13:if(e.prev=13,e.t0=e.catch(5),!this.bLocal){e.next=19;break}throw dE(u={}),{code:u._errorCode,message:u._errorString};case 19:throw{code:-2604,message:"Failed to connect to the Proxy Service. Please make sure the Proxy Service is configured successfully, Dynamsoft Service is running, or the certificate is valid."};case 20:case"end":return e.stop()}}),e,this,[[5,13]])}))),function(e,t,r){return n.apply(this,arguments)})}]);var n,i,o,a,u,c,l,d}(NK);function YK(e,t,r){return QK.apply(this,arguments)}function QK(){return(QK=GE(m.mark((function e(t,r,n){var i,o,a,s,u,c;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=t&&t.device){e.next=2;break}throw{code:-1011,message:"Operation out of expected sequence"};case 2:return n=null!==(i=n)&&void 0!==i?i:{ver:"",clientId:""},(o=["getImage",xt.stringify({UUID:t.device.serviceInfo.attrs.UUID,service_type:r})])[2]=xt.stringify(t.scanOptions),o[3]=t.scanJobs,o[4]=t.scanId,o[5]=n._clientId,o[6]=n._ver,a={id:this.clientId,cmdId:xt.guid(),method:"SendRequestToScanner",parameter:o,version:iD},e.next=12,this._requestAsync(a,0,!0);case 12:if(!((s=e.sent).headers.get("content-type").indexOf("image/")>=0)){e.next=20;break}return e.next=17,s.arrayBuffer();case 17:return e.abrupt("return",e.sent);case 20:return e.next=22,s.json();case 22:if(u=e.sent,"boolean"!=typeof(c=this.parseResultDefault(u))){e.next=28;break}return e.abrupt("return",null);case 28:return e.abrupt("return",c);case 29:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}function XK(e){var t=[];if(e){xt.isNumber(e.PixelType)&&(t.push({capability:CH.ICAP_PIXELTYPE,curValue:e.PixelType}),Wt.DWT.EnumDWT_PixelType.TWPT_BW==e.PixelType&&(t.push({capability:32771,curValue:"application/octet-stream"}),t.push({capability:32772,curValue:"application/octet-stream"})));var r=e.Resolution;r||(r=300),t.push({capability:CH.ICAP_XRESOLUTION,curValue:r}),t.push({capability:CH.ICAP_YRESOLUTION,curValue:r}),void 0!==e.Brightness&&t.push({capability:CH.ICAP_BRIGHTNESS,curValue:e.Brightness}),void 0!==e.XferCount&&t.push({capability:CH.CAP_XFERCOUNT,curValue:e.XferCount}),void 0!==e.Contrast&&t.push({capability:CH.ICAP_CONTRAST,curValue:e.Contrast}),void 0!==e.TransferMode&&t.push({capability:CH.ICAP_XFERMECH,curValue:e.TransferMode}),void 0!==e.IfFeederEnabled&&t.push({capability:CH.CAP_FEEDERENABLED,curValue:e.IfFeederEnabled?1:0}),void 0!==e.IfDuplexEnabled&&t.push({capability:CH.CAP_DUPLEXENABLED,curValue:e.IfDuplexEnabled?1:0})}return t}function qK(){var e=JK.logLevel;xt.isNumber(e)||(JK.logLevel=-1)}Dt.removeNonPrintableChar;var ZK=function(e,t,r){r==EK&&xt.each(t,(function(t,r){Wj(e,t,{get:function(){return e._resetErr(),e._isValid()?Bb:Lb},set:function(t){return e._resetErr(),e._isValid()?Bb:Lb}})}))},$K=function(e,t){xt.each(t,(function(t,r){AK(e,t,CK,EK)}))},eJ=function(e,t){xt.each(t,(function(t,r){AK(e,t,CK,wK)}))},tJ=function(e,t){xt.each(t,(function(t,r){AK(e,t,bK)}))},rJ=function(e,t){xt.each(t,(function(t,r){AK(e,t,CK)}))};Dt.DynamicLoadAddonFuns=[],Dt.attachAddon=function(e){var t=!1;return xt.each(Dt.DynamicLoadAddonFuns,(function(r){xt.isFunction(r)&&(r(e),t=!0)})),!sw.bFullEdition&&e.__addon&&delete e.__addon.Camera,t};var nJ=s((function e(r,n,i){t(this,e),this.Url=r,this.Width=n,this.Height=i})),iJ=function(){return s((function e(r){t(this,e),this._stwain=r,this._ImgManager=r._ImgManager}),[{key:"Print",value:function(){var e=this;if(e.count()<=0)return!1;var t,r=[];for(t=0;t<e.count();t++)r.push(t);return e.PrintEx(r)}},{key:"PrintCurrentImage",value:function(){var e,t,r,n=this;if(!((e=n._ImgManager.getCurrentImageIndex())<0))return-1==(r=n._ImgManager.convertClientIndexToServerId(e))?(Gw(n),!1):(t=dR.getImageUrl(n._ImgManager.getBaseUrl,r,-1,-1),n.__PrintInner(t,r,e))}},{key:"PrintEx",value:function(e){var t=this;if(!(t.count()<=0)){var r=[];return Wt.DWT.ConnectWithSocket?t.__GetPrintUrlforSocket(e,r):t.__GetPrintUrlforHttp(e,r),!0}}},{key:"__PrintInner",value:function(e,t,r){var n=this,i=n._ImgManager.getImageIdMap(t),o=[];if(!i)return!1;var a=xt.clone(i),s=a.width;(xt.isUndefined(a.width)||a.width<=0)&&(a.width=n.getImageWidthFromServer(r));var u=a.height;(xt.isUndefined(a.height)||a.height<=0)&&(a.height=n.getImageHeightFromServer(r));var c=new nJ(e,a.width,a.height);return o.push(c),a.width=s,a.height=u,dR.print(o),!0}},{key:"__GetPrintUrl",value:function(e,t,r){var n,i,o=this,a=0,s=0;return(n=o._ImgManager.getImageIdMap(t))&&(!n.width||n.width<=0?n.width=o.getImageWidthFromServer(r):a=n.width,!n.height||n.height<=0?n.height=o.getImageHeightFromServer(r):s=n.height,i=new nJ(e,n.width,n.height),n.width=a,n.height=s),i}},{key:"__GetPrintUrlforHttp",value:(e=GE(m.mark((function e(t,r){var n,i,o,a,s,u,c,l,d,f;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this,i=0;case 2:if(!(i<t.length)){e.next=23;break}if(o=t[i],-1==(a=n._ImgManager.convertClientIndexToServerId(o))){e.next=20;break}if(s=void 0,!(Wt.navInfoSync.bMac&&Wt.navInfoSync.bSafari||Wt.navInfoSync.bFirefox)){e.next=17;break}if(!(u=n._stwain._ImgManager.getImageIdMap(a))){e.next=17;break}if(!(c=u.uuid)||-1==c){e.next=17;break}return e.next=14,n._stwain.Viewer.webViewer.myDvs.getImageData(c,{type:"blob"});case 14:l=e.sent,d=window.URL||window.webkitURL,s=d.createObjectURL(l);case 17:s||(s=dR.getImageUrl(n._ImgManager.getBaseUrl,a,-1,-1)),f=n.__GetPrintUrl(s,a,o),r.push(f);case 20:i++,e.next=2;break;case 23:dR.print(r);case 24:case"end":return e.stop()}}),e,this)}))),function(t,r){return e.apply(this,arguments)})},{key:"__GetPrintUrlforSocket",value:function(e,t){var r,n=this,i=Wb.Promise.resolve(0),o=0;return xt.each(e,(function(a){i=i.then((function(){var i=n._ImgManager.convertClientIndexToServerId(a);-1!=i&&n._ImgManager.getImageData(a).then((function(s){if(o++,!s){var u={};return pw(u),void GC(u._errorString)}r=vR(s.oriData)?URL.createObjectURL(new Blob([s.oriData])):s.oriData instanceof Blob?URL.createObjectURL(s.oriData):s.oriData;var c=n.__GetPrintUrl(r,i,a);t.push(c),e.length==o&&dR.print(t)}))}))})),!0}},{key:"__GetPrintUrlforMobileEx",value:function(e,t){var r,n=this,i=Wb.Promise.resolve(0),o=0;return xt.each(e,(function(a){i=i.then((function(){var i=n._ImgManager.convertClientIndexToServerId(a);-1!=i&&n._ImgManager.getImageData(a).then((function(s){if(o++,!s){var u={};return pw(u),void GC(u._errorString)}r=vR(s.oriData)?URL.createObjectURL(new Blob([s.oriData])):s.oriData instanceof Blob?URL.createObjectURL(s.oriData):s.oriData;var c=n.__GetPrintUrl(r,i,a);t.push(c),e.length==o&&dR.print(t)}))}))})),!0}},{key:"count",value:function(){return this._ImgManager.count()}},{key:"getImageHeightFromServer",value:function(e){var t,r,n,i=this,o=1*e;return t=i.count(),o<0||o>t?0:(n=i._ImgManager.convertClientIndexToServerId(o),(r=i._ImgManager.getImageIdMap(n))&&r.imageHeight?r.imageHeight:i._stwain.GetImageHeight(o))}},{key:"getImageWidthFromServer",value:function(e){var t,r,n,i=this,o=1*e;return t=i.count(),o<0||o>t?0:(n=i._ImgManager.convertClientIndexToServerId(o),(r=i._ImgManager.getImageIdMap(n))&&r.imageWidth?r.imageWidth:i._stwain.GetImageWidth(o))}}]);var e}();function oJ(e,t){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.add(e)}function aJ(e,t,r){return t.has(e),r}Dt.detect.viewerScriptLoaded=Bb;var sJ=new WeakSet,uJ=new WeakSet,cJ=new WeakSet,lJ=new WeakSet,dJ=new WeakSet,fJ=new WeakSet,hJ=new WeakSet,gJ=function(e){function r(e){var n,i,o,a,s;return t(this,r),i=this,a=[e],o=QE(o=r),oJ(n=YE(i,function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(QG){return!1}}()?Reflect.construct(o,a||[],QE(i).constructor):o.apply(i,a)),hJ),oJ(n,fJ),oJ(n,dJ),oJ(n,lJ),oJ(n,cJ),oJ(n,uJ),oJ(n,sJ),n._ImgManager=new $H(n,n._imageBufferWrapper),n._imageBufferWrapper=n._ImgManager,n._ImagePrint=new iJ(n),s=e||{},n._config=s,n._destroying=Lb,n._iServiceType=oz.TwainService,n.__addon={},n._bNoMask=Lb,n._bNotShowMessage=Lb,n._bSelectedSourceByServer=Lb,n._bKeepAwake=Lb,n._bAx=Lb,s.container&&(n._containerElement=s.container),n.__IfShowCancelDialogWhenImageTransfer=Bb,n._errorCode=0,n._errorString="",n.__bLoadingImage=Lb,n.__bAcquireImageNow=Lb,n.__bOpenFileNow=Lb,n.__defaultSourceName="",n.__sourceCount=0,n._bConnecting=Lb,n.__licenseInfo=void 0,n.__strProductName=Wt.DWT.ProductName,n.__productKey="",n._moduleSize=1048576,n._driverType=lk.TWAIN,n.__maxUploadImageSize=-1,n._bServerPercentDone=Bb,n._bSSL=Y.bSSL,n._bRegistedLoad=!1,n._logLevel=0,n._scaleDownThreshold=0,n._pdfWriteSetting={},n.__serverPlatform=gC.enumUnknown,n._reconnectTimeSpan=sw.LocaleReconnectTimeSpan,n._bRemoteMode||(n.httpFormFields={},n.HTTPPassword="",n.HTTPPort=Dt.detect.ssl?443:80,n.HTTPUserName="",n.__HTTPPostResponseString="",n.__remoteFilename="RemoteFile",n.__httpHeaderMap=Lb,n._b64bit?n._segementUploadThreshold=4294967296:n._segementUploadThreshold=524288e3,n._aryTiffTag=[],n._tiffCompressionType=Wt.DWT.EnumDWT_TIFFCompressionType.TIFF_AUTO,n._jpgQuality=80,n._pdfConvertMode=3,n._pdfOptions={convertMode:TD.CM_AUTO,password:"",renderOptions:{renderAnnotations:!1,resolution:200,maxWidth:0,maxHeight:0,renderGrayscale:!1}}),function(e){var t=e;t._bRemoteMode||(Wj(t,"ProductKey",{get:function(){return Wt.DWT.ProductKey},set:function(e){return xt.isString(e)?(t._resetErr(),!!t._isValid()&&t._setProductKey(e,!1)):(_w(t),Lb)}}),Wj(t,"ProductName",{get:function(){return t.__strProductName}}),Wj(t,"VersionInfo",{get:function(){return zC.JSVersion}}),Wj(t,"DefaultSourceName",{get:function(){var e=t._getDefaultDevice();return e?e.displayName:""}}),Wj(t,"ImageCaptureDriverType",{get:function(){return t._resetErr(),t._isValid()?t._driverType:0},set:function(e){var r=!1,n=!1,i=!1;if(t._bRemoteMode?t.__serverPlatform==gC.enumWindow?i=!0:t.__serverPlatform==gC.enumLinux?n=!0:t.__serverPlatform==gC.enumMac&&(r=!0):(r=Y.bMac,n=Y.bLinux,i=Y.bWin),t._resetErr(),!t._isValid())return!1;if(""!==e){var o=1*e,a=!1;if(o<lk.TWAIN||o>lk.TWAIN64)return Yw(t),Lb;if(i){if(o===lk.TWAIN_AND_TWAIN64)t._b64bit&&(t._driverType=o);else if(o!=lk.TWAIN&&o!=lk.TWAIN64)return Yw(t),Lb;t._b64bit||(o=lk.TWAIN),t._driverType=o,a=!0}else if(n)o=lk.SANE,t._driverType=o,a=!0;else if(r){if(o===lk.TWAIN_AND_ICA);else if(o!=lk.ICA&&o!=lk.TWAIN&&o!=lk.TWAIN64)return Yw(t),Lb;t._driverType=o,a=!0}return a&&(t._curDevice=null,t.__devices=null),!0}return Yw(t),Lb}}),Wj(t,"HTTPPostResponseString",{get:function(){return t._resetErr(),t._isValid()&&t.__HTTPPostResponseString?t.__HTTPPostResponseString:""}}),Wj(t,"IfAppendImage",{get:function(){return t._resetErr(),!!t._isValid()&&t.__IfAppendImage},set:function(e){return t._resetErr(),!!t._isValid()&&(xt.isBoolean(e)?t.__IfAppendImage=e:(_w(t),Lb))}}),Wj(t,"FTPPort",{get:function(){return t._resetErr(),t._isValid()?t._innerFun("FTPPort"):0},set:function(e){if(t._resetErr(),!t._isValid())return!1;if(""!==e){var r=1*e;return t._innerFun("FTPPort",mR(r))}}}),Wj(t,"JPEGQuality",{get:function(){return t._resetErr(),t._isValid()?t._innerFun("JPEGQuality"):0},set:function(e){var r=1*e;return r>=100?r=100:r<0&&(r=0),t._resetErr(),!!t._isValid()&&t._innerFun("JPEGQuality",mR(r))}}),AK(t,"TIFFCompressionType",CK,wK),AK(t,"BufferMemoryLimit",CK,wK),Wj(t,"LogLevel",{get:function(){return t._resetErr(),t._isValid()?t._innerFun("LogLevel"):0},set:function(e){if(t._resetErr(),!t._isValid())return!1;var r=1*e;return t._logLevel=r,JK.logLevel=t._logLevel,t._innerFun("LogLevel",mR(r))}}),Wj(t,"HttpContentTypeFieldValue",{get:function(){return t._resetErr(),t._isValid()?t._strHttpContentTypeFieldValue:""},set:function(e){return t._resetErr(),!!t._isValid()&&(t._strHttpContentTypeFieldValue=e,e)}}),Wj(t,"BrokerProcessType",{get:function(){return t._resetErr(),t._isValid()?1:0},set:function(e){return t._resetErr(),!!t._isValid()}}),Wj(t,"BorderStyle",{get:function(){return t._resetErr(),!!t._isValid()&&0},set:function(e){return t._resetErr(),t._isValid(),!1}}),Wj(t,"HttpFieldNameOfUploadedImage",{get:function(){return t._resetErr(),t._isValid()?t.__remoteFilename:""},set:function(e){return t._resetErr(),t._isValid()?t.__remoteFilename=e:""}}),Wj(t,"style",{get:function(){return t._isValid()?t.__style:""}}),Wj(t,"ScaleDownThreshold",{get:function(){return t._resetErr(),t._isValid()?t._scaleDownThreshold:0},set:function(e){var r=1*e;return!xt.isNumber(r)||isNaN(r)?(_w(self),Lb):(t._resetErr(),!!t._isValid()&&(t._scaleDownThreshold=e))}}),Wj(t,"CurrentImageIndexInBuffer",{get:function(){return t._isValid()&&t._ImgManager?t._ImgManager.getCurrentImageIndex():0},set:function(e){var r=1*e;return t._resetErr(),!!t._isValid()&&(r>=0&&r<t._ImgManager.count()&&(t._ImgManager.setSelectedClientIndexArray([r]),t._isBindViewer()&&Oj.__innerRefreshFromUIView(t,t._ImgManager.getCurrentImageIndex())),!0)}}),Wj(t,"SelectedImagesIndices",{get:function(){return t._resetErr(),t._isValid()?t._ImgManager.count()<=0?[]:t._ImgManager.getSelectedClientIndexArray():[]}}),Wj(t,"MaxImagesInBuffer",{get:function(){return t._resetErr(),t._isValid()?t.__maxImagesInBuffer:0},set:function(e){var r=1*e;return t._resetErr(),!!t._isValid()&&(r>0&&r<32768?t.__maxImagesInBuffer=r:fw(t,-1010,"Data parameter out of supported range."),t.__maxImagesInBuffer)}}),Wj(t,"IfSSL",{get:function(){return t._bSSL},set:function(e){return t._bSSL=e,t._innerFun("IfSSL",mR(e)),!0}}),AK(t,"IfAllowLocalCache",CK,EK),Wj(t,"UseLocalService",{get:function(){return!0}}),Wj(t,"PDFCompressionType",{get:function(){return t._resetErr(),!!t._isValid()&&t._innerFun("PDFCompressionType")},set:function(e){var r=1*e;return r==Wt.DWT.EnumDWT_PDFCompressionType.PDF_FAX3&&(r=Wt.DWT.EnumDWT_PDFCompressionType.PDF_FAX4),t._resetErr(),!!t._isValid()&&t._innerFun("PDFCompressionType",mR(r))}}),t._setProductKey=function(e,r,n,i){var o=!0,a=e,s=function(e){e||(t.__licenseInfo=void 0);var r=!0;return i||(r=sP.checkProductKey(t,{Core:!0})),xt.isFunction(n)&&n(),r};if(t._resetErr(),!t._isValid())return!1;if(a=xt.isString(a)?xt.trim(a):"",Wt.DWT.ProductKey=a,""==a)o=!1,s();else{sP.reparseProductKey();var u=Wt.DWT.licenseException;if(0!=u.code)return t.__licenseInfo=void 0,t._errorCode=u.code,t._errorString=u.message,xt.isFunction(n)&&n(),!1;t._innerFunRaw("ProductKey",mR(a),r,!1,!1,(function(e){var n;n=xt.isArray(e)?e[0]:e,xt.isArray(e)&&e.length>=3&&"1"===e[1]&&xt.isFunction(Wt.DWT.ShowMessage)&&Wt.DWT.ShowMessage(e[2],{width:510,height:272,headerStyle:1,seconds:10}),r||(o=n),t.__licenseInfo=void 0,t.GetLicenseInfo((function(){t._setConvertMode(t._pdfConvertMode),s(!0)}),s)}),(function(){r||(o=!1),s()}))}return o},rJ(t,["ProxyServer"]),rJ(t,["CapValueString","CapDescription","FTPPassword","FTPUserName","PDFAuthor","PDFCreationDate","PDFCreator","PDFKeywords","PDFModifiedDate","PDFProducer","PDFSubject","PDFTitle","PDFVersion"]),tJ(t,["Manufacturer","ProductFamily","ImageBitsPerPixel","ImageLength","ImageWidth","ImageXResolution","ImageYResolution"]),tJ(t,["BlankImageCurrentStdDev","CapDefaultIndex","CapDefaultValue","DataSourceStatus","Duplex","PendingXfers","ImageLayoutDocumentNumber","ImageLayoutFrameBottom","ImageLayoutFrameLeft","ImageLayoutFrameNumber","ImageLayoutFrameRight","ImageLayoutFrameTop","ImageLayoutPageNumber","ImagePixelType","MagData","MagType","IfFeederLoaded","IfPaperDetectable","IfUIControllable"]),$K(t,["AllowPluginAuthentication","IfModalUI","IfScanInNewThread","_AutoCropMethod","IfSortBySelectionOrder"]),$K(t,["IfDisableSourceAfterAcquire","IfDuplexEnabled","IfFeederEnabled","IfPASVMode","IfAutoBright","IfAutoDiscardBlankpages","IfAutoFeed","IfAutomaticBorderDetection","IfAutomaticDeskew","IfAutoScan","IfShowIndicator","IfUseTwainDSM","IfTiffMultiPage"]),eJ(t,["MaxInternetTransferThreads"]),eJ(t,["BlankImageMaxStdDev","BlankImageThreshold","BitDepth","Brightness","PageSize","PixelType","Resolution","Capability","CapCurrentIndex","CapCurrentValue","CapMaxValue","CapMinValue","CapNumItems","CapStepSize","CapType","CapValue","CapValueType","Contrast","PixelFlavor","TransferMode","Unit","XferCount"]),ZK(t,["AsyncMode","EnableInteractiveZoom","IfThrowException","ImageEditorIfEnableEnumerator","ImageEditorIfReadonly","ImageEditorIfModal","ImageEditorWindowTitle","IfShowPrintUI","VScrollBar"],EK),ZK(t,["IfOpenImageWithGDIPlus"]))}(n),function(e){Wj(e,"Width",{get:function(){return e._resetErr(),e._isValid()?e._isNoViewer()?(e._nouiNotSupport("Width"),""):e._UIView.GetWidth():""},set:function(t){return e._resetErr(),!!e._isValid()&&(e._isNoViewer()?e._nouiNotSupport("Width"):e._UIView.SetWidth(t))}}),Wj(e,"Height",{get:function(){return e._resetErr(),e._isValid()?e._isNoViewer()?(e._nouiNotSupport("Height"),""):e._UIView.GetHeight():""},set:function(t){return e._resetErr(),!!e._isValid()&&(e._isNoViewer()?e._nouiNotSupport("Height"):e._UIView.SetHeight(t))}}),Wj(e,"AllowMultiSelect",{get:function(){return e._resetErr(),e._isValid()?e._isNoViewer()?e._nouiNotSupport("AllowMultiSelect"):e._UIView.GetAllowMultiSelect():""},set:function(t){return e._resetErr(),!!e._isValid()&&(e._isNoViewer()?e._nouiNotSupport("AllowMultiSelect"):void e._UIView.SetAllowMultiSelect(t))}}),Wj(e,"BackgroundColor",{get:function(){return e._resetErr(),e._isValid()?e._isNoViewer()?(e._nouiNotSupport("BackgroundColor"),""):e._UIView.GetBackgroundColor():""},set:function(t){return e._resetErr(),!!e._isValid()&&(e._isNoViewer()?e._nouiNotSupport("BackgroundColor"):e._UIView.SetBackgroundColor(t))}}),Wj(e,"BackgroundFillColor",{get:function(){if(e._resetErr(),!e._isValid())return"";if(e._isNoViewer())return e._nouiNotSupport("BackgroundFillColor"),"";var t=e._innerFun("BackgroundFillColor");return Nb.BGR2RGB(t)},set:function(t){if(e._resetErr(),!e._isValid())return!1;if(e._isNoViewer())return e._nouiNotSupport("BackgroundFillColor");var r,n=1*t;return!xt.isNumber(n)||xt.isNaN(n)?(_w(e),Lb):(r=Nb.RGB2BGR(n),e._innerFun("BackgroundFillColor",mR(r)))}}),Wj(e,"FitWindowType",{get:function(){return e._resetErr(),!!e._isValid()&&(e._isNoViewer()?(e._nouiNotSupport("FitWindowType"),0):e._UIView.GetFitWindowType())},set:function(t){if(e._resetErr(),!e._isValid())return!1;if(e._isNoViewer())return e._nouiNotSupport("FitWindowType");var r=1*t;return e._UIView.SetFitWindowType(r)}}),Wj(e,"IfFitWindow",{get:function(){return e._resetErr(),!!e._isValid()&&(e._isNoViewer()?e._nouiNotSupport("IfFitWindow"):e._UIView.GetIfFitWindow())},set:function(t){return e._resetErr(),!!e._isValid()&&(e._isNoViewer()?e._nouiNotSupport("IfFitWindow"):t?e._UIView.SetIfFitWindow(!0):e._UIView.SetIfFitWindow(!1))}}),Wj(e,"ImageMargin",{get:function(){return e._resetErr(),e._isValid()?e._isNoViewer()?(e._nouiNotSupport("ImageMargin"),0):e._UIView.GetImageMargin():0},set:function(t){if(e._resetErr(),!e._isValid())return!1;if(e._isNoViewer())return e._nouiNotSupport("ImageMargin");var r=parseInt(t);return!isNaN(r)&&e._UIView.SetImageMargin(r)}}),Wj(e,"MouseX",{get:function(){return e._resetErr(),e._isValid()?e._isNoViewer()?(e._nouiNotSupport("MouseX"),0):e.__MouseX:0}}),Wj(e,"MouseY",{get:function(){return e._resetErr(),e._isValid()?e._isNoViewer()?(e._nouiNotSupport("MouseY"),0):e.__MouseY:0}}),Wj(e,"SelectionImageBorderColor",{get:function(){return e._resetErr(),e._isValid()?e._isNoViewer()?(e._nouiNotSupport("SelectionImageBorderColor"),""):e._UIView.GetSelectionImageBorderColor():""},set:function(t){return e._resetErr(),!!e._isValid()&&(e._isNoViewer()?e._nouiNotSupport("SelectionImageBorderColor"):e._UIView.SetSelectionImageBorderColor(t))}}),Wj(e,"Zoom",{get:function(){return e._resetErr(),e._isValid()?e._isNoViewer()?(e._nouiNotSupport("Zoom"),0):e._UIView.GetZoom():0},set:function(t){return e._resetErr(),!!e._isValid()&&(e._isNoViewer()?e._nouiNotSupport("Zoom"):e._UIView.SetZoom(t))}}),Wj(e,"MouseShape",{get:function(){return e._resetErr(),!!e._isValid()&&(e._isNoViewer()?e._nouiNotSupport("MouseShape"):e._UIView.GetMouseShape())},set:function(t){return e._resetErr(),!!e._isValid()&&(e._isNoViewer()?e._nouiNotSupport("MouseShape"):e._UIView.SetMouseShape(t))}}),Wj(e,"SelectionRectAspectRatio",{get:function(){return e._resetErr(),e._isValid()?e._isNoViewer()?(e._nouiNotSupport("SelectionRectAspectRatio"),0):e._UIView.GetSelectionRectAspectRatio():0},set:function(t){if(e._resetErr(),!e._isValid())return!1;if(e._isNoViewer())return e._nouiNotSupport("SelectionRectAspectRatio");var r=parseFloat(t);return r>=0&&(e._UIView.SetSelectionRectAspectRatio(r),!0)}}),Wj(e,"ShowPageNumber",{get:function(){return e._resetErr(),!!e._isValid()&&(e._isNoViewer()?e._nouiNotSupport("ShowPageNumber"):e._UIView.GetShowPageNumber())},set:function(t){return e._resetErr(),!!e._isValid()&&(e._isNoViewer()?e._nouiNotSupport("ShowPageNumber"):e._UIView.SetShowPageNumber(t))}}),Wj(e,"IfAutoScroll",{get:function(){return e._resetErr(),!!e._isValid()&&(e._isNoViewer()?e._nouiNotSupport("IfAutoScroll"):e._UIView.GetIfAutoScroll())},set:function(t){return e._resetErr(),!!e._isValid()&&(e._isNoViewer()?e._nouiNotSupport("IfAutoScroll"):e._UIView.SetIfAutoScroll(t))}})}(n),n._innerInitEvents(s),n}return qE(r,e),s(r,[{key:"GetImageDataAsync",value:function(e){return this._ImgManager.getImageData(e)}},{key:"SetCustomDataAsync",value:function(e,t){return this._ImgManager.setCustomData(e,t)}},{key:"style",get:function(){return this.__style}},{key:"GetSourceNamesAsync",value:(i=GE(m.mark((function e(t){var r;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((r=this)._resetErr(),r._isValid()){e.next=4;break}throw{code:r._errorCode,message:r._errorString};case 4:return DR("GetSourceNamesAsync",r),e.prev=5,e.next=8,r._getSourceCountAsync(r._driverType);case 8:e.next=13;break;case 10:throw e.prev=10,e.t0=e.catch(5),e.t0;case 13:return e.prev=13,PR("GetSourceNamesAsync"),e.finish(13);case 16:if(!t){e.next=20;break}return e.abrupt("return",aJ(r,sJ,pJ).call(r));case 20:return e.abrupt("return",aJ(r,uJ,_J).call(r));case 21:case"end":return e.stop()}}),e,this,[[5,10,13,16]])}))),function(e){return i.apply(this,arguments)})},{key:"SelectSourceAsync",value:function(e){var t;return t=vH.dialogText.selectSource,this._selectSourceAsync("SelectSourceAsync",e,t)}},{key:"SelectSourceByIndexAsync",value:function(e){return this._selectSourceByIndexAsync("SelectSourceByIndex",e)}},{key:"OpenSourceAsync",value:function(){return this._openSourceAsync("OpenSourceAsync")}},{key:"CloseSourceAsync",value:function(){return this._closeSourceAsync("CloseSourceAsync")}},{key:"OpenSourceManagerAsync",value:function(){var e=this;return e._resetErr(),e._isValid()?e._innerFunV2("OpenSourceManager"):Dt.Promise.reject({code:e._errorCode,message:e._errorString})}},{key:"CloseSourceManagerAsync",value:function(){var e=this;return e._resetErr(),e._isValid()?e._innerFunV2("CloseSourceManager"):Dt.Promise.reject({code:e._errorCode,message:e._errorString})}},{key:"AcquireImage",value:function(e,t,r){var n,i=this,o=null,a=null;return i._resetErr(),!!i._isValid()&&(xt.isUndefined(r)&&(xt.isFunction(e)&&xt.isFunction(t)||xt.isFunction(e)&&xt.isUndefined(t)||xt.isFunction(e)&&null==t||null==e&&xt.isFunction(t))?(n={},xt.isFunction(e)&&(o=e),xt.isFunction(t)&&(a=function(e){e&&e.code&&(i._errorCode=e.code,i._errorString=e.message),t(i._errorCode,i._errorString)})):(n=xt.isUndefined(e)||null==e?{}:xt.clone(e),xt.isFunction(t)&&(o=function(){t(n)}),xt.isFunction(r)&&(a=function(e){e&&e.code&&(i._errorCode=e.code,i._errorString=e.message),r(n,i._errorCode,i._errorString)})),o||(o=function(){}),a||(a=function(e){e&&e.code&&(i._errorCode=e.code,i._errorString=e.message)}),i.AcquireImageAsync(n).then(o,a),!Xx.isServerInvalid(i))}},{key:"GetDevicesAsync",value:function(e,t,r){return this._getDevicesAsync("GetDevicesAsync",e,t,r)}},{key:"SelectDeviceAsync",value:function(e,t){var r=this;return r._resetErr(),r._isValid()?this._selectDeviceAsync("SelectDeviceAsync",e,t):Dt.Promise.reject({code:r._errorCode,message:r._errorString})}},{key:"AcquireImageAsync",value:function(e){return Dk(QE(r.prototype),"_acquireImage",this).call(this,this._curDevice,e)}},{key:"ImageIDToIndex",value:function(e){return this._uidFromServer2index(e)}},{key:"IndexToImageID",value:function(e){return this._index2uidFromServer(e)}},{key:"RemoveImage",value:function(e){return this._removeImage("RemoveImage",e)}},{key:"_innerGetSourceNamesSync",value:function(e){var t=this;return t._getSourceCountSync(),e?aJ(t,sJ,pJ).call(t):aJ(t,uJ,_J).call(t)}},{key:"getCapabilities",value:function(e,t,r){var n,i,o,a=this;if(Dt.isFunction(e)?(i=e,o=t):(n=e,i=t,o=r),!xt.isUndefined(n)){if(!xt.isArray(n))return Zw(a),void(xt.isFunction(o)&&o(a._errorCode,a._getErrorString()));if(xt.isArray(n)&&n.indexOf(null)>=0)return Zw(a),void(xt.isFunction(o)&&o(a._errorCode,a._getErrorString()));if(xt.isString(n)&&0==n.trim().length)return Zw(a),void(xt.isFunction(o)&&o(a._errorCode,a._getErrorString()))}return this._dwtGetCapabilities(n,i,o)}},{key:"setCapabilities",value:function(e,t,r){return this._dwtSetCapabilities(e,t,r)}},{key:"CancelAllPendingTransfers",value:function(){return this._resetErr(),!!this._isValid()&&this._innerFun("CancelAllPendingTransfers")}},{key:"CloseSource",value:function(){var e=this;if(e._resetErr(),!e._isValid())return!1;var t=e._innerFun("CloseSource");return t&&(e._curDevice=null),t}},{key:"CloseSourceManager",value:function(){var e=this;return e._resetErr(),!!e._isValid()&&e._innerFun("CloseSourceManager")}},{key:"SelectDevice",value:function(e,t){var r,n=this;if(e&&e.deviceType,n._resetErr(),Wt.DWT.ConnectWithSocket)return fw(n,-2400,"SelectDevice doesn't work under current settings."),!1;var i,o=null===(r=this._dmService.attrs)||void 0===r?void 0:r.UUID;if(o)if((null===(i=e.serviceInfo.attrs)||void 0===i?void 0:i.UUID)==o);else{var a,s=(null===(a=e.serviceInfo.attrs)||void 0===a?void 0:a.url)||e.serviceInfo.server;if(!(s&&s.indexOf(o)>-1))return cE(n),!1}var u=!1;try{(u=aJ(this,cJ,mJ).call(this,e.strDevice,t))&&(this._curDevice=e,this._bSelectedSourceByServer=!1)}catch(f){u=!1,this._errorCode=rw.CommonError,f&&f.message&&(this._errorString=f.message)}return u}},{key:"DisableSource",value:function(){var e=this;return e._resetErr(),!!e._isValid()&&e._innerFun("DisableSource")}},{key:"FeedPage",value:function(){var e=this;return e._resetErr(),!!e._isValid()&&e._innerFun("FeedPage")}},{key:"GetDeviceType",value:function(){var e=this;return e._resetErr(),!!e._isValid()&&e._innerFun("GetDeviceType")}},{key:"GetSourceNameItems",value:function(e){var t=this;return t._resetErr(),!!t._isValid()&&(t.__sourceCount<0&&(t.__sourceCount=0),e<t.__sourceCount&&e>=0?t._getSourceNameByIndex(e):"")}},{key:"SourceNameItems",value:function(e){var t=this;return t._resetErr(),!!t._isValid()&&t.GetSourceNameItems(e)}},{key:"GetSourceNames",value:function(e){return this._innerGetSourceNamesSync(e)}},{key:"getSourceCount",value:function(e){return this._getSourceCountAsync(e)}},{key:"GetSourceCountAsync",value:function(e){return this._getSourceCountAsync(e)}},{key:"GetSourceType",value:function(e){var t,r,n,i=this,o=parseInt(e);return i._resetErr(),isNaN(o)?(Zw(i),!1):(null==i.__devices&&i.GetSourceNames(!1),o>=i.__devices.length||o<0?(Gw(i),!1):(t=i.__devices[o].deviceType,r=lk.TWAIN,(n=t&TR)==fR.TWAINSCANNER||n==fR.WIATWAINSCANNER||(n==fR.TWAINX64SCANNER?r=lk.TWAIN64:n==fR.ICASCANNER?r=lk.ICA:n==fR.SANESCANNER?r=lk.SANE:(n&fR.TWAINX64SCANNER)==fR.TWAINX64SCANNER?(n&fR.TWAINSCANNER)!=fR.TWAINSCANNER&&(n&fR.WIATWAINSCANNER)!=fR.WIATWAINSCANNER||(r=lk.TWAIN_AND_TWAIN64):(n&fR.ICASCANNER)==fR.ICASCANNER&&((n&fR.TWAINSCANNER)!=fR.TWAINSCANNER&&(n&fR.WIATWAINSCANNER)!=fR.WIATWAINSCANNER||(r=lk.TWAIN_AND_ICA))),r))}},{key:"OpenSource",value:function(){var e=this;return e._resetErr(),!!e._isValid()&&(e._bRemoteMode?(fw(e,-2610,"OpenSource is not supported when Object is created by CreateRemoteScanObjectAsync. Please use OpenSourceAsync instead."),!1):e._innerFun("OpenSource"))}},{key:"OpenSourceManager",value:function(){var e=this;return e._resetErr(),!!e._isValid()&&e._innerFun("OpenSourceManager")}},{key:"ResetImageLayout",value:function(){var e=this;return e._resetErr(),!!e._isValid()&&e._innerFun("ResetImageLayout")}},{key:"RewindPage",value:function(){var e=this;return e._resetErr(),!!e._isValid()&&e._innerFun("RewindPage")}},{key:"SelectSource",value:function(e,t){var r=this,n=!1;if(xt.isFunction(e)&&(n=!0),r._resetErr(),!r._isValid())return!!n&&void 0;var i=lk.TWAIN;if(!n){if(r._bRemoteMode)return fw(r,-2438,"SelectSource cannot be used synchronously when Object is created by CreateRemoteScanObjectAsync. Please use SelectSourceAsync instead."),!1;if(r._driverType==lk.TWAIN_AND_TWAIN64)return function(e){fw(e,-2429,"The method SelectSource() must be invoked asynchronously (i.e. with callback functions) when ImageCaptureDriverType is set to TWAIN_AND_ICA or TWAIN_AND_TWAIN64.")}(r),!1;r._driverType!=lk.ICA&&r._driverType!=lk.SANE&&r._driverType!=lk.TWAIN64||(i=r._driverType);var o=Y.bMac,a=Y.bLinux,s=_k(i,Y.bWin,a,o,Y.bAndroid);return r._bSelectedSourceByServer=!0,r._curDevice=null,r._innerFun("SelectSource",mR(s))}r._driverType!=lk.ICA&&r._driverType!=lk.SANE&&r._driverType!=lk.TWAIN64&&r._driverType!=lk.TWAIN_AND_TWAIN64||(i=r._driverType);var u=Y.bMac,c=Y.bLinux,l=_k(i,Y.bWin,c,u,Y.bAndroid);r.SelectSourceAsync(l).then((function(){xt.isFunction(e)&&e()}),(function(e){e&&e.code&&(r._errorCode=e.code,r._errorString=e.message),xt.isFunction(t)&&t(r._errorCode,r._getErrorString())}))}},{key:"GetSourceTypeAsync",value:function(e){var t=this,r=1*e;return t._resetErr(),t._isValid()?Dt.Promise.resolve(t.GetSourceType(r)):Dt.Promise.reject({code:t._errorCode,message:t._errorString})}},{key:"SetFileXferInfo",value:function(e,t){var r,n,i=this;return i._resetErr(),!!i._isValid()&&(r=Y.bFileSystem?e.replace(/<%/g,"<%25"):e,n=pk.replaceLocalFilename(r),i._innerFun("SetFileXferInfo",mR(n,t)))}},{key:"SetImageLayout",value:function(e,t,r,n){var i=this;return i._resetErr(),!!i._isValid()&&i._innerFun("SetImageLayout",mR(e,t,r,n))}},{key:"CapGet",value:function(){return this._resetErr(),!!this._isValid()&&this._innerFun("CapGet")}},{key:"CapGetCurrent",value:function(){return this._resetErr(),!!this._isValid()&&this._innerFun("CapGetCurrent")}},{key:"CapGetDefault",value:function(){return this._resetErr(),!!this._isValid()&&this._innerFun("CapGetDefault")}},{key:"CapGetFrameBottom",value:function(e){return this._resetErr(),!!this._isValid()&&this._innerFun("CapGetFrameBottom",mR(e))}},{key:"CapGetFrameLeft",value:function(e){return this._resetErr(),!!this._isValid()&&this._innerFun("CapGetFrameLeft",mR(e))}},{key:"CapGetFrameRight",value:function(e){return this._resetErr(),!!this._isValid()&&this._innerFun("CapGetFrameRight",mR(e))}},{key:"CapGetFrameTop",value:function(e){return this._resetErr(),!!this._isValid()&&this._innerFun("CapGetFrameTop",mR(e))}},{key:"CapGetHelp",value:function(){return this._resetErr(),!!this._isValid()&&this._innerFun("CapGetHelp")}},{key:"CapGetLabel",value:function(){return this._resetErr(),!!this._isValid()&&this._innerFun("CapGetLabel")}},{key:"CapGetLabels",value:function(){return this._resetErr(),!!this._isValid()&&this._innerFun("CapGetLabels")}},{key:"CapIfSupported",value:function(e){return this._resetErr(),!!this._isValid()&&this._innerFun("CapIfSupported",mR(e))}},{key:"CapReset",value:function(){return this._resetErr(),!!this._isValid()&&this._innerFun("CapReset")}},{key:"CapSet",value:function(){return this._resetErr(),!!this._isValid()&&this._innerFun("CapSet")}},{key:"CapSetFrame",value:function(e,t,r,n,i){return this._resetErr(),!!this._isValid()&&this._innerFun("CapSetFrame",mR(e,t,r,n,i))}},{key:"GetCapItems",value:function(e){return this._resetErr(),!!this._isValid()&&this._innerFun("GetCapItems",mR(e))}},{key:"GetCapItemsString",value:function(e){return this._resetErr(),!!this._isValid()&&this._innerFun("GetCapItemsString",mR(e))}},{key:"SetCapItems",value:function(e,t){return this._resetErr(),!!this._isValid()&&this._innerFun("SetCapItems",mR(e,t))}},{key:"SetCapItemsString",value:function(e,t){return this._resetErr(),!!this._isValid()&&this._innerFun("SetCapItemsString",mR(e,t))}},{key:"GenerateURLForUploadData",value:function(e,t,r,n,i){var o=this,a=[];if(t==Wt.DWT.EnumDWT_ImageType.IT_BMP||t==Wt.DWT.EnumDWT_ImageType.IT_JPG||t==Wt.DWT.EnumDWT_ImageType.IT_PNG){if(!xt.isArray(e))return Vw(o),xt.isFunction(n)&&n(o._errorCode,o._getErrorString(),"",e,t),"";if(e.length>1)return Lw(o),xt.isFunction(n)&&n(o._errorCode,o._getErrorString(),"",e,t),"";if(!o._checkIndices(e))return n(o._errorCode,o._getErrorString(),"",e,t),!1;var s=o._ImgManager.convertClientIndexToServerId(e[0]);-1!=s&&a.push(s)}else{if(t!=Wt.DWT.EnumDWT_ImageType.IT_TIF&&t!=Wt.DWT.EnumDWT_ImageType.IT_PDF)return xt.isArray(e)?Hw(o):Vw(o),xt.isFunction(n)&&n(o._errorCode,o._getErrorString(),o.__HTTPPostResponseString,e,t),"";var u,c;if(xt.isArray(e)){if(!o._checkIndices(e))return n(o._errorCode,o._getErrorString(),"",e,t),!1;u=e}else{if(-1!=e)return Vw(o),xt.isFunction(n)&&n(o._errorCode,o._getErrorString(),o.__HTTPPostResponseString,e,t),"";for(u=[],c=0;c<o._ImgManager.count();c++)u.push(c)}xt.each(u,(function(e){var t=o._ImgManager.convertClientIndexToServerId(e);-1!=t&&a.push(t)}))}return xt.isFunction(r)&&xt.isFunction(n)?(o._asyncGenerateURLForUploadData(a,t,i,r,(function(e){n(o._errorCode,o._getErrorString(),o.__HTTPPostResponseString,e,t)})),!0):this._syncGenerateURLForUploadData(a,t,i)}},{key:"_syncGenerateURLForUploadData",value:function(e,t,r){var n,i=this,o=!1,a=ow.managerVersion.join(""),s=r,u=",";xt.isString(s)&&""!=s||(s="",u="");var c=["[",'"dcp","dwasm_'+a,'",',t,',"',e.join(","),'"',u,s,"]"].join("");if((n=this._innerFunRaw("GenerateURLForUploadData",c,!1,!1,!0))&&xt.isArray(n.result)&&n.result.length>1){var l=n.result[0],d=n.result[1];1==l&&(o=["dcp://dwasm_",a,"/file/",d].join(""))}return xt.isArray(e)&&xt.each(e,(function(e){i._ImgManager.convertServerIdToClientIndex(e)})),0==o?(Jw(i),""):o}},{key:"_asyncGenerateURLForUploadData",value:function(e,t,r,n,i){var o=this,a=t,s=function(){if(xt.isFunction(i)){var t=[];xt.isArray(e)&&xt.each(e,(function(e){var r=o._ImgManager.convertServerIdToClientIndex(e);r>-1&&t.push(r)})),i(t)}return""},u=",";if(a==Wt.DWT.EnumDWT_ImageType.IT_BMP||a==Wt.DWT.EnumDWT_ImageType.IT_JPG||a==Wt.DWT.EnumDWT_ImageType.IT_PNG){if(e.length>1)return Lw(o),s(),""}else if(a!=Wt.DWT.EnumDWT_ImageType.IT_TIF&&a!=Wt.DWT.EnumDWT_ImageType.IT_PDF)return Hw(o),s(),"";var c=!1,l=ow.managerVersion.join(""),d=r;xt.isString(d)&&""!=d||(d="",u="");var f=["[",'"dcp","dwasm_'+l,'",',a,',"',e.join(","),'"',u,d,"]"].join("");return this._innerFunRaw("GenerateURLForUploadData",f,!0,!1,!0,(function(r){if(r&&xt.isArray(r.result)&&r.result.length>0)if(1==r.result[0]&&r.result.length>1){var i=r.result[1];c=["dcp://dwasm_",l,"/file/",i].join("")}else void 0!==r.exception&&void 0!==r.description?(o._errorCode=r.exception,o._errorString=r.description):Jw(o);else Jw(o);if(0==c)return s(),"";if(xt.isFunction(n)){var a=[];xt.isArray(e)&&xt.each(e,(function(e){var t=o._ImgManager.convertServerIdToClientIndex(e);t>-1&&a.push(t)})),n(c,a,t)}return c}),s)}},{key:"SelectSourceByIndex",value:function(e){var t=this,r=parseInt(e);if(t._resetErr(),isNaN(r))return Zw(t),!1;if(null==t.__devices&&t.GetSourceNames(!1),r>=t.__devices.length||r<0)return Gw(t),!1;var n=t.__devices[r];return t.SelectDevice(n)}},{key:"EnableSource",value:function(e,t,r){var n=this;return n._resetErr(),!!n._isValid()&&n.AcquireImage(e,t,r)}},{key:"SourceCount",get:function(){return this._getSourceCountSync()}},{key:"CurrentSourceName",get:function(){return this._curDevice?this._curDevice.displayName:""}},{key:"checkStartScanParams",value:function(e,t){var r=this;if(!e)return fw(r,-2381,"scanSetup is invalid."),!1;if(!xt.isUndefined(t.transferMode)&&0!=e.transferMode&&1!=e.transferMode&&2!=e.transferMode)return function(e){fw(e,-2382,"Scanner setup error: Invalid Transfer Mode.")}(r),!1;if(e.transferMode==Wt.DWT.EnumDWT_TransferMode.TWSX_FILE){if(!e.fileXfer)return function(e){fw(e,-2383,"Scanner setup error: fileXfer is invalid.")}(r),!1;if(!xt.isString(e.fileXfer.fileName)||""==e.fileXfer.fileName)return function(e){fw(e,-2384,"Scanner setup error: Invalid fileName in fileXfer.")}(r),!1;if(!xt.isNumber(e.fileXfer.fileFormat)||e.fileXfer.fileFormat<0||e.fileXfer.fileFormat>16)return function(e){fw(e,-2385,"Scanner setup error: Invalid fileFormat in fileXfer.")}(r),!1}if(t){if(!xt.isString(t.type)||""==t.type)return function(e){fw(e,-2387,"Output setup error: Invalid type in outputSetup.")}(r),!1;if(!t.httpParams)return function(e){fw(e,-2386,"Output setup error: Invalid httpParams in outputSetup.")}(r),!1;if(e.transferMode!=Wt.DWT.EnumDWT_TransferMode.TWSX_FILE&&xt.isUndefined(t.format))return function(e){fw(e,-2390,"Output setup error: Invalid format in outputSetup.")}(r),!1;if(!xt.isString(t.httpParams.url)||""==t.httpParams.url)return function(e){fw(e,-2388,"Output setup error: Invalid url in outputSetup.httpParams.")}(r),!1;if(!xt.isString(t.httpParams.fileName)||""==t.httpParams.fileName)return function(e){fw(e,-2389,"Output setup error: Invalid fileName in outputSetup.httpParams.")}(r),!1}return!0}},{key:"startScan",value:function(e){var t,r=this,n=e;if(r._resetErr(),!r._isValid())return!1;if(1==r._startScanFlag)return fw(t={},-2432,"Operation in progress, please try again when the current operation has finished."),Dt.Promise.reject({code:t._errorCode,message:t._errorString});r._startScanFlag=!0,xt.isObject(n)||(n={});var i,o,a,s=!1,u=!1,c=!0,l=!0,d=!0,f=!1,h=n.onFinally,g=[],p=[],_=0,m=1,v=[],y={type:"http",format:Wt.DWT.EnumDWT_ImageType.IT_PDF,reTries:3,useUploader:!1,singlePost:!0,showProgressBar:!0,removeAfterOutput:!0,httpParams:{url:"",headers:{},formFields:{},remoteName:"RemoteFile",fileName:""}},S=xt.clone(n),T=n;if(a=S.funcScanStatus,delete S.funcScanStatus,xt.isFunction(a)?S.bfuncScanStatus=!0:S.bfuncScanStatus=!1,S.outputSetup){var I={pdfSetup:{},tiffSetup:{}};IJ(S.outputSetup,y),o=S.outputSetup,delete S.outputSetup,o.pdfSetup&&(o.format!=Wt.DWT.EnumDWT_ImageType.IT_MULTIPAGE_PDF&&o.format!=Wt.DWT.EnumDWT_ImageType.IT_PDF||xt.mix(I.pdfSetup,o.pdfSetup)),o.tiffSetup&&(o.format!=Wt.DWT.EnumDWT_ImageType.IT_MULTIPAGE_TIF&&o.format!=Wt.DWT.EnumDWT_ImageType.IT_TIF||xt.mix(I.tiffSetup,o.tiffSetup)),o.format!=Wt.DWT.EnumDWT_ImageType.IT_MULTIPAGE_PDF&&o.format!=Wt.DWT.EnumDWT_ImageType.IT_MULTIPAGE_TIF||(o.singlePost=!0),o.httpParams&&xt.isNumber(o.httpParams.threads)&&(m=o.httpParams.threads),s=xt.stringify(I),u=r.checkStartScanParams(S,o)}else(o=y).type="",u=r.checkStartScanParams(S,!1);if(!u)return new Dt.Promise((function(e,t){c&&(t({code:r._errorCode,message:r._getErrorString(),response:""}),c=!1,r._startScanFlag=!1)}));o.funcHttpUploadStatus&&(f=o.funcHttpUploadStatus);var b,C,w,E,A,D,P=r.__remoteFilename,R=r.MaxUploadImageSize,x=r.IfShowProgressBar,k=r.__OnPostTransferAsync,F=r.__OnPostAllTransfers,O=r.__OnHttpUploadStatus,W=r.__insertingIndex,N=r.__IfAppendImage,M=r.httpFormFields,L=r._tiffCompressionType,B=!1,U=o.showProgressBar;if(b=function(e){var t=!0;xt.each(v,(function(e,r){-1==e.st&&(t=!1)})),t?C(e):setTimeout((function(){b(e)}),200)},C=function(e){e.__OnPostTransferAsync=k,e.__OnPostAllTransfers=F,e.__OnHttpUploadStatus=O,e.__remoteFilename=P,e.__maxUploadImageSize=R,e.IfShowProgressBar=x,e.__insertingIndex=W,e.__IfAppendImage=N,e.httpFormFields=M,e._tiffCompressionType=L,Wt.FileUploader&&(Wt.FileUploader.nextLoopTime=600),e._startScanFlag=!1},w=function(e,t,r){l?(t(r),b(e)):setTimeout((function(){w(e,t,r)}),200)},E=function(e,t){B=!0,c&&(c=!1,l||r._innerSendCmd("CancelAllPendingTransfers"),w(r,e,t))},A=function(e,t,r,n){if(xt.isFunction(f)){var i,o=t,a=0;xt.isNumber(n)&&n>0&&(a=n),i={fileName:o,percentage:r,statusCode:a,responseString:e.__HTTPPostResponseString},setTimeout((function(){f(i)}),10)}},r.__HTTPPostResponseString="",r.IfShowProgressBar=U,xt.isNumber(S.insertingIndex)&&S.insertingIndex>-1&&(r.__insertingIndex=S.insertingIndex,r.__IfAppendImage=!1),xt.isFunction(f)?r.__OnHttpUploadStatus=f:r.__OnHttpUploadStatus=!1,o.useUploader&&!Wt.FileUploader)return new Dt.Promise((function(e,t){fw(r,-2380,"Please make sure the Uploader Module has been installed.");var n={code:r._errorCode,message:r._getErrorString(),response:""};l=!0,E(t,n)}));if(i=o.reTries,o.useUploader){if(o.httpParams&&(D=o.httpParams.url),!xt.startsWith(D,"http://")&&!xt.startsWith(D,"https://")){var V=window.location.href,G=V.lastIndexOf("/");V=V.substring(0,G+1),o.httpParams.url=V+D}}else o.httpParams&&(xt.each(o.httpParams.headers,(function(e,t){r.SetHTTPHeader(t,e)})),xt.each(o.httpParams.formFields,(function(e,t){r.SetHTTPFormField(t,e)})));return o.httpParams&&""!==o.httpParams.remoteName&&(r.__remoteFilename=o.httpParams.remoteName),new Dt.Promise((function(e,t){o.useUploader?Wt.FileUploader.Init(0,(function(t){e({uploadManager:t})}),(function(e,n){r._errorCode=e,r._errorString=n;var i={code:e,message:n,response:r.__HTTPPostResponseString};l=!0,E(t,i)})):e({})})).then((function(e){return new Dt.Promise((function(t,n){var u=function e(){(S.transferMode==Wt.DWT.EnumDWT_TransferMode.TWSX_FILE?_==p.length:_==g.length)?(Dt.closeProgress(null,"Scan Upload"),B=!0,t(T),C(r)):setTimeout(e,100)};a&&xt.isFunction(a)&&(r.__OnPreAllTransfersAsync=function(e){a(e)}),r.registerEvent("OnPostTransferAsync",(function(t){var u,c,h,y,T,I,b=o.httpParams&&o.httpParams.url,C=r._uidFromServer2ServerId(t.imageId),w=o.singlePost,D=S.transferMode==Wt.DWT.EnumDWT_TransferMode.TWSX_FILE,P=o.removeAfterOutput,R=0;if(d&&(l=!1,d=!1),D?(R=p.length,p.push(t.path)):(R=g.length,g.push(C)),a&&xt.isFunction(a)){var x={event:"postTransfer",bScanCompleted:!1,result:{currentPageNum:R+1}};setTimeout((function(){a(x)}),10)}if(B)return!1;if("http"==o.type)if(o.httpParams&&(c=Sj(o.httpParams.fileName,R+1),h=Sj(o.httpParams.remoteName,R+1)),w||"http"!=o.type)!w&&o.type;else if(o.httpParams&&xt.isNumber(o.httpParams.maxSizeLimit)&&(r.__maxUploadImageSize=o.httpParams.maxSizeLimit),o.useUploader){U?(Wt.FileUploader.nextLoopTime=300,Dt.showProgress(r,"Scan Upload",r.__IfShowCancelDialogWhenImageTransfer)):Dt.hideProgress(),y=function(e,t){return r.__HTTPPostResponseString=t,A(r,e._fileName,100,200),r._OnPercentDone([0,100,"","http",e._fileName]),U&&Dt.closeProgress(null,"Scan Upload"),!D&&o.removeAfterOutput?setTimeout((function(){r._ImgManager.convertServerIdToClientIndex(C)>-1?aJ(r,fJ,yJ).call(r,C,(function(){_++}),(function(){_++})):_++}),100):_++,!0};var k,F=e.uploadManager;if(T=function(){if(U){var e,t;for(t=D?p.length:g.length,e=0;e<t;e++)Dt.closeProgress(null,"Scan Upload")}!D&&o.removeAfterOutput&&setTimeout((function(){r._ImgManager.convertServerIdToClientIndex(C)>-1&&aJ(r,fJ,yJ).call(r,C)}),100),F.CancelAllUpload();var i={code:r._errorCode,message:r._getErrorString(),response:r.__HTTPPostResponseString};return E(n,i),!1},I=function(e,t,n,i){var o=303;t==TJ.TRANS_SERVICE_ERROR_404?o=404:t==TJ.TRANS_SERVICE_ERROR_500?o=500:t==TJ.TRANS_SERVICE_ERROR_503&&(o=503),r._errorCode=t,r._errorString=n,r.__HTTPPostResponseString=i,A(r,c,100,o),T()},k=function(){r.__HTTPPostResponseString="",A(r,c,100,303),T()},D){var O=F.CreateJob(),W=O.FormField;o.httpParams&&(xt.each(o.httpParams.headers,(function(e,t){O.HttpHeader[t]=e})),xt.each(o.httpParams.formFields,(function(e,t){W.Add(t,e)}))),O.ServerUrl=b,O.bDeleteFile=P,O.reTries=i,o.httpParams&&xt.isNumber(o.httpParams.maxSizeLimit)&&(O.maxSizeLimit=o.httpParams.maxSizeLimit),O._fileName=c,O.SourceValue.Add(t.path,c,h),O.ImageType=S.fileXfer.fileFormat,O.ThreadNum=m,O.OnRunSuccess=y,O.OnRunFailure=I,(U||xt.isFunction(f))&&(O.OnUploadTransferPercentage=function(e,t){t>0&&t<=100&&(r._OnPercentDone([0,t,"","http",e._fileName]),xt.isFunction(f)&&A(r,e._fileName,t,0))},Dt.cancelFrom=fj.Scan,U&&aJ(r,hJ,SJ).call(r,T),r._OnPercentDone([0,-1,QP.Uploading,"http",c]),A(r,c,0,0)),F.Run(O)}else(u=o.format)==Wt.DWT.EnumDWT_ImageType.IT_MULTIPAGE_PDF?u=Wt.DWT.EnumDWT_ImageType.IT_PDF:u==Wt.DWT.EnumDWT_ImageType.IT_MULTIPAGE_TIF&&(u=Wt.DWT.EnumDWT_ImageType.IT_TIF),Dt.cancelFrom=fj.Scan,U&&aJ(r,hJ,SJ).call(r,T),r._OnPercentDone([0,-1,QP.Encoding,"http",c]),r._asyncGenerateURLForUploadData([C],u,s,(function(e){var t=F.CreateJob(),n=t.FormField;o.httpParams&&(xt.each(o.httpParams.headers,(function(e,r){t.HttpHeader[r]=e})),xt.each(o.httpParams.formFields,(function(e,t){n.Add(t,e)}))),t.ServerUrl=b,t.bDeleteFile=P,t.reTries=i,o.httpParams&&xt.isNumber(o.httpParams.maxSizeLimit)&&(t.maxSizeLimit=o.httpParams.maxSizeLimit),t._fileName=c,t.SourceValue.Add(e,c,h),t.ImageType=u,t.ThreadNum=m,t.OnRunSuccess=y,t.OnRunFailure=I,(U||xt.isFunction(f))&&(t.OnUploadTransferPercentage=function(e,t){t>0&&t<=100&&(r._OnPercentDone([0,t,"","http",e._fileName]),xt.isFunction(f)&&A(r,e._fileName,t,0))},r._OnPercentDone([0,-1,QP.Uploading,"http",c]),A(r,c,0,0)),F.Run(t)}),k)}else{var N={id:C,st:-1,bCancel:!1};if(v.push(N),0==R&&(U?Dt.showProgress(r,"Scan Upload",r.__IfShowCancelDialogWhenImageTransfer):Dt.hideProgress()),D)y=function(e){return N.st=0,!D&&o.removeAfterOutput?setTimeout((function(){r._ImgManager.convertServerIdToClientIndex(C)>-1?aJ(r,fJ,yJ).call(r,C,(function(){_++}),(function(){_++})):_++}),100):_++,!0},T=function(){!D&&o.removeAfterOutput&&setTimeout((function(){r._ImgManager.convertServerIdToClientIndex(C)>-1&&aJ(r,fJ,yJ).call(r,C)}),100);var e={code:r._errorCode,message:r._getErrorString(),response:r.__HTTPPostResponseString};return Dt.closeProgress(null,"Scan Upload"),2==N.st||(N.st=1,xt.each(v,(function(e,t){-1==e.st&&(e.bCancel=!0)})),E(n,e)),!1},r._innerUploadDirectly(b,t.path,c,U,P,i,!1,N,y,T);else{if(y=function(e,t){return N.st=0,!D&&o.removeAfterOutput?setTimeout((function(){r._ImgManager.convertServerIdToClientIndex(C)>-1?aJ(r,fJ,yJ).call(r,C,(function(){_++}),(function(){_++})):_++}),100):_++,!0},T=function(e){!D&&o.removeAfterOutput&&setTimeout((function(){r._ImgManager.convertServerIdToClientIndex(C)>-1&&aJ(r,fJ,yJ).call(r,C)}),100);var t={code:r._errorCode,message:r._getErrorString(),response:r.__HTTPPostResponseString};return Dt.closeProgress(null,"Scan Upload"),2==N.st||(N.st=1,xt.each(v,(function(e,t){-1==e.st&&(e.bCancel=!0)})),E(n,t)),!1},u=o.format,xt.isUndefined(u)){var M=r._ImgManager.convertServerIdToClientIndex(C);return Hw(r),T([M]),!1}u==Wt.DWT.EnumDWT_ImageType.IT_MULTIPAGE_PDF?u=Wt.DWT.EnumDWT_ImageType.IT_PDF:u==Wt.DWT.EnumDWT_ImageType.IT_MULTIPAGE_TIF&&(u=Wt.DWT.EnumDWT_ImageType.IT_TIF);var L={method:"startScan",url:b,serverIds:[C],headers:r._GetHttpHeadersAndClear(),formData:dH(r.httpFormFields),enumImageType:u,saveSetup:s,fileName:c,dataFormat:YH.Binary,retry:i,bOnlyResponseEmptyIsOK:!1,objUploadFileStatus:N,asyncSuccessFunc:y,asyncFailureFunc:T};r._asyncUploadCmd(L)}}})),r.__OnPostAllTransfers=function(){var c,d,v=-1,y=YH.Binary,I=o.httpParams.url,b=o.singlePost,w=S.transferMode==Wt.DWT.EnumDWT_TransferMode.TWSX_FILE,D=o.removeAfterOutput;if(a&&xt.isFunction(a)&&(v=w?p.length:g.length,d={event:"postTransfer",bScanCompleted:!0,result:{currentPageNum:v}},setTimeout((function(){a(d)}),10)),0==v)return function(e){fw(e,-1029,"Source has nothing to capture.")}(r),void setTimeout((function(){l=!0,h&&xt.isFunction(h)&&h();var e={code:r._errorCode,message:r._getErrorString(),response:r.__HTTPPostResponseString};E(n,e)}),1e3);if(v>0&&-1029==r._errorCode)r._errorCode=0;else if(0!=r._errorCode){l=!0,h&&xt.isFunction(h)&&h();var P={code:r._errorCode,message:r._getErrorString(),response:r.__HTTPPostResponseString};return void E(n,P)}if("http"==o.type){if(b&&"http"==o.type){var R,x,k,F=g;if(o.httpParams&&xt.isNumber(o.httpParams.maxSizeLimit)&&(r.__maxUploadImageSize=o.httpParams.maxSizeLimit),o.useUploader){var O,W=e.uploadManager,N=W.CreateJob(),M=N.FormField;if(U?(Wt.FileUploader.nextLoopTime=300,Dt.showProgress(r,"Scan Upload",r.__IfShowCancelDialogWhenImageTransfer)):Dt.hideProgress(),R=function(e,n){var i=e._fileName;return i||(i=""),r._bServerPercentDone=!0,r.__HTTPPostResponseString=n,A(r,i,100,200),r._OnPercentDone([0,100,"","http"]),U&&Dt.closeProgress(null,"Scan Upload"),!w&&o.removeAfterOutput?setTimeout((function(){_=0,xt.each(F,(function(e){r._ImgManager.convertServerIdToClientIndex(e)>-1?aJ(r,fJ,yJ).call(r,e,(function(){_++}),(function(){_++})):_++})),setTimeout(u,100)}),100):(B=!0,t(T),C(r)),!0},x=function(){U&&Dt.closeProgress(null,"Scan Upload"),W.CancelAllUpload(),r._bServerPercentDone=!0;var e={code:r._errorCode,message:r._getErrorString(),response:r.__HTTPPostResponseString};return E(n,e),!w&&o.removeAfterOutput&&setTimeout((function(){xt.each(F,(function(e){r._ImgManager.convertServerIdToClientIndex(e)>-1&&aJ(r,fJ,yJ).call(r,e)}))}),100),!1},k=function(e,t,n,i){var o=303;t==TJ.TRANS_SERVICE_ERROR_404?o=404:t==TJ.TRANS_SERVICE_ERROR_500?o=500:t==TJ.TRANS_SERVICE_ERROR_503&&(o=503),r._errorCode=t,r._errorString=n,r.__HTTPPostResponseString=i,A(r,"",100,o),x()},O=function(){r.__HTTPPostResponseString="",A(r,"",100,303),x()},U&&(Dt.cancelFrom=fj.Scan,aJ(r,hJ,SJ).call(r,x)),w)o.httpParams&&(xt.each(o.httpParams.headers,(function(e,t){N.HttpHeader[t]=e})),xt.each(o.httpParams.formFields,(function(e,t){M.Add(t,e)}))),N.ServerUrl=I,N.bDeleteFile=D,N.reTries=i,o.httpParams&&xt.isNumber(o.httpParams.maxSizeLimit)&&(N.maxSizeLimit=o.httpParams.maxSizeLimit),xt.each(p,(function(e,t){var r,n;o.httpParams&&(r=Sj(o.httpParams.fileName,t+1),n=Sj(o.httpParams.remoteName,t+1)),N.SourceValue.Add(e,r,n)})),N.ImageType=S.fileXfer.fileFormat,N.ThreadNum=m,N.OnRunSuccess=R,N.OnRunFailure=k,(U||xt.isFunction(f))&&(N.OnUploadTransferPercentage=function(e,t){t>0&&t<=100&&(r._OnPercentDone([0,t,"","http"]),xt.isFunction(f)&&A(r,"",t,0))},r._OnPercentDone([0,-1,QP.Uploading,"http"]),A(r,"",0,0)),W.Run(N);else if((c=o.format)==Wt.DWT.EnumDWT_ImageType.IT_MULTIPAGE_PDF||c==Wt.DWT.EnumDWT_ImageType.IT_MULTIPAGE_TIF)c==Wt.DWT.EnumDWT_ImageType.IT_MULTIPAGE_PDF?c=Wt.DWT.EnumDWT_ImageType.IT_PDF:c==Wt.DWT.EnumDWT_ImageType.IT_MULTIPAGE_TIF&&(c=Wt.DWT.EnumDWT_ImageType.IT_TIF),r._OnPercentDone([0,-1,QP.Encoding,"http"]),r._asyncGenerateURLForUploadData(F,c,s,(function(e){var t,n;o.httpParams&&(xt.each(o.httpParams.headers,(function(e,t){N.HttpHeader[t]=e})),xt.each(o.httpParams.formFields,(function(e,t){M.Add(t,e)}))),N.ServerUrl=I,N.bDeleteFile=D,N.reTries=i,o.httpParams&&xt.isNumber(o.httpParams.maxSizeLimit)&&(N.maxSizeLimit=o.httpParams.maxSizeLimit),o.httpParams&&(t=Sj(o.httpParams.fileName,1),n=Sj(o.httpParams.remoteName,1)),N._fileName=t,N.SourceValue.Add(e,t,n),N.ImageType=c,N.ThreadNum=m,N.OnRunSuccess=R,N.OnRunFailure=k,(U||xt.isFunction(f))&&(N.OnUploadTransferPercentage=function(e,n){n>0&&n<=100&&(r._OnPercentDone([0,n,"","http",t]),xt.isFunction(f)&&A(r,t,n,0))},r._OnPercentDone([0,-1,QP.Uploading,"http",t])),W.Run(N)}),O);else{var L=F.length,V=0,G=0,j="";U&&(r._bServerPercentDone=!1),r._OnPercentDone([0,-1,QP.Encoding,"http"]),xt.each(F,(function(e,t){var n,a;o.httpParams&&(n=Sj(o.httpParams.fileName,t+1),a=Sj(o.httpParams.remoteName,t+1)),r._asyncGenerateURLForUploadData([e],c,s,(function(e){G=(V+1)/L*100,j=[V+1,"/",L].join(""),r._OnPercentDone([0,G,j,"http"]),N.SourceValue.Add(e,n,a),++V>=L&&(U&&(r._bServerPercentDone=!0),o.httpParams&&(xt.each(o.httpParams.headers,(function(e,t){N.HttpHeader[t]=e})),xt.each(o.httpParams.formFields,(function(e,t){M.Add(t,e)}))),N.ServerUrl=I,N.bDeleteFile=D,N.reTries=i,o.httpParams&&xt.isNumber(o.httpParams.maxSizeLimit)&&(N.maxSizeLimit=o.httpParams.maxSizeLimit),N.ImageType=c,N.ThreadNum=m,N.OnRunSuccess=R,N.OnRunFailure=k,(U||xt.isFunction(f))&&(N.OnUploadTransferPercentage=function(e,t){t>0&&t<=100&&(r._OnPercentDone([0,t,"","http"]),xt.isFunction(f)&&A(r,"",t,0))},r._OnPercentDone([0,-1,QP.Uploading,"http"])),W.Run(N))}),O)}))}}else if(w)R=function(e){return r._bServerPercentDone=!0,!w&&o.removeAfterOutput?setTimeout((function(){_=0,xt.each(F,(function(e){r._ImgManager.convertServerIdToClientIndex(e)>-1?aJ(r,fJ,yJ).call(r,e,(function(){_++}),(function(){_++})):_++})),setTimeout(u,100)}),100):(B=!0,t(T),C(r)),!0},x=function(e){r._bServerPercentDone=!0;var t={code:r._errorCode,message:r._getErrorString(),response:r.__HTTPPostResponseString};return E(n,t),!w&&o.removeAfterOutput&&setTimeout((function(){xt.each(F,(function(e){r._ImgManager.convertServerIdToClientIndex(e)>-1&&aJ(r,fJ,yJ).call(r,e)}))}),100),!1},r._innerUploadFilesDirectly(I,p,o.httpParams&&o.httpParams.fileName,U,D,i,!1,R,x);else{R=function(e,n){return r._bServerPercentDone=!0,!w&&o.removeAfterOutput?setTimeout((function(){_=0,xt.each(F,(function(e){r._ImgManager.convertServerIdToClientIndex(e)>-1?aJ(r,fJ,yJ).call(r,e,(function(){_++}),(function(){_++})):_++})),setTimeout(u,100)}),100):(B=!0,t(T),C(r)),!0},x=function(e){r._bServerPercentDone=!0;var t={code:r._errorCode,message:r._getErrorString(),response:r.__HTTPPostResponseString};return E(n,t),!w&&o.removeAfterOutput&&setTimeout((function(){xt.each(F,(function(e){r._ImgManager.convertServerIdToClientIndex(e)>-1&&aJ(r,fJ,yJ).call(r,e)}))}),100),!1},c=o.format;var H=r._GetHttpHeadersAndClear(),z=dH(r.httpFormFields);if(c==Wt.DWT.EnumDWT_ImageType.IT_MULTIPAGE_PDF||c==Wt.DWT.EnumDWT_ImageType.IT_MULTIPAGE_TIF){var K;c==Wt.DWT.EnumDWT_ImageType.IT_MULTIPAGE_PDF?c=Wt.DWT.EnumDWT_ImageType.IT_PDF:c==Wt.DWT.EnumDWT_ImageType.IT_MULTIPAGE_TIF&&(c=Wt.DWT.EnumDWT_ImageType.IT_TIF),o.httpParams&&(K=Sj(o.httpParams.fileName,1),Sj(o.httpParams.remoteName,1));var J={method:"startScan",url:I,headers:H,formData:z,serverIds:F,enumImageType:c,saveSetup:s,fileName:K,dataFormat:y,retry:i,bOnlyResponseEmptyIsOK:!1,objUploadFileStatus:!1,asyncSuccessFunc:R,asyncFailureFunc:x};r._asyncUploadCmd(J)}else F.length>0&&r._asyncUploadFilesCmd(I,F,H,z,c,o.httpParams&&o.httpParams.fileName,s,U,i,!1,R,x)}}b&&o.type}l=!0,h&&xt.isFunction(h)&&h()};var c=function(){if("http"!=o.type)return B=!0,t(T),void C(r);o.singlePost?setTimeout((function(){if(!l&&r._startScanFlag)return B=!0,t(T),void C(r)}),300):setTimeout(u,100)};aJ(r,lJ,vJ).call(r,S,c,(function(e){if(-1029==r._errorCode&&(S.transferMode==Wt.DWT.EnumDWT_TransferMode.TWSX_FILE?p.length>0:g.length>0))return r._errorCode=0,c();var t={code:r._errorCode,message:r._getErrorString(),response:r.__HTTPPostResponseString};E(n,t)}))}))}))}},{key:"_innerInitEvents",value:function(e){this.__OnWSReconnect=e.onWSReconnect||null,this.__OnWSClose=e.onWSClose||null,this.__OnWSMessage=e.onWSMessage||null,this.__OnWSError=e.onWSError||null,this.__OnPercentDone=e.onPercentDone||"",this.__OnPrintMsg=e.onPrintMsg||"",this.__OnResult=e.onResult||"",this.__OnAfterOperate=e.onAfterOperate||"",this.__OnBeforeOperate=e.onBeforeOperate||"",this.__OnOperateStatus=e.onOperateStatus||"",this.__OnBitmapChanged=e.onBitmapChanged||"",this.__OnGetFilePath=e.onGetFilePath||"",this.__OnPreAllTransfers=e.onPreAllTransfers||"",this.__OnPreTransfer=e.onPreTransfer||"",this.__OnPostLoad=e.onPostLoad||"",this.__OnPostTransfer=e.onPostTransfer||"",this.__OnPostAllTransfers=e.onPostAllTransfers||"",this.__OnSourceUIClose=e.onSourceUIClose||"",this.__OnTransferCancelled=e.onTransferCancelled||"",this.__OnTransferError=e.onTransferError||"",this.__OnInternetTransferPercentage=e.onInternetTransferPercentage||"",this.__OnInternetTransferPercentageEx=e.onInternetTransferPercentageEx||"",this.__OnRemoteScanStatusAsync=e.onRemoteScanStatusAsync||""}}],[{key:"create",value:(n=GE(m.mark((function e(t){var n;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new r(t),e.next=3,Xx.STwainConnectToServer(n);case 3:return e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)}))),function(e){return n.apply(this,arguments)})}]);var n,i}(SK);function pJ(){var e,t,r=[],n=this.__devices.length;for(e=0;e<n;e++){var i=this.__devices[e],o=i.deviceType,a={ProductName:"",DeviceInfo:{},DriverType:"",IsCurrentSource:!1,IsDefaultSource:!1,Manufacturer:"",ProductFamily:"",ProtocolMajor:0,ProtocolMinor:0,SupportedGroups:0,Version:{Country:0,Info:"",Language:0,MajorNum:0,MinorNum:0}},s=void 0,u=xt.clone(i.deviceInfo);(t=o)==fR.TWAINSCANNER||t==fR.WIATWAINSCANNER||t==fR.TWAINX64SCANNER?(o==fR.TWAINSCANNER?s="TWAIN":o==fR.WIATWAINSCANNER?s="WIATWAIN":o==fR.TWAINX64SCANNER&&(s="TWAIN64"),a.Manufacturer=u.Manufacturer,a.ProductFamily=u.ProductFamily,a.ProtocolMajor=u.ProtocolMajor,a.ProtocolMinor=u.ProtocolMinor,a.SupportedGroups=u.SupportedGroups,a.Version=u.Version):o==fR.SANESCANNER?(s="SANE",a.DeviceInfo=u):o==fR.ICASCANNER?(s="ICA",a.DeviceInfo=u):o==fR.ESCLSCANNER?(s="eSCL",a.DeviceInfo=u):o==fR.WIFIDIRECTSCANNER?(s="WiFiScanner",a.DeviceInfo=u):o==fR.WIASCANNER&&(s="WIA",a.DeviceInfo=u),a.ProductName=i.displayName,a.DriverType=s,r.push(a)}return r}function _J(){var e,t=this,r=[],n=0;for(t.__devices&&(n=t.__devices.length),e=0;e<n;e++){var i=t.__devices[e];r.push(i.displayName)}return r}function mJ(e,t){var r=["[",e,",",null!=t?t:lx.SMF_NAME,"]"].join("");return this._innerFun("SelectSourceEx",r)}function vJ(e,t,r){var n,i,o=this,a=null,s=null;if(i=xt.isUndefined(e)||null==e?{}:e,o._resetErr(),!o._isValid())return!1;if(xt.isFunction(t)&&(a=function(){t(i)}),xt.isFunction(r)&&(s=function(e,t){r(e,t,i)}),!sP.checkProductKey(o,{Core:!0}))return xt.isFunction(s)&&s(o._errorCode,o._errorString),!1;for(var u=0,c=0;c<uk.length;c++){var l=["__",uk[c]].join("");xt.isFunction(o[l])&&(u|=1<<c)}if(i.EnableEvents=u,i.scanner){var d=i.scanner;xt.isString(d)||xt.isString(d.strDevice)&&(i.device=d.strDevice,delete i.scanner)}return n=["[",xt.stringify(i),"]"].join(""),o.__bAcquireImageNow=!0,o.__innerAcquireOrLoadImageAsync("StartScan",n,!1,!0).then(a,(function(e){o._errorCode=e.code,o._errorString=e.message,xt.isFunction(s)&&s(e.code,e.message)})),!0}function yJ(e,t,r){var n=this;return n._innerFunRaw("RemoveImage",mR(e),!0,!1,!0,(function(){n._OnBitmapChanged(["c1",""+e,3,n._ImgManager.getCurrentImageIndex(),n._ImgManager.count()]),xt.isFunction(t)&&t()}),r)}function SJ(e){var t=this;t.IfShowCancelDialogWhenImageTransfer?(Dt.progressContext&&Dt.progressContext.on("cancel",(function(){fE(t),e()})),Cj(!0)):Cj(!1)}var TJ={TRANS_SERVICE_ERROR_404:12,TRANS_SERVICE_ERROR_500:13,TRANS_SERVICE_ERROR_503:14},IJ=function t(r,n){if(!xt.isUndefined(r)&&!xt.isUndefined(n)&&null!=r&&null!=n){for(var i in n)r.hasOwnProperty(i)?"object"===e(r[i])&&t(r[i],n[i]):r[i]=n[i];return r}};function bJ(e){return CJ.apply(this,arguments)}function CJ(){return CJ=GE(m.mark((function e(t){var r,n,i,o,a,s,u,c,l;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=t.id,a=null===(r=t.container)||void 0===r?void 0:r.id,s=window,!(n=Wt.DWT.GetWebTwain(o))&&a&&(i=Wt.DWT.GetWebTwain(a)),!n&&!i){e.next=8;break}throw u={},n?bE(u):CE(u),{code:u._errorCode,message:u._errorString};case 8:return Wt.DWT.UseDefaultViewer||(t.container=null),((d=t.container)&&!xt.isString(d)?Bb:Lb)?t.bNoViewer=!1:t.bNoViewer=!0,e.prev=10,e.next=13,gJ.create(t);case 13:c=e.sent,e.next=22;break;case 16:throw e.prev=16,e.t0=e.catch(10),(l=e.t0&&e.t0.code)==rw.ResponseDataTypeError||l==rw.HTSTError||l==rw.CORSError||l==rw.CORSErrorFromService||l==rw.SSLCertExpired||l==rw.SSLCertInvalid||(l==rw.MustUpgrade?Qz(!0):l==rw.ModuleNotExists&&DJ(c)),c&&c.dispose(),e.t0;case 22:return e.prev=22,s.DCP_DWT_OnClickCloseInstall&&s.DCP_DWT_OnClickCloseInstall(!1,!0),e.finish(22);case 25:return EJ(c),e.abrupt("return",c);case 27:case"end":return e.stop()}var d}),e,null,[[10,16,22,25]])}))),CJ.apply(this,arguments)}function wJ(e,t){if(xt.isFunction(Wt.OnWebTwainNeedUpgradeCallback)){var r,n,i={};if(n=BC.getDSPath(),Y.bWin)r=gC.enumWindow;else if(Wt.navInfo.bEmbed||Y.bAndroid||Y.bChromeOS||Y.bHarmonyOS||Y.biPhone||Y.biPad)Y.bAndroid?r=gC.enumAndroid:(i.deb=n,r=Y.biPhone||Y.biPad?gC.enumiOS:Y.bChromeOS?gC.enumChromeOS:Y.bHarmonyOS?gC.enumHarmonyOS:gC.enumEmbed);else if(Y.bLinux){var o=BC.getLinuxHTML5DebPath(),a=BC.getLinuxHTML5RpmPath();n=o,i.deb=o,i.rpm=a,r=gC.enumLinux}else r=gC.enumMac;i.default=n;var s=Wb.one(".dynamsoft-dialog-license");s&&s.getEL()&&(s.getEL().style.display="none"),Dt.detect.needUpgrade=Bb,Wt.OnWebTwainNeedUpgradeCallback(aw.name,i,aw.bHTML5Edition,r,Y.bIE,Y.bSafari,Dt.detect.ssl,lR.strIEVersion,Dt.detect.bPromptJSOrServerOutdated,e,t)}}function EJ(e){return AJ.apply(this,arguments)}function AJ(){return AJ=GE(m.mark((function e(t){var r,n,i;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&!t._blts){e.next=2;break}return e.abrupt("return");case 2:if(-2207==t.ErrorCode&&(Dt.detect.bPromptJSOrServerOutdated=Bb,xt.isFunction(Wt.DWT.OnWebTwainNeedUpgradeWebJavascript)&&Wt.DWT.OnWebTwainNeedUpgradeWebJavascript(t.ErrorString)),!sw.versionInfoFromServer){e.next=7;break}r=sw.versionInfoFromServer,e.next=10;break;case 7:return e.next=9,t._getVersionInfoAsync();case 9:r=e.sent;case 10:if(Dt.detect.bNeedUpgradeEvent||xx(r)){e.next=19;break}if(Dt.detect.bNeedUpgradeEvent=Bb,!xt.isFunction(Wt.DWT.OnWebTwainNeedUpgrade)){e.next=15;break}if(!Wt.DWT.OnWebTwainNeedUpgrade()){e.next=15;break}return e.abrupt("return");case 15:if(!t._bRemoteMode){e.next=18;break}return xt.isFunction(Wt.OnRemoteWebTwainNeedUpgradeCallback)&&(n=t._serverInfo.port,Wt.OnRemoteWebTwainNeedUpgradeCallback(aw.name,t._serverInfo.server,n,t._serverInfo.ssl)),e.abrupt("return");case 18:(aw.bHTML5Edition&&t._isBindViewer()||!aw.bHTML5Edition)&&((i=t._containerElement)&&(Wb.one(i).before(Dt.install._strNonInstallDIV),xt.show(Dt.install._divDWTNonInstallContainerID)),""!=Dt.install._divDWTemessageContainer&&xt.hide(Dt.install._divDWTemessageContainer),wJ());case 19:case"end":return e.stop()}}),e)}))),AJ.apply(this,arguments)}function DJ(e){if(!Dt.detect.bNoControlEvent){var t,r=0,n=0;e&&(r=e._width,n=e._height,t=e._containerElement),e&&e._bRemoteMode?e._bNotShowMessage||xt.isFunction(Wt.OnRemoteWebTwainNotFoundCallback)&&Wt.OnRemoteWebTwainNotFoundCallback(aw.name,e._serverInfo.server,e._serverInfo.port,e._serverInfo.ssl,lR.bMobile):(Yz(t,r,n),Qz(!1)),Dt.detect.bNoControlEvent=!0}}var PJ=function(e){function r(e){var n,i,o,a;t(this,r),i=this,a=[e],o=QE(o=r),(n=YE(i,function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(QG){return!1}}()?Reflect.construct(o,a||[],QE(i).constructor):o.apply(i,a)))._bServerPercentDone=!0,n._bScanForProxyRemote=Bb;var s=Xx.getServerImageUrlPrefix(n);return hj._setBaseUrl(n._imageBufferWrapper,s),n}return qE(r,e),s(r,[{key:"getDevices",value:function(e,t,r){return this._getDevices(e,t,r)}},{key:"_connnect",value:(h=GE(m.mark((function e(){var t;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this,e.abrupt("return",new Dt.Promise((function(e,r){sK(t._serverInfo.server,t._serverInfo.port,void 0,(function(r,n,i){t._strRemoteServiceVer=i,e()}),r)})));case 2:case"end":return e.stop()}}),e,this)}))),function(){return h.apply(this,arguments)})},{key:"acquireImage",value:function(e,t){return Dk(QE(r.prototype),"_acquireImage",this).call(this,e,t)}},{key:"_acquireImageForSendTo",value:function(e,t,n,i){return Dk(QE(r.prototype),"_acquireImageForSendTo",this).call(this,e,t,n,i)}},{key:"getCapabilities",value:function(e,t,r){return this._getCapabilities(e,t,r)}},{key:"setCapabilities",value:function(e,t,r){return this._setCapabilities(e,t,r)}},{key:"closeSource",value:function(){return this._closeSource()}},{key:"setBufferMemoryLimit",value:(f=GE(m.mark((function e(t){var r,n;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this,xt.isNumber(t)&&!isNaN(t)){e.next=4;break}throw _w(r),{code:r._errorCode,message:r._errorString};case 4:if(r._resetErr(),r._isValid()){e.next=7;break}throw{code:r._errorCode,message:r._errorString};case 7:return e.next=9,r._innerFunV2("BufferMemoryLimit",mR(t));case 9:return n=e.sent,e.abrupt("return",n);case 11:case"end":return e.stop()}}),e,this)}))),function(e){return f.apply(this,arguments)})},{key:"setIfAllowLocalCache",value:(d=GE(m.mark((function e(t){var r,n;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this,xt.isBoolean(t)){e.next=4;break}throw _w(self),{code:r._errorCode,message:r._errorString};case 4:if(r._resetErr(),r._isValid()){e.next=7;break}throw{code:r._errorCode,message:r._errorString};case 7:return e.next=9,r._innerFunV2("IfAllowLocalCache",mR(t));case 9:return n=e.sent,e.abrupt("return",n);case 11:case"end":return e.stop()}}),e,this)}))),function(e){return d.apply(this,arguments)})},{key:"howManyImagesInBuffer",get:function(){return this._imageBufferWrapper.count()}},{key:"currentImageIndexInBuffer",get:function(){return this._imageBufferWrapper.getCurrentImageIndex()},set:function(e){this._imageBufferWrapper.setCurrentImageIndex(e)}},{key:"saveImages",value:(l=GE(m.mark((function e(t,r,n,i){var o;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o="saveImages",this._checkIndices(r)){e.next=3;break}throw{code:this._errorCode,message:this._getErrorString()};case 3:return this._containerElement=i,e.next=6,this._saveImages(o,t,r,n);case 6:case"end":return e.stop()}}),e,this)}))),function(e,t,r,n){return l.apply(this,arguments)})},{key:"getImages",value:function(e,t,r,n){if(!this._checkIndices(e))throw{code:this._errorCode,message:this._getErrorString()};return this._containerElement=n,this._getImages("getImages",e,t,r)}},{key:"removeImages",value:(c=GE(m.mark((function e(t){var r,n,i,o,a;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._checkIndices(t)){e.next=2;break}throw{code:this._errorCode,message:this._getErrorString()};case 2:for(r=t.sort((function(e,t){return t-e})),n=[],i=0;i<r.length;i++)o=r[i],(a=this._imageBufferWrapper.convertClientIndexToServerId(o))>0&&n.push(a);if(0!=n.length){e.next=7;break}return e.abrupt("return");case 7:return e.next=9,this._innerFunV2("RemoveAllImages",mR(n.join(",")));case 9:if(!e.sent&&-1033!=this._errorCode){e.next=16;break}if(this._imageBufferWrapper.removeImages(r)){e.next=14;break}throw this._imageBufferWrapper.getError();case 14:e.next=17;break;case 16:throw{code:this._errorCode,message:this._errorString};case 17:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"updateImage",value:function(e,t,n){var i=this._imageBufferWrapper.getIndexByUid(e),o=this._imageBufferWrapper.convertClientIndexToServerId(i);return Dk(QE(r.prototype),"_updateImage",this).call(this,o,t,n)}},{key:"getSkewAngleFromBinaryAsync",value:function(e,t,r,n){var i=this;if(i._resetErr(),!i._isValid())return Dt.Promise.reject({code:i._errorCode,message:i._errorString});var o=this._imageBufferWrapper.getCustomDataByIndex(e),a=this._imageBufferWrapper.getMetadataByIndex(e),s=this._imageBufferWrapper.convertClientIndexToServerId(e),u={imageId:s,serverId:s,bufferLen:t.size,imageType:dx.IT_BMP,width:a.width,height:a.height,bit:a.bitDepth,xres:a.resolutionX,yres:a.resolutionY,uidFromServer:o.uidFromServer},c=xt.stringify([xt.stringify(u)]);return this._innerSendBlob("GetSkewAngleFromBinary",c,t,!0,!0,r,n)}},{key:"httpUpload",value:(u=GE(m.mark((function e(t,n,i,o,a,s,u){var c,l;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((c=this)._resetErr(),c._isValid()){e.next=4;break}throw{code:c._errorCode,message:c._errorString};case 4:if(!xt.isUndefined(t)&&""!==t){e.next=9;break}throw kw(c),{code:c._errorCode,message:c._errorString};case 9:if(xt.isString(t)){e.next=12;break}throw Kw(c),{code:c._errorCode,message:c._errorString};case 12:if(c._checkIndices(n)){e.next=14;break}throw{code:c._errorCode,message:c._errorString};case 14:if(0!=(l=Ck(c,n)).length){e.next=18;break}throw pw(c),{code:c._errorCode,message:c._errorString};case 18:if(!xt.isUndefined(i)){e.next=21;break}throw Hw(c),{code:c._errorCode,message:c._errorString};case 21:if(i!=Wt.DWT.EnumDWT_ImageType.IT_BMP&&i!=Wt.DWT.EnumDWT_ImageType.IT_JPG&&i!=Wt.DWT.EnumDWT_ImageType.IT_PNG){e.next=27;break}if(!(l.length>1)){e.next=25;break}throw Lw(c),{code:c._errorCode,message:c._errorString};case 25:e.next=32;break;case 27:if(i!=Wt.DWT.EnumDWT_ImageType.IT_TIF&&i!=Wt.DWT.EnumDWT_ImageType.IT_PDF){e.next=30;break}e.next=32;break;case 30:throw Hw(c),{code:c._errorCode,message:c._errorString};case 32:if(!(xt.isUndefined(o)||o!=Wt.DWT.EnumDWT_UploadDataFormat.Binary&&o!=Wt.DWT.EnumDWT_UploadDataFormat.Base64)){e.next=35;break}throw zw(c),{code:c._errorCode,message:c._errorString};case 35:return e.next=37,new Dt.Promise((function(e,n){var d,f,h=parseInt(i),g=parseInt(o);null!=s&&s.formFields&&(d=new FormData,xt.each(null==s?void 0:s.formFields,(function(e,t){var r=e.name,n=e.value;xt.isString(r)&&(n instanceof Blob?d.append(r,n,e.fileName):d.append(r,n))}))),null!=s&&s.headers&&(f={},xt.each(null==s?void 0:s.headers,(function(e,t){xt.isString(e.name)&&(f[e.name]=e.value)}))),c._containerElement=u,r._innerHTTPUpload(c,"httpUpload",t,null==s?void 0:s.responseType,f,d,l,h,g,a,void 0,0,!1,void 0,(function(t){if(xt.isFunction(e)){var r=[];xt.isArray(l)&&xt.each(l,(function(e){var t=c._imageBufferWrapper.convertServerIdToClientIndex(e);t>-1&&r.push(t)}));try{wk(e,t,r)}catch(i){}}return t=null,!0}),(function(t){if(xt.isFunction(n))try{n(t)}catch(e){}return!1}))}));case 37:return e.abrupt("return",e.sent);case 38:case"end":return e.stop()}}),e,this)}))),function(e,t,r,n,i,o,a){return u.apply(this,arguments)})},{key:"getCustomDataByIndex",value:function(e){return this._imageBufferWrapper.getCustomDataByIndex(e)}},{key:"getIndexByUid",value:function(e){return this._imageBufferWrapper.getIndexByUid(e)}},{key:"getProfile",value:function(e){return Dk(QE(r.prototype),"_getProfile",this).call(this,e)}},{key:"setProfile",value:function(e,t){return Dk(QE(r.prototype),"_setProfile",this).call(this,e,t)}},{key:"imageIDToIndex",value:function(e){return this._uidFromServer2index(e)}},{key:"indexToImageID",value:function(e){return this._index2uidFromServer(e)}},{key:"rotate",value:function(e,t,r,n){var i=this;if(i._resetErr(),!i._isValid())return Dt.Promise.reject({code:i._errorCode,message:i._errorString});var o=parseInt(e);if(isNaN(o))return pw(i),Dt.Promise.reject({code:i._errorCode,message:i._errorString});if(o<0||o>=i.howManyImagesInBuffer)return Gw(i),Dt.Promise.reject({code:i._errorCode,message:i._errorString});var a=i._imageBufferWrapper.convertClientIndexToServerId(o);return-1==a?(Gw(i),Dt.Promise.reject({code:i._errorCode,message:i._errorString})):i._innerFunV2("RotateEx",mR(a,t,r,n),!0).then((function(e){}))}},{key:"crop",value:function(e,t){var r=this;if(r._resetErr(),!r._isValid())return Dt.Promise.reject({code:r._errorCode,message:r._errorString});var n=parseInt(e);if(isNaN(n))return pw(r),Dt.Promise.reject({code:r._errorCode,message:r._errorString});if(n<0||n>=r.howManyImagesInBuffer)return Gw(r),Dt.Promise.reject({code:r._errorCode,message:r._errorString});var i=r._imageBufferWrapper.convertClientIndexToServerId(n);if(-1==i)return Gw(r),Dt.Promise.reject({code:r._errorCode,message:r._errorString});var o=t.x,a=t.y,s=t.x+t.width,u=t.y+t.height;return r._innerFunV2("Crop",mR(i,o,a,s,u),!0).then((function(e){}))}},{key:"_createHttpUploaderConfig",value:function(){var e=this,t=new Dj;return t.IfShowProgressBar=e.IfShowProgressBar,t.IfShowCancelDialogWhenImageTransfer=e.IfShowCancelDialogWhenImageTransfer,t.MaxUploadImageSize=e.MaxUploadImageSize,t.HTTPRequestswithCredentials=e.HTTPRequestswithCredentials,t.onPercent=function(t){e._OnPercentDone(t)},t.onHttpUploadStatus=function(e){},t}},{key:"_OnReady",value:(a=GE(m.mark((function e(){var t,n,i;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return dw((t=this)._serverInfo.server)&&(Dx.item("DWT_port",t._serverInfo.port),Dx.item("DWT_ssl",t._serverInfo.ssl?"true":"false")),t._bNoMask||DR("OnReady",t),e.prev=3,e.next=6,Dk(QE(r.prototype),"_OnReady",this).call(this);case 6:return e.next=8,t._innerActiveUI(t._uuidForActiveUI);case 8:return n=e.sent,e.next=11,t._OnActiveUI(n);case 11:(i=t._id)&&!Wt.DWT.WebTwainIdMap[i]&&(Wt.DWT.WebTwainIdMap[i]=t),e.next=20;break;case 15:throw e.prev=15,e.t0=e.catch(3),e.t0&&(t._errorCode=e.t0.code,t._errorString=e.t0.message),t.dispose(),e.t0;case 20:return e.prev=20,t._bNoMask||PR("OnReady"),e.finish(20);case 23:case"end":return e.stop()}}),e,this,[[3,15,20,23]])}))),function(){return a.apply(this,arguments)})},{key:"_isBindViewer",value:function(){return this._bBindViewer}},{key:"_isNoViewer",value:function(){return!this._isBindViewer()}},{key:"getServiceInfo",value:function(){return Dk(QE(r.prototype),"getServiceInfo",this).call(this)}},{key:"setViewerInfo",value:function(e){this._bBindViewer=e}},{key:"setViewerControlInfo",value:function(e){this._controlWidth=e.width,this._controlHeight=e.height}}],[{key:"create",value:(o=GE(m.mark((function e(t){var n;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new r(t),e.next=3,Xx.STwainConnectToServer(n);case 3:return e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)}))),function(e){return o.apply(this,arguments)})},{key:"_getBuffer",value:function(e){return hj._getBuffer(e._imageBufferWrapper)}},{key:"_setError",value:function(e,t,r){e._errorCode=t,e._errorString=r}},{key:"createByServiceInfo",value:(i=GE(m.mark((function e(t,n,i){var o,a,s;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={id:xt.guid(),dmService:n,bNoViewer:!0,bNoMask:null==n||null===(o=n.attrs)||void 0===o?void 0:o.bNoMask,bNotShowMessage:!0},(s=new r(a))._uuidForActiveUI=t,s._bLicenseErrorDispose=!1,i&&(s._containerElement=i),e.next=7,s._connnect();case 7:return e.next=9,Xx.STwainConnectToServer(s);case 9:return e.abrupt("return",s);case 10:case"end":return e.stop()}}),e)}))),function(e,t,r){return i.apply(this,arguments)})},{key:"checkOnlineByServiceInfo",value:(n=GE(m.mark((function e(t){var n,i;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={id:xt.guid(),dmService:t,bNoViewer:!0,bNoMask:!0,bNotShowMessage:!0},e.prev=1,i=new r(n),e.next=5,i._connnect();case 5:return i._bReady=!0,i._wsClient||(i._wsClient=new RA(null)),i.dispose(),e.abrupt("return",!0);case 11:return e.prev=11,e.t0=e.catch(1),xt.warn(e.t0),e.abrupt("return",!1);case 15:case"end":return e.stop()}}),e,null,[[1,11]])}))),function(e){return n.apply(this,arguments)})},{key:"_isReady",value:function(e){return e._bReady}},{key:"_innerHTTPUpload",value:function(e,t,r,n,i,o,a,s,u,c,l,d,f,h,g,p){var _=c,m=r;if(xt.isUndefined(s))return Hw(e),void(xt.isFunction(p)&&p({code:e._errorCode,message:e._errorString}));Dt.cancelFrom=fj.HTTPUpload;var v,y=function(r,n,i){Dt.needShowTwiceShowDialog=!1,e.IfShowProgressBar&&Dt.closeProgress(null,t),xt.isFunction(p)&&p({code:r,message:n,response:i})},S=e._createHttpUploaderConfig();if(S.objUploadStatus=h,_=Tj(_,s),Dt.needShowTwiceShowDialog=!0,e.IfShowProgressBar?(Dt.showProgress(e,t,!1),Dt.progressContext&&(Dt.progressContext._onPercent=function(e){var t,r,n=0;e&&(t=e.loaded,r=e.total,(n=Math.floor(t/r*100))>100&&(n=100));Dt.progressBarOnPercentDone(-1,"Transferring...","",n,"")})):Dt.hideProgress(),u==Wt.DWT.EnumDWT_UploadDataFormat.Binary){if(h&&h.bCancel)return h.st=2,fE(e),void y(e._errorCode,e._errorString);S.onPercent([0,-1,QP.Encoding,"http"]),e._convertToBlobForUpload(s,a,l,4,(function(r,a,s){if(v=function(r){return Dt.needShowTwiceShowDialog=!1,e.IfShowProgressBar&&Dt.closeProgress(null,t),xt.isFunction(g)&&wk(g,r),r=null,!0},h&&h.bCancel)return h.st=2,fE(e),y(e._errorCode,e._errorString);if(!r||r.size<=0)return Pw(e),y(e._errorCode,e._errorString);var u=e.__maxUploadImageSize;if(r.size>u&&-1!=u)return xw(e),y(e._errorCode,e._errorString);if(0!=e._errorCode)return y(e._errorCode,e._errorString);Wt.DWT.IfAddMD5InUploadHeader&&a&&""!=a&&(i["dwt-md5"]=a);var c=new Ej,l=new Aj;l.url=m,l.method=t,l.content=r,r=null,l.contentType=e._strHttpContentTypeFieldValue,l.headers=i,l.fileName=_,l.httpFormData=o,l.retry=d,l.bOnlyResponseEmptyIsOK=f,l.responseType=n,S.objUploadStatus=h,c.httpPostUpload(S,l,v,y)}),y)}else u==Wt.DWT.EnumDWT_UploadDataFormat.Base64&&e._convertToBase64ByServerIdsWithUI(t,a,s,l,4,(function(r){var a,s;if(!r||r.getLength()<=0)return Pw(e),y(e._errorCode,e._errorString);if(v=function(r){return Dt.needShowTwiceShowDialog=!1,e.IfShowProgressBar&&Dt.closeProgress(null,t),xt.isFunction(g)&&wk(g,r),!0},a=r.getMD5(),Wt.DWT.IfAddMD5InUploadHeader&&(i["dwt-md5"]=a),!(s=r.getData(0,r.getLength()))||""==s)return Pw(e),y(e._errorCode,e._errorString);var u=new Aj;u.url=m,u.method=t,u.content=s,s=null,u.headers=i,u.fileName=_,u.httpFormData=o,u.retry=d,u.bOnlyResponseEmptyIsOK=f,u.responseType=n,(new Ej).httpPostUpload(S,u,v,y)}),y)}}]);var n,i,o,a,u,c,l,d,f,h}(xj),RJ=dR,xJ=function(){return s((function e(r){var n=this;if(t(this,e),this._serverUrl=r,this._defaultDSScanClient=null,this._dsScanClientsMap={},this._serviceInfos=null,this._id=xt.guid(),this.onBufferChanged=null,this.onPostTransferAsync=null,this._errorCode=0,this._errorString="",this._bDispose=!1,this._needSetLogLevel=!1,this._logLevel=-1,this._showProgressBar=!0,this._checkServerUrl(),this._id&&!Wt.DWT.RemoteScanIdMap[this._id]&&(Wt.DWT.RemoteScanIdMap[this._id]=this),this._uuidForRemoteScanObject="",Dt.dlgProgress||Dt.initProgress(null),Wt.DWT.UseDefaultViewer){var i={viewerEvents:{bufferChanged:function(e,t){n.__bufferChanged(n,e,t)},save:function(e,t,r,i){return n.__save(e,t,r,i)},rotate:function(e,t,r){return n.__rotate(e,t,r)},crop:function(e,t,r,i,o){return n.__crop(e,{x:t,y:r,width:i,height:o})}},viewerError:{setError:function(e,t){n._defaultDSScanClient?PJ._setError(n._defaultDSScanClient,e,t):0==e&&""==t||(n._errorCode=e,n._errorString=t)}},imageEditorEvents:{deskew:function(e,t){n.__deskew(n,e,t)},removeImage:function(){n.__remove(n)},removeAllImage:function(){n.__removeAll(n)},close:function(){n.__close(n)}},imageEditorUiConfig:{buttons:{visibility:{scan:!1,load:!1}}},beforeImageEditorCreated:function(e){n.__beforeImageEditorCreated(e)}};this._viewer=new Wt.DWTViewerEx(null,i)}else this._viewer=null}),[{key:"Viewer",get:function(){return this._viewer}},{key:"_disposeDSClientByKey",value:(E=GE(m.mark((function e(t){var r;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=this._dsScanClientsMap[t])){e.next=10;break}if(r.isDestroy){e.next=9;break}if(!r.__unload){e.next=8;break}return e.next=6,r.__unload();case 6:e.next=9;break;case 8:r.dispose();case 9:delete this._dsScanClientsMap[t];case 10:case"end":return e.stop()}}),e,this)}))),function(e){return E.apply(this,arguments)})},{key:"_checkServerUrl",value:function(){var e=this._serverUrl;if(e&&xt.isString(e)&&xt.startsWith(location.href,"https://")&&xt.startsWith(e,"http://")){var t={};throw function(e,t,r){fw(e,-2436,'Mixed Content: The page at "'+t+'" was loaded over HTTPS, but requested an insecure resource "'+r+'/ddm/18625/ddm/SearchScanner". This request has been blocked; the content must be served over HTTPS.')}(t,location.href,e),tA(t)}if(!xt.isString(e)||""==e){var r={};throw fw(r,-2545,"The  proxy server URL is invalid."),tA(r)}}},{key:"getDynamsoftService",value:(w=GE(m.mark((function e(t){var r,n,i,o,a,s,u,c,l,d,f,h,g,p,_,v,y,S,I;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._bDispose){e.next=4;break}throw pE(r={}),tA(r);case 4:if(n=this._serverUrl,this._checkServerUrl(),i=new JK(n,!0),DR("getDynamsoftService",this.getViewerElement()),e.prev=8,!t&&this._serviceInfos){e.next=68;break}if(o=null,a=this._serviceInfos,this._serviceInfos=[],s="",u="",!lw()){e.next=30;break}return e.next=16,this._setRemoteUuid();case 16:return e.prev=16,e.next=19,KR(Wt.DWT.EnumInstance.dwt_desktop,"");case 19:(c=e.sent)&&(s=c.ar,u=this._uuidForRemoteScanObject),e.next=28;break;case 23:throw e.prev=23,e.t0=e.catch(16),ok(l={},e.t0),{code:l._errorCode,message:l._errorString};case 28:e.next=31;break;case 30:s=aw.refProductKey;case 31:return e.next=33,i.getDynamsoftService(s,u,t);case 33:if(!(o=e.sent)){e.next=68;break}f=[],d=0;case 37:if(!(d<o.length)){e.next=65;break}return p=ix(o[d]),_=null!==(h=null==p||null===(g=p.attrs)||void 0===g?void 0:g.ty)&&void 0!==h?h:"",e.next=42,PJ.checkOnlineByServiceInfo(p);case 42:if(!e.sent){e.next=60;break}if(p.attrs=p.attrs||{},p.attrs.bNoMask=!0,p.attrs.bNotShowMessage=!0,!a){e.next=57;break}v=void 0,v=0;case 50:if(!(v<a.length)){e.next=57;break}if(!this.isSameService(p,a[v])){e.next=54;break}return a.splice(v,1),e.abrupt("break",57);case 54:v++,e.next=50;break;case 57:this._serviceInfos.push(p),e.next=61;break;case 60:_+="(x)";case 61:f.push(_);case 62:d++,e.next=37;break;case 65:if(xt.log("Find Dynamsoft Services:"),xt.log(f.join(", ")),a)for(y=0;y<a.length;y++)(I=null===(S=a[y])||void 0===S||null===(S=S.attrs)||void 0===S?void 0:S.UUID)&&this._disposeDSClientByKey(I);case 68:this._needSetLogLevel&&-1!=this._logLevel&&this.setLogLevel(this._logLevel),e.next=74;break;case 71:throw e.prev=71,e.t1=e.catch(8),e.t1;case 74:e.prev=74,PR("getDynamsoftService");try{i._bInited&&i.dispose()}catch(T){}return e.finish(74);case 78:return e.abrupt("return",this._serviceInfos);case 79:case"end":return e.stop()}}),e,this,[[8,71,74,78],[16,23]])}))),function(e){return w.apply(this,arguments)})},{key:"getDefaultDynamsoftService",value:function(){if(this._bDispose){var e={};throw pE(e),tA(e)}return this._defaultDSScanClient?this._defaultDSScanClient.getServiceInfo():null}},{key:"setDefaultDynamsoftService",value:(C=GE(m.mark((function e(t){var r,n,i,o;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._bDispose){e.next=4;break}throw pE(r={}),tA(r);case 4:if(null!==t){e.next=7;break}return this._defaultDSScanClient=null,e.abrupt("return");case 7:if(t&&t instanceof nx){e.next=11;break}throw Zw(n={}),{code:n._errorCode,message:n._errorString};case 11:return i=this.getViewerElement(),e.next=14,this._createDSClientByServiceInfo(t,!0,i._containerElement);case 14:if(!(o=e.sent)){e.next=18;break}return e.next=18,this._innerSetDefault(o);case 18:case"end":return e.stop()}}),e,this)}))),function(e){return C.apply(this,arguments)})},{key:"_innerSetDefault",value:(b=GE(m.mark((function e(t){var r,n,i;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=11;break}if(PJ._isReady(t)){e.next=5;break}throw i=null!==(r=null===(n=t.getServiceInfo())||void 0===n||null===(n=n.attrs)||void 0===n?void 0:n.name)&&void 0!==r?r:"",dE(t,i),{code:t._getErrorCode(),message:t._getErrorString()};case 5:this._defaultDSScanClient=t,this._defaultDSScanClient.IfShowProgressBar=this._showProgressBar,this.Viewer&&this.Viewer.webViewer&&this.Viewer.webViewer.bindViewUI&&this._defaultDSScanClient.setViewerInfo(this.Viewer.webViewer.bindViewUI),this.__setViewerControlInfo(),this._registEventToDefaultDS(),this._viewer&&this._viewer.webViewer.setBufferService(PJ._getBuffer(this._defaultDSScanClient));case 11:case"end":return e.stop()}}),e,this)}))),function(e){return b.apply(this,arguments)})},{key:"__setViewerControlInfo",value:function(){this.Viewer.webViewer.bindViewUI&&this.Viewer.width&&this.Viewer.width>0&&this.Viewer.height&&this.Viewer.height>0&&this._defaultDSScanClient.setViewerControlInfo({width:this.Viewer.width,height:this.Viewer.height})}},{key:"__beforeImageEditorCreated",value:function(e){var t=Wt.DWT.CustomizableDisplayInfo;if(!xt.isUndefined(t)){if(!xt.isUndefined(t.buttons)){var r=t.buttons.titles;xt.isUndefined(r)||(xt.isUndefined(r.previous)||(e.buttons.titles.previous=r.previous),xt.isUndefined(r.next)||(e.buttons.titles.next=r.next),xt.isUndefined(r.print)||(e.buttons.titles.print=r.print),xt.isUndefined(r.scan)||(e.buttons.titles.scan=r.scan),xt.isUndefined(r.load)||(e.buttons.titles.load=r.load),xt.isUndefined(r.rotateleft)||(e.buttons.titles.rotateleft=r.rotateleft),xt.isUndefined(r.rotate)||(e.buttons.titles.rotate=r.rotate),xt.isUndefined(r.rotateright)||(e.buttons.titles.rotateright=r.rotateright),xt.isUndefined(r.deskew)||(e.buttons.titles.deskew=r.deskew),xt.isUndefined(r.crop)||(e.buttons.titles.crop=r.crop),xt.isUndefined(r.cut)||(e.buttons.titles.cut=r.cut),xt.isUndefined(r.changeimagesize)||(e.buttons.titles.changeimagesize=r.changeimagesize),xt.isUndefined(r.flip)||(e.buttons.titles.flip=r.flip),xt.isUndefined(r.mirror)||(e.buttons.titles.mirror=r.mirror),xt.isUndefined(r.zoomin)||(e.buttons.titles.zoomin=r.zoomin),xt.isUndefined(r.originalsize)||(e.buttons.titles.originalsize=r.originalsize),xt.isUndefined(r.zoomout)||(e.buttons.titles.zoomout=r.zoomout),xt.isUndefined(r.stretch)||(e.buttons.titles.stretch=r.stretch),xt.isUndefined(r.fit)||(e.buttons.titles.fit=r.fit),xt.isUndefined(r.fitw)||(e.buttons.titles.fitw=r.fitw),xt.isUndefined(r.fith)||(e.buttons.titles.fith=r.fith),xt.isUndefined(r.hand)||(e.buttons.titles.hand=r.hand),xt.isUndefined(r.rectselect)||(e.buttons.titles.rectselect=r.rectselect),xt.isUndefined(r.zoom)||(e.buttons.titles.zoom=r.zoom),xt.isUndefined(r.restore)||(e.buttons.titles.restore=r.restore),xt.isUndefined(r.save)||(e.buttons.titles.save=r.save),xt.isUndefined(r.close)||(e.buttons.titles.close=r.close),xt.isUndefined(r.removeall)||(e.buttons.titles.removeall=r.removeall),xt.isUndefined(r.removeselected)||(e.buttons.titles.removeselected=r.removeselected));var n=t.buttons.bShowAllButtons;xt.isUndefined(n)||(e.buttons.bShowAllButtons=n);var i=t.buttons.visibility;xt.isUndefined(i)||(xt.isUndefined(i.scan)||(e.buttons.visibility.scan=i.scan),xt.isUndefined(i.load)||(e.buttons.visibility.load=i.load),xt.isUndefined(i.print)||(e.buttons.visibility.print=i.print),xt.isUndefined(i.removeall)||(e.buttons.visibility.removeall=i.removeall),xt.isUndefined(i.removeselected)||(e.buttons.visibility.removeselected=i.removeselected),xt.isUndefined(i.rotateleft)||(e.buttons.visibility.rotateleft=i.rotateleft),xt.isUndefined(i.rotate)||(e.buttons.visibility.rotate=i.rotate),xt.isUndefined(i.rotateright)||(e.buttons.visibility.rotateright=i.rotateright),xt.isUndefined(i.deskew)||(e.buttons.visibility.deskew=i.deskew),xt.isUndefined(i.crop)||(e.buttons.visibility.crop=i.crop),xt.isUndefined(i.cut)||(e.buttons.visibility.cut=i.cut),xt.isUndefined(i.changeimagesize)||(e.buttons.visibility.changeimagesize=i.changeimagesize),xt.isUndefined(i.flip)||(e.buttons.visibility.flip=i.flip),xt.isUndefined(i.mirror)||(e.buttons.visibility.mirror=i.mirror),xt.isUndefined(i.zoomin)||(e.buttons.visibility.zoomin=i.zoomin),xt.isUndefined(i.originalsize)||(e.buttons.visibility.originalsize=i.originalsize),xt.isUndefined(i.zoomout)||(e.buttons.visibility.zoomout=i.zoomout),xt.isUndefined(i.stretch)||(e.buttons.visibility.stretch=i.stretch),xt.isUndefined(i.fit)||(e.buttons.visibility.fit=i.fit),xt.isUndefined(i.fitw)||(e.buttons.visibility.fitw=i.fitw),xt.isUndefined(i.fith)||(e.buttons.visibility.fith=i.fith),xt.isUndefined(i.hand)||(e.buttons.visibility.hand=i.hand),xt.isUndefined(i.rectselect)||(e.buttons.visibility.rectselect=i.rectselect),xt.isUndefined(i.zoom)||(e.buttons.visibility.zoom=i.zoom))}var o=t.dialogText;xt.isUndefined(o)||(xt.isUndefined(o.dlgRotateAnyAngle)||(e.dialogText.dlgRotateAnyAngle=o.dlgRotateAnyAngle),xt.isUndefined(o.dlgChangeImageSize)||(e.dialogText.dlgChangeImageSize=o.dlgChangeImageSize),xt.isUndefined(o.saveChangedImage)||(e.dialogText.saveChangedImage=o.saveChangedImage),xt.isUndefined(o.selectSource)||(e.dialogText.selectSource=o.selectSource))}}},{key:"__bufferChanged",value:function(e,t,r){var n,i=e,o=[],a=-1,s=[];t.operation&&(t.action=t.operation);for(var u=0;u<i.howManyImagesInBuffer;u++)(n=i._defaultDSScanClient.getCustomDataByIndex(u))&&n.uidFromServer&&o.push(n.uidFromServer);if(t.imageIds=o,t.curIndex>=0&&(n=i._defaultDSScanClient.getCustomDataByIndex(t.curIndex))&&n.uidFromServer&&(a=n.uidFromServer),t.currentId=a,t.afterStatus.selectedUids)for(var c=0;c<t.afterStatus.selectedUids.length;c++){var l=t.afterStatus.selectedUids[c];if(l&&-1!=l){var d=i._defaultDSScanClient.getIndexByUid(t.afterStatus.selectedUids[c]);d>=0&&(n=i._defaultDSScanClient.getCustomDataByIndex(d))&&n.serverId&&s.push(n.uidFromServer)}}t.selectedIds=s,xt.mix(t,{}),delete t.uids,delete t.currentUid,delete t.selectedUids,delete t.afterStatus,delete t.beforeStatus,delete t.operation,delete t.curIndex,delete t.docUid,i.__fireEvent("onBufferChanged",t)}},{key:"__acquire",value:function(e,t){var r=e;r._stwain.SelectSource((function(){r._stwain.CloseSource(),r._stwain.OpenSource(),r._stwain.IfShowUI=!0,1==Wt.DWT.IfConfineMaskWithinTheViewer?(Wt.DWT.IfConfineMaskWithinTheViewer=!1,r._stwain.AcquireImage({},(function(){Wt.DWT.IfConfineMaskWithinTheViewer=!0}),(function(){}))):r._stwain.AcquireImage()}),(function(){xt.log("User did not select a source")}))}},{key:"__remove",value:(I=GE(m.mark((function e(t){var r,n;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this,!this._defaultDSScanClient){e.next=10;break}if(aE(this._defaultDSScanClient),!(r.howManyImagesInBuffer<=0||r.currentImageIndexInBuffer<0)){e.next=6;break}return RJ.output(r,"No image in Buffer"),e.abrupt("return",!0);case 6:return n=PJ._getBuffer(this._defaultDSScanClient),e.next=9,this._defaultDSScanClient.removeImages(n.getSelectedImagesIndices());case 9:return e.abrupt("return",e.sent);case 10:return e.abrupt("return",!1);case 11:case"end":return e.stop()}}),e,this)}))),function(e){return I.apply(this,arguments)})},{key:"__removeAll",value:(T=GE(m.mark((function e(t){return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._defaultDSScanClient){e.next=4;break}return aE(this._defaultDSScanClient),e.next=4,this._defaultDSScanClient._removeAllImagesAsync("removeAllImages",!0);case 4:return e.abrupt("return",!1);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return T.apply(this,arguments)})},{key:"__save",value:(S=GE(m.mark((function e(t,r,n,i){var o,a,s;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a="save",s=(o=this).__getViewerElementForViewer(o,i),DR(a,s),e.prev=3,aE(o._defaultDSScanClient),!(o.howManyImagesInBuffer<=0||o.currentImageIndexInBuffer<0)){e.next=8;break}return RJ.output(o,"No image in Buffer"),e.abrupt("return");case 8:return e.next=10,o._defaultDSScanClient.updateImage(t,r,n);case 10:return e.sent,e.next=13,o._defaultDSScanClient.__saveToViewerAfterUpdate(t,n);case 13:e.next=17;break;case 15:e.prev=15,e.t0=e.catch(3);case 17:return e.prev=17,PR(a),e.finish(17);case 20:case"end":return e.stop()}}),e,this,[[3,15,17,20]])}))),function(e,t,r,n){return S.apply(this,arguments)})},{key:"__getViewerElementForViewer",value:function(e,t){var r,n=e;if(t)if(n._viewer.webViewer.imageEditor){var i=n._viewer.createImageEditor();r="dwt-viewer-imageEditor-fullScreen"==i.inner.containerElement.className?{_containerElement:document.body}:{_containerElement:i.inner.containerElement}}else r=n.getViewerElement();else r=n.getViewerElement();return r}},{key:"__close",value:function(e){var t=e;if(xt.isFunction(t.__CloseImageEditorUI))try{t.__CloseImageEditorUI()}catch(r){GC(r)}}},{key:"__deskew",value:function(e,t,r){var n=this,i="deskew";if(aE(n._defaultDSScanClient),n.howManyImagesInBuffer<=0||n.currentImageIndexInBuffer<0)RJ.output(n,"No image in Buffer");else{var o=n.__getViewerElementForViewer(n,!0);DR(i,o),n._defaultDSScanClient.getSkewAngleFromBinaryAsync(n.currentImageIndexInBuffer,t,(function(e){r(e[0]),PR(i)}),(function(){PR(i)}))}}},{key:"__rotate",value:(y=GE(m.mark((function e(t,r,n){var i;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return aE(this._defaultDSScanClient),e.next=4,this._makeSureDefaultServiceInfo();case 4:if(this._defaultDSScanClient){e.next=6;break}throw{code:-2825,message:"Failed to setup the Default Dynamsoft Service."};case 6:return e.next=8,this._defaultDSScanClient.rotate(t,r,n,-1);case 8:return i=e.sent,e.abrupt("return",i);case 10:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return y.apply(this,arguments)})},{key:"__crop",value:(v=GE(m.mark((function e(t,r){var n;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return aE(this._defaultDSScanClient),e.next=4,this._makeSureDefaultServiceInfo();case 4:if(this._defaultDSScanClient){e.next=6;break}throw{code:-2825,message:"Failed to setup the Default Dynamsoft Service."};case 6:return e.next=8,this._defaultDSScanClient.crop(t,r);case 8:return n=e.sent,e.abrupt("return",n);case 10:case"end":return e.stop()}}),e,this)}))),function(e,t){return v.apply(this,arguments)})},{key:"__fireEvent",value:function(e,t){return!xt.isFunction(this[e])||this[e](t)}},{key:"getDevices",value:(_=GE(m.mark((function e(t){var r,n,i,o,a,s,u,c,l,d,f,h,g,p,_,v,y,S,T,I,b,C,w;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._bDispose){e.next=4;break}throw pE(n={}),tA(n);case 4:if(i=[],o="getDevices",a=this.getViewerElement(),s=!1,c=null==t?void 0:t.serviceInfo,l=null!==(r=null==t?void 0:t.deviceType)&&void 0!==r?r:SR,DR(o,a),e.prev=6,f=!1,h=[],this._serviceInfos){e.next=12;break}return e.next=12,this.getDynamsoftService();case 12:if(!c){e.next=25;break}return e.next=15,this._createDSClientByServiceInfo(c,!0);case 15:if(!(p=e.sent)){e.next=21;break}h.push(p),f=!1,e.next=23;break;case 21:throw DE(null==c||null===(_=c.attrs)||void 0===_?void 0:_.ty);case 23:e.next=37;break;case 25:if(!this._serviceInfos){e.next=37;break}g=0;case 27:if(!(g<this._serviceInfos.length)){e.next=36;break}return v=this._serviceInfos[g],e.next=31,this._createDSClientByServiceInfo(v);case 31:(y=e.sent)&&h.push(y);case 33:g++,e.next=27;break;case 36:f=!0;case 37:g=0;case 38:if(!(g<h.length)){e.next=60;break}return S=void 0,e.prev=40,e.next=43,h[g].getDevices(l,null==t?void 0:t.refresh,s);case 43:if(S=e.sent,xt.isArray(S)&&S.length>0)for(u=0;u<S.length;u++)i.push(S[u]);e.next=52;break;case 47:if(e.prev=47,e.t0=e.catch(40),!s){e.next=51;break}throw e.t0;case 51:d=e.t0;case 52:return e.prev=52,T=null,this._defaultDSScanClient&&(T=null===(I=this._defaultDSScanClient.getServiceInfo())||void 0===I||null===(I=I.attrs)||void 0===I?void 0:I.UUID,this._defaultDSScanClient.isDestroy&&(this._disposeDSClientByKey(T),this._defaultDSScanClient=null,T=null)),f&&(C=h[g].getServiceInfo(),(w=null==C||null===(b=C.attrs)||void 0===b?void 0:b.UUID)&&w!=T&&this._disposeDSClientByKey(w)),e.finish(52);case 57:g++,e.next=38;break;case 60:e.next=65;break;case 62:throw e.prev=62,e.t1=e.catch(6),e.t1;case 65:return e.prev=65,PR(o),d&&Wt.DWT.lsetException(d.code,d.message),e.finish(65);case 69:return e.abrupt("return",i);case 70:case"end":return e.stop()}}),e,this,[[6,62,65,69],[40,47,52,57]])}))),function(e){return _.apply(this,arguments)})},{key:"acquireImage",value:(p=GE(m.mark((function e(t,r){var n,i,o,a,s,u,c,l,d,f,h,g,p,_;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=this)._bDispose){e.next=5;break}throw pE(i={}),tA(i);case 5:if(t&&t instanceof gx){e.next=9;break}throw Zw(o={}),{code:o._errorCode,message:o._errorString};case 9:return s="acquireImage",u=n.getViewerElement(),c=[],DR(s,u),e.prev=12,xt.isUndefined(r)&&(r={}),xt.isUndefined(r.IfShowUI)&&(r.IfShowUI=!1),xt.isUndefined(r.IfCloseSourceAfterAcquire)&&(r.IfCloseSourceAfterAcquire=!0),l=t.serviceInfo,e.next=19,this._createDSClientByServiceInfo(l,!0);case 19:if(!(a=e.sent)){e.next=47;break}if(n._defaultDSScanClient){e.next=24;break}return e.next=24,n._innerSetDefault(a);case 24:c.push(a),a!=n._defaultDSScanClient&&c.push(n._defaultDSScanClient),d=0;case 27:if(!(d<c.length)){e.next=36;break}if(f=c[d],PJ._isReady(f)){e.next=33;break}throw p=null!==(h=null===(g=f.getServiceInfo())||void 0===g||null===(g=g.attrs)||void 0===g?void 0:g.name)&&void 0!==h?h:"",dE(f,p),{code:f._getErrorCode(),message:f._getErrorString()};case 33:d++,e.next=27;break;case 36:if(n.onPostTransferAsync?a.registerEvent("OnPostTransferAsync",n.onPostTransferAsync):a.unregisterEvent("OnPostTransferAsync"),this.__setViewerControlInfo(),a!=n._defaultDSScanClient){e.next=43;break}return e.next=41,a.acquireImage(t,r);case 41:e.next=45;break;case 43:return e.next=45,a._acquireImageForSendTo(s,t,r,n._defaultDSScanClient);case 45:e.next=49;break;case 47:throw sE(null==l||null===(_=l.attrs)||void 0===_?void 0:_.name);case 49:e.next=54;break;case 51:throw e.prev=51,e.t0=e.catch(12),e.t0;case 54:return e.prev=54,a&&a.__closeRemoteScanUI(!0),PR(s),e.finish(54);case 58:case"end":return e.stop()}}),e,this,[[12,51,54,58]])}))),function(e,t){return p.apply(this,arguments)})},{key:"_waitForDSValid",value:function(e,t){for(var r=0,n=e.length,i=this;r<n;r++)if(!PJ._isReady(e[r]))return void setTimeout((function(){i._waitForDSValid(e,t)}),sw.RemoteReconnectTimeSpan);xt.isFunction(i[t.command])&&i[t.command].apply(i,t.parmas)}},{key:"getCapabilities",value:(g=GE(m.mark((function e(t){var r,n,i,o,a,s,u;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._bDispose){e.next=4;break}throw pE(r={}),tA(r);case 4:if(t&&t instanceof gx){e.next=8;break}throw Zw(n={}),tA(n);case 8:return o="getCapabilities",a=[],s=this.getViewerElement(),DR(o,s),e.prev=10,u=t.serviceInfo,e.next=14,this._createDSClientByServiceInfo(u,!0);case 14:if(i=e.sent,!(i=this._findDSClientByServiceInfo(u))){e.next=20;break}return e.next=19,i.getCapabilities(t);case 19:a=e.sent;case 20:e.next=25;break;case 22:throw e.prev=22,e.t0=e.catch(10),e.t0;case 25:return e.prev=25,i&&i.__closeRemoteScanUI(!0),PR(o),e.finish(25);case 29:return e.abrupt("return",a);case 30:case"end":return e.stop()}}),e,this,[[10,22,25,29]])}))),function(e){return g.apply(this,arguments)})},{key:"setCapabilities",value:(h=GE(m.mark((function e(t,r){var n,i,o,a,s,u;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._bDispose){e.next=4;break}throw pE(n={}),tA(n);case 4:if(t&&t instanceof gx){e.next=8;break}throw Zw(i={}),tA(i);case 8:return a="setCapabilities",s=this.getViewerElement(),DR(a,s),e.prev=10,u=t.serviceInfo,e.next=14,this._createDSClientByServiceInfo(u,!0);case 14:if(!(o=e.sent)){e.next=18;break}return e.next=18,o.setCapabilities(t,r);case 18:e.next=23;break;case 20:throw e.prev=20,e.t0=e.catch(10),e.t0;case 23:return e.prev=23,o&&o.__closeRemoteScanUI(!0),PR(a),e.finish(23);case 27:case"end":return e.stop()}}),e,this,[[10,20,23,27]])}))),function(e,t){return h.apply(this,arguments)})},{key:"closeSource",value:(f=GE(m.mark((function e(t){var r,n,i,o,a,s;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._bDispose){e.next=4;break}throw pE(r={}),tA(r);case 4:if(t&&t instanceof gx){e.next=8;break}throw Zw(n={}),tA(n);case 8:return i="closeSource",o=this.getViewerElement(),DR(i,o),e.prev=10,a=t.serviceInfo,s=this._findDSClientByServiceInfo(a),e.next=15,s.closeSource();case 15:e.next=20;break;case 17:throw e.prev=17,e.t0=e.catch(10),e.t0;case 20:return e.prev=20,PR(i),e.finish(20);case 23:case"end":return e.stop()}}),e,this,[[10,17,20,23]])}))),function(e){return f.apply(this,arguments)})},{key:"_putDSClientToMap",value:function(e,t){var r,n=null==e||null===(r=e.attrs)||void 0===r?void 0:r.UUID;n&&(this._dsScanClientsMap[n]=t)}},{key:"_getDSClientFromMap",value:function(e){var t,r=null==e||null===(t=e.attrs)||void 0===t?void 0:t.UUID;return r?this._dsScanClientsMap[r]:null}},{key:"_createDSClientByServiceInfo",value:(d=GE(m.mark((function e(t,r,n){var i,o,a,s;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._serviceInfos){e.next=3;break}return e.next=3,this.getDynamsoftService();case 3:if(i=this._findDSClientByServiceInfo(t)){e.next=20;break}return e.next=7,this._setRemoteUuid();case 7:return e.prev=7,e.next=10,PJ.createByServiceInfo(this._uuidForRemoteScanObject,t,n);case 10:(i=e.sent)&&this._putDSClientToMap(t,i),e.next=20;break;case 14:if(e.prev=14,e.t0=e.catch(7),e.t0.code==rw.MustUpgrade&&(a=null==t||null===(o=t.attrs)||void 0===o?void 0:o.ty)&&(Sw(s={},a),e.t0.message=s._errorString),!r){e.next=19;break}throw e.t0;case 19:xt.warn(e.t0);case 20:return e.abrupt("return",i);case 21:case"end":return e.stop()}}),e,this,[[7,14]])}))),function(e,t,r){return d.apply(this,arguments)})},{key:"_makeSureDefaultServiceInfo",value:(l=GE(m.mark((function e(){var t;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._serviceInfos){e.next=3;break}return e.next=3,this.getDynamsoftService();case 3:if(!(this._serviceInfos&&this._serviceInfos.length>0)){e.next=8;break}return t=this._serviceInfos[0],e.next=7,this._createDSClientByServiceInfo(t);case 7:return e.abrupt("return",e.sent);case 8:return e.abrupt("return",null);case 9:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"httpUpload",value:(c=GE(m.mark((function e(t,r,n,i,o,a){var s,u,c,l;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._bDispose){e.next=4;break}return pE(s={}),e.abrupt("return",Dt.Promise.reject(tA(s)));case 4:return c=this.getViewerElement(),l=c._containerElement,e.next=7,this._makeSureDefaultServiceInfo();case 7:if(this._defaultDSScanClient){e.next=9;break}throw{code:-2825,message:"Failed to setup the Default Dynamsoft Service."};case 9:return e.next=11,this._defaultDSScanClient.httpUpload(t,r,n,i,o,a,l);case 11:return u=e.sent,e.abrupt("return",u);case 13:case"end":return e.stop()}}),e,this)}))),function(e,t,r,n,i,o){return c.apply(this,arguments)})},{key:"runCommand",value:function(e){return this._defaultDSScanClient.RunCommandAsync(e)}},{key:"removeImages",value:(u=GE(m.mark((function e(t){var r,n,i,o,a;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._bDispose){e.next=4;break}return pE(r={}),e.abrupt("return",Dt.Promise.reject(tA(r)));case 4:return n="removeImages",o=this.getViewerElement(),DR(n,o),e.prev=6,e.next=9,this._makeSureDefaultServiceInfo();case 9:if(this._defaultDSScanClient){e.next=11;break}throw{code:-2825,message:"Failed to setup the Default Dynamsoft Service."};case 11:if(!this._defaultDSScanClient){e.next=17;break}return e.next=14,this._defaultDSScanClient.removeImages(t);case 14:i=e.sent,e.next=21;break;case 17:if(0!=this.howManyImagesInBuffer){e.next=21;break}if(a={},Fj(t,this.howManyImagesInBuffer,a)){e.next=21;break}throw{code:a._errorCode,message:a._errorString};case 21:e.next=26;break;case 23:throw e.prev=23,e.t0=e.catch(6),e.t0;case 26:return e.prev=26,PR(n),e.finish(26);case 29:return e.abrupt("return",i);case 30:case"end":return e.stop()}}),e,this,[[6,23,26,29]])}))),function(e){return u.apply(this,arguments)})},{key:"saveImages",value:(a=GE(m.mark((function e(t,r,n){var i,o,a,s;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i={},!this._bDispose){e.next=4;break}return pE(i),e.abrupt("return",Dt.Promise.reject(tA(i)));case 4:if(0!=this.howManyImagesInBuffer){e.next=7;break}return mw(i),e.abrupt("return",Dt.Promise.reject(tA(i)));case 7:if(xt.isNumber(n)){e.next=10;break}return Zw(i),e.abrupt("return",Dt.Promise.reject(tA(i)));case 10:if(n!=dx.IT_BMP&&n!=dx.IT_JPG&&n!=dx.IT_PNG){e.next=16;break}if(!(r.length>1)){e.next=14;break}return fw(i,-2623,"Saving multiple images is not allowable when the selected output format is BMP, JPG or PNG."),e.abrupt("return",Dt.Promise.reject(tA(i)));case 14:e.next=26;break;case 16:if(n!=dx.IT_TIF&&n!=dx.IT_PDF){e.next=19;break}e.next=26;break;case 19:if(n!=dx.IT_ALL&&n!=dx.IT_MULTIPAGE_PDF&&n!=dx.IT_MULTIPAGE_TIF){e.next=24;break}return mE(i),e.abrupt("return",Dt.Promise.reject(tA(i)));case 24:return Hw(i),e.abrupt("return",Dt.Promise.reject(tA(i)));case 26:return a=this.getViewerElement(),s=a._containerElement,e.next=29,this._makeSureDefaultServiceInfo();case 29:if(this._defaultDSScanClient){e.next=31;break}throw{code:-2825,message:"Failed to setup the Default Dynamsoft Service."};case 31:return e.next=33,this._defaultDSScanClient.saveImages(t,r,n,s);case 33:return o=e.sent,e.abrupt("return",o);case 35:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return a.apply(this,arguments)})},{key:"getImages",value:(o=GE(m.mark((function e(t,r,n){var i,o,a,s;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i={},!this._bDispose){e.next=4;break}return pE(i),e.abrupt("return",Dt.Promise.reject(tA(i)));case 4:if(0!=this.howManyImagesInBuffer){e.next=7;break}return mw(i),e.abrupt("return",Dt.Promise.reject(tA(i)));case 7:if(xt.isNumber(r)&&xt.isNumber(n)){e.next=10;break}return Zw(i),e.abrupt("return",Dt.Promise.reject(tA(i)));case 10:return a=this.getViewerElement(),s=a._containerElement,e.next=13,this._makeSureDefaultServiceInfo();case 13:if(this._defaultDSScanClient){e.next=15;break}throw{code:-2825,message:"Failed to setup the Default Dynamsoft Service."};case 15:return e.next=17,this._defaultDSScanClient.getImages(t,r,n,s);case 17:return o=e.sent,e.abrupt("return",o);case 19:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return o.apply(this,arguments)})},{key:"__unload",value:(i=GE(m.mark((function e(){var t,r,n,i;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._viewer&&this._viewer.unbind(),!this._dsScanClientsMap){e.next=12;break}r=this._dsScanClientsMap,n=Object.keys(r),t=0;case 5:if(!(t<n.length)){e.next=12;break}return i=n[t],e.next=9,this._disposeDSClientByKey(i);case 9:t++,e.next=5;break;case 12:this._dsScanClientsMap=null,this._bDispose=!0;case 14:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"dispose",value:function(){return this.__unload()}},{key:"setLogLevel",value:function(e){var t,r=this._dsScanClientsMap;if(r){var n=Object.keys(r);for(t=0;t<n.length;t++)r[n[t]]._setLogLevel(e);this._needSetLogLevel=!1,this._logLevel=-1}else this._needSetLogLevel=!0,this._logLevel=e;return!0}},{key:"getProfile",value:(n=GE(m.mark((function e(t){var r,n,i,o;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r="",t&&t instanceof gx){e.next=5;break}throw Zw(n={}),{code:n._errorCode,message:n._errorString};case 5:return e.prev=5,i=t.serviceInfo,e.next=9,this._createDSClientByServiceInfo(i,!0);case 9:if(!(o=e.sent)){e.next=14;break}return e.next=13,o.getProfile(t);case 13:r=e.sent;case 14:e.next=19;break;case 16:throw e.prev=16,e.t0=e.catch(5),e.t0;case 19:return e.abrupt("return",r);case 20:case"end":return e.stop()}}),e,this,[[5,16]])}))),function(e){return n.apply(this,arguments)})},{key:"setProfile",value:(r=GE(m.mark((function e(t,r){var n,i,o,a;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n="",t&&t instanceof gx){e.next=5;break}throw Zw(i={}),{code:i._errorCode,message:i._errorString};case 5:return e.prev=5,o=t.serviceInfo,e.next=9,this._createDSClientByServiceInfo(o,!0);case 9:if(!(a=e.sent)){e.next=14;break}return e.next=13,a.setProfile(t,r);case 13:n=e.sent;case 14:e.next=19;break;case 16:throw e.prev=16,e.t0=e.catch(5),e.t0;case 19:return e.abrupt("return",n);case 20:case"end":return e.stop()}}),e,this,[[5,16]])}))),function(e,t){return r.apply(this,arguments)})},{key:"imageIDToIndex",value:function(e){return this._defaultDSScanClient?this._defaultDSScanClient.imageIDToIndex(e):0}},{key:"indexToImageID",value:function(e){return this._defaultDSScanClient?this._defaultDSScanClient.indexToImageID(e):""}},{key:"howManyImagesInBuffer",get:function(){return this._defaultDSScanClient?this._defaultDSScanClient.howManyImagesInBuffer:0}},{key:"currentImageIndexInBuffer",get:function(){return this._defaultDSScanClient?this._defaultDSScanClient.currentImageIndexInBuffer:-1},set:function(e){this._defaultDSScanClient&&(this._defaultDSScanClient.currentImageIndexInBuffer=e)}},{key:"showProgressBar",get:function(){return this._defaultDSScanClient?this._defaultDSScanClient.IfShowProgressBar:this._showProgressBar},set:function(e){this._defaultDSScanClient?(this._showProgressBar=e,this._defaultDSScanClient.IfShowProgressBar=e):this._showProgressBar}},{key:"registerEvent",value:function(e,t){if(this._bDispose){var r={};return pE(r),Dt.Promise.reject(tA(r))}if(!xt.isFunction(t)){var n={};return eE(n),Dt.Promise.reject(tA(n))}if("onBufferChanged"==e||"OnBufferChanged"==e)this.onBufferChanged=t;else{if("onPostTransferAsync"!=e&&"OnPostTransferAsync"!=e){var i={};return Qw(i),Dt.Promise.reject(tA(i))}this.onPostTransferAsync=t}return this._registEventToDefaultDS(),!0}},{key:"unregisterEvent",value:function(e,t){if(this._bDispose){var r={};return pE(r),Dt.Promise.reject(tA(r))}if("onBufferChanged"==e||"OnBufferChanged"==e){if(this.onBufferChanged=null,this._defaultDSScanClient)return this._defaultDSScanClient.unregisterEvent("OnBufferChanged",t)}else{if("onPostTransferAsync"!=e&&"OnPostTransferAsync"!=e){var n={};return Qw(n),Dt.Promise.reject(tA(n))}if(this.onPostTransferAsync=null,this._defaultDSScanClient)return this._defaultDSScanClient.unregisterEvent("OnPostTransferAsync",t)}}},{key:"getViewerElement",value:function(){return this.Viewer&&this.Viewer.webViewer&&this.Viewer.webViewer.containerElement?{_containerElement:this.Viewer.webViewer.containerElement}:{_containerElement:document.body}}},{key:"isSameService",value:function(e,t){return!(!e||!t)&&e.server==t.server&&e.attrs.UUID==t.attrs.UUID&&e.attrs.accessmode==t.attrs.accessmode&&e.attrs.name==t.attrs.name&&e.attrs.os==t.attrs.os&&e.attrs.service_type==t.attrs.service_type&&e.attrs.tags==t.attrs.tags&&e.attrs.ty==t.attrs.ty&&e.attrs.type==t.attrs.type&&e.attrs.txtvers==t.attrs.txtvers}},{key:"_findDSClientByServiceInfo",value:function(e){var t,r=this._serviceInfos;if(r)for(t=0;t<r.length;t++){var n=r[t];if(this.isSameService(e,n)){var i=this._getDSClientFromMap(n);if(i){var o;if(PJ._isReady(i))return i;i.isDestroy||i.dispose();var a=null==n||null===(o=n.attrs)||void 0===o?void 0:o.UUID;a&&delete this._dsScanClientsMap[a]}break}}return null}},{key:"_setRemoteUuid",value:(e=GE(m.mark((function e(){var t;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!lw()){e.next=8;break}if(this._uuidForRemoteScanObject){e.next=6;break}return e.next=4,Wt.DWT.lgcuid(Wt.DWT.EnumInstance.dwt_desktop,"");case 4:t=e.sent,this._uuidForRemoteScanObject=t;case 6:e.next=8;break;case 8:case"end":return e.stop()}}),e,this)}))),function(){return e.apply(this,arguments)})},{key:"_registEventToDefaultDS",value:function(){this._defaultDSScanClient&&(this.onBufferChanged&&this._defaultDSScanClient.registerEvent("OnBufferChanged",this.onBufferChanged),this.onPostTransferAsync&&this._defaultDSScanClient.registerEvent("OnPostTransferAsync",this.onPostTransferAsync))}}]);var e,r,n,i,o,a,u,c,l,d,f,h,g,p,_,v,y,S,T,I,b,C,w,E}(),kJ=!1;function FJ(e,t){return OJ.apply(this,arguments)}function OJ(){return OJ=GE(m.mark((function e(t,r){var n,i;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r&&SD(CD),sP.isLicenseMixed(null,!0)||sP.reparseProductKey(r),0==(n=Wt.DWT.licenseException).code){e.next=6;break}throw t&&ex(n),{code:n.code,message:n.message};case 6:if(kJ){e.next=14;break}if(i=!1,Y.bIE&&(i=Y.IEVersion<=7),i||!lw()){e.next=14;break}if(!Wt.DWT.bChromeExtension){e.next=13;break}return kJ=!0,e.abrupt("return");case 13:return e.abrupt("return",new Dt.Promise((function(e,t){var r=Wt.DWT.ResourcesPath,n="";Y.bFileSystem||(n=Dt.timestamp),xt.addScript([r,"/src/dynamsoft.lts.js",n].join(""),!0,!1,(function(r){if(Wt.LTS&&Wt.LTS._)return kJ=!0,void e();if(r){if(Y.bIE)return void t({code:-2822,message:"The WebTwain JavaScript lts.js load failed."});if("error"==r.type)return void t({code:-2822,message:"The WebTwain JavaScript lts.js load failed."})}kJ=!0,e()}))})));case 14:case"end":return e.stop()}}),e)}))),OJ.apply(this,arguments)}function WJ(e,t,r){return NJ.apply(this,arguments)}function NJ(){return NJ=GE(m.mark((function e(t,r,n){var i,o,a,s,u,c,l,d,f,h,g;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=Wt.DWT.Containers,o=0;case 2:if(!(o<i.length)){e.next=52;break}if(!(a=xt.clone(i[o])).ContainerId){e.next=8;break}if(!Wt.DWT.ContainerMap[a.ContainerId]){e.next=8;break}return e.abrupt("continue",49);case 8:if(!a.WebTwainId){e.next=12;break}if(!Wt.DWT.WebTwainIdMap[a.WebTwainId]){e.next=12;break}return e.abrupt("continue",49);case 12:if(a.Host=t,a.SSLPort=n,a.Port=r,!xt.isDOM(a.Container)){e.next=18;break}e.next=25;break;case 18:if(!a.ContainerId){e.next=25;break}if(c=a.ContainerId,xt.isString(c)){e.next=22;break}throw{code:-2806,message:'Error: The argument passed to the parameter "conatinerId" is not a string.'};case 22:if(a.Container=xt.get(c),a.Container){e.next=25;break}throw TE(c);case 25:if(!IH(a.Container)){e.next=32;break}return l=document.createElement("div"),a.Container.appendChild(l),a.Container=l,d=TH(l),e.next=32,Cx(d);case 32:return yx(f=Jz(a)),h=void 0,e.prev=35,e.next=38,gJ.create(f);case 38:h=e.sent,e.next=45;break;case 41:throw e.prev=41,e.t0=e.catch(35),h&&h.dispose(),e.t0;case 45:if(0===(u=Wt.DWT.licenseException).code){e.next=48;break}throw{code:u.code,message:u.message};case 48:s=h;case 49:o++,e.next=2;break;case 52:g=window,s&&(g.DCP_DWT_OnClickCloseInstall&&g.DCP_DWT_OnClickCloseInstall(!1,!0),EJ(s),kj(s)),setTimeout((function(){try{xt.isFunction(Wt.DWT.OnWebTwainReady)?Wt.DWT.OnWebTwainReady():xt.isFunction(g.Dynamsoft_OnReady)&&g.Dynamsoft_OnReady()}catch(e){GC(e)}}),100);case 55:case"end":return e.stop()}}),e,null,[[35,41]])}))),NJ.apply(this,arguments)}function MJ(){return LJ.apply(this,arguments)}function LJ(){return LJ=GE(m.mark((function e(){var t,r,n,i,o,a,s,u,c,l,d,f,h,g;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Dt.page.bUnload=Lb,e.next=3,FJ(!0,!0);case 3:if(aw.bHTML5Edition){e.next=5;break}return e.abrupt("return",Wt.DWT._innerLoad());case 5:if((t=Wt.DWT.Containers)&&0!==t.length){e.next=10;break}throw _E(r={}),{code:r._errorCode,message:r._errorString};case 10:o=!1,a=[],s=[],n=0;case 12:if(!(n<t.length)){e.next=37;break}if(!(i=t[n])){e.next=32;break}if(xt.isObject(i)){e.next=18;break}return o=!0,e.abrupt("break",37);case 18:if(!xt.isString(i.WebTwainId)||""==i.WebTwainId){e.next=24;break}if(!Ex(a,i.WebTwainId)){e.next=23;break}throw bE(r={}),{code:r._errorCode,message:r._errorString};case 23:a.push(i.WebTwainId);case 24:if(!xt.isString(i.ContainerId)||""==i.ContainerId){e.next=30;break}if(!Ex(s,i.ContainerId)){e.next=29;break}throw CE(r={}),{code:r._errorCode,message:r._errorString};case 29:s.push(i.ContainerId);case 30:e.next=34;break;case 32:return o=!0,e.abrupt("break",37);case 34:n++,e.next=12;break;case 37:if(!o){e.next=41;break}throw vE(u={}),{code:u._errorCode,message:u._errorString};case 41:return c=JC(),l=Wt.DWT.Port,d=Wt.DWT.SSLPort,e.next=44,nK(c,l,d);case 44:if(!Wt.DWT.IfCheckDCP){e.next=65;break}return f=Y.bSSL?d:l,e.next=48,Wx(c,l,d);case 48:if(!(h=e.sent)){e.next=54;break}l=h.port,d=h.sslPort,e.next=57;break;case 54:throw SE(g={}),tA(g);case 57:if(!Wt.dcp.bEnhancedMode){e.next=65;break}return e.prev=58,e.next=61,ZA.closeWsClient(c,f,Y.bSSL);case 61:e.next=65;break;case 63:e.prev=63,e.t0=e.catch(58);case 65:return SD(FD),e.next=68,WJ(c,l,d);case 68:case"end":return e.stop()}}),e,null,[[58,63]])}))),LJ.apply(this,arguments)}var BJ=new(s((function e(){t(this,e)}),[{key:"InvalidValue",value:function(e){_w(e)}},{key:"ParameterCannotEmpty",value:function(e){kw(e)}},{key:"Webcam_InvalidIndex",value:function(e,t){fw(e,-2315,"The index is out of range.")}},{key:"Webcam_InvalidRemoteFilename",value:function(e){fw(e,-2316,"The RemoteFile field is empty in the Webcam Download Function.")}},{key:"InvalidDestination",value:function(e){fw(e,-2318,"Invalid destination file.")}},{key:"InvalidSourceFile",value:function(e){fw(e,-2319,"Invalid source file.")}},{key:"InvalidFile",value:function(e){Fw(e)}},{key:"OCR_InvalidIndex",value:function(e,t){fw(e,-2321,"The index is out of range.")}},{key:"OCR_InvalidLeftOrTopOrRightOrBottom",value:function(e){fw(e,-2322,"The left or top or right or bottom you entered is invalid.")}},{key:"OCR_InvalidOutputFormat",value:function(e){fw(e,-2323,"The OCR output format is not supported.")}},{key:"OCR_InvalidPageSetMode",value:function(e){fw(e,-2324,"The OCR page set mode is not supported.")}},{key:"IndexOutOfRange",value:function(e){Gw(e)}},{key:"OCR_InvalidRemoteFilename",value:function(e){fw(e,-2379,"The RemoteFile field is empty in the OCR Download Function.")}},{key:"ImageEditorOpenCannotPlayVideo",value:function(e){fw(e,-2437,"The video can not be played while the Image Editor is open.")}},{key:"EventNotExist",value:function(e){fw(e,-2509,"The specified event doesn't exist.")}},{key:"CallbackNotAFunction",value:function(e){eE(e)}},{key:"WasmNotLoaded",value:function(e){fw(e,-2537,"The wasm not loaded.")}},{key:"WasmNotLoaded_UseWasmFalse",value:function(e){fw(e,-2538,"The wasm not loaded when Dynamsoft.DWT.UseCameraAddonWasm is set to false.")}},{key:"CannotDoWhenNoViewerJS",value:function(e){iE(e)}},{key:"LicenseNoDbr",value:function(e){fw(e,-2611,"The license for the Barcode module is invalid."),hw(e)}}]));if(aw.bHTML5Edition){var UJ=function(){var e=GE(m.mark((function e(t){var r,n,i,o,a,s,u,c;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return bz(),e.next=3,FJ(!0,!1);case 3:if(Wt.DWT.UseDefaultViewer||(t.Container=null),!IH(t.Container)){e.next=11;break}return n=document.createElement("div"),t.Container.appendChild(n),t.Container=n,i=TH(n),e.next=11,Cx(i);case 11:return r=Jz(t),e.next=14,Pz();case 14:return e.next=16,Kz();case 16:o=3,a=0;case 18:if(!(a<o)){e.next=35;break}return e.prev=19,e.next=22,nK(r.host,r.port,r.sslPort);case 22:return e.abrupt("break",35);case 25:if(e.prev=25,e.t0=e.catch(19),!(a<o-1&&e.t0.code==rw.DWTPortNotReady)){e.next=31;break}return e.next=30,new Dt.Promise((function(e,t){setTimeout((function(){e()}),300)}));case 30:return e.abrupt("continue",32);case 31:throw e.t0;case 32:a++,e.next=18;break;case 35:if(!Wt.DWT.IfCheckDCP){e.next=47;break}return e.next=38,Wx(r.host,r.port,r.sslPort);case 38:if(!(s=e.sent)){e.next=44;break}r.port=s.port,r.sslPort=s.sslPort,e.next=47;break;case 44:throw SE(u={}),tA(u);case 47:return SD("Creating a WebTwain instance..."),e.next=50,bJ(r);case 50:return c=e.sent,e.abrupt("return",c);case 52:case"end":return e.stop()}}),e,null,[[19,25]])})));return function(t){return e.apply(this,arguments)}}(),VJ=window;Wt.DWT.OnBeforeUnload=function(e){},VJ.addEventListener("beforeunload",(function(e){if(Dt.isFunction(Wt.DWT.OnBeforeUnload))return Wt.DWT.OnBeforeUnload(e)})),Wt.DWT.Unload=GE(m.mark((function e(){var t;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!aw.bDWTLoading&&!aw.bDWTUnloading){e.next=2;break}return e.abrupt("return");case 2:return aw.bDWTUnloading=!0,e.prev=3,e.next=6,GJ(!1,!0);case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(3),t=e.t0;case 11:try{zJ(),Wt.DWT.CloseDialog(),Dt._zdgb_xkz_dhk(),Dt.closeProgress(null,""),Dt.hideMask(),bx()}catch(r){}if(aw.bDWTLoading=!1,aw.bDWTUnloading=!1,!t){e.next=16;break}throw t;case 16:case"end":return e.stop()}}),e,null,[[3,8]])}))),Wt.DWT.Load=GE(m.mark((function e(){var t,r;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!aw.bDWTLoading){e.next=2;break}return e.abrupt("return");case 2:if(!aw.bDWTUnloading){e.next=5;break}return setTimeout(Wt.DWT.Load,500),e.abrupt("return");case 5:return aw.bDWTLoading=!0,HJ(),e.prev=7,e.prev=8,e.next=11,Lz();case 11:return e.next=13,Pz();case 13:return e.next=15,Kz();case 15:e.next=21;break;case 17:throw e.prev=17,e.t0=e.catch(8),XR(e.t0),e.t0;case 21:return e.prev=21,Wt.Lib.closeProgress(),e.next=25,GJ(!0,!0);case 25:e.next=31;break;case 27:return e.prev=27,e.t1=e.catch(21),e.next=31,GJ();case 31:e.prev=31,Wt.DWT.CloseDialog(),t=3,r=0;case 35:if(!(r<t)){e.next=52;break}return e.prev=36,e.next=39,MJ();case 39:return e.abrupt("break",52);case 42:if(e.prev=42,e.t2=e.catch(36),!(r<t-1&&e.t2.code==rw.DWTPortNotReady)){e.next=48;break}return e.next=47,new Dt.Promise((function(e,t){setTimeout((function(){e()}),300)}));case 47:return e.abrupt("continue",49);case 48:throw e.t2;case 49:r++,e.next=35;break;case 52:e.next=66;break;case 54:return e.prev=54,e.t3=e.catch(31),ZR(e.t3.code)||Dt.detect.bOK||xt.asyncQueue.pushToDo(null,Wt.DWT.Load),XR(e.t3),e.prev=59,e.next=62,GJ();case 62:e.next=66;break;case 64:e.prev=64,e.t4=e.catch(59);case 66:return e.prev=66,aw.bDWTLoading=!1,zJ(),e.finish(66);case 70:case"end":return e.stop()}}),e,null,[[7,,66,70],[8,17],[21,27],[31,54],[36,42],[59,64]])}))),Wt.DWT.CheckConnectToTheService=function(e,t,r,n){uK(e,t,null,r,n)},Wt.DWT.ConnectToTheService=function(){xt.asyncQueue.start()},Wt.DWT.CreateDWTObject=function(e,t,r,n,i,o){var a,s=i,u=o;xt.isFunction(t)&&xt.isFunction(r)?(s=t,u=r,a={}):a={Host:t,Port:r,SSLPort:n};var c,l=e;if(xt.isString(l)&&!(l=xt.get(l)))return function(e){fw(e,-2813,pC.ErrStr_CreateID_NotContainer)}(c={}),u&&u({code:c._errorCode,message:c._errorString}),Lb;if(xt.isDOM(l))a.Container=l;else{if(!xt.isString(e)){return xt.isFunction(u)&&u({code:-2806,message:'Error: The argument passed to the parameter "conatinerId" is not a string.'}),Lb}if(!xt.get(e)){var d=TE(e);return xt.isFunction(u)&&u(d),Lb}}return a.WebTwainId=ER(),Wt.DWT.CreateDWTObjectEx(a,s,u)},Wt.DWT.CreateDWTObjectEx=function(e,t,r){var n=arguments,i=!!e.bLoadingDialogOpened;return aw.loadResourcePath?xt.isString(e.WebTwainId)?(i||HJ(),delete e.bLoadingDialogOpened,UJ(e).then((function(e){zJ(),kj(e),xt.isFunction(t)&&t(e)}),(function(e){if(zJ(),!Dt.detect.bOK){var t=e&&e.code,i=Wt.DWT.licenseException;(t&&!ZR(t)||0==i.code)&&(xt.asyncQueue.stop(),xt.asyncQueue.pushToDo(null,Wt.DWT.CreateDWTObjectEx,n))}xt.isFunction(r)&&r(e)})),!0):(i&&zJ(),r&&r({code:-2805,message:'Error: The "WebTwainId" is not a string.'}),Lb):(i||(HJ(),e.bLoadingDialogOpened=!0),void Lz().then(Pz).then((function(){setTimeout((function(){Wt.DWT.CreateDWTObjectEx(e,t,r)}),100)}),(function(e){zJ(),r(e)})))},Wt.DWT.CreateRemoteScanObjectAsync=function(){var e=GE(m.mark((function e(t){var r,n;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=null,t){e.next=5;break}throw Zw(n={}),{code:n._errorCode,message:n._errorString};case 5:return aw.bDWTLoading=!0,HJ(),e.prev=7,e.next=10,Pz();case 10:return e.next=12,Kz();case 12:return e.next=14,FJ(!1,!1);case 14:r=new xJ(t),Object.preventExtensions(r);case 16:return e.prev=16,aw.bDWTLoading=!1,zJ(),e.finish(16);case 20:return e.abrupt("return",r);case 21:case"end":return e.stop()}}),e,null,[[7,,16,20]])})));return function(t){return e.apply(this,arguments)}}(),Wt.DWT.DeleteDWTObject=function(e){var t,r=e;return aw.bHTML5Edition&&r?!!(t=xt.isString(r)?Wt.DWT.GetWebTwain(r):r)&&(t.dispose(),!0):Lb}}function GJ(e,t){return jJ.apply(this,arguments)}function jJ(){return jJ=GE(m.mark((function e(t,r){var n,i,o,a,s,u,c;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&SD(bD),!r){e.next=4;break}return e.next=4,Wt.DWT.lunload();case 4:if(Dt.dlgProgress=!1,Dt.detect.bOK=!1,Dt.detect.bFirst=!0,!(a=Wt.DWT.WebTwainIdMap)){e.next=32;break}s=Object.keys(a),n=0;case 11:if(!(n<s.length)){e.next=32;break}if(!(o=s[n])||!(o in a)){e.next=29;break}if(!(i=a[o])){e.next=29;break}if(e.prev=16,!i.__unload){e.next=22;break}return e.next=20,i.__unload();case 20:e.next=24;break;case 22:return e.next=24,i.dispose();case 24:e.next=29;break;case 26:e.prev=26,e.t0=e.catch(16),u=e.t0;case 29:n++,e.next=11;break;case 32:if(!(a=Wt.DWT.ContainerMap)){e.next=57;break}s=Object.keys(a),n=0;case 36:if(!(n<s.length)){e.next=57;break}if(!(o=s[n])||!(o in a)){e.next=54;break}if(!(i=a[o])){e.next=54;break}if(e.prev=41,!i.__unload){e.next=47;break}return e.next=45,i.__unload();case 45:e.next=49;break;case 47:return e.next=49,i.dispose();case 49:e.next=54;break;case 51:e.prev=51,e.t1=e.catch(41),u=e.t1;case 54:n++,e.next=36;break;case 57:if(!(a=Wt.DWT.RemoteScanIdMap)){e.next=82;break}s=Object.keys(a),n=0;case 61:if(!(n<s.length)){e.next=82;break}if(!(o=s[n])||!(o in a)){e.next=79;break}if(!(i=a[o])){e.next=79;break}if(e.prev=66,!i.__unload){e.next=72;break}return e.next=70,i.__unload();case 70:e.next=74;break;case 72:return e.next=74,i.dispose();case 74:e.next=79;break;case 76:e.prev=76,e.t2=e.catch(66),u=e.t2;case 79:n++,e.next=61;break;case 82:for(n=0;n<aw.unloadQueue.length;n++)c=aw.unloadQueue[n],xt.isFunction(c)&&c();if(aw.unloadQueue.splice(0),!u){e.next=86;break}throw u;case 86:case"end":return e.stop()}}),e,null,[[16,26],[41,51],[66,76]])}))),jJ.apply(this,arguments)}function HJ(){aw.bHTML5Edition&&(yH(),DR("openLoadingMsg",null,{width:Dt.loaderBarWidth+"px"}))}function zJ(){aw.bHTML5Edition&&PR("closeLoadingMsg:")}function KJ(e,t){var r,n=this,i=0;r=xt.isString(e)?document.getElementById(e):e,n.isLoaded=!1,n.displayType=0,n.progress=0,n.progressPosition=0,n.borderWidth={left:0,right:0,top:0,bottom:0},n.orientation=t.orientation||KJ.Orientation.Horizontal,n.direction=t.direction||KJ.Direction.LeftToRight,n.creationType=t.creationType||KJ.CreationType.Replace,n.value=0,n.initialValue=t.value||0,n.minValue=t.minValue||0,n.maxValue=t.maxValue||100,n.showLabel="undefined"==typeof t.showLabel||t.showLabel,n.labelText=t.labelText||"",n.width=t.width||280,n.height=t.height||20,n.borderRadius=t.borderRadius||10,n.orientation==KJ.Orientation.Horizontal&&n.borderRadius>n.height/2&&(n.borderRadius=Math.round(n.height/2)),n.orientation==KJ.Orientation.Vertical&&n.borderRadius>n.width/2&&(n.borderRadius=Math.round(n.width/2)),n.backColor=t.backColor||"",n.color=t.color||"#50a8e1",n.animationStyle=0,n.animationInterval=t.animationInterval||100;var o=["parent","background","wrapper","left","middle","right","horizontalText","verticalText","marker"];for(n.extraClassName={},i=0;i<o.length;i++)t.extraClassName?"string"==typeof t.extraClassName?n.extraClassName[o[i]]=t.extraClassName:n.extraClassName[o[i]]=t.extraClassName[o[i]]||"":n.extraClassName[o[i]]="";n.onLoad=t.onLoad||null,n.onValueChanged=t.onValueChanged||null,n.onAnimate=t.onAnimate||null,n.creationType==KJ.CreationType.Replace?n.parentElement=r:(n.parentElement=document.createElement("DIV"),r.appendChild(n.parentElement)),n.finishLoading()}Dt.Errors=BJ,yD(GE(m.mark((function e(){var t,r,n,i;return m.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((t=window)&&(xt.addEventListener(t,"focus",(function(){var e;(e=Wt.DWT.WebTwainIdMap)&&xt.each(e,(function(e,t){e&&e._OnPageFocus&&e._OnPageFocus()}))})),xt.addEventListener(t,"blur",(function(){Y.bWin&&Bz()})),r=t.document,xt.addEventListener(r,"visibilitychange",(function(){Y.bWin&&"hidden"==r.visibilityState&&Bz()}))),Wt.navInfo){e.next=11;break}return e.prev=3,e.next=6,uD();case 6:Wt.navInfo=e.sent,e.next=11;break;case 9:e.prev=9,e.t0=e.catch(3);case 11:if(!1!==Wt.DWT.AutoLoad&&!aw.bDWTLoading){e.next=13;break}return e.abrupt("return");case 13:return e.prev=13,e.next=16,Lz();case 16:if(!(Wt.DWT.Containers&&Wt.DWT.Containers.length>0&&Wt.DWT.AutoLoad)||aw.bDWTLoading){e.next=48;break}return aw.bDWTLoading=!0,HJ(),e.prev=20,e.next=23,Pz();case 23:return e.next=25,Kz();case 25:n=3,i=0;case 27:if(!(i<n)){e.next=44;break}return e.prev=28,e.next=31,MJ();case 31:return e.abrupt("break",44);case 34:if(e.prev=34,e.t1=e.catch(28),!(i<n-1&&e.t1.code==rw.DWTPortNotReady)){e.next=40;break}return e.next=39,new Dt.Promise((function(e,t){setTimeout((function(){e()}),300)}));case 39:return e.abrupt("continue",41);case 40:throw e.t1;case 41:i++,e.next=27;break;case 44:return e.prev=44,aw.bDWTLoading=!1,zJ(),e.finish(44);case 48:e.next=62;break;case 50:return e.prev=50,e.t2=e.catch(13),ZR(e.t2.code)||Dt.detect.bOK||xt.asyncQueue.pushToDo(null,Wt.DWT.Load),XR(e.t2),e.prev=55,e.next=58,GJ();case 58:e.next=62;break;case 60:e.prev=60,e.t3=e.catch(55);case 62:case"end":return e.stop()}}),e,null,[[3,9],[13,50],[20,,44,48],[28,34],[55,60]])})))),KJ.Orientation={Horizontal:0,Vertical:1},KJ.Direction={LeftToRight:0,RightToLeft:1,TopToBottom:0,BottomToTop:1},KJ.CreationType={Replace:0,AppendChild:1},KJ.AnimationStyle={None:0,Static:1,StaticFull:2,Custom:3,CustomFull:4,Flickering1:10,Flickering2:11,Flickering3:12,LeftToRight1:20,LeftToRight2:21,RightToLeft1:22,RightToLeft2:23,TwoWay:24},KJ.prototype.finishLoading=function(){var e,t=this;t.wrapperElement=null,t.backgroundElement=null,t.valueElement=null,t.leftElement=null,t.middleElement=null,t.rightElement=null,t.backgroundElement=document.createElement("DIV"),t.backgroundElement.className="progressbar_background"+(t.extraClassName.background?" ":"")+t.extraClassName.background,t.backgroundElement.style.cssText=t.backgroundElement.style.cssText+KJ._createBorderRadiusCss(t.borderRadius),t.parentElement.appendChild(t.backgroundElement);var r=["border-radius","border-bottom-right-radius","-moz-border-radius-bottomright","-webkit-border-bottom-right-radius","-khtml-border-radius-bottomright","-khtml-border-bottom-right-radius"],n=0,i="";for(n=0;n<r.length&&!(i=KJ._elementCurrentStyle(t.backgroundElement,r[n]))&&"string"!=typeof i;n++);""!=i&&KJ._parseInt(i)!=t.borderRadius&&(t.borderRadius=KJ._parseInt(i)),t.orientation==KJ.Orientation.Horizontal||t.orientation==KJ.Orientation.Vertical?t.displayType=0:t.displayType=1,t.parentElement.className=(""!=t.parentElement.className?" ":"")+"progressbar_parent dynamsoft-progressBar"+(t.extraClassName.parent?" ":"")+t.extraClassName.parent,0==t.displayType?((e=t.wrapperElement=document.createElement("DIV")).style.border="1px solid #A0A0A0",e.style.cssFloat="left",e.style.display="inline-block",e.style.width=t.width+"px",e.style.height=t.height+"px",e.style.left="0px",e.style.top=-t.height+"px",e.style.backgroundColor=t.backColor,e.style.backgroundRepeat="no-repeat",e.style.position="relative",e.style.cssText=e.style.cssText+KJ._createBorderRadiusCss(t.borderRadius),t.parentElement.appendChild(e),t.borderWidth={left:KJ._parseInt(KJ._elementCurrentStyle(e,"border-left-width")),right:KJ._parseInt(KJ._elementCurrentStyle(e,"border-right-width")),top:KJ._parseInt(KJ._elementCurrentStyle(e,"border-top-width")),bottom:KJ._parseInt(KJ._elementCurrentStyle(e,"border-bottom-width"))}):1==t.displayType&&(t.orientation==KJ.Orientation.Horizontal?t.borderRadius>t.width/2&&(t.borderRadius=t.width):t.orientation==KJ.Orientation.Vertical&&t.borderRadius>t.height/2&&(t.borderRadius=t.height),t.valueElement=document.createElement("DIV"),t.valueElement.className="",t.leftElement=document.createElement("DIV"),t.middleElement=document.createElement("DIV"),t.rightElement=document.createElement("DIV"),t.leftElement.style.border="1px solid #A0A0A0",t.leftElement.style.cssFloat="left",t.leftElement.style.display="inline-block",t.leftElement.style.backgroundColor=t.backColor,t.leftElement.style.backgroundRepeat="no-repeat",t.leftElement.style.position="relative",t.rightElement.style.border="1px solid #A0A0A0",t.rightElement.style.cssFloat="left",t.rightElement.style.display="inline-block",t.rightElement.style.backgroundColor=t.backColor,t.rightElement.style.backgroundRepeat="no-repeat",t.rightElement.style.position="relative",t.middleElement.style.border="1px solid #A0A0A0",t.middleElement.style.cssFloat="left",t.middleElement.style.display="inline-block",t.middleElement.style.overflow="hidden",t.middleElement.style.position="relative",t.valueElement.style.backgroundColor=t.backColor,t.valueElement.style.position="relative",t.orientation==KJ.Orientation.Horizontal?(t.leftElement.style.width=t.borderRadius+"px",t.leftElement.style.height=t.height+"px",t.leftElement.style.top=-t.height+"px",t.leftElement.style.left="0px",t.leftElement.style.borderRight="none",t.leftElement.style.cssText=t.leftElement.style.cssText+KJ._createBorderRadiusCss(t.borderRadius,0,0,t.borderRadius),t.rightElement.style.width=t.borderRadius+"px",t.rightElement.style.height=t.height+"px",t.rightElement.style.top=-t.height+"px",t.rightElement.style.borderLeft="none",t.rightElement.style.cssText=t.rightElement.style.cssText+KJ._createBorderRadiusCss(0,t.borderRadius,t.borderRadius,0),t.middleElement.style.width=t.width-2*t.borderRadius+"px",t.middleElement.style.height=t.height+"px",t.middleElement.style.top=-t.height+"px",t.middleElement.style.borderLeft="none",t.middleElement.style.borderRight="none",t.valueElement.style.width="0px",t.valueElement.style.height=t.height+"px"):t.orientation==KJ.Orientation.Vertical&&(t.leftElement.style.width=t.width+"px",t.leftElement.style.height=t.borderRadius+"px",t.leftElement.style.top=-t.height+"px",t.leftElement.style.left="0px",t.leftElement.style.borderBottom="none",t.leftElement.style.cssText=t.leftElement.style.cssText+KJ._createBorderRadiusCss(t.borderRadius,t.borderRadius,0,0),t.rightElement.style.width=t.width+"px",t.rightElement.style.height=t.borderRadius+"px",t.rightElement.style.top=-t.height+"px",t.rightElement.style.left="0px",t.rightElement.style.borderTop="none",t.rightElement.style.cssText=t.rightElement.style.cssText+KJ._createBorderRadiusCss(0,0,t.borderRadius,t.borderRadius),t.middleElement.style.width=t.width+"px",t.middleElement.style.height=t.height-2*t.borderRadius+"px",t.middleElement.style.top=-t.height+"px",t.middleElement.style.left="0px",t.middleElement.style.borderTop="none",t.middleElement.style.borderBottom="none",t.valueElement.style.width=t.width+"px",t.valueElement.style.height="0px"),t.middleElement.appendChild(t.valueElement),t.parentElement.appendChild(t.leftElement),t.parentElement.appendChild(t.middleElement),t.parentElement.appendChild(t.rightElement),t.orientation==KJ.Orientation.Horizontal?t.borderWidth={left:KJ._parseInt(KJ._elementCurrentStyle(t.leftElement,"border-left-width")),right:KJ._parseInt(KJ._elementCurrentStyle(t.rightElement,"border-right-width")),top:KJ._parseInt(KJ._elementCurrentStyle(t.middleElement,"border-top-width")),bottom:KJ._parseInt(KJ._elementCurrentStyle(t.middleElement,"border-bottom-width"))}:t.orientation==KJ.Orientation.Vertical&&(t.borderWidth={left:KJ._parseInt(KJ._elementCurrentStyle(t.middleElement,"border-left-width")),right:KJ._parseInt(KJ._elementCurrentStyle(t.middleElement,"border-right-width")),top:KJ._parseInt(KJ._elementCurrentStyle(t.leftElement,"border-top-width")),bottom:KJ._parseInt(KJ._elementCurrentStyle(t.rightElement,"border-bottom-width"))})),t.parentElement.style.width=t.width+t.borderWidth.left+t.borderWidth.right+"px",t.parentElement.style.height=t.height+t.borderWidth.top+t.borderWidth.bottom+"px",t.backgroundElement.style.cssFloat="left",t.backgroundElement.style.display="inline-block",t.backgroundElement.style.width=t.width+t.borderWidth.left+t.borderWidth.right+"px",t.backgroundElement.style.height=t.height+"px",t.backgroundElement.style.backgroundColor="#FFFFFF",t.backgroundElement.style.position="relative",0==t.displayType&&(t.backgroundElement.style.width=t.width+t.borderWidth.left+t.borderWidth.right+"px"),t.backgroundElement.style.top=t.borderWidth.top+"px",t.markerElement=document.createElement("DIV"),t.markerElement.style.display="inline-block",t.markerElement.style.zoom="1.0",t.markerElement.style.width=t.width+"px",t.markerElement.style.height=t.height+"px",t.markerElement.style.top=2*-t.height-t.borderWidth.top+"px",t.markerElement.style.left=t.borderWidth.left+"px",t.markerElement.style.backgroundColor=t.color,t.markerElement.style.lineHeight=t.height+"px",t.markerElement.style.position="relative",t.parentElement.appendChild(t.markerElement),t.isLoaded=!0,t.setValue(t.initialValue),null!=t.onLoad&&t.onLoad()},KJ.prototype.setValue=function(e){var t=this;if(null!==e&&e<t.minValue&&(e=t.minValue),null!==e&&e>t.maxValue&&(e=t.maxValue),null===e||(t.value=e),t.isLoaded){var r,n=0;if(t.orientation==KJ.Orientation.Horizontal){n=t.value/t.maxValue*t.width,t.progressPosition=n,0==t.displayType?(t.direction,KJ.Direction.LeftToRight):1==t.displayType&&(t.direction==KJ.Direction.LeftToRight?n<=t.borderRadius?t.valueElement.style.width="0px":n>=t.width-t.borderRadius?t.valueElement.style.width=t.middleElement.style.width:t.valueElement.style.width=n-t.borderRadius+"px":n<=t.borderRadius?t.valueElement.style.width="0px":n>=t.width-t.borderRadius?(t.valueElement.style.left="0px",t.valueElement.style.width=t.middleElement.style.width):(t.valueElement.style.left=t.width-n-t.borderRadius+"px",t.valueElement.style.width=n-t.borderRadius+"px")),n>0?(t.animationStyle!=KJ.AnimationStyle.StaticFull&&t.animationStyle!=KJ.AnimationStyle.CustomFull?t.markerElement.style.width=n+"px":t.markerElement.style.width=t.width+"px",t.markerElement.style.visibility="visible"):(t.markerElement.style.width=t.width+"px",t.animationStyle!=KJ.AnimationStyle.StaticFull&&t.animationStyle!=KJ.AnimationStyle.CustomFull&&(t.markerElement.style.visibility="hidden")),t.animationStyle!=KJ.AnimationStyle.StaticFull&&t.animationStyle!=KJ.AnimationStyle.CustomFull?t.direction==KJ.Direction.LeftToRight?t.markerElement.style.left=t.borderWidth.left+"px":t.markerElement.style.left=t.width-n+t.borderWidth.left+"px":t.markerElement.style.left=t.borderWidth.left+"px",t.height,t.height,t.borderWidth.top;var i=2*-t.height-t.borderWidth.top;if(0==n||t.width==n)t.markerElement.style.top=i+"px",t.markerElement.style.height=t.height+"px",t.markerElement.style.cssText=t.markerElement.style.cssText+KJ._createBorderRadiusCss(t.borderRadius);else if(n<t.borderRadius){var o=t.height-2.25*(t.borderRadius-Math.sqrt(Math.pow(t.borderRadius,2)-Math.pow(t.borderRadius-n,2))),a=i+t.height/2-o/2;t.markerElement.style.top=a+"px",t.markerElement.style.height=o+"px",t.direction==KJ.Direction.LeftToRight?t.markerElement.style.cssText=t.markerElement.style.cssText+KJ._createBorderRadiusCss(t.borderRadius,0,0,t.borderRadius):t.markerElement.style.cssText=t.markerElement.style.cssText+KJ._createBorderRadiusCss(0,t.borderRadius,t.borderRadius,0)}else t.width-n<t.borderRadius?(r=(2*(t.borderRadius-(t.width-n))+(t.borderRadius-Math.sqrt(Math.pow(t.borderRadius,2)-Math.pow(t.borderRadius-(t.width-n),2))))/3,t.direction==KJ.Direction.LeftToRight?t.markerElement.style.cssText=t.markerElement.style.cssText+KJ._createBorderRadiusCss(t.borderRadius,r,r,t.borderRadius):t.markerElement.style.cssText=t.markerElement.style.cssText+KJ._createBorderRadiusCss(r,t.borderRadius,t.borderRadius,r)):(t.markerElement.style.top=i+"px",t.markerElement.style.height=t.height+"px",t.direction==KJ.Direction.LeftToRight?t.markerElement.style.cssText=t.markerElement.style.cssText+KJ._createBorderRadiusCss(t.borderRadius,0,0,t.borderRadius):t.markerElement.style.cssText=t.markerElement.style.cssText+KJ._createBorderRadiusCss(0,t.borderRadius,t.borderRadius,0))}else if(t.orientation==KJ.Orientation.Vertical){n=t.value/t.maxValue*t.height,t.progressPosition=n,0==t.displayType?(t.direction,KJ.Direction.TopToBottom):1==t.displayType&&(t.direction==KJ.Direction.TopToBottom?n<=t.borderRadius?t.valueElement.style.height="0px":n>=t.height-t.borderRadius?t.valueElement.style.height=t.middleElement.style.height:t.valueElement.style.height=n-t.borderRadius+"px":n<=t.borderRadius?t.valueElement.style.height="0px":n>=t.height-t.borderRadius?(t.valueElement.style.top="0px",t.valueElement.style.height=t.middleElement.style.height):(t.valueElement.style.top=t.height-n-t.borderRadius+"px",t.valueElement.style.height=n+2*t.borderRadius+"px")),n>0?(t.animationStyle!=KJ.AnimationStyle.StaticFull&&t.animationStyle!=KJ.AnimationStyle.CustomFull?t.markerElement.style.height=n+"px":(t.markerElement.style.height=t.height+"px",t.markerElement.style.cssText=t.markerElement.style.cssText+KJ._createBorderRadiusCss(t.borderRadius)),t.markerElement.style.visibility="visible"):(t.markerElement.style.height="0px",t.animationStyle!=KJ.AnimationStyle.StaticFull&&t.animationStyle!=KJ.AnimationStyle.CustomFull&&(t.markerElement.style.visibility="hidden")),t.borderWidth.left;var s=t.borderWidth.left;if(0==n||t.height==n)t.markerElement.style.left=s+"px",t.markerElement.style.width=t.width+"px",t.markerElement.style.cssText=t.markerElement.style.cssText+KJ._createBorderRadiusCss(t.borderRadius);else if(n<t.borderRadius){var u=2.5*n;u>t.width&&(u=t.width);var c=s+t.width/2-u/2;t.markerElement.style.left=c+"px",t.markerElement.style.width=u+"px",t.direction==KJ.Direction.BottomToTop?t.markerElement.style.cssText=t.markerElement.style.cssText+KJ._createBorderRadiusCss(0,0,t.borderRadius,t.borderRadius):t.markerElement.style.cssText=t.markerElement.style.cssText+KJ._createBorderRadiusCss(t.borderRadius,t.borderRadius,0,0)}else t.height-n<t.borderRadius?(r=(2*(t.borderRadius-(t.height-n))+(t.borderRadius-Math.sqrt(Math.pow(t.borderRadius,2)-Math.pow(t.borderRadius-(t.height-n),2))))/3,t.direction==KJ.Direction.BottomToTop?t.markerElement.style.cssText=t.markerElement.style.cssText+KJ._createBorderRadiusCss(r,r,t.borderRadius,t.borderRadius):t.markerElement.style.cssText=t.markerElement.style.cssText+KJ._createBorderRadiusCss(t.borderRadius,t.borderRadius,r,r)):(t.markerElement.style.left=s+"px",t.markerElement.style.width=t.width+"px",t.direction==KJ.Direction.BottomToTop?t.markerElement.style.cssText=t.markerElement.style.cssText+KJ._createBorderRadiusCss(0,0,t.borderRadius,t.borderRadius):t.markerElement.style.cssText=t.markerElement.style.cssText+KJ._createBorderRadiusCss(t.borderRadius,t.borderRadius,0,0));t.animationStyle!=KJ.AnimationStyle.StaticFull&&t.animationStyle!=KJ.AnimationStyle.CustomFull?t.direction==KJ.Direction.TopToBottom?t.markerElement.style.top=2*-t.height-t.borderWidth.top+"px":t.markerElement.style.top=-t.height-n-t.borderWidth.top+"px":t.markerElement.style.top=2*-t.height-t.borderWidth.top+"px"}t.progress=t.value/t.maxValue}null!=t.onValueChanged&&t.onValueChanged()},KJ._elementCurrentStyle=function(e,t){if(e.currentStyle){var r=0,n="",i=!1;for(r=0;r<t.length;r++)"-"!=t[r].toString()?(n+=i?t[r].toString().toUpperCase():t[r].toString(),i=!1):i=!0;return t=n,e.currentStyle[t]}return getComputedStyle(e,null).getPropertyValue(t)},KJ._parseInt=function(e){var t=parseInt(e);return isNaN(t)&&(t=0),t},KJ._createBorderRadiusCss=function(e,t,r,n){return null!=e&&null==t&&null==r&&null==n?"; -moz-border-radius: "+e+"px; -ms-border-radius: "+e+"px; -o-border-radius: "+e+"px; -webkit-border-radius: "+e+"px; -khtml-border-radius: "+e+"px; border-radius: "+e+"px;":"; -moz-border-radius: "+(e=e||0)+"px "+(t=t||0)+"px "+(r=r||0)+"px "+(n=n||0)+"px; -ms-border-radius: "+e+"px "+t+"px "+r+"px "+n+"px; -o-border-radius: "+e+"px "+t+"px "+r+"px "+n+"px; -webkit-border-radius: "+e+"px "+t+"px "+r+"px "+n+"px; -khtml-border-radius: "+e+"px "+t+"px "+r+"px "+n+"px; border-radius: "+e+"px "+t+"px "+r+"px "+n+"px;"};var JJ=s((function e(){t(this,e),Mb(this,"handlers",{})}),[{key:"on",value:function(e,t){var r=xt.guid();return this.handlers[e]||(this.handlers[e]=[]),this.handlers[e].push({id:r,handler:t}),r}},{key:"off",value:function(e,t){if(this.handlers[e]){var r,n=this.handlers[e];if(t){for(r=0;r<n.length;r++)if(n[r].id==t){n.splice(r,1);break}}else n.splice(0)}}},{key:"fire",value:function(e){if(this.handlers[e]){var t,r=this.handlers[e];for(t=0;t<r.length;t++)r[t].handler();return r.length}return 0}},{key:"clear",value:function(){this.handlers={}}}]),YJ=Wt.DWT;Dt.ProgressBar=KJ,Dt.progressMessage="",Dt.dialogShowStatus=!1,Dt.needShowTwiceShowDialog=!1,Dt.dlgProgress=!1,Dt.cancelFrom=fj.Other,Dt.dlgRef=0,Dt.initProgress=function(e){var t,r;if(!Dt.dlgProgress){(r=[]).push('<dialog class="dynamsoft-dwt-dialogProgress" closed="closed" style="top:30%"><div class="ds-dwt-progressWrap">'),r.push('<h3 class="dynamsoft-finalMessage"> </h3>'),r.push('<p class="dynamsoft-desc"> </p><p class="dynamsoft-status">0%</p>'),Y.bIE?r.push('<div class="dynamsoft-progressBar" value="" max="100"></div>'):r.push('<progress class="dynamsoft-progressBar" value="" max="100"></progress>'),r.push('<br /><div style="width:100%;text-align:center"><button class="dynamsoft-btnCancel" value="cancel" autofcus>cancel</button></div>'),r.push("</div></dialog>"),(t=Wb.one(".dynamsoft-dwt-dialogProgress"))&&t.getEL()&&t.remove();var n=Dt.parseHTML(r.join(""));if(n&&n.length>0&&document.body.appendChild(n[0]),Y.bIE){var i=Wb.one(".dynamsoft-progressBar"),o=i&&i.getEL();o&&(o.objProgressBar=new KJ(o,{width:280,height:20}))}(t=Wb.one(".dynamsoft-dwt-dialogProgress"))&&t.getEL()&&(Dt.dlgProgress=t[0],Wb.dialog.setup(Dt.dlgProgress)),Dt.dlgRef=0,Dt.dialogShowStatus=!1,Dt.cancelFrom=fj.Other}},Dt.showProgressMsg=function(){};var QJ=function(e){function r(){return t(this,r),e=this,i=arguments,n=QE(n=r),YE(e,function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(QG){return!1}}()?Reflect.construct(n,i||[],QE(e).constructor):n.apply(e,i));var e,n,i}return qE(r,e),s(r)}(JJ);Dt.progressContext=new QJ;var XJ=function(){var e=Dt.progressContext;if(e){var t,r=e.fire("cancel");if(r>=1)for(t=0;t<r;t++)Dt.closeProgress(null,"");else e.__cancelBeforObjectCreated&&(Dt.closeProgress(null,""),e.__clickCancel=!0)}};Dt.hideProgress=function(){var e=Dt.progressContext;e&&(e.IfShowProgressBar=!1,e.IfShowCancelDialogWhenImageTransfer=!1,e.off("cancel"),e._onPercent=null)},Dt.showProgress=function(e,t,r){var n,i=e;if(i.IfShowProgressBar)if(Dt.progressContext&&(Dt.progressContext.IfShowProgressBar=!0,Dt.progressContext.IfShowCancelDialogWhenImageTransfer=i.IfShowCancelDialogWhenImageTransfer),Dt.dlgRef>0)Dt.dlgRef++;else{var o;if((n=Wt.DWT.IfConfineMaskWithinTheViewer)?i._isNoViewer&&i._isNoViewer()?o=document.body:i._containerElement?o=i._containerElement:Wt.DWT.Containers&&Wt.DWT.Containers.length>0&&Wt.DWT.Containers[0].ContainerId&&(o=xt.get(Wt.DWT.Containers[0].ContainerId))||(o=document.body):o=document.body,o&&o!==document.body){var a=!1,s=o.firstElementChild;if(s&&s!==Dt.dlgProgress&&"dvs-root dvs-web-viewer"==s.className&&(o=s,a=!0),0==a)for(var u=0;u<o.children.length;u++)if((s=o.children[u])&&s!==Dt.dlgProgress&&"dvs-root dvs-web-viewer"==s.className){o=s;break}var c=Dt.progressContext;""!==o.style.position&&"static"!==o.style.position||(o.style.position="relative",c.progressContainer={el:o})}xt.log("showProgress:"+t+",bCancel:"+r),Dt.dlgProgress&&o.appendChild(Dt.dlgProgress),UE(r);var l=Wb.one(".dynamsoft-btnCancel");if(l&&l.getEL()&&(xt.removeEventListener(l[0],"click",XJ),xt.addEventListener(l[0],"click",XJ)),0==Dt.dialogShowStatus){Dt.dlgProgress&&(n&&o&&o!==document.body?Wb.dialog.setup(Dt.dlgProgress,!0):Wb.dialog.setup(Dt.dlgProgress),Dt.dlgProgress.showModal()),Dt.dialogShowStatus=!0;var d=Wb.one(".dynamsoft-finalMessage"),f=Wb.one(".dynamsoft-progressBar"),h=f&&f.getEL(),g=Wb.one(".dynamsoft-status");d&&d.getEL()&&d.html(""),g&&g.getEL()&&g.html("0%"),h&&(Y.bIE&&h.objProgressBar?h.objProgressBar.setValue(0):h.value=0)}Dt.dlgRef++}else Dt.hideProgress()},Dt.closeProgress=function(e,t){var r=Dt.progressContext;xt.log("closeProgress:"+t),r&&r.IfShowProgressBar?(Dt.dlgRef--,Dt.dlgRef<=0&&(Dt.dlgRef=0)):Dt.dlgRef=0,0==Dt.dlgRef&&(r.off("cancel"),r._onPercent=null,1==Dt.dialogShowStatus&&(Dt.dlgProgress&&(Dt.dlgProgress.close(),Dt.dlgProgress&&document.body.appendChild(Dt.dlgProgress),r&&r.progressContainer&&r.progressContainer.el&&(r.progressContainer.el.style.position="",r.progressContainer=null)),Dt.dialogShowStatus=!1),Dt.cancelFrom=fj.Other)},YJ.RemoveAllAuthorizations=function(){var e=Dx.item("DWT_port"),t="http://";return"true"==Dx.item("DWT_ssl")&&(t="https://"),fC({method:"GET",xhrFields:{withCredentials:!0},url:[t,JC(),":",e,"/dwt/",aw.getDWTPrefix(),aw.getServerVersionInfo(),"/RemoveAllAuthorizations?t=",xt.now()].join(""),async:!0}),!0};var qJ={upload:"Uploading...",download:"Downloading...",load:"Processing...",decode:"Processing...",decodeTIFF:"Processing tiff...",decodePDF:"Processing pdf...",encodeTIFF:"Processing tiff...",encodePDF:"Processing pdf...",encode:"Processing...",transfer:"Transferring..."};Dt.progressBarOnPercentDone=function(e,t,r,n,i,o){var a,s=Wb.one(".dynamsoft-progressBar"),u=Wb.one(".dynamsoft-status"),c=Wb.one(".dynamsoft-finalMessage"),l=Wb.one(".dynamsoft-desc");if(Wt.DWT.UseDefaultViewer&&Wt.DWT.IfConfineMaskWithinTheViewer&&o&&(s=Wb.one(".dynamsoft-progressBar",o),u=Wb.one(".dynamsoft-status",o),c=Wb.one(".dynamsoft-finalMessage",o),l=Wb.one(".dynamsoft-desc",o)),Dt.cancelFrom==fj.FTPUpload||Dt.cancelFrom==fj.FTPDownload){var d=r;0==d?Dt.setBtnCancelVisibleForProgress(!1):1==d&&Dt.setBtnCancelVisibleForProgress(!0)}else Dt.cancelFrom==fj.HTTPUpload||Dt.cancelFrom==fj.LoadImage||Dt.cancelFrom==fj.HTTPPut?"Processing..."==t&&Dt.setBtnCancelVisibleForProgress(!1):Dt.cancelFrom==fj.ConvertToBlob&&(-1==e||Dt.setBtnCancelVisibleForProgress(!1),100==n&&(t="",Dt.progressMessage="Processing..."));if(e<0?(Dt.progressMessage=t,a=Dt.progressMessage):a=""!=t&&"1/1"!=t?Dt.progressMessage+"("+t+")":Dt.progressMessage,c&&c.getEL()){var f="",h="";a.indexOf(" ...")&&(a=a.replace(" ...","...")),-1!=a.indexOf("(")?(f=a.substr(0,a.indexOf("(")),h=a.substr(a.indexOf("("))):f=a,xt.each(qJ,(function(e,t){-1!=e.indexOf(f)&&(a=vH.customProgressText[t]+h)})),""==a&&(a="&nbsp;"),c.html(a)}if(i?(""==i||xt.isUndefined(i)?i="&nbsp;":xt.isString(i)&&i.length>30&&(i=i.substring(0,30)+"..."),l.html(i)):l.html("&nbsp;"),(n||0===n)&&(u&&u.getEL()&&u.html(n+"%"),s&&s.getEL())){var g=n;g>99&&(g=99),Y.bIE?s[0].objProgressBar?s[0].objProgressBar.setValue(g):s[0].value=g:Y.bEdge?(s[0].style.display="",s[0].value=g):s[0].value=g}Dt.dlgRef<=0&&setTimeout((function(){s&&s.getEL()&&(Y.bIE?s[0].objProgressBar?s[0].objProgressBar.setValue(0):s[0].value=0:Y.bEdge?(s[0].style.display="none",s[0].value=0):s[0].value=0)}),1e3)};var ZJ=Wt.DWT;ZJ.CloseDialog=function(){var e=Dt.install._dlgInstall;if(e){var t=xt.sizzle(".dynamsoft-dialog-close");xt.each(t,(function(e,t){xt.removeEventListener(e,"click",ZJ.CloseDialog)})),e.open&&e.close(),document.body.removeChild(e),Dt.install._dlgInstall=!1}},ZJ.ShowDialog=function(e,t,r,n,i){if(!1!==r){var o,a={width:e,height:t,position:"absolute"};n?(o=['<div class="dynamsoft-dwt-dialog-body">',r,"</div>"].join(""),a.closeButton=!1):o=['<div class="ds-dwt-ui-showdlg">','<div class="dynamsoft-dwt-dialog-body">','<div class="dynamsoft-dwt-dlg-header">',i?"":'<div class="dynamsoft-dialog-close"></div>',"</div>",r,"</div>","</div>"].join(""),i&&(a.closeButton=!1),ZJ.ShowMessage(o,a)}},ZJ.ShowMessage=function(e,t){var r,n,i,o,a,s=Dt.install,u="ds-dwt-ui-dlg",c="ds-dwt-ui-dlg-wrap",l=screen.width,d=!0,f=0,h=!0,g=!0,p=0,_="fixed",m="Error",v=aw.bActiveXEdition,y=!1,S=null;if(t&&(r=t.width,n=t.height,t.seconds&&(f=t.seconds),t.headerStyle&&(p=t.headerStyle),1==t.backgroundStyle&&(y=!0),!1===t.closeButton&&(h=!1),t.bAutoClose&&(i=t.bAutoClose,h=!0),0==t.bReadyClosed&&(d=!1),t.position&&(_=t.position),t.caption&&(m=t.caption),xt.isFunction(t.onClose)&&(S=t.onClose)),r?r>l-10&&(r=l-10):r=l>600?600:l-10,n||(n="100%"),1==p?e=['<div class="dynamsoft-dialog">','<div class="dynamsoft-dwt-dialog-body">','<div class="dynamsoft-dwt-dlg-header">',h?'<div class="dynamsoft-dialog-close"></div>':"","</div>",e,"</div></div>"].join(""):2==p&&(e=['<div class="dynamsoft-dialog">','<div class="dynamsoft-dwt-ltsdlg-header"><span style="color:#FFF;line-height:35px;margin-left:15px">',m,"</span>",h?'<div class="dynamsoft-dialog-close"></div>':"","</div>",'<div class="dynamsoft-dwt-ltsdlg-body" style="padding:25px 40px 20px 40px;">',e,"</div></div>"].join("")),0==xt.sizzle("."+u).length){var T=document.createElement("div"),I=document.createElement("div"),b=document.createElement("div");if(T.className=u,I.className=c,I.style.margin="auto",I.style.zIndex="9999",I.style.position="relative",I.style.border="0",i&&((o=document.createElement("div")).className="dynamsoft-dialog-close",I.insertBefore(o,I.firstElementChild),(a=document.createElement("div")).className="dynamsoft-dialog-closeTimer",a.style.width="100%",a.style.height="2px",a.style.marginTop="-2px",a.style.backgroundColor="#fe8e14",I.insertBefore(a,I.firstElementChild)),I.appendChild(b),b.innerHTML=e,T.appendChild(I),document.body.appendChild(T),S){var C=Wb.one(".dynamsoft-dialog-close",Wb.one(T));C&&((C=C[0]).onClose=function(){xt.removeEventListener(C,"click",C.onClose),C.onClose=null,S()},xt.addEventListener(C,"click",C.onClose))}if(y?Wb.setBackOpacity({opacity:.4,grayHex:0}):Wb.setBackOpacity({}),T.bTopmost=!0,s._dlgInstall=T,Wb.dialog.setup(s._dlgInstall,!1),Y.bIE){var w=document.createElement("iframe");w.frameborder="0",w.marginheight="0",w.marginwidth="0",w.style.border="0",w.style.backgroundColor="transparent",w.style.position="absolute",w.style.left=0,w.style.top=0,w.style.width="100%",w.style.height=document.body.clientHeight+"px",w.style.margin="0 auto",w.style.zIndex="10000",w.src=["javas","cript:",'""'].join("");var E=Wb.one(".dynamsoft-backdrop");E&&E.length>0&&(E[0].innerHTML="",E[0].style.zIndex="10000",E[0].appendChild(w))}}else g=!1;var A=Wb.one("."+c);if(A&&A.getEL()&&(A[0].style.width=r+"px",xt.isNumber(n)&&n>0?A[0].style.height=n+"px":A[0].style.height="100%",g||xt.each(A[0].childNodes,(function(t){if("DIV"==t.tagName&&"dynamsoft-dialog-close"!=t.className&&"dynamsoft-dialog-closeTimer"!=t.className)return t.innerHTML=e,!1}))),v){var D=Wb.one(".dynamsoft-dialog");D&&D.getEL()&&(D.getEL().style.border="1px solid #999")}if(s._dlgInstall.open&&s._dlgInstall.close(),s._dlgInstall.showModal({position:_}),s._dlgInstall.bReadyClosed=d,y&&Wb.setBackOpacity({}),h){var P=xt.sizzle(".dynamsoft-dialog-close");xt.each(P,(function(e,t){xt.addEventListener(e,"click",ZJ.CloseDialog)})),P.length>0&&i&&f>0&&setTimeout(Dt._zdgb_xkz_dhk,100)}},ZJ.OnWebTwainPreExecute||(ZJ.OnWebTwainPreExecute=function(e,t){var r,n,i=Wt.DWT.IfConfineMaskWithinTheViewer;if(i&&(e&&(n=e._containerElement),n||Wt.DWT.Containers&&Wt.DWT.Containers.length>0&&Wt.DWT.Containers[0].ContainerId&&(n=xt.get(Wt.DWT.Containers[0].ContainerId)),n)){r=n.getBoundingClientRect();for(var o=0;o<n.children.length;o++){var a=n.children[o];if(a&&"dvs-root dvs-web-viewer"==a.className){for(a=a.firstElementChild;a;){if(xt.isFunction(a.getBoundingClientRect)){r=a.getBoundingClientRect();break}a=a.nextSibling}n=a;break}}}(n===document.body||void 0==r||Wt.DWT.Containers&&Wt.DWT.Containers.length>1||Wt.DWT.Containers&&1==Wt.DWT.Containers.length&&(0==r.width||0==r.height))&&(i=!1,n=null);var s=null!=t?t:{};i&&(s={confined:i,wrapperEl:n}),Dt.showMask(s)}),ZJ.OnWebTwainPostExecute||(ZJ.OnWebTwainPostExecute=function(){Wb.hideMask()}),window.DCP_DWT_OnClickCloseInstall=function(e,t){t||Wt.DWT.CloseDialog();var r=xt.get(Dt.install._divDWTNonInstallContainerID);if(r&&r.parentNode&&r.parentNode.removeChild(r),e&&xt.isDOM(e)&&xt.show(e),e&&xt.isString(e))xt.show(e);else{var n=Wt.DWT.WebTwainIdMap;if(n){var i,o,a=Object.keys(n);for(i=0;i<a.length;i++)n[o=a[i]]._containerElement&&xt.show(n[o]._containerElement)}}""!=Dt.install._divDWTemessageContainer&&xt.show(Dt.install._divDWTemessageContainer)},(Dt.__ver||0)<kt&&(xt.mix(Dt,Wb),Dt.__ver=kt),Dt.bNode=Ft,Dt._defaultAgent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.0.0 Safari/537.36",Dt._defaultPlatform="Win64",Dt.timestamp="?t=20240509141451",xt.mix(Dt,Nb),Dt.ajax=fC,Dt.fetch=BE,Dt.detect.showMask=XP,Dt.detect.hideMask=qP,Dt.env=lR,Dt.product=aw,Dt.scannerInfo=sw,Dt.License=sP,Dt.BIO=HP,Dt.UI.ImageUIView=ZH,Dt.UI.ImageManager=$H,Wt.MSG=QP,Wt.navInfoSync=Y,Dt.domReady=yD,function e(){if(!window||document&&document.body){var t=document;if(t.readyState!==pD)if(_D(window,gD,vD),dD)_D(t,fD,(function e(){mD(t,fD,e),vD()}));else{var r,n,i;_D(t,hD,(function e(){t.readyState===pD&&(mD(t,hD,e),vD())})),n=t&&t.documentElement,i=n&&n.doScroll;try{r=null===window.frameElement}catch(QG){r=!1}i&&r&&function e(){try{i("left"),setTimeout(vD,30)}catch(r){setTimeout(e,40)}}()}else vD()}else setTimeout(e,100)}(),yD((function(){if(Wt.DWT.CustomizableDisplayInfo||(Wt.DWT.CustomizableDisplayInfo=vH),Y.bIE){Wt.DWT.CustomizableDisplayInfo.loaderBarSourceIE||(Wt.DWT.CustomizableDisplayInfo.loaderBarSourceIE=mH.loaderBarSourceIE);try{document.execCommand("BackgroundImageCache",!1,!0)}catch(QG){}}})),Wt.Ready=function(e){if(!Wt.navInfo)return uD().then((function(t){Wt.navInfo=t;try{e()}catch(QG){throw xt.log(QG.stack||QG,"error"),QG}}));try{e()}catch(QG){throw xt.log(QG.stack||QG,"error"),QG}}}(),a.navInfoSync.bIE&&(!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.Promise=e()}}((function(){return function e(t,r,n){function i(a,s){if(!r[a]){if(!t[a]){var u="function"==typeof _dereq_&&_dereq_;if(!s&&u)return u(a,!0);if(o)return o(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var l=r[a]={exports:{}};t[a][0].call(l.exports,(function(e){var r=t[a][1][e];return i(r||e)}),l,l.exports,e,t,r,n)}return r[a].exports}for(var o="function"==typeof _dereq_&&_dereq_,a=0;a<n.length;a++)i(n[a]);return i}({1:[function(e,t,r){t.exports=function(e){function t(e){var t=new r(e),n=t.promise();return t.setHowMany(1),t.setUnwrap(),t.init(),n}var r=e._SomePromiseArray;e.any=function(e){return t(e)},e.prototype.any=function(){return t(this)}}},{}],2:[function(e,t,r){function n(){this._customScheduler=!1,this._isTickUsed=!1,this._lateQueue=new c(16),this._normalQueue=new c(16),this._haveDrainedQueues=!1;var e=this;this.drainQueues=function(){e._drainQueues()},this._schedule=u}function o(e){for(;e.length()>0;)a(e)}function a(e){var t=e.shift();if("function"!=typeof t)t._settlePromises();else{var r=e.shift(),n=e.shift();t.call(r,n)}}var s;try{throw new Error}catch(l){s=l}var u=e("./schedule"),c=e("./queue");n.prototype.setScheduler=function(e){var t=this._schedule;return this._schedule=e,this._customScheduler=!0,t},n.prototype.hasCustomScheduler=function(){return this._customScheduler},n.prototype.haveItemsQueued=function(){return this._isTickUsed||this._haveDrainedQueues},n.prototype.fatalError=function(e,t){t?(i.stderr.write("Fatal "+(e instanceof Error?e.stack:e)+"\n"),i.exit(2)):this.throwLater(e)},n.prototype.throwLater=function(e,t){if(1===arguments.length&&(t=e,e=function(){throw t}),"undefined"!=typeof setTimeout)setTimeout((function(){e(t)}),0);else try{this._schedule((function(){e(t)}))}catch(r){throw new Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n")}},n.prototype.invokeLater=function(e,t,r){this._lateQueue.push(e,t,r),this._queueTick()},n.prototype.invoke=function(e,t,r){this._normalQueue.push(e,t,r),this._queueTick()},n.prototype.settlePromises=function(e){this._normalQueue._pushOne(e),this._queueTick()},n.prototype._drainQueues=function(){o(this._normalQueue),this._reset(),this._haveDrainedQueues=!0,o(this._lateQueue)},n.prototype._queueTick=function(){this._isTickUsed||(this._isTickUsed=!0,this._schedule(this.drainQueues))},n.prototype._reset=function(){this._isTickUsed=!1},t.exports=n,t.exports.firstLineError=s},{"./queue":26,"./schedule":29}],3:[function(e,t,r){t.exports=function(e,t,r,n){var i=!1,o=function(e,t){this._reject(t)},a=function(e,t){t.promiseRejectionQueued=!0,t.bindingPromise._then(o,o,null,this,e)},s=function(e,t){0===(50397184&this._bitField)&&this._resolveCallback(t.target)},u=function(e,t){t.promiseRejectionQueued||this._reject(e)};e.prototype.bind=function(o){i||(i=!0,e.prototype._propagateFrom=n.propagateFromFunction(),e.prototype._boundValue=n.boundValueFunction());var c=r(o),l=new e(t);l._propagateFrom(this,1);var d=this._target();if(l._setBoundTo(c),c instanceof e){var f={promiseRejectionQueued:!1,promise:l,target:d,bindingPromise:c};d._then(t,a,void 0,l,f),c._then(s,u,void 0,l,f),l._setOnCancel(c)}else l._resolveCallback(d);return l},e.prototype._setBoundTo=function(e){void 0!==e?(this._bitField=2097152|this._bitField,this._boundTo=e):this._bitField=-2097153&this._bitField},e.prototype._isBound=function(){return 2097152===(2097152&this._bitField)},e.bind=function(t,r){return e.resolve(r).bind(t)}}},{}],4:[function(e,t,r){var n;"undefined"!=typeof Promise&&(n=Promise);var i=e("./promise")();i.noConflict=function(){try{Promise===i&&(Promise=n)}catch(e){}return i},t.exports=i},{"./promise":22}],5:[function(e,t,r){var n=Object.create;if(n){var i=n(null),o=n(null);i[" size"]=o[" size"]=0}t.exports=function(t){function r(e,r){var n;if(null!=e&&(n=e[r]),"function"!=typeof n){var i="Object "+a.classString(e)+" has no method '"+a.toString(r)+"'";throw new t.TypeError(i)}return n}function n(e){return r(e,this.pop()).apply(e,this)}function i(e){return e[this]}function o(e){var t=+this;return 0>t&&(t=Math.max(0,t+e.length)),e[t]}var a=e("./util"),s=a.canEvaluate;a.isIdentifier,t.prototype.call=function(e){var t=[].slice.call(arguments,1);return t.push(e),this._then(n,void 0,void 0,t,void 0)},t.prototype.get=function(e){var t;if("number"==typeof e)t=o;else if(s){var r=undefined(e);t=null!==r?r:i}else t=i;return this._then(t,void 0,void 0,e,void 0)}}},{"./util":36}],6:[function(e,t,r){t.exports=function(t,r,n,i){var o=e("./util"),a=o.tryCatch,s=o.errorObj,u=t._async;t.prototype.break=t.prototype.cancel=function(){if(!i.cancellation())return this._warn("cancellation is disabled");for(var e=this,t=e;e._isCancellable();){if(!e._cancelBy(t)){t._isFollowing()?t._followee().cancel():t._cancelBranched();break}var r=e._cancellationParent;if(null==r||!r._isCancellable()){e._isFollowing()?e._followee().cancel():e._cancelBranched();break}e._isFollowing()&&e._followee().cancel(),e._setWillBeCancelled(),t=e,e=r}},t.prototype._branchHasCancelled=function(){this._branchesRemainingToCancel--},t.prototype._enoughBranchesHaveCancelled=function(){return void 0===this._branchesRemainingToCancel||this._branchesRemainingToCancel<=0},t.prototype._cancelBy=function(e){return e===this?(this._branchesRemainingToCancel=0,this._invokeOnCancel(),!0):(this._branchHasCancelled(),!!this._enoughBranchesHaveCancelled()&&(this._invokeOnCancel(),!0))},t.prototype._cancelBranched=function(){this._enoughBranchesHaveCancelled()&&this._cancel()},t.prototype._cancel=function(){this._isCancellable()&&(this._setCancelled(),u.invoke(this._cancelPromises,this,void 0))},t.prototype._cancelPromises=function(){this._length()>0&&this._settlePromises()},t.prototype._unsetOnCancel=function(){this._onCancelField=void 0},t.prototype._isCancellable=function(){return this.isPending()&&!this._isCancelled()},t.prototype.isCancellable=function(){return this.isPending()&&!this.isCancelled()},t.prototype._doInvokeOnCancel=function(e,t){if(o.isArray(e))for(var r=0;r<e.length;++r)this._doInvokeOnCancel(e[r],t);else if(void 0!==e)if("function"==typeof e){if(!t){var n=a(e).call(this._boundValue());n===s&&(this._attachExtraTrace(n.e),u.throwLater(n.e))}}else e._resultCancelled(this)},t.prototype._invokeOnCancel=function(){var e=this._onCancel();this._unsetOnCancel(),u.invoke(this._doInvokeOnCancel,this,e)},t.prototype._invokeInternalOnCancel=function(){this._isCancellable()&&(this._doInvokeOnCancel(this._onCancel(),!0),this._unsetOnCancel())},t.prototype._resultCancelled=function(){this.cancel()}}},{"./util":36}],7:[function(e,t,r){t.exports=function(t){var r=e("./util"),n=e("./es5").keys,i=r.tryCatch,o=r.errorObj;return function(e,a,s){return function(u){var c=s._boundValue();e:for(var l=0;l<e.length;++l){var d=e[l];if(d===Error||null!=d&&d.prototype instanceof Error){if(u instanceof d)return i(a).call(c,u)}else if("function"==typeof d){var f=i(d).call(c,u);if(f===o)return f;if(f)return i(a).call(c,u)}else if(r.isObject(u)){for(var h=n(d),g=0;g<h.length;++g){var p=h[g];if(d[p]!=u[p])continue e}return i(a).call(c,u)}}return t}}}},{"./es5":13,"./util":36}],8:[function(e,t,r){t.exports=function(e){function t(){this._trace=new t.CapturedTrace(r())}function r(){var e=i.length-1;return e>=0?i[e]:void 0}var n=!1,i=[];return e.prototype._promiseCreated=function(){},e.prototype._pushContext=function(){},e.prototype._popContext=function(){return null},e._peekContext=e.prototype._peekContext=function(){},t.prototype._pushContext=function(){void 0!==this._trace&&(this._trace._promiseCreated=null,i.push(this._trace))},t.prototype._popContext=function(){if(void 0!==this._trace){var e=i.pop(),t=e._promiseCreated;return e._promiseCreated=null,t}return null},t.CapturedTrace=null,t.create=function(){return n?new t:void 0},t.deactivateLongStackTraces=function(){},t.activateLongStackTraces=function(){var i=e.prototype._pushContext,o=e.prototype._popContext,a=e._peekContext,s=e.prototype._peekContext,u=e.prototype._promiseCreated;t.deactivateLongStackTraces=function(){e.prototype._pushContext=i,e.prototype._popContext=o,e._peekContext=a,e.prototype._peekContext=s,e.prototype._promiseCreated=u,n=!1},n=!0,e.prototype._pushContext=t.prototype._pushContext,e.prototype._popContext=t.prototype._popContext,e._peekContext=e.prototype._peekContext=r,e.prototype._promiseCreated=function(){var e=this._peekContext();e&&null==e._promiseCreated&&(e._promiseCreated=this)}},t}},{}],9:[function(e,t,r){t.exports=function(t,r,n,o){function a(e,t){return{promise:t}}function s(){return!1}function u(e,t,r){var n=this;try{e(t,r,(function(e){if("function"!=typeof e)throw new TypeError("onCancel must be a function, got: "+F.toString(e));n._attachCancellationCallback(e)}))}catch(o){return o}}function c(e){if(!this._isCancellable())return this;var t=this._onCancel();void 0!==t?F.isArray(t)?t.push(e):this._setOnCancel([t,e]):this._setOnCancel(e)}function l(){return this._onCancelField}function d(e){this._onCancelField=e}function f(){this._cancellationParent=void 0,this._onCancelField=void 0}function h(e,t){if(0!==(1&t)){this._cancellationParent=e;var r=e._branchesRemainingToCancel;void 0===r&&(r=0),e._branchesRemainingToCancel=r+1}0!==(2&t)&&e._isBound()&&this._setBoundTo(e._boundTo)}function g(){var e=this._boundTo;return void 0!==e&&e instanceof t?e.isFulfilled()?e.value():void 0:e}function p(){this._trace=new E(this._peekContext())}function _(e,t){if(W(e)){var r=this._trace;if(void 0!==r&&t&&(r=r._parent),void 0!==r)r.attachExtraTrace(e);else if(!e.__stackCleaned__){var n=S(e);F.notEnumerableProp(e,"stack",n.message+"\n"+n.stack.join("\n")),F.notEnumerableProp(e,"__stackCleaned__",!0)}}}function m(){this._trace=void 0}function v(e,r,n){if(re.warnings){var i,o=new k(e);if(r)n._attachExtraTrace(o);else if(re.longStackTraces&&(i=t._peekContext()))i.attachExtraTrace(o);else{var a=S(o);o.stack=a.message+"\n"+a.stack.join("\n")}q("warning",o)||T(o,"",!0)}}function y(e){for(var t=[],r=0;r<e.length;++r){var n=e[r],i="    (No stack trace)"===n||B.test(n),o=i&&$(n);i&&!o&&(V&&" "!==n.charAt(0)&&(n="    "+n),t.push(n))}return t}function S(e){var t=e.stack,r=e.toString();return t="string"==typeof t&&t.length>0?function(e){for(var t=e.stack.replace(/\s+$/g,"").split("\n"),r=0;r<t.length;++r){var n=t[r];if("    (No stack trace)"===n||B.test(n))break}return r>0&&"SyntaxError"!=e.name&&(t=t.slice(r)),t}(e):["    (No stack trace)"],{message:r,stack:"SyntaxError"==e.name?t:y(t)}}function T(e,t,r){if("undefined"!=typeof console){var n;if(F.isObject(e)){var i=e.stack;n=t+U(i,e)}else n=t+String(e);"function"==typeof P?P(n,r):("function"==typeof console.log||"object"==typeof console.log)&&console.log(n)}}function I(e,t,r,n){var i=!1;try{"function"==typeof t&&(i=!0,"rejectionHandled"===e?t(n):t(r,n))}catch(a){x.throwLater(a)}"unhandledRejection"===e?q(e,r,n)||i||T(r,"Unhandled rejection "):q(e,n)}function b(e){var t;if("function"==typeof e)t="[function "+(e.name||"anonymous")+"]";else{t=e&&"function"==typeof e.toString?e.toString():F.toString(e);if(/\[object [a-zA-Z0-9$_]+\]/.test(t))try{t=JSON.stringify(e)}catch(o){}0===t.length&&(t="(empty array)")}return"(<"+function(e){var t=41;return e.length<t?e:e.substr(0,t-3)+"..."}(t)+">, no stack trace)"}function C(){return"function"==typeof te}function w(e){var t=e.match(ee);return t?{fileName:t[1],line:parseInt(t[2],10)}:void 0}function E(e){this._parent=e,this._promisesCreated=0;var t=this._length=1+(void 0===e?0:e._length);te(this,E),t>32&&this.uncycle()}var A,D,P,R,x=t._async,k=e("./errors").Warning,F=e("./util"),O=e("./es5"),W=F.canAttachTrace,N=/[\\\/]bluebird[\\\/]js[\\\/](release|debug|instrumented)/,M=/\((?:timers\.js):\d+:\d+\)/,L=/[\/<\(](.+?):(\d+):(\d+)\)?\s*$/,B=null,U=null,V=!1,G=!(0==F.env("BLUEBIRD_DEBUG")||!F.env("BLUEBIRD_DEBUG")&&"development"!==F.env("NODE_ENV")),j=!(0==F.env("BLUEBIRD_WARNINGS")||!G&&!F.env("BLUEBIRD_WARNINGS")),H=!(0==F.env("BLUEBIRD_LONG_STACK_TRACES")||!G&&!F.env("BLUEBIRD_LONG_STACK_TRACES")),z=0!=F.env("BLUEBIRD_W_FORGOTTEN_RETURN")&&(j||!!F.env("BLUEBIRD_W_FORGOTTEN_RETURN"));!function(){function e(){for(var e=0;e<n.length;++e)n[e]._notifyUnhandledRejection();r()}function r(){n.length=0}var n=[];R=function(t){n.push(t),setTimeout(e,1)},O.defineProperty(t,"_unhandledRejectionCheck",{value:e}),O.defineProperty(t,"_unhandledRejectionClear",{value:r})}(),t.prototype.suppressUnhandledRejections=function(){var e=this._target();e._bitField=-1048577&e._bitField|524288},t.prototype._ensurePossibleRejectionHandled=function(){0===(524288&this._bitField)&&(this._setRejectionIsUnhandled(),R(this))},t.prototype._notifyUnhandledRejectionIsHandled=function(){I("rejectionHandled",A,void 0,this)},t.prototype._setReturnedNonUndefined=function(){this._bitField=268435456|this._bitField},t.prototype._returnedNonUndefined=function(){return 0!==(268435456&this._bitField)},t.prototype._notifyUnhandledRejection=function(){if(this._isRejectionUnhandled()){var e=this._settledValue();this._setUnhandledRejectionIsNotified(),I("unhandledRejection",D,e,this)}},t.prototype._setUnhandledRejectionIsNotified=function(){this._bitField=262144|this._bitField},t.prototype._unsetUnhandledRejectionIsNotified=function(){this._bitField=-262145&this._bitField},t.prototype._isUnhandledRejectionNotified=function(){return(262144&this._bitField)>0},t.prototype._setRejectionIsUnhandled=function(){this._bitField=1048576|this._bitField},t.prototype._unsetRejectionIsUnhandled=function(){this._bitField=-1048577&this._bitField,this._isUnhandledRejectionNotified()&&(this._unsetUnhandledRejectionIsNotified(),this._notifyUnhandledRejectionIsHandled())},t.prototype._isRejectionUnhandled=function(){return(1048576&this._bitField)>0},t.prototype._warn=function(e,t,r){return v(e,t,r||this)},t.onPossiblyUnhandledRejection=function(e){var r=t._getContext();D=F.contextBind(r,e)},t.onUnhandledRejectionHandled=function(e){var r=t._getContext();A=F.contextBind(r,e)};var K=function(){};t.longStackTraces=function(){if(x.haveItemsQueued()&&!re.longStackTraces)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");if(!re.longStackTraces&&C()){var e=t.prototype._captureStackTrace,n=t.prototype._attachExtraTrace,i=t.prototype._dereferenceTrace;re.longStackTraces=!0,K=function(){if(x.haveItemsQueued()&&!re.longStackTraces)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");t.prototype._captureStackTrace=e,t.prototype._attachExtraTrace=n,t.prototype._dereferenceTrace=i,r.deactivateLongStackTraces(),re.longStackTraces=!1},t.prototype._captureStackTrace=p,t.prototype._attachExtraTrace=_,t.prototype._dereferenceTrace=m,r.activateLongStackTraces()}},t.hasLongStackTraces=function(){return re.longStackTraces&&C()};var J={unhandledrejection:{before:function(){var e=F.global.onunhandledrejection;return F.global.onunhandledrejection=null,e},after:function(e){F.global.onunhandledrejection=e}},rejectionhandled:{before:function(){var e=F.global.onrejectionhandled;return F.global.onrejectionhandled=null,e},after:function(e){F.global.onrejectionhandled=e}}},Y=function(){var e=function(e,t){if(!e)return!F.global.dispatchEvent(t);var r;try{return r=e.before(),!F.global.dispatchEvent(t)}finally{e.after(r)}};try{if("function"==typeof CustomEvent){var t=new CustomEvent("CustomEvent");return F.global.dispatchEvent(t),function(t,r){t=t.toLowerCase();var n=new CustomEvent(t,{detail:r,cancelable:!0});return O.defineProperty(n,"promise",{value:r.promise}),O.defineProperty(n,"reason",{value:r.reason}),e(J[t],n)}}if("function"==typeof Event){t=new Event("CustomEvent");return F.global.dispatchEvent(t),function(t,r){t=t.toLowerCase();var n=new Event(t,{cancelable:!0});return n.detail=r,O.defineProperty(n,"promise",{value:r.promise}),O.defineProperty(n,"reason",{value:r.reason}),e(J[t],n)}}return(t=document.createEvent("CustomEvent")).initCustomEvent("testingtheevent",!1,!0,{}),F.global.dispatchEvent(t),function(t,r){t=t.toLowerCase();var n=document.createEvent("CustomEvent");return n.initCustomEvent(t,!1,!0,r),e(J[t],n)}}catch(r){}return function(){return!1}}(),Q=F.isNode?function(){return i.emit.apply(i,arguments)}:F.global?function(e){var t="on"+e.toLowerCase(),r=F.global[t];return!!r&&(r.apply(F.global,[].slice.call(arguments,1)),!0)}:function(){return!1},X={promiseCreated:a,promiseFulfilled:a,promiseRejected:a,promiseResolved:a,promiseCancelled:a,promiseChained:function(e,t,r){return{promise:t,child:r}},warning:function(e,t){return{warning:t}},unhandledRejection:function(e,t,r){return{reason:t,promise:r}},rejectionHandled:a},q=function(e){var t=!1;try{t=Q.apply(null,arguments)}catch(r){x.throwLater(r),t=!0}var n=!1;try{n=Y(e,X[e].apply(null,arguments))}catch(r){x.throwLater(r),n=!0}return n||t};t.config=function(e){if("longStackTraces"in(e=Object(e))&&(e.longStackTraces?t.longStackTraces():!e.longStackTraces&&t.hasLongStackTraces()&&K()),"warnings"in e){var r=e.warnings;re.warnings=!!r,z=re.warnings,F.isObject(r)&&"wForgottenReturn"in r&&(z=!!r.wForgottenReturn)}if("cancellation"in e&&e.cancellation&&!re.cancellation){if(x.haveItemsQueued())throw new Error("cannot enable cancellation after promises are in use");t.prototype._clearCancellationData=f,t.prototype._propagateFrom=h,t.prototype._onCancel=l,t.prototype._setOnCancel=d,t.prototype._attachCancellationCallback=c,t.prototype._execute=u,Z=h,re.cancellation=!0}if("monitoring"in e&&(e.monitoring&&!re.monitoring?(re.monitoring=!0,t.prototype._fireEvent=q):!e.monitoring&&re.monitoring&&(re.monitoring=!1,t.prototype._fireEvent=s)),"asyncHooks"in e&&F.nodeSupportsAsyncResource){var i=re.asyncHooks,a=!!e.asyncHooks;i!==a&&(re.asyncHooks=a,a?n():o())}return t},t.prototype._fireEvent=s,t.prototype._execute=function(e,t,r){try{e(t,r)}catch(n){return n}},t.prototype._onCancel=function(){},t.prototype._setOnCancel=function(e){},t.prototype._attachCancellationCallback=function(e){},t.prototype._captureStackTrace=function(){},t.prototype._attachExtraTrace=function(){},t.prototype._dereferenceTrace=function(){},t.prototype._clearCancellationData=function(){},t.prototype._propagateFrom=function(e,t){};var Z=function(e,t){0!==(2&t)&&e._isBound()&&this._setBoundTo(e._boundTo)},$=function(){return!1},ee=/[\/<\(]([^:\/]+):(\d+):(?:\d+)\)?\s*$/;F.inherits(E,Error),r.CapturedTrace=E,E.prototype.uncycle=function(){var e=this._length;if(!(2>e)){for(var t=[],r={},n=0,i=this;void 0!==i;++n)t.push(i),i=i._parent;for(n=(e=this._length=n)-1;n>=0;--n){var o=t[n].stack;void 0===r[o]&&(r[o]=n)}for(n=0;e>n;++n){var a=r[t[n].stack];if(void 0!==a&&a!==n){a>0&&(t[a-1]._parent=void 0,t[a-1]._length=1),t[n]._parent=void 0,t[n]._length=1;var s=n>0?t[n-1]:this;e-1>a?(s._parent=t[a+1],s._parent.uncycle(),s._length=s._parent._length+1):(s._parent=void 0,s._length=1);for(var u=s._length+1,c=n-2;c>=0;--c)t[c]._length=u,u++;return}}}},E.prototype.attachExtraTrace=function(e){if(!e.__stackCleaned__){this.uncycle();for(var t=S(e),r=t.message,n=[t.stack],i=this;void 0!==i;)n.push(y(i.stack.split("\n"))),i=i._parent;(function(e){for(var t=e[0],r=1;r<e.length;++r){for(var n=e[r],i=t.length-1,o=t[i],a=-1,s=n.length-1;s>=0;--s)if(n[s]===o){a=s;break}for(s=a;s>=0;--s){var u=n[s];if(t[i]!==u)break;t.pop(),i--}t=n}})(n),function(e){for(var t=0;t<e.length;++t)(0===e[t].length||t+1<e.length&&e[t][0]===e[t+1][0])&&(e.splice(t,1),t--)}(n),F.notEnumerableProp(e,"stack",function(e,t){for(var r=0;r<t.length-1;++r)t[r].push("From previous event:"),t[r]=t[r].join("\n");return r<t.length&&(t[r]=t[r].join("\n")),e+"\n"+t.join("\n")}(r,n)),F.notEnumerableProp(e,"__stackCleaned__",!0)}};var te=function(){var e=/^\s*at\s*/,t=function(e,t){return"string"==typeof e?e:void 0!==t.name&&void 0!==t.message?t.toString():b(t)};if("number"==typeof Error.stackTraceLimit&&"function"==typeof Error.captureStackTrace){Error.stackTraceLimit+=6,B=e,U=t;var r=Error.captureStackTrace;return $=function(e){return N.test(e)},function(e,t){Error.stackTraceLimit+=6,r(e,t),Error.stackTraceLimit-=6}}var n,i=new Error;if("string"==typeof i.stack&&i.stack.split("\n")[0].indexOf("stackDetection@")>=0)return B=/@/,U=t,V=!0,function(e){e.stack=(new Error).stack};try{throw new Error}catch(a){n="stack"in a}return"stack"in i||!n||"number"!=typeof Error.stackTraceLimit?(U=function(e,t){return"string"==typeof e?e:"object"!=typeof t&&"function"!=typeof t||void 0===t.name||void 0===t.message?b(t):t.toString()},null):(B=e,U=t,function(e){Error.stackTraceLimit+=6;try{throw new Error}catch(t){e.stack=t.stack}Error.stackTraceLimit-=6})}();"undefined"!=typeof console&&"undefined"!=typeof console.warn&&(P=function(e){console.warn(e)},F.isNode&&i.stderr.isTTY?P=function(e,t){var r=t?"\x1b[33m":"\x1b[31m";console.warn(r+e+"\x1b[0m\n")}:F.isNode||"string"!=typeof(new Error).stack||(P=function(e,t){console.warn("%c"+e,t?"color: darkorange":"color: red")}));var re={warnings:j,longStackTraces:!1,cancellation:!1,monitoring:!1,asyncHooks:!1};return H&&t.longStackTraces(),{asyncHooks:function(){return re.asyncHooks},longStackTraces:function(){return re.longStackTraces},warnings:function(){return re.warnings},cancellation:function(){return re.cancellation},monitoring:function(){return re.monitoring},propagateFromFunction:function(){return Z},boundValueFunction:function(){return g},checkForgottenReturns:function(e,t,r,n,i){if(void 0===e&&null!==t&&z){if(void 0!==i&&i._returnedNonUndefined())return;if(0===(65535&n._bitField))return;r&&(r+=" ");var o="",a="";if(t._trace){for(var s=t._trace.stack.split("\n"),u=y(s),c=u.length-1;c>=0;--c){var l=u[c];if(!M.test(l)){var d=l.match(L);d&&(o="at "+d[1]+":"+d[2]+":"+d[3]+" ");break}}if(u.length>0){var f=u[0];for(c=0;c<s.length;++c)if(s[c]===f){c>0&&(a="\n"+s[c-1]);break}}}var h="a promise was created in a "+r+"handler "+o+"but was not returned from it, see http://goo.gl/rRqMUw"+a;n._warn(h,!0,t)}},setBounds:function(e,t){if(C()){for(var r,n,i=(e.stack||"").split("\n"),o=(t.stack||"").split("\n"),a=-1,s=-1,u=0;u<i.length;++u){if(c=w(i[u])){r=c.fileName,a=c.line;break}}for(u=0;u<o.length;++u){var c;if(c=w(o[u])){n=c.fileName,s=c.line;break}}0>a||0>s||!r||!n||r!==n||a>=s||($=function(e){if(N.test(e))return!0;var t=w(e);return!!(t&&t.fileName===r&&a<=t.line&&t.line<=s)})}},warn:v,deprecated:function(e,t){var r=e+" is deprecated and will be removed in a future version.";return t&&(r+=" Use "+t+" instead."),v(r)},CapturedTrace:E,fireDomEvent:Y,fireGlobalEvent:Q}}},{"./errors":12,"./es5":13,"./util":36}],10:[function(e,t,r){t.exports=function(e){function t(){return this.value}function r(){throw this.reason}e.prototype.return=e.prototype.thenReturn=function(r){return r instanceof e&&r.suppressUnhandledRejections(),this._then(t,void 0,void 0,{value:r},void 0)},e.prototype.throw=e.prototype.thenThrow=function(e){return this._then(r,void 0,void 0,{reason:e},void 0)},e.prototype.catchThrow=function(e){if(arguments.length<=1)return this._then(void 0,r,void 0,{reason:e},void 0);var t=arguments[1];return this.caught(e,(function(){throw t}))},e.prototype.catchReturn=function(r){if(arguments.length<=1)return r instanceof e&&r.suppressUnhandledRejections(),this._then(void 0,t,void 0,{value:r},void 0);var n=arguments[1];n instanceof e&&n.suppressUnhandledRejections();return this.caught(r,(function(){return n}))}}},{}],11:[function(e,t,r){t.exports=function(e,t){function r(){return i(this)}var n=e.reduce,i=e.all;e.prototype.each=function(e){return n(this,e,t,0)._then(r,void 0,void 0,this,void 0)},e.prototype.mapSeries=function(e){return n(this,e,t,t)},e.each=function(e,i){return n(e,i,t,0)._then(r,void 0,void 0,e,void 0)},e.mapSeries=function(e,r){return n(e,r,t,t)}}},{}],12:[function(e,t,r){function n(e,t){function r(n){return this instanceof r?(d(this,"message","string"==typeof n?n:t),d(this,"name",e),void(Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):Error.call(this))):new r(n)}return l(r,Error),r}function i(e){return this instanceof i?(d(this,"name","OperationalError"),d(this,"message",e),this.cause=e,this.isOperational=!0,void(e instanceof Error?(d(this,"message",e.message),d(this,"stack",e.stack)):Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor))):new i(e)}var o,a,s=e("./es5"),u=s.freeze,c=e("./util"),l=c.inherits,d=c.notEnumerableProp,f=n("Warning","warning"),h=n("CancellationError","cancellation error"),g=n("TimeoutError","timeout error"),p=n("AggregateError","aggregate error");try{o=TypeError,a=RangeError}catch(S){o=n("TypeError","type error"),a=n("RangeError","range error")}for(var _="join pop push shift unshift slice filter forEach some every map indexOf lastIndexOf reduce reduceRight sort reverse".split(" "),m=0;m<_.length;++m)"function"==typeof Array.prototype[_[m]]&&(p.prototype[_[m]]=Array.prototype[_[m]]);s.defineProperty(p.prototype,"length",{value:0,configurable:!1,writable:!0,enumerable:!0}),p.prototype.isOperational=!0;var v=0;p.prototype.toString=function(){var e=Array(4*v+1).join(" "),t="\n"+e+"AggregateError of:\n";v++,e=Array(4*v+1).join(" ");for(var r=0;r<this.length;++r){for(var n=this[r]===this?"[Circular AggregateError]":this[r]+"",i=n.split("\n"),o=0;o<i.length;++o)i[o]=e+i[o];t+=(n=i.join("\n"))+"\n"}return v--,t},l(i,Error);var y=Error.__BluebirdErrorTypes__;y||(y=u({CancellationError:h,TimeoutError:g,OperationalError:i,RejectionError:i,AggregateError:p}),s.defineProperty(Error,"__BluebirdErrorTypes__",{value:y,writable:!1,enumerable:!1,configurable:!1})),t.exports={Error:Error,TypeError:o,RangeError:a,CancellationError:y.CancellationError,OperationalError:y.OperationalError,TimeoutError:y.TimeoutError,AggregateError:y.AggregateError,Warning:f}},{"./es5":13,"./util":36}],13:[function(e,t,r){var n=function(){return void 0===this}();if(n)t.exports={freeze:Object.freeze,defineProperty:Object.defineProperty,getDescriptor:Object.getOwnPropertyDescriptor,keys:Object.keys,names:Object.getOwnPropertyNames,getPrototypeOf:Object.getPrototypeOf,isArray:Array.isArray,isES5:n,propertyIsWritable:function(e,t){var r=Object.getOwnPropertyDescriptor(e,t);return!(r&&!r.writable&&!r.set)}};else{var i={}.hasOwnProperty,o={}.toString,a={}.constructor.prototype,s=function(e){var t=[];for(var r in e)i.call(e,r)&&t.push(r);return t};t.exports={isArray:function(e){try{return"[object Array]"===o.call(e)}catch(t){return!1}},keys:s,names:s,defineProperty:function(e,t,r){return e[t]=r.value,e},getDescriptor:function(e,t){return{value:e[t]}},freeze:function(e){return e},getPrototypeOf:function(e){try{return Object(e).constructor.prototype}catch(t){return a}},isES5:n,propertyIsWritable:function(){return!0}}}},{}],14:[function(e,t,r){t.exports=function(e,t){var r=e.map;e.prototype.filter=function(e,n){return r(this,e,n,t)},e.filter=function(e,n,i){return r(e,n,i,t)}}},{}],15:[function(e,t,r){t.exports=function(t,r,n){function i(e,t,r){this.promise=e,this.type=t,this.handler=r,this.called=!1,this.cancelPromise=null}function o(e){this.finallyHandler=e}function a(e,t){return null!=e.cancelPromise&&(arguments.length>1?e.cancelPromise._reject(t):e.cancelPromise._cancel(),e.cancelPromise=null,!0)}function s(){return c.call(this,this.promise._target()._settledValue())}function u(e){return a(this,e)?void 0:(f.e=e,f)}function c(e){var i=this.promise,c=this.handler;if(!this.called){this.called=!0;var l=this.isFinallyHandler()?c.call(i._boundValue()):c.call(i._boundValue(),e);if(l===n)return l;if(void 0!==l){i._setReturnedNonUndefined();var h=r(l,i);if(h instanceof t){if(null!=this.cancelPromise){if(h._isCancelled()){var g=new d("late cancellation observer");return i._attachExtraTrace(g),f.e=g,f}h.isPending()&&h._attachCancellationCallback(new o(this))}return h._then(s,u,void 0,this,void 0)}}}return i.isRejected()?(a(this),f.e=e,f):(a(this),e)}var l=e("./util"),d=t.CancellationError,f=l.errorObj,h=e("./catch_filter")(n);return i.prototype.isFinallyHandler=function(){return 0===this.type},o.prototype._resultCancelled=function(){a(this.finallyHandler)},t.prototype._passThrough=function(e,t,r,n){return"function"!=typeof e?this.then():this._then(r,n,void 0,new i(this,t,e),void 0)},t.prototype.lastly=t.prototype.finally=function(e){return this._passThrough(e,0,c,c)},t.prototype.tap=function(e){return this._passThrough(e,1,c)},t.prototype.tapCatch=function(e){var r=arguments.length;if(1===r)return this._passThrough(e,1,void 0,c);var n,i=new Array(r-1),o=0;for(n=0;r-1>n;++n){var a=arguments[n];if(!l.isObject(a))return t.reject(new TypeError("tapCatch statement predicate: expecting an object but got "+l.classString(a)));i[o++]=a}i.length=o;var s=arguments[n];return this._passThrough(h(i,s,this),1,void 0,c)},i}},{"./catch_filter":7,"./util":36}],16:[function(e,t,r){t.exports=function(t,r,n,i,o,a){function s(e,r,i,o){if(a.cancellation()){var s=new t(n),u=this._finallyPromise=new t(n);this._promise=s.lastly((function(){return u})),s._captureStackTrace(),s._setOnCancel(this)}else{(this._promise=new t(n))._captureStackTrace()}this._stack=o,this._generatorFunction=e,this._receiver=r,this._generator=void 0,this._yieldHandlers="function"==typeof i?[i].concat(f):f,this._yieldedPromise=null,this._cancellationPhase=!1}var u=e("./errors").TypeError,c=e("./util"),l=c.errorObj,d=c.tryCatch,f=[];c.inherits(s,o),s.prototype._isResolved=function(){return null===this._promise},s.prototype._cleanup=function(){this._promise=this._generator=null,a.cancellation()&&null!==this._finallyPromise&&(this._finallyPromise._fulfill(),this._finallyPromise=null)},s.prototype._promiseCancelled=function(){if(!this._isResolved()){var e;if("undefined"!=typeof this._generator.return)this._promise._pushContext(),e=d(this._generator.return).call(this._generator,void 0),this._promise._popContext();else{var r=new t.CancellationError("generator .return() sentinel");t.coroutine.returnSentinel=r,this._promise._attachExtraTrace(r),this._promise._pushContext(),e=d(this._generator.throw).call(this._generator,r),this._promise._popContext()}this._cancellationPhase=!0,this._yieldedPromise=null,this._continue(e)}},s.prototype._promiseFulfilled=function(e){this._yieldedPromise=null,this._promise._pushContext();var t=d(this._generator.next).call(this._generator,e);this._promise._popContext(),this._continue(t)},s.prototype._promiseRejected=function(e){this._yieldedPromise=null,this._promise._attachExtraTrace(e),this._promise._pushContext();var t=d(this._generator.throw).call(this._generator,e);this._promise._popContext(),this._continue(t)},s.prototype._resultCancelled=function(){if(this._yieldedPromise instanceof t){var e=this._yieldedPromise;this._yieldedPromise=null,e.cancel()}},s.prototype.promise=function(){return this._promise},s.prototype._run=function(){this._generator=this._generatorFunction.call(this._receiver),this._receiver=this._generatorFunction=void 0,this._promiseFulfilled(void 0)},s.prototype._continue=function(e){var r=this._promise;if(e===l)return this._cleanup(),this._cancellationPhase?r.cancel():r._rejectCallback(e.e,!1);var n=e.value;if(!0===e.done)return this._cleanup(),this._cancellationPhase?r.cancel():r._resolveCallback(n);var o=i(n,this._promise);if(o instanceof t||(o=function(e,r,n){for(var o=0;o<r.length;++o){n._pushContext();var a=d(r[o])(e);if(n._popContext(),a===l){n._pushContext();var s=t.reject(l.e);return n._popContext(),s}var u=i(a,n);if(u instanceof t)return u}return null}(o,this._yieldHandlers,this._promise),null!==o)){var a=(o=o._target())._bitField;0===(50397184&a)?(this._yieldedPromise=o,o._proxy(this,null)):0!==(33554432&a)?t._async.invoke(this._promiseFulfilled,this,o._value()):0!==(16777216&a)?t._async.invoke(this._promiseRejected,this,o._reason()):this._promiseCancelled()}else this._promiseRejected(new u("A value %s was yielded that could not be treated as a promise\n\n    See http://goo.gl/MqrFmX\n\n".replace("%s",String(n))+"From coroutine:\n"+this._stack.split("\n").slice(1,-7).join("\n")))},t.coroutine=function(e,t){if("function"!=typeof e)throw new u("generatorFunction must be a function\n\n    See http://goo.gl/MqrFmX\n");var r=Object(t).yieldHandler,n=s,i=(new Error).stack;return function(){var t=e.apply(this,arguments),o=new n(void 0,void 0,r,i),a=o.promise();return o._generator=t,o._promiseFulfilled(void 0),a}},t.coroutine.addYieldHandler=function(e){if("function"!=typeof e)throw new u("expecting a function but got "+c.classString(e));f.push(e)},t.spawn=function(e){if(a.deprecated("Promise.spawn()","Promise.coroutine()"),"function"!=typeof e)return r("generatorFunction must be a function\n\n    See http://goo.gl/MqrFmX\n");var n=new s(e,this),i=n.promise();return n._run(t.spawn),i}}},{"./errors":12,"./util":36}],17:[function(e,t,r){t.exports=function(t,r,n,i,o){var a=e("./util");a.canEvaluate,a.tryCatch,a.errorObj,t.join=function(){var e,t=arguments.length-1;t>0&&"function"==typeof arguments[t]&&(e=arguments[t]);var n=[].slice.call(arguments);e&&n.pop();var i=new r(n).promise();return void 0!==e?i.spread(e):i}}},{"./util":36}],18:[function(e,t,r){t.exports=function(t,r,n,i,o,a){function s(e,r,n,i){this.constructor$(e),this._promise._captureStackTrace();var a=t._getContext();if(this._callback=c.contextBind(a,r),this._preservedValues=i===o?new Array(this.length()):null,this._limit=n,this._inFlight=0,this._queue=[],f.invoke(this._asyncInit,this,void 0),c.isArray(e))for(var s=0;s<e.length;++s){var u=e[s];u instanceof t&&u.suppressUnhandledRejections()}}function u(e,r,i,o){if("function"!=typeof r)return n("expecting a function but got "+c.classString(r));var a=0;if(void 0!==i){if("object"!=typeof i||null===i)return t.reject(new TypeError("options argument must be an object but it is "+c.classString(i)));if("number"!=typeof i.concurrency)return t.reject(new TypeError("'concurrency' must be a number but it is "+c.classString(i.concurrency)));a=i.concurrency}return new s(e,r,a="number"==typeof a&&isFinite(a)&&a>=1?a:0,o).promise()}var c=e("./util"),l=c.tryCatch,d=c.errorObj,f=t._async;c.inherits(s,r),s.prototype._asyncInit=function(){this._init$(void 0,-2)},s.prototype._init=function(){},s.prototype._promiseFulfilled=function(e,r){var n=this._values,o=this.length(),s=this._preservedValues,u=this._limit;if(0>r){if(n[r=-1*r-1]=e,u>=1&&(this._inFlight--,this._drainQueue(),this._isResolved()))return!0}else{if(u>=1&&this._inFlight>=u)return n[r]=e,this._queue.push(r),!1;null!==s&&(s[r]=e);var c=this._promise,f=this._callback,h=c._boundValue();c._pushContext();var g=l(f).call(h,e,r,o),p=c._popContext();if(a.checkForgottenReturns(g,p,null!==s?"Promise.filter":"Promise.map",c),g===d)return this._reject(g.e),!0;var _=i(g,this._promise);if(_ instanceof t){var m=(_=_._target())._bitField;if(0===(50397184&m))return u>=1&&this._inFlight++,n[r]=_,_._proxy(this,-1*(r+1)),!1;if(0===(33554432&m))return 0!==(16777216&m)?(this._reject(_._reason()),!0):(this._cancel(),!0);g=_._value()}n[r]=g}return++this._totalResolved>=o&&(null!==s?this._filter(n,s):this._resolve(n),!0)},s.prototype._drainQueue=function(){for(var e=this._queue,t=this._limit,r=this._values;e.length>0&&this._inFlight<t;){if(this._isResolved())return;var n=e.pop();this._promiseFulfilled(r[n],n)}},s.prototype._filter=function(e,t){for(var r=t.length,n=new Array(r),i=0,o=0;r>o;++o)e[o]&&(n[i++]=t[o]);n.length=i,this._resolve(n)},s.prototype.preservedValues=function(){return this._preservedValues},t.prototype.map=function(e,t){return u(this,e,t,null)},t.map=function(e,t,r,n){return u(e,t,r,n)}}},{"./util":36}],19:[function(e,t,r){t.exports=function(t,r,n,i,o){var a=e("./util"),s=a.tryCatch;t.method=function(e){if("function"!=typeof e)throw new t.TypeError("expecting a function but got "+a.classString(e));return function(){var n=new t(r);n._captureStackTrace(),n._pushContext();var i=s(e).apply(this,arguments),a=n._popContext();return o.checkForgottenReturns(i,a,"Promise.method",n),n._resolveFromSyncValue(i),n}},t.attempt=t.try=function(e){if("function"!=typeof e)return i("expecting a function but got "+a.classString(e));var n,u=new t(r);if(u._captureStackTrace(),u._pushContext(),arguments.length>1){o.deprecated("calling Promise.try with more than 1 argument");var c=arguments[1],l=arguments[2];n=a.isArray(c)?s(e).apply(l,c):s(e).call(l,c)}else n=s(e)();var d=u._popContext();return o.checkForgottenReturns(n,d,"Promise.try",u),u._resolveFromSyncValue(n),u},t.prototype._resolveFromSyncValue=function(e){e===a.errorObj?this._rejectCallback(e.e,!1):this._resolveCallback(e,!0)}}},{"./util":36}],20:[function(e,t,r){function n(e){var t;if(function(e){return e instanceof Error&&s.getPrototypeOf(e)===Error.prototype}(e)){(t=new a(e)).name=e.name,t.message=e.message,t.stack=e.stack;for(var r=s.keys(e),n=0;n<r.length;++n){var o=r[n];u.test(o)||(t[o]=e[o])}return t}return i.markAsOriginatingFromRejection(e),e}var i=e("./util"),o=i.maybeWrapAsError,a=e("./errors").OperationalError,s=e("./es5"),u=/^(?:name|message|stack|cause)$/;t.exports=function(e,t){return function(r,i){if(null!==e){if(r){var a=n(o(r));e._attachExtraTrace(a),e._reject(a)}else if(t){var s=[].slice.call(arguments,1);e._fulfill(s)}else e._fulfill(i);e=null}}}},{"./errors":12,"./es5":13,"./util":36}],21:[function(e,t,r){t.exports=function(t){function r(e,t){if(!o.isArray(e))return n.call(this,e,t);var r=s(t).apply(this._boundValue(),[null].concat(e));r===u&&a.throwLater(r.e)}function n(e,t){var r=this._boundValue(),n=void 0===e?s(t).call(r,null):s(t).call(r,null,e);n===u&&a.throwLater(n.e)}function i(e,t){if(!e){var r=new Error(e+"");r.cause=e,e=r}var n=s(t).call(this._boundValue(),e);n===u&&a.throwLater(n.e)}var o=e("./util"),a=t._async,s=o.tryCatch,u=o.errorObj;t.prototype.asCallback=t.prototype.nodeify=function(e,t){if("function"==typeof e){var o=n;void 0!==t&&Object(t).spread&&(o=r),this._then(o,i,void 0,this,e)}return this}}},{"./util":36}],22:[function(e,t,r){t.exports=function(){function r(){}function n(e){e!==C&&function(e,t){if(null==e||e.constructor!==n&&"undefined"!=typeof Promise&&e.constructor!==Promise)throw new I("the promise constructor cannot be invoked directly\n\n    See http://goo.gl/MqrFmX\n");if("function"!=typeof t)throw new I("expecting a function but got "+f.classString(t))}(this,e),this._bitField=0,this._fulfillmentHandler0=void 0,this._rejectionHandler0=void 0,this._promise0=void 0,this._receiver0=void 0,this._resolveFromExecutor(e),this._promiseCreated(),this._fireEvent("promiseCreated",this)}function o(e){this.promise._resolveCallback(e)}function a(e){this.promise._rejectCallback(e,!1)}function s(e){var t=new n(C);t._fulfillmentHandler0=e,t._rejectionHandler0=e,t._promise0=e,t._receiver0=e}var u=function(){return new I("circular promise resolution chain\n\n    See http://goo.gl/MqrFmX\n")},c=function(){return new n.PromiseInspection(this._target())},l=function(e){return n.reject(new I(e))},d={},f=e("./util");f.setReflectHandler(c);var h=function(){var e=i.domain;return void 0===e?null:e},g=function(){return{domain:h(),async:null}},p=f.isNode&&f.nodeSupportsAsyncResource?e("async_hooks").AsyncResource:null,_=function(){return{domain:h(),async:new p("Bluebird::Promise")}},m=f.isNode?g:function(){return null};f.notEnumerableProp(n,"_getContext",m);var v=e("./es5"),y=e("./async"),S=new y;v.defineProperty(n,"_async",{value:S});var T=e("./errors"),I=n.TypeError=T.TypeError;n.RangeError=T.RangeError;var b=n.CancellationError=T.CancellationError;n.TimeoutError=T.TimeoutError,n.OperationalError=T.OperationalError,n.RejectionError=T.OperationalError,n.AggregateError=T.AggregateError;var C=function(){},w={},E={},A=e("./thenables")(n,C),D=e("./promise_array")(n,C,A,l,r),P=e("./context")(n),R=P.create,x=e("./debuggability")(n,P,(function(){m=_,f.notEnumerableProp(n,"_getContext",_)}),(function(){m=g,f.notEnumerableProp(n,"_getContext",g)})),k=(x.CapturedTrace,e("./finally")(n,A,E)),F=e("./catch_filter")(E),O=e("./nodeback"),W=f.errorObj,N=f.tryCatch;return n.prototype.toString=function(){return"[object Promise]"},n.prototype.caught=n.prototype.catch=function(e){var t=arguments.length;if(t>1){var r,n=new Array(t-1),i=0;for(r=0;t-1>r;++r){var o=arguments[r];if(!f.isObject(o))return l("Catch statement predicate: expecting an object but got "+f.classString(o));n[i++]=o}if(n.length=i,"function"!=typeof(e=arguments[r]))throw new I("The last argument to .catch() must be a function, got "+f.toString(e));return this.then(void 0,F(n,e,this))}return this.then(void 0,e)},n.prototype.reflect=function(){return this._then(c,c,void 0,this,void 0)},n.prototype.then=function(e,t){if(x.warnings()&&arguments.length>0&&"function"!=typeof e&&"function"!=typeof t){var r=".then() only accepts functions but was passed: "+f.classString(e);arguments.length>1&&(r+=", "+f.classString(t)),this._warn(r)}return this._then(e,t,void 0,void 0,void 0)},n.prototype.done=function(e,t){this._then(e,t,void 0,void 0,void 0)._setIsFinal()},n.prototype.spread=function(e){return"function"!=typeof e?l("expecting a function but got "+f.classString(e)):this.all()._then(e,void 0,void 0,w,void 0)},n.prototype.toJSON=function(){var e={isFulfilled:!1,isRejected:!1,fulfillmentValue:void 0,rejectionReason:void 0};return this.isFulfilled()?(e.fulfillmentValue=this.value(),e.isFulfilled=!0):this.isRejected()&&(e.rejectionReason=this.reason(),e.isRejected=!0),e},n.prototype.all=function(){return arguments.length>0&&this._warn(".all() was passed arguments but it does not take any"),new D(this).promise()},n.prototype.error=function(e){return this.caught(f.originatesFromRejection,e)},n.getNewLibraryCopy=t.exports,n.is=function(e){return e instanceof n},n.fromNode=n.fromCallback=function(e){var t=new n(C);t._captureStackTrace();var r=arguments.length>1&&!!Object(arguments[1]).multiArgs,i=N(e)(O(t,r));return i===W&&t._rejectCallback(i.e,!0),t._isFateSealed()||t._setAsyncGuaranteed(),t},n.all=function(e){return new D(e).promise()},n.cast=function(e){var t=A(e);return t instanceof n||((t=new n(C))._captureStackTrace(),t._setFulfilled(),t._rejectionHandler0=e),t},n.resolve=n.fulfilled=n.cast,n.reject=n.rejected=function(e){var t=new n(C);return t._captureStackTrace(),t._rejectCallback(e,!0),t},n.setScheduler=function(e){if("function"!=typeof e)throw new I("expecting a function but got "+f.classString(e));return S.setScheduler(e)},n.prototype._then=function(e,t,r,i,o){var a=void 0!==o,s=a?o:new n(C),u=this._target(),c=u._bitField;a||(s._propagateFrom(this,3),s._captureStackTrace(),void 0===i&&0!==(2097152&this._bitField)&&(i=0!==(50397184&c)?this._boundValue():u===this?void 0:this._boundTo),this._fireEvent("promiseChained",this,s));var l=m();if(0!==(50397184&c)){var d,h,g=u._settlePromiseCtx;0!==(33554432&c)?(h=u._rejectionHandler0,d=e):0!==(16777216&c)?(h=u._fulfillmentHandler0,d=t,u._unsetRejectionIsUnhandled()):(g=u._settlePromiseLateCancellationObserver,h=new b("late cancellation observer"),u._attachExtraTrace(h),d=t),S.invoke(g,u,{handler:f.contextBind(l,d),promise:s,receiver:i,value:h})}else u._addCallbacks(e,t,s,i,l);return s},n.prototype._length=function(){return 65535&this._bitField},n.prototype._isFateSealed=function(){return 0!==(117506048&this._bitField)},n.prototype._isFollowing=function(){return 67108864===(67108864&this._bitField)},n.prototype._setLength=function(e){this._bitField=-65536&this._bitField|65535&e},n.prototype._setFulfilled=function(){this._bitField=33554432|this._bitField,this._fireEvent("promiseFulfilled",this)},n.prototype._setRejected=function(){this._bitField=16777216|this._bitField,this._fireEvent("promiseRejected",this)},n.prototype._setFollowing=function(){this._bitField=67108864|this._bitField,this._fireEvent("promiseResolved",this)},n.prototype._setIsFinal=function(){this._bitField=4194304|this._bitField},n.prototype._isFinal=function(){return(4194304&this._bitField)>0},n.prototype._unsetCancelled=function(){this._bitField=-65537&this._bitField},n.prototype._setCancelled=function(){this._bitField=65536|this._bitField,this._fireEvent("promiseCancelled",this)},n.prototype._setWillBeCancelled=function(){this._bitField=8388608|this._bitField},n.prototype._setAsyncGuaranteed=function(){if(!S.hasCustomScheduler()){var e=this._bitField;this._bitField=e|(536870912&e)>>2^134217728}},n.prototype._setNoAsyncGuarantee=function(){this._bitField=-134217729&(536870912|this._bitField)},n.prototype._receiverAt=function(e){var t=0===e?this._receiver0:this[4*e-4+3];return t===d?void 0:void 0===t&&this._isBound()?this._boundValue():t},n.prototype._promiseAt=function(e){return this[4*e-4+2]},n.prototype._fulfillmentHandlerAt=function(e){return this[4*e-4+0]},n.prototype._rejectionHandlerAt=function(e){return this[4*e-4+1]},n.prototype._boundValue=function(){},n.prototype._migrateCallback0=function(e){var t=(e._bitField,e._fulfillmentHandler0),r=e._rejectionHandler0,n=e._promise0,i=e._receiverAt(0);void 0===i&&(i=d),this._addCallbacks(t,r,n,i,null)},n.prototype._migrateCallbackAt=function(e,t){var r=e._fulfillmentHandlerAt(t),n=e._rejectionHandlerAt(t),i=e._promiseAt(t),o=e._receiverAt(t);void 0===o&&(o=d),this._addCallbacks(r,n,i,o,null)},n.prototype._addCallbacks=function(e,t,r,n,i){var o=this._length();if(o>=65531&&(o=0,this._setLength(0)),0===o)this._promise0=r,this._receiver0=n,"function"==typeof e&&(this._fulfillmentHandler0=f.contextBind(i,e)),"function"==typeof t&&(this._rejectionHandler0=f.contextBind(i,t));else{var a=4*o-4;this[a+2]=r,this[a+3]=n,"function"==typeof e&&(this[a+0]=f.contextBind(i,e)),"function"==typeof t&&(this[a+1]=f.contextBind(i,t))}return this._setLength(o+1),o},n.prototype._proxy=function(e,t){this._addCallbacks(void 0,void 0,t,e,null)},n.prototype._resolveCallback=function(e,t){if(0===(117506048&this._bitField)){if(e===this)return this._rejectCallback(u(),!1);var r=A(e,this);if(!(r instanceof n))return this._fulfill(e);t&&this._propagateFrom(r,2);var i=r._target();if(i===this)return void this._reject(u());var o=i._bitField;if(0===(50397184&o)){var a=this._length();a>0&&i._migrateCallback0(this);for(var s=1;a>s;++s)i._migrateCallbackAt(this,s);this._setFollowing(),this._setLength(0),this._setFollowee(r)}else if(0!==(33554432&o))this._fulfill(i._value());else if(0!==(16777216&o))this._reject(i._reason());else{var c=new b("late cancellation observer");i._attachExtraTrace(c),this._reject(c)}}},n.prototype._rejectCallback=function(e,t,r){var n=f.ensureErrorObject(e),i=n===e;if(!i&&!r&&x.warnings()){var o="a promise was rejected with a non-error: "+f.classString(e);this._warn(o,!0)}this._attachExtraTrace(n,!!t&&i),this._reject(e)},n.prototype._resolveFromExecutor=function(e){if(e!==C){var t=this;this._captureStackTrace(),this._pushContext();var r=!0,n=this._execute(e,(function(e){t._resolveCallback(e)}),(function(e){t._rejectCallback(e,r)}));r=!1,this._popContext(),void 0!==n&&t._rejectCallback(n,!0)}},n.prototype._settlePromiseFromHandler=function(e,t,r,n){var i=n._bitField;if(0===(65536&i)){var o;n._pushContext(),t===w?r&&"number"==typeof r.length?o=N(e).apply(this._boundValue(),r):(o=W).e=new I("cannot .spread() a non-array: "+f.classString(r)):o=N(e).call(t,r);var a=n._popContext();0===(65536&(i=n._bitField))&&(o===E?n._reject(r):o===W?n._rejectCallback(o.e,!1):(x.checkForgottenReturns(o,a,"",n,this),n._resolveCallback(o)))}},n.prototype._target=function(){for(var e=this;e._isFollowing();)e=e._followee();return e},n.prototype._followee=function(){return this._rejectionHandler0},n.prototype._setFollowee=function(e){this._rejectionHandler0=e},n.prototype._settlePromise=function(e,t,i,o){var a=e instanceof n,s=this._bitField,u=0!==(134217728&s);0!==(65536&s)?(a&&e._invokeInternalOnCancel(),i instanceof k&&i.isFinallyHandler()?(i.cancelPromise=e,N(t).call(i,o)===W&&e._reject(W.e)):t===c?e._fulfill(c.call(i)):i instanceof r?i._promiseCancelled(e):a||e instanceof D?e._cancel():i.cancel()):"function"==typeof t?a?(u&&e._setAsyncGuaranteed(),this._settlePromiseFromHandler(t,i,o,e)):t.call(i,o,e):i instanceof r?i._isResolved()||(0!==(33554432&s)?i._promiseFulfilled(o,e):i._promiseRejected(o,e)):a&&(u&&e._setAsyncGuaranteed(),0!==(33554432&s)?e._fulfill(o):e._reject(o))},n.prototype._settlePromiseLateCancellationObserver=function(e){var t=e.handler,r=e.promise,i=e.receiver,o=e.value;"function"==typeof t?r instanceof n?this._settlePromiseFromHandler(t,i,o,r):t.call(i,o,r):r instanceof n&&r._reject(o)},n.prototype._settlePromiseCtx=function(e){this._settlePromise(e.promise,e.handler,e.receiver,e.value)},n.prototype._settlePromise0=function(e,t,r){var n=this._promise0,i=this._receiverAt(0);this._promise0=void 0,this._receiver0=void 0,this._settlePromise(n,e,i,t)},n.prototype._clearCallbackDataAtIndex=function(e){var t=4*e-4;this[t+2]=this[t+3]=this[t+0]=this[t+1]=void 0},n.prototype._fulfill=function(e){var t=this._bitField;if(!((117506048&t)>>>16)){if(e===this){var r=u();return this._attachExtraTrace(r),this._reject(r)}this._setFulfilled(),this._rejectionHandler0=e,(65535&t)>0&&(0!==(134217728&t)?this._settlePromises():S.settlePromises(this),this._dereferenceTrace())}},n.prototype._reject=function(e){var t=this._bitField;if(!((117506048&t)>>>16))return this._setRejected(),this._fulfillmentHandler0=e,this._isFinal()?S.fatalError(e,f.isNode):void((65535&t)>0?S.settlePromises(this):this._ensurePossibleRejectionHandled())},n.prototype._fulfillPromises=function(e,t){for(var r=1;e>r;r++){var n=this._fulfillmentHandlerAt(r),i=this._promiseAt(r),o=this._receiverAt(r);this._clearCallbackDataAtIndex(r),this._settlePromise(i,n,o,t)}},n.prototype._rejectPromises=function(e,t){for(var r=1;e>r;r++){var n=this._rejectionHandlerAt(r),i=this._promiseAt(r),o=this._receiverAt(r);this._clearCallbackDataAtIndex(r),this._settlePromise(i,n,o,t)}},n.prototype._settlePromises=function(){var e=this._bitField,t=65535&e;if(t>0){if(0!==(16842752&e)){var r=this._fulfillmentHandler0;this._settlePromise0(this._rejectionHandler0,r,e),this._rejectPromises(t,r)}else{var n=this._rejectionHandler0;this._settlePromise0(this._fulfillmentHandler0,n,e),this._fulfillPromises(t,n)}this._setLength(0)}this._clearCancellationData()},n.prototype._settledValue=function(){var e=this._bitField;return 0!==(33554432&e)?this._rejectionHandler0:0!==(16777216&e)?this._fulfillmentHandler0:void 0},"undefined"!=typeof Symbol&&Symbol.toStringTag&&v.defineProperty(n.prototype,Symbol.toStringTag,{get:function(){return"Object"}}),n.defer=n.pending=function(){return x.deprecated("Promise.defer","new Promise"),{promise:new n(C),resolve:o,reject:a}},f.notEnumerableProp(n,"_makeSelfResolutionError",u),e("./method")(n,C,A,l,x),e("./bind")(n,C,A,x),e("./cancel")(n,D,l,x),e("./direct_resolve")(n),e("./synchronous_inspection")(n),e("./join")(n,D,A,C,S),n.Promise=n,n.version="3.7.2",e("./call_get.js")(n),e("./generators.js")(n,l,C,A,r,x),e("./map.js")(n,D,l,A,C,x),e("./nodeify.js")(n),e("./promisify.js")(n,C),e("./props.js")(n,D,A,l),e("./race.js")(n,C,A,l),e("./reduce.js")(n,D,l,A,C,x),e("./settle.js")(n,D,x),e("./some.js")(n,D,l),e("./timers.js")(n,C,x),e("./using.js")(n,l,A,R,C,x),e("./any.js")(n),e("./each.js")(n,C),e("./filter.js")(n,C),f.toFastProperties(n),f.toFastProperties(n.prototype),s({a:1}),s({b:2}),s({c:3}),s(1),s((function(){})),s(void 0),s(!1),s(new n(C)),x.setBounds(y.firstLineError,f.lastLineError),n}},{"./any.js":1,"./async":2,"./bind":3,"./call_get.js":5,"./cancel":6,"./catch_filter":7,"./context":8,"./debuggability":9,"./direct_resolve":10,"./each.js":11,"./errors":12,"./es5":13,"./filter.js":14,"./finally":15,"./generators.js":16,"./join":17,"./map.js":18,"./method":19,"./nodeback":20,"./nodeify.js":21,"./promise_array":23,"./promisify.js":24,"./props.js":25,"./race.js":27,"./reduce.js":28,"./settle.js":30,"./some.js":31,"./synchronous_inspection":32,"./thenables":33,"./timers.js":34,"./using.js":35,"./util":36,async_hooks:void 0}],23:[function(e,t,r){t.exports=function(t,r,n,i,o){function a(e){var n=this._promise=new t(r);e instanceof t&&(n._propagateFrom(e,3),e.suppressUnhandledRejections()),n._setOnCancel(this),this._values=e,this._length=0,this._totalResolved=0,this._init(void 0,-2)}var s=e("./util");return s.isArray,s.inherits(a,o),a.prototype.length=function(){return this._length},a.prototype.promise=function(){return this._promise},a.prototype._init=function e(r,o){var a=n(this._values,this._promise);if(a instanceof t){var u=(a=a._target())._bitField;if(this._values=a,0===(50397184&u))return this._promise._setAsyncGuaranteed(),a._then(e,this._reject,void 0,this,o);if(0===(33554432&u))return 0!==(16777216&u)?this._reject(a._reason()):this._cancel();a=a._value()}if(null!==(a=s.asArray(a)))return 0===a.length?void(-5===o?this._resolveEmptyArray():this._resolve(function(e){switch(e){case-2:return[];case-3:return{};case-6:return new Map}}(o))):void this._iterate(a);var c=i("expecting an array or an iterable object but got "+s.classString(a)).reason();this._promise._rejectCallback(c,!1)},a.prototype._iterate=function(e){var r=this.getActualLength(e.length);this._length=r,this._values=this.shouldCopyValues()?new Array(r):this._values;for(var i=this._promise,o=!1,a=null,s=0;r>s;++s){var u=n(e[s],i);u instanceof t?a=(u=u._target())._bitField:a=null,o?null!==a&&u.suppressUnhandledRejections():null!==a?0===(50397184&a)?(u._proxy(this,s),this._values[s]=u):o=0!==(33554432&a)?this._promiseFulfilled(u._value(),s):0!==(16777216&a)?this._promiseRejected(u._reason(),s):this._promiseCancelled(s):o=this._promiseFulfilled(u,s)}o||i._setAsyncGuaranteed()},a.prototype._isResolved=function(){return null===this._values},a.prototype._resolve=function(e){this._values=null,this._promise._fulfill(e)},a.prototype._cancel=function(){!this._isResolved()&&this._promise._isCancellable()&&(this._values=null,this._promise._cancel())},a.prototype._reject=function(e){this._values=null,this._promise._rejectCallback(e,!1)},a.prototype._promiseFulfilled=function(e,t){return this._values[t]=e,++this._totalResolved>=this._length&&(this._resolve(this._values),!0)},a.prototype._promiseCancelled=function(){return this._cancel(),!0},a.prototype._promiseRejected=function(e){return this._totalResolved++,this._reject(e),!0},a.prototype._resultCancelled=function(){if(!this._isResolved()){var e=this._values;if(this._cancel(),e instanceof t)e.cancel();else for(var r=0;r<e.length;++r)e[r]instanceof t&&e[r].cancel()}},a.prototype.shouldCopyValues=function(){return!0},a.prototype.getActualLength=function(e){return e},a}},{"./util":36}],24:[function(e,t,r){t.exports=function(t,r){function n(e){return!_.test(e)}function i(e){try{return!0===e.__isPromisified__}catch(t){return!1}}function o(e,t,r){var n=c.getDataPropertyOrDefault(e,t+r,p);return!!n&&i(n)}function a(e,t,r,n){for(var a=c.inheritedDataKeys(e),s=[],u=0;u<a.length;++u){var l=a[u],d=e[l],f=n===m||m(l,d,e);"function"!=typeof d||i(d)||o(e,l,t)||!n(l,d,e,f)||s.push(l,d)}return function(e,t,r){for(var n=0;n<e.length;n+=2){var i=e[n];if(r.test(i))for(var o=i.replace(r,""),a=0;a<e.length;a+=2)if(e[a]===o)throw new g("Cannot promisify an API that has normal methods with '%s'-suffix\n\n    See http://goo.gl/MqrFmX\n".replace("%s",t))}}(s,t,r),s}function s(e,t,r,n,i){for(var o=new RegExp(v(t)+"$"),s=a(e,t,o,r),l=0,d=s.length;d>l;l+=2){var f=s[l],h=s[l+1],g=f+t;if(n===y)e[g]=y(f,u,f,h,t,i);else{var p=n(h,(function(){return y(f,u,f,h,t,i)}));c.notEnumerableProp(p,"__isPromisified__",!0),e[g]=p}}return c.toFastProperties(e),e}var u={},c=e("./util"),l=e("./nodeback"),d=c.withAppended,f=c.maybeWrapAsError,h=c.canEvaluate,g=e("./errors").TypeError,p={__isPromisified__:!0},_=new RegExp("^(?:"+["arity","length","name","arguments","caller","callee","prototype","__isPromisified__"].join("|")+")$"),m=function(e){return c.isIdentifier(e)&&"_"!==e.charAt(0)&&"constructor"!==e},v=function(e){return e.replace(/([$])/,"\\$")},y=h?undefined:function(e,n,i,o,a,s){function h(){var i=n;n===u&&(i=this);var o=new t(r);o._captureStackTrace();var a="string"==typeof p&&this!==g?this[p]:e,c=l(o,s);try{a.apply(i,d(arguments,c))}catch(h){o._rejectCallback(f(h),!0,!0)}return o._isFateSealed()||o._setAsyncGuaranteed(),o}var g=function(){return this}(),p=e;return"string"==typeof p&&(e=o),c.notEnumerableProp(h,"__isPromisified__",!0),h};t.promisify=function(e,t){if("function"!=typeof e)throw new g("expecting a function but got "+c.classString(e));if(i(e))return e;var r=function(e,t,r){return y(e,t,void 0,e,null,r)}(e,void 0===(t=Object(t)).context?u:t.context,!!t.multiArgs);return c.copyDescriptors(e,r,n),r},t.promisifyAll=function(e,t){if("function"!=typeof e&&"object"!=typeof e)throw new g("the target of promisifyAll must be an object or a function\n\n    See http://goo.gl/MqrFmX\n");var r=!!(t=Object(t)).multiArgs,n=t.suffix;"string"!=typeof n&&(n="Async");var i=t.filter;"function"!=typeof i&&(i=m);var o=t.promisifier;if("function"!=typeof o&&(o=y),!c.isIdentifier(n))throw new RangeError("suffix must be a valid identifier\n\n    See http://goo.gl/MqrFmX\n");for(var a=c.inheritedDataKeys(e),u=0;u<a.length;++u){var l=e[a[u]];"constructor"!==a[u]&&c.isClass(l)&&(s(l.prototype,n,i,o,r),s(l,n,i,o,r))}return s(e,n,i,o,r)}}},{"./errors":12,"./nodeback":20,"./util":36}],25:[function(e,t,r){t.exports=function(t,r,n,i){function o(e){var t,r=!1;if(void 0!==s&&e instanceof s)t=d(e),r=!0;else{var n=l.keys(e),i=n.length;t=new Array(2*i);for(var o=0;i>o;++o){var a=n[o];t[o]=e[a],t[o+i]=a}}this.constructor$(t),this._isMap=r,this._init$(void 0,r?-6:-3)}function a(e){var r,a=n(e);return c(a)?(r=a instanceof t?a._then(t.props,void 0,void 0,void 0,void 0):new o(a).promise(),a instanceof t&&r._propagateFrom(a,2),r):i("cannot await properties of a non-object\n\n    See http://goo.gl/MqrFmX\n")}var s,u=e("./util"),c=u.isObject,l=e("./es5");"function"==typeof Map&&(s=Map);var d=function(){function e(e,n){this[t]=e,this[t+r]=n,t++}var t=0,r=0;return function(n){r=n.size,t=0;var i=new Array(2*n.size);return n.forEach(e,i),i}}();u.inherits(o,r),o.prototype._init=function(){},o.prototype._promiseFulfilled=function(e,t){if(this._values[t]=e,++this._totalResolved>=this._length){var r;if(this._isMap)r=function(e){for(var t=new s,r=e.length/2|0,n=0;r>n;++n){var i=e[r+n],o=e[n];t.set(i,o)}return t}(this._values);else{r={};for(var n=this.length(),i=0,o=this.length();o>i;++i)r[this._values[i+n]]=this._values[i]}return this._resolve(r),!0}return!1},o.prototype.shouldCopyValues=function(){return!1},o.prototype.getActualLength=function(e){return e>>1},t.prototype.props=function(){return a(this)},t.props=function(e){return a(e)}}},{"./es5":13,"./util":36}],26:[function(e,t,r){function n(e){this._capacity=e,this._length=0,this._front=0}n.prototype._willBeOverCapacity=function(e){return this._capacity<e},n.prototype._pushOne=function(e){var t=this.length();this._checkCapacity(t+1),this[this._front+t&this._capacity-1]=e,this._length=t+1},n.prototype.push=function(e,t,r){var n=this.length()+3;if(this._willBeOverCapacity(n))return this._pushOne(e),this._pushOne(t),void this._pushOne(r);var i=this._front+n-3;this._checkCapacity(n);var o=this._capacity-1;this[i+0&o]=e,this[i+1&o]=t,this[i+2&o]=r,this._length=n},n.prototype.shift=function(){var e=this._front,t=this[e];return this[e]=void 0,this._front=e+1&this._capacity-1,this._length--,t},n.prototype.length=function(){return this._length},n.prototype._checkCapacity=function(e){this._capacity<e&&this._resizeTo(this._capacity<<1)},n.prototype._resizeTo=function(e){var t=this._capacity;this._capacity=e,function(e,t,r,n,i){for(var o=0;i>o;++o)r[o+n]=e[o+t],e[o+t]=void 0}(this,0,this,t,this._front+this._length&t-1)},t.exports=n},{}],27:[function(e,t,r){t.exports=function(t,r,n,i){function o(e,o){var u=n(e);if(u instanceof t)return s(u);if(null===(e=a.asArray(e)))return i("expecting an array or an iterable object but got "+a.classString(e));var c=new t(r);void 0!==o&&c._propagateFrom(o,3);for(var l=c._fulfill,d=c._reject,f=0,h=e.length;h>f;++f){var g=e[f];(void 0!==g||f in e)&&t.cast(g)._then(l,d,void 0,c,null)}return c}var a=e("./util"),s=function(e){return e.then((function(t){return o(t,e)}))};t.race=function(e){return o(e,void 0)},t.prototype.race=function(){return o(this,void 0)}}},{"./util":36}],28:[function(e,t,r){t.exports=function(t,r,n,i,o,a){function s(e,r,n,i){this.constructor$(e);var a=t._getContext();this._fn=f.contextBind(a,r),void 0!==n&&(n=t.resolve(n))._attachCancellationCallback(this),this._initialValue=n,this._currentCancellable=null,this._eachValues=i===o?Array(this._length):0===i?null:void 0,this._promise._captureStackTrace(),this._init$(void 0,-5)}function u(e,t){this.isFulfilled()?t._resolve(e):t._reject(e)}function c(e,t,r,i){return"function"!=typeof t?n("expecting a function but got "+f.classString(t)):new s(e,t,r,i).promise()}function l(e){this.accum=e,this.array._gotAccum(e);var r=i(this.value,this.array._promise);return r instanceof t?(this.array._currentCancellable=r,r._then(d,void 0,void 0,this,void 0)):d.call(this,r)}function d(e){var r,n=this.array,i=n._promise,o=h(n._fn);i._pushContext(),(r=void 0!==n._eachValues?o.call(i._boundValue(),e,this.index,this.length):o.call(i._boundValue(),this.accum,e,this.index,this.length))instanceof t&&(n._currentCancellable=r);var s=i._popContext();return a.checkForgottenReturns(r,s,void 0!==n._eachValues?"Promise.each":"Promise.reduce",i),r}var f=e("./util"),h=f.tryCatch;f.inherits(s,r),s.prototype._gotAccum=function(e){void 0!==this._eachValues&&null!==this._eachValues&&e!==o&&this._eachValues.push(e)},s.prototype._eachComplete=function(e){return null!==this._eachValues&&this._eachValues.push(e),this._eachValues},s.prototype._init=function(){},s.prototype._resolveEmptyArray=function(){this._resolve(void 0!==this._eachValues?this._eachValues:this._initialValue)},s.prototype.shouldCopyValues=function(){return!1},s.prototype._resolve=function(e){this._promise._resolveCallback(e),this._values=null},s.prototype._resultCancelled=function(e){return e===this._initialValue?this._cancel():void(this._isResolved()||(this._resultCancelled$(),this._currentCancellable instanceof t&&this._currentCancellable.cancel(),this._initialValue instanceof t&&this._initialValue.cancel()))},s.prototype._iterate=function(e){this._values=e;var r,n,i=e.length;void 0!==this._initialValue?(r=this._initialValue,n=0):(r=t.resolve(e[0]),n=1),this._currentCancellable=r;for(var o=n;i>o;++o){var a=e[o];a instanceof t&&a.suppressUnhandledRejections()}if(!r.isRejected())for(;i>n;++n){var s={accum:null,value:e[n],index:n,length:i,array:this};r=r._then(l,void 0,void 0,s,void 0),0===(127&n)&&r._setNoAsyncGuarantee()}void 0!==this._eachValues&&(r=r._then(this._eachComplete,void 0,void 0,this,void 0)),r._then(u,u,void 0,r,this)},t.prototype.reduce=function(e,t){return c(this,e,t,null)},t.reduce=function(e,t,r,n){return c(e,t,r,n)}}},{"./util":36}],29:[function(e,t,r){var n,o=e("./util"),a=o.getNativePromise();if(o.isNode&&"undefined"==typeof MutationObserver){var s=global.setImmediate,u=i.nextTick;n=o.isRecentNode?function(e){s.call(global,e)}:function(e){u.call(i,e)}}else if("function"==typeof a&&"function"==typeof a.resolve){var c=a.resolve();n=function(e){c.then(e)}}else n="undefined"==typeof MutationObserver||"undefined"!=typeof window&&window.navigator&&(window.navigator.standalone||window.cordova)||!("classList"in document.documentElement)?"undefined"!=typeof setImmediate?function(e){setImmediate(e)}:"undefined"!=typeof setTimeout?function(e){setTimeout(e,0)}:function(){throw new Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n")}:function(){var e=document.createElement("div"),t={attributes:!0},r=!1,n=document.createElement("div");new MutationObserver((function(){e.classList.toggle("foo"),r=!1})).observe(n,t);var i=function(){r||(r=!0,n.classList.toggle("foo"))};return function(r){var n=new MutationObserver((function(){n.disconnect(),r()}));n.observe(e,t),i()}}();t.exports=n},{"./util":36}],30:[function(e,t,r){t.exports=function(t,r,n){function i(e){this.constructor$(e)}var o=t.PromiseInspection;e("./util").inherits(i,r),i.prototype._promiseResolved=function(e,t){return this._values[e]=t,++this._totalResolved>=this._length&&(this._resolve(this._values),!0)},i.prototype._promiseFulfilled=function(e,t){var r=new o;return r._bitField=33554432,r._settledValueField=e,this._promiseResolved(t,r)},i.prototype._promiseRejected=function(e,t){var r=new o;return r._bitField=16777216,r._settledValueField=e,this._promiseResolved(t,r)},t.settle=function(e){return n.deprecated(".settle()",".reflect()"),new i(e).promise()},t.allSettled=function(e){return new i(e).promise()},t.prototype.settle=function(){return t.settle(this)}}},{"./util":36}],31:[function(e,t,r){t.exports=function(t,r,n){function i(e){this.constructor$(e),this._howMany=0,this._unwrap=!1,this._initialized=!1}function o(e,t){if((0|t)!==t||0>t)return n("expecting a positive integer\n\n    See http://goo.gl/MqrFmX\n");var r=new i(e),o=r.promise();return r.setHowMany(t),r.init(),o}var a=e("./util"),s=e("./errors").RangeError,u=e("./errors").AggregateError,c=a.isArray,l={};a.inherits(i,r),i.prototype._init=function(){if(this._initialized){if(0===this._howMany)return void this._resolve([]);this._init$(void 0,-5);var e=c(this._values);!this._isResolved()&&e&&this._howMany>this._canPossiblyFulfill()&&this._reject(this._getRangeError(this.length()))}},i.prototype.init=function(){this._initialized=!0,this._init()},i.prototype.setUnwrap=function(){this._unwrap=!0},i.prototype.howMany=function(){return this._howMany},i.prototype.setHowMany=function(e){this._howMany=e},i.prototype._promiseFulfilled=function(e){return this._addFulfilled(e),this._fulfilled()===this.howMany()&&(this._values.length=this.howMany(),1===this.howMany()&&this._unwrap?this._resolve(this._values[0]):this._resolve(this._values),!0)},i.prototype._promiseRejected=function(e){return this._addRejected(e),this._checkOutcome()},i.prototype._promiseCancelled=function(){return this._values instanceof t||null==this._values?this._cancel():(this._addRejected(l),this._checkOutcome())},i.prototype._checkOutcome=function(){if(this.howMany()>this._canPossiblyFulfill()){for(var e=new u,t=this.length();t<this._values.length;++t)this._values[t]!==l&&e.push(this._values[t]);return e.length>0?this._reject(e):this._cancel(),!0}return!1},i.prototype._fulfilled=function(){return this._totalResolved},i.prototype._rejected=function(){return this._values.length-this.length()},i.prototype._addRejected=function(e){this._values.push(e)},i.prototype._addFulfilled=function(e){this._values[this._totalResolved++]=e},i.prototype._canPossiblyFulfill=function(){return this.length()-this._rejected()},i.prototype._getRangeError=function(e){var t="Input array must contain at least "+this._howMany+" items but contains only "+e+" items";return new s(t)},i.prototype._resolveEmptyArray=function(){this._reject(this._getRangeError(0))},t.some=function(e,t){return o(e,t)},t.prototype.some=function(e){return o(this,e)},t._SomePromiseArray=i}},{"./errors":12,"./util":36}],32:[function(e,t,r){t.exports=function(e){function t(e){void 0!==e?(e=e._target(),this._bitField=e._bitField,this._settledValueField=e._isFateSealed()?e._settledValue():void 0):(this._bitField=0,this._settledValueField=void 0)}t.prototype._settledValue=function(){return this._settledValueField};var r=t.prototype.value=function(){if(!this.isFulfilled())throw new TypeError("cannot get fulfillment value of a non-fulfilled promise\n\n    See http://goo.gl/MqrFmX\n");return this._settledValue()},n=t.prototype.error=t.prototype.reason=function(){if(!this.isRejected())throw new TypeError("cannot get rejection reason of a non-rejected promise\n\n    See http://goo.gl/MqrFmX\n");return this._settledValue()},i=t.prototype.isFulfilled=function(){return 0!==(33554432&this._bitField)},o=t.prototype.isRejected=function(){return 0!==(16777216&this._bitField)},a=t.prototype.isPending=function(){return 0===(50397184&this._bitField)},s=t.prototype.isResolved=function(){return 0!==(50331648&this._bitField)};t.prototype.isCancelled=function(){return 0!==(8454144&this._bitField)},e.prototype.__isCancelled=function(){return 65536===(65536&this._bitField)},e.prototype._isCancelled=function(){return this._target().__isCancelled()},e.prototype.isCancelled=function(){return 0!==(8454144&this._target()._bitField)},e.prototype.isPending=function(){return a.call(this._target())},e.prototype.isRejected=function(){return o.call(this._target())},e.prototype.isFulfilled=function(){return i.call(this._target())},e.prototype.isResolved=function(){return s.call(this._target())},e.prototype.value=function(){return r.call(this._target())},e.prototype.reason=function(){var e=this._target();return e._unsetRejectionIsUnhandled(),n.call(e)},e.prototype._value=function(){return this._settledValue()},e.prototype._reason=function(){return this._unsetRejectionIsUnhandled(),this._settledValue()},e.PromiseInspection=t}},{}],33:[function(e,t,r){t.exports=function(t,r){function n(e){try{return function(e){return e.then}(e)}catch(t){return a.e=t,a}}function i(e,n,i){var s=new t(r),u=s;i&&i._pushContext(),s._captureStackTrace(),i&&i._popContext();var c=!0,l=o.tryCatch(n).call(e,(function(e){s&&(s._resolveCallback(e),s=null)}),(function(e){s&&(s._rejectCallback(e,c,!0),s=null)}));return c=!1,s&&l===a&&(s._rejectCallback(l.e,!0,!0),s=null),u}var o=e("./util"),a=o.errorObj,s=o.isObject,u={}.hasOwnProperty;return function(e,o){if(s(e)){if(e instanceof t)return e;var c=n(e);if(c===a){o&&o._pushContext();var l=t.reject(c.e);return o&&o._popContext(),l}if("function"==typeof c){if(function(e){try{return u.call(e,"_promise0")}catch(t){return!1}}(e)){l=new t(r);return e._then(l._fulfill,l._reject,void 0,l,null),l}return i(e,c,o)}}return e}}},{"./util":36}],34:[function(e,t,r){t.exports=function(t,r,n){function i(e){this.handle=e}function o(e){return clearTimeout(this.handle),e}function a(e){throw clearTimeout(this.handle),e}var s=e("./util"),u=t.TimeoutError;i.prototype._resultCancelled=function(){clearTimeout(this.handle)};var c=function(e){return l(+this).thenReturn(e)},l=t.delay=function(e,o){var a,s;return void 0!==o?(a=t.resolve(o)._then(c,null,null,e,void 0),n.cancellation()&&o instanceof t&&a._setOnCancel(o)):(a=new t(r),s=setTimeout((function(){a._fulfill()}),+e),n.cancellation()&&a._setOnCancel(new i(s)),a._captureStackTrace()),a._setAsyncGuaranteed(),a};t.prototype.delay=function(e){return l(e,this)};var d=function(e,t,r){var n;n="string"!=typeof t?t instanceof Error?t:new u("operation timed out"):new u(t),s.markAsOriginatingFromRejection(n),e._attachExtraTrace(n),e._reject(n),null!=r&&r.cancel()};t.prototype.timeout=function(e,t){e=+e;var r,s,u=new i(setTimeout((function(){r.isPending()&&d(r,t,s)}),e));return n.cancellation()?(s=this.then(),(r=s._then(o,a,void 0,u,void 0))._setOnCancel(u)):r=this._then(o,a,void 0,u,void 0),r}}},{"./util":36}],35:[function(e,t,r){t.exports=function(t,r,n,i,o,a){function s(e){setTimeout((function(){throw e}),0)}function u(e,r){var i=0,a=e.length,u=new t(o);return function o(){if(i>=a)return u._fulfill();var c=function(e){var t=n(e);return t!==e&&"function"==typeof e._isDisposable&&"function"==typeof e._getDisposer&&e._isDisposable()&&t._setDisposable(e._getDisposer()),t}(e[i++]);if(c instanceof t&&c._isDisposable()){try{c=n(c._getDisposer().tryDispose(r),e.promise)}catch(l){return s(l)}if(c instanceof t)return c._then(o,s,null,null,null)}o()}(),u}function c(e,t,r){this._data=e,this._promise=t,this._context=r}function l(e,t,r){this.constructor$(e,t,r)}function d(e){return c.isDisposer(e)?(this.resources[this.index]._setDisposable(e),e.promise()):e}function f(e){this.length=e,this.promise=null,this[e-1]=null}var h=e("./util"),g=e("./errors").TypeError,p=e("./util").inherits,_=h.errorObj,m=h.tryCatch,v={};c.prototype.data=function(){return this._data},c.prototype.promise=function(){return this._promise},c.prototype.resource=function(){return this.promise().isFulfilled()?this.promise().value():v},c.prototype.tryDispose=function(e){var t=this.resource(),r=this._context;void 0!==r&&r._pushContext();var n=t!==v?this.doDispose(t,e):null;return void 0!==r&&r._popContext(),this._promise._unsetDisposable(),this._data=null,n},c.isDisposer=function(e){return null!=e&&"function"==typeof e.resource&&"function"==typeof e.tryDispose},p(l,c),l.prototype.doDispose=function(e,t){return this.data().call(e,e,t)},f.prototype._resultCancelled=function(){for(var e=this.length,r=0;e>r;++r){var n=this[r];n instanceof t&&n.cancel()}},t.using=function(){var e=arguments.length;if(2>e)return r("you must pass at least 2 arguments to Promise.using");var i=arguments[e-1];if("function"!=typeof i)return r("expecting a function but got "+h.classString(i));var o,s=!0;2===e&&Array.isArray(arguments[0])?(e=(o=arguments[0]).length,s=!1):(o=arguments,e--);for(var l=new f(e),g=0;e>g;++g){var p=o[g];if(c.isDisposer(p)){var v=p;(p=p.promise())._setDisposable(v)}else{var y=n(p);y instanceof t&&(p=y._then(d,null,null,{resources:l,index:g},void 0))}l[g]=p}var S=new Array(l.length);for(g=0;g<S.length;++g)S[g]=t.resolve(l[g]).reflect();var T=t.all(S).then((function(e){for(var t=0;t<e.length;++t){var r=e[t];if(r.isRejected())return _.e=r.error(),_;if(!r.isFulfilled())return void T.cancel();e[t]=r.value()}I._pushContext(),i=m(i);var n=s?i.apply(void 0,e):i(e),o=I._popContext();return a.checkForgottenReturns(n,o,"Promise.using",I),n})),I=T.lastly((function(){var e=new t.PromiseInspection(T);return u(l,e)}));return l.promise=I,I._setOnCancel(l),I},t.prototype._setDisposable=function(e){this._bitField=131072|this._bitField,this._disposer=e},t.prototype._isDisposable=function(){return(131072&this._bitField)>0},t.prototype._getDisposer=function(){return this._disposer},t.prototype._unsetDisposable=function(){this._bitField=-131073&this._bitField,this._disposer=void 0},t.prototype.disposer=function(e){if("function"==typeof e)return new l(e,this,i());throw new g}}},{"./errors":12,"./util":36}],36:[function(e,t,r){function n(){try{var e=d;return d=null,e.apply(this,arguments)}catch(t){return g.e=t,g}}function o(e){return null==e||!0===e||!1===e||"string"==typeof e||"number"==typeof e}function a(e,t,r){if(o(e))return e;var n={value:r,configurable:!0,enumerable:!1,writable:!0};return f.defineProperty(e,t,n),e}function s(e){try{return e+""}catch(t){return"[no string representation]"}}function u(e){return e instanceof Error||null!==e&&"object"==typeof e&&"string"==typeof e.message&&"string"==typeof e.name}function c(e){return u(e)&&f.propertyIsWritable(e,"stack")}function l(e){return{}.toString.call(e)}var d,f=e("./es5"),h="undefined"==typeof navigator,g={e:{}},p="undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:void 0!==this?this:null,_=function(){var e=[Array.prototype,Object.prototype,Function.prototype],t=function(t){for(var r=0;r<e.length;++r)if(e[r]===t)return!0;return!1};if(f.isES5){var r=Object.getOwnPropertyNames;return function(e){for(var n=[],i=Object.create(null);null!=e&&!t(e);){var o;try{o=r(e)}catch(c){return n}for(var a=0;a<o.length;++a){var s=o[a];if(!i[s]){i[s]=!0;var u=Object.getOwnPropertyDescriptor(e,s);null!=u&&null==u.get&&null==u.set&&n.push(s)}}e=f.getPrototypeOf(e)}return n}}var n={}.hasOwnProperty;return function(r){if(t(r))return[];var i=[];e:for(var o in r)if(n.call(r,o))i.push(o);else{for(var a=0;a<e.length;++a)if(n.call(e[a],o))continue e;i.push(o)}return i}}(),m=/this\s*\.\s*\S+\s*=/,v=/^[a-z$_][a-z$_0-9]*$/i,y="stack"in new Error?function(e){return c(e)?e:new Error(s(e))}:function(e){if(c(e))return e;try{throw new Error(s(e))}catch(t){return t}},S=function(e){return f.isArray(e)?e:null};if("undefined"!=typeof Symbol&&Symbol.iterator){var T="function"==typeof Array.from?function(e){return Array.from(e)}:function(e){for(var t,r=[],n=e[Symbol.iterator]();!(t=n.next()).done;)r.push(t.value);return r};S=function(e){return f.isArray(e)?e:null!=e&&"function"==typeof e[Symbol.iterator]?T(e):null}}var I,b="undefined"!=typeof i&&"[object process]"===l(i).toLowerCase(),C="undefined"!=typeof i&&"undefined"!=typeof i.env,w={setReflectHandler:function(e){I=e},isClass:function(e){try{if("function"==typeof e){var t=f.names(e.prototype),r=f.isES5&&t.length>1,n=t.length>0&&!(1===t.length&&"constructor"===t[0]),i=m.test(e+"")&&f.names(e).length>0;if(r||n||i)return!0}return!1}catch(o){return!1}},isIdentifier:function(e){return v.test(e)},inheritedDataKeys:_,getDataPropertyOrDefault:function(e,t,r){if(!f.isES5)return{}.hasOwnProperty.call(e,t)?e[t]:void 0;var n=Object.getOwnPropertyDescriptor(e,t);return null!=n?null==n.get&&null==n.set?n.value:r:void 0},thrower:function(e){throw e},isArray:f.isArray,asArray:S,notEnumerableProp:a,isPrimitive:o,isObject:function(e){return"function"==typeof e||"object"==typeof e&&null!==e},isError:u,canEvaluate:h,errorObj:g,tryCatch:function(e){return d=e,n},inherits:function(e,t){function r(){for(var r in this.constructor=e,this.constructor$=t,t.prototype)n.call(t.prototype,r)&&"$"!==r.charAt(r.length-1)&&(this[r+"$"]=t.prototype[r])}var n={}.hasOwnProperty;return r.prototype=t.prototype,e.prototype=new r,e.prototype},withAppended:function(e,t){var r,n=e.length,i=new Array(n+1);for(r=0;n>r;++r)i[r]=e[r];return i[r]=t,i},maybeWrapAsError:function(e){return o(e)?new Error(s(e)):e},toFastProperties:function(e){function t(){}function r(){return typeof n.foo}t.prototype=e;var n=new t;return r(),r(),e},filledRange:function(e,t,r){for(var n=new Array(e),i=0;e>i;++i)n[i]=t+i+r;return n},toString:s,canAttachTrace:c,ensureErrorObject:y,originatesFromRejection:function(e){return null!=e&&(e instanceof Error.__BluebirdErrorTypes__.OperationalError||!0===e.isOperational)},markAsOriginatingFromRejection:function(e){try{a(e,"isOperational",!0)}catch(t){}},classString:l,copyDescriptors:function(e,t,r){for(var n=f.names(e),i=0;i<n.length;++i){var o=n[i];if(r(o))try{f.defineProperty(t,o,f.getDescriptor(e,o))}catch(a){}}},isNode:b,hasEnvVariables:C,env:function(e){return C?i.env[e]:void 0},global:p,getNativePromise:function(){if("function"==typeof Promise)try{if("[object Promise]"===l(new Promise((function(){}))))return Promise}catch(t){}},contextBind:function(e,t){if(null===e||"function"!=typeof t||t===I)return t;null!==e.domain&&(t=e.domain.bind(t));var r=e.async;if(null!==r){var n=t;t=function(){var e=new Array(2).concat([].slice.call(arguments));return e[0]=n,e[1]=this,r.runInAsyncScope.apply(r,e)}}return t}};w.isRecentNode=w.isNode&&function(){var e;return i.versions&&i.versions.node?e=i.versions.node.split(".").map(Number):i.version&&(e=i.version.split(".").map(Number)),0===e[0]&&e[1]>10||e[0]>0}(),w.nodeSupportsAsyncResource=w.isNode&&function(){var t=!1;try{t="function"==typeof e("async_hooks").AsyncResource.prototype.runInAsyncScope}catch(n){t=!1}return t}(),w.isNode&&w.toFastProperties(i);try{throw new Error}catch(E){w.lastLineError=E}t.exports=w},{"./es5":13,async_hooks:void 0}]},{},[4])(4)})),"undefined"!=typeof window&&null!==window?window.P=window.Promise:"undefined"!=typeof self&&null!==self&&(self.P=self.Promise))),a.DWT.bNpm=!0,a.DWT.dbrCanvasMaxWH=4096,a.aryAddonReadyFun=[],a.AddonReady=function(e){a.aryAddonReadyFun.push(e)},(a=self.Dynamsoft||{}).DWT=a.DWT||{},a.DBR=a.DBR||{},a.aryAddonReadyFun=a.aryAddonReadyFun||[],a.AddonReady=a.AddonReady||function(e){a.aryAddonReadyFun.push(e)},function(){a.BarcodeReaderAddon=a.BarcodeReaderAddon||{};var e=a.BarcodeReaderAddon;e.Version="9.6.1.0312",e._decoding=!1,e._decodeQueue=[],e._decodeNext=function(){var t,r;0==e._decodeQueue.length?e._decoding=!1:(t=(r=e._decodeQueue[0]).method,r=r.args,e._decodeQueue.splice(0,1),t.apply(null,r))},e._defaultRuntimeSettingsStr="",e._defaultTemplateStr="",e._activeXInstance=!1,e.BarcodeReaderException=function(){var e=arguments[0],t=a.DBR.EnumErrorCode.DBR_UNKNOWN;return(e="number"==typeof e?(t=e,new Error(arguments[1])):new Error(e)).code=t,e},e.RemoveNonPrintableChar=function(e){return a.Lib.isString(e)?e.replace(/[^\x20-\x7E]|(\\")/g,""):e},e.errors={webcamNotInstalled:"The Webcam add-on not installed.",nonServiceNotSupportWebcamDecode:"The BarcodeReader add-on does not support reading barcodes from video streams.",decodeResultEmpty:"decode result is empty.",ServiceEditionNotSupportDbr:"The BarcodeReader add-on does not support your Operating System.",ServiceEditionNotSupportWasmMode:"You cannot call this method on this WebTwain instance."},e._activeXMaxIEVersion=9,e.logLevel=3,a.DBR.EnumAccompanyingTextRecognitionMode={ATRM_GENERAL:1,ATRM_SKIP:0},a.DBR.EnumBarcodeColourMode={BICM_DARK_ON_LIGHT:1,BICM_LIGHT_ON_DARK:2,BICM_DARK_ON_DARK:4,BICM_LIGHT_ON_LIGHT:8,BICM_DARK_LIGHT_MIXED:16,BICM_DARK_ON_LIGHT_DARK_SURROUNDING:32,BICM_SKIP:0},a.DBR.EnumBarcodeComplementMode={BCM_AUTO:1,BCM_GENERAL:2,BCM_SKIP:0},a.DBR.EnumBarcodeFormat={BF_ALL:-32505857,BF_ONED:2047,BF_GS1_DATABAR:260096,BF_CODE_39:1,BF_CODE_128:2,BF_CODE_93:4,BF_CODABAR:8,BF_ITF:16,BF_EAN_13:32,BF_EAN_8:64,BF_UPC_A:128,BF_UPC_E:256,BF_INDUSTRIAL_25:512,BF_CODE_39_EXTENDED:1024,BF_GS1_DATABAR_OMNIDIRECTIONAL:2048,BF_GS1_DATABAR_TRUNCATED:4096,BF_GS1_DATABAR_STACKED:8192,BF_GS1_DATABAR_STACKED_OMNIDIRECTIONAL:16384,BF_GS1_DATABAR_EXPANDED:32768,BF_GS1_DATABAR_EXPANDED_STACKED:65536,BF_GS1_DATABAR_LIMITED:131072,BF_PATCHCODE:262144,BF_PDF417:33554432,BF_QR_CODE:67108864,BF_DATAMATRIX:134217728,BF_AZTEC:268435456,BF_MAXICODE:536870912,BF_MICRO_QR:1073741824,BF_MICRO_PDF417:524288,BF_GS1_COMPOSITE:-2147483648,BF_NULL:0},a.DBR.EnumBarcodeFormat_2={BF2_NULL:0,BF2_POSTALCODE:32505856,BF2_NONSTANDARD_BARCODE:1,BF2_USPSINTELLIGENTMAIL:1048576,BF2_POSTNET:2097152,BF2_PLANET:4194304,BF2_AUSTRALIANPOST:8388608,BF2_RM4SCC:16777216,BF2_DOTCODE:2},a.DBR.EnumBinarizationMode={BM_AUTO:1,BM_LOCAL_BLOCK:2,BM_SKIP:0},a.DBR.EnumClarityCalculationMethod={ECCM_CONTRAST:1},a.DBR.EnumClarityFilterMode={CFM_GENERAL:1},a.DBR.EnumColourClusteringMode={CCM_AUTO:1,CCM_GENERAL_HSV:2,CCM_SKIP:0},a.DBR.EnumColourConversionMode={CICM_GENERAL:1,CICM_SKIP:0},a.DBR.EnumConflictMode={CM_IGNORE:1,CM_OVERWRITE:2},a.DBR.EnumDeformationResistingMode={DRM_AUTO:1,DRM_GENERAL:2,DRM_SKIP:0},a.DBR.EnumDPMCodeReadingMode={DPMCRM_AUTO:1,DPMCRM_GENERAL:2,DPMCRM_SKIP:0},a.DBR.EnumErrorCode={DBR_SYSTEM_EXCEPTION:1,DBR_SUCCESS:0,DBR_UNKNOWN:-1e4,DBR_NO_MEMORY:-10001,DBR_NULL_REFERENCE:-10002,DBR_LICENSE_INVALID:-10003,DBR_LICENSE_EXPIRED:-10004,DBR_FILE_NOT_FOUND:-10005,DBR_FILETYPE_NOT_SUPPORTED:-10006,DBR_BPP_NOT_SUPPORTED:-10007,DBR_INDEX_INVALID:-10008,DBR_BARCODE_FORMAT_INVALID:-10009,DBR_CUSTOM_REGION_INVALID:-10010,DBR_MAX_BARCODE_NUMBER_INVALID:-10011,DBR_IMAGE_READ_FAILED:-10012,DBR_TIFF_READ_FAILED:-10013,DBR_QR_LICENSE_INVALID:-10016,DBR_1D_LICENSE_INVALID:-10017,DBR_DIB_BUFFER_INVALID:-10018,DBR_PDF417_LICENSE_INVALID:-10019,DBR_DATAMATRIX_LICENSE_INVALID:-10020,DBR_PDF_READ_FAILED:-10021,DBR_PDF_DLL_MISSING:-10022,DBR_PAGE_NUMBER_INVALID:-10023,DBR_CUSTOM_SIZE_INVALID:-10024,DBR_CUSTOM_MODULESIZE_INVALID:-10025,DBR_RECOGNITION_TIMEOUT:-10026,DBR_JSON_PARSE_FAILED:-10030,DBR_JSON_TYPE_INVALID:-10031,DBR_JSON_KEY_INVALID:-10032,DBR_JSON_VALUE_INVALID:-10033,DBR_JSON_NAME_KEY_MISSING:-10034,DBR_JSON_NAME_VALUE_DUPLICATED:-10035,DBR_TEMPLATE_NAME_INVALID:-10036,DBR_JSON_NAME_REFERENCE_INVALID:-10037,DBR_PARAMETER_VALUE_INVALID:-10038,DBR_DOMAIN_NOT_MATCHED:-10039,DBR_RESERVEDINFO_NOT_MATCHED:-10040,DBR_AZTEC_LICENSE_INVALID:-10041,DBR_LICENSE_DLL_MISSING:-10042,DBR_LICENSEKEY_NOT_MATCHED:-10043,DBR_REQUESTED_FAILED:-10044,DBR_LICENSE_INIT_FAILED:-10045,DBR_PATCHCODE_LICENSE_INVALID:-10046,DBR_POSTALCODE_LICENSE_INVALID:-10047,DBR_DPM_LICENSE_INVALID:-10048,DBR_FRAME_DECODING_THREAD_EXISTS:-10049,DBR_STOP_DECODING_THREAD_FAILED:-10050,DBR_SET_MODE_ARGUMENT_ERROR:-10051,DBR_LICENSE_CONTENT_INVALID:-10052,DBR_LICENSE_KEY_INVALID:-10053,DBR_LICENSE_DEVICE_RUNS_OUT:-10054,DBR_GET_MODE_ARGUMENT_ERROR:-10055,DBR_IRT_LICENSE_INVALID:-10056,DBR_MAXICODE_LICENSE_INVALID:-10057,DBR_GS1_DATABAR_LICENSE_INVALID:-10058,DBR_GS1_COMPOSITE_LICENSE_INVALID:-10059,DBR_DOTCODE_LICENSE_INVALID:-10061,DMERR_FAILED_TO_REACH_LTS:-20200},a.DBR.EnumGrayscaleTransformationMode={GTM_INVERTED:1,GTM_ORIGINAL:2,GTM_SKIP:0},a.DBR.EnumImagePixelFormat={IPF_Binary:0,IPF_BinaryInverted:1,IPF_GrayScaled:2,IPF_NV21:3,IPF_RGB_565:4,IPF_RGB_555:5,IPF_RGB_888:6,IPF_ARGB_8888:7,IPF_RGB_161616:8,IPF_ARGB_16161616:9,IPF_ABGR_8888:10,IPF_ABGR_16161616:11,IPF_BGR_888:12},a.DBR.EnumImagePreprocessingMode={IPM_AUTO:1,IPM_GENERAL:2,IPM_GRAY_EQUALIZE:4,IPM_GRAY_SMOOTH:8,IPM_SHARPEN_SMOOTH:16,IPM_MORPHOLOGY:32,IPM_SKIP:0},a.DBR.EnumIMResultDataType={IMRDT_IMAGE:1,IMRDT_CONTOUR:2,IMRDT_LINESEGMENT:4,IMRDT_LOCALIZATIONRESULT:8,IMRDT_REGIONOFINTEREST:16,IMRDT_QUADRILATERAL:32},a.DBR.EnumIntermediateResultSavingMode={IRSM_MEMORY:1,IRSM_FILESYSTEM:2,IRSM_BOTH:4},a.DBR.EnumIntermediateResultType={IRT_NO_RESULT:0,IRT_ORIGINAL_IMAGE:1,IRT_COLOUR_CLUSTERED_IMAGE:2,IRT_COLOUR_CONVERTED_GRAYSCALE_IMAGE:4,IRT_TRANSFORMED_GRAYSCALE_IMAGE:8,IRT_PREDETECTED_REGION:16,IRT_PREPROCESSED_IMAGE:32,IRT_BINARIZED_IMAGE:64,IRT_TEXT_ZONE:128,IRT_CONTOUR:256,IRT_LINE_SEGMENT:512,IRT_FORM:1024,IRT_SEGMENTATION_BLOCK:2048,IRT_TYPED_BARCODE_ZONE:4096,IRT_PREDETECTED_QUADRILATERAL:8192},a.DBR.EnumLocalizationMode={LM_SKIP:0,LM_AUTO:1,LM_CONNECTED_BLOCKS:2,LM_LINES:8,LM_STATISTICS:4,LM_SCAN_DIRECTLY:16,LM_STATISTICS_MARKS:32,LM_STATISTICS_POSTAL_CODE:64},a.DBR.EnumPDFReadingMode={PDFRM_RASTER:1,PDFRM_AUTO:2,PDFRM_VECTOR:4},a.DBR.EnumQRCodeErrorCorrectionLevel={QRECL_ERROR_CORRECTION_H:0,QRECL_ERROR_CORRECTION_L:1,QRECL_ERROR_CORRECTION_M:2,QRECL_ERROR_CORRECTION_Q:3},a.DBR.EnumRegionPredetectionMode={RPM_AUTO:1,RPM_GENERAL:2,RPM_GENERAL_RGB_CONTRAST:4,RPM_GENERAL_GRAY_CONTRAST:8,RPM_GENERAL_HSV_CONTRAST:16,RPM_SKIP:0},a.DBR.EnumResultCoordinateType={RCT_PIXEL:1,RCT_PERCENTAGE:2},a.DBR.EnumResultType={RT_STANDARD_TEXT:0,RT_RAW_TEXT:1,RT_CANDIDATE_TEXT:2,RT_PARTIAL_TEXT:3},a.DBR.EnumScaleUpMode={SUM_AUTO:1,SUM_LINEAR_INTERPOLATION:2,SUM_NEAREST_NEIGHBOUR_INTERPOLATION:4,SUM_SKIP:0},a.DBR.EnumTerminatePhase={TP_REGION_PREDETECTED:1,TP_IMAGE_PREPROCESSED:2,TP_IMAGE_BINARIZED:4,TP_BARCODE_LOCALIZED:8,TP_BARCODE_TYPE_DETERMINED:16,TP_BARCODE_RECOGNIZED:32},a.DBR.EnumTextAssistedCorrectionMode={TACM_AUTO:1,TACM_VERIFYING:2,TACM_VERIFYING_PATCHING:4,TACM_SKIP:0},a.DBR.EnumTextFilterMode={TFM_AUTO:1,TFM_GENERAL_CONTOUR:2,TFM_SKIP:0},a.DBR.EnumTextResultOrderMode={TROM_CONFIDENCE:1,TROM_POSITION:2,TROM_FORMAT:4,TROM_SKIP:0},a.DBR.EnumTextureDetectionMode={TDM_AUTO:1,TDM_GENERAL_WIDTH_CONCENTRATION:2,TDM_SKIP:0}}(),a.AddonReady((function(e,t){var r,n=a.BarcodeReaderAddon;function i(e){return e&&e instanceof ArrayBuffer}n.Class=function(){function t(e){this._runtimeSettings=null,this._initSettingsContent=null,this._tplContentArr=[],this._stwain=e}var r;return t.prototype._decodeBlob=function(t,r){var n=this;return new e.Promise((function(e){if(!(t instanceof Blob))throw TypeError("'_decodeBlob(blob, templateName)': Type of 'blob' should be 'Blob'.");e()})).then((function(){return n._innerDecode(0,t,r)}))},t.prototype._decodeArrayBuffer=function(t,r){var n=this;return new e.Promise((function(e){if(!(t instanceof ArrayBuffer))throw TypeError("'_decodeBlob(arrayBuffer, templateName)': Type of 'arrayBuffer' should be 'ArrayBuffer'.");e()})).then((function(){return n._innerDecode(0,t,r)}))},t.prototype._decodeUint8Array=function(t,r){var n=this;return new e.Promise((function(e){if(!(t instanceof Uint8Array||self.Uint8ClampedArray&&t instanceof Uint8ClampedArray))throw TypeError("'_decodeBlob(uint8Array, templateName)': Type of 'uint8Array' should be 'Uint8Array'.");e()})).then((function(){return n._innerDecode(0,t,r)}))},t.prototype._decodeImage=function(t,r){var i=this;return new e.Promise((function(e){if(!(t instanceof HTMLImageElement))throw TypeError("'_decodeImage(image, templateName)': Type of 'image' should be 'HTMLImageElement'.");if(t.crossOrigin&&"anonymous"!=t.crossOrigin)throw"cors";r=r||"",e()})).then((function(){return"data:image/"==t.src.substring(0,11)?i._decodeBase64(t.src,r):i._decodeUrl(t.src,r).catch((function(o){return 3<=n.logLevel&&console&&console.warn&&(console.warn("'_decodeImage(image, templateName)': Image src not available. Use '_decodeCanvas' instead."),console.warn(o)),self.HTMLCanvasElement?((o=document.createElement("canvas")).width=t.naturalWidth,o.height=t.naturalHeight,o.getContext("2d").drawImage(t,0,0),i._decodeCanvas(o,r)):e.Promise.reject(Error("'_decodeImage(image, templateName)': Browser not support HTMLCanvasElement."))}))}))},t.prototype._decodeCanvas=function(t,r){var n=this;return new e.Promise((function(e){if(!(t instanceof HTMLCanvasElement))throw TypeError("'_decodeCanvas(canvas, templateName)': Type of 'canvas' should be 'HTMLCanvasElement'.");if(t.crossOrigin&&"anonymous"!=t.crossOrigin)throw"cors";r=r||"",t.toBlob?t.toBlob((function(t){e(t)})):t.msToBlob?t.msToBlob((function(t){e(t)})):e(t.toDataURL())})).then((function(e){return t.toBlob||t.msToBlob?n._decodeBlob(e,r):n._decodeBase64(e,r)}))},t.prototype._decodeVideo=function(t){var r,n=this,i=arguments;return new e.Promise((function(e){if(!(t instanceof HTMLVideoElement))throw TypeError("'_decodeVideo(video [ [, sx, sy, sWidth, sHeight], dWidth, dHeight] [, templateName] )': Type of 'video' should be 'HTMLVideoElement'.");if(t.crossOrigin&&"anonymous"!=t.crossOrigin)throw"cors";i.length<=2?(n=o=0,a=u=t.videoWidth,s=c=t.videoHeight):c=i.length<=4?(n=o=0,a=t.videoWidth,s=t.videoHeight,u=i[1],i[2]):(n=i[1],o=i[2],a=i[3],s=i[4],u=i[5],i[6]),r="string"==typeof i[i.length-1]?i[i.length-1]:"";var n,o,a,s,u,c,l=document.createElement("canvas");l.width=u,l.height=c,l.getContext("2d").drawImage(t,n,o,a,s,0,0,u,c),e(l)})).then((function(e){return n._decodeCanvas(e,r)}))},t.prototype._decodeBase64=t.prototype.decodeBase64String=function(t,r){var n=this;return new e.Promise((function(e){if(!("string"==typeof t||"object"==typeof t&&t instanceof String))throw TypeError("'decodeBase64(base64Str, templateName)': Type of 'base64Str' should be 'String'.");"data:image/"==t.substring(0,11)&&(t=t.substring(t.indexOf(",")+1)),e()})).then((function(){return n._innerDecode(1,t,r)}))},t.prototype._decodeUrl=function(t,r){var i=this;return t&&t.indexOf&&(0==t.indexOf("dwt://")||0==t.indexOf("dcs://"))?i._decodeDynamsoftServiceInnerUrl(t,r):new e.Promise((function(e,i){var o;if(!("string"==typeof t||"object"==typeof t&&t instanceof String))throw TypeError("'_decodeUrl(url, templateName)': Type of 'url' should be 'String'.");r=r||"",n._activeXInstance?((o=new ActiveXObject("MSXML2.XMLHTTP")).open("GET",t,!0),o.overrideMimeType?o.overrideMimeType("text/plain; charset=x-user-defined"):o.setRequestHeader("Accept-Charset","x-user-defined"),o.onreadystatechange=function(){4==o.readyState&&e(new VBArray(o.responseBody).toArray())},o.send("")):((o=new XMLHttpRequest).open("GET",t,!0),o.responseType="arraybuffer",o.send(),o.onloadend=function(){e(this.response)},o.onerror=function(){i(Error(o.error))})})).then((function(e){return n._activeXInstance?i._activeXDecodeArray(e,r):i._decodeArrayBuffer(e,r)}))},t.prototype._decodeDynamsoftServiceInnerUrl=function(t,r){var n=this;return new e.Promise((function(e){if(!("string"==typeof t||"object"==typeof t&&t instanceof String))throw TypeError("'_decodeUrl(url, templateName)': Type of 'innerUrl' should be 'String'.");if(0!=t.indexOf("dwt://")&&0!=t.indexOf("dcs://"))throw TypeError("'_decodeDynamsoftServiceInnerUrl(innerUrl, templateName)': 'innerUrl' should start with 'dwt://' or 'dcs://'.");e()})).then((function(){return n._innerDecode(4e3,t,r)}))},t.prototype._activeXDecodeArray=function(t,r){var n=this;return new e.Promise((function(e,n){if(!(t instanceof Array))throw TypeError("'_activeXDecodeArray(array, templateName)': Type of 'array' should be 'Array'.");r=r||"";try{e(a.Lib.btoa(String.fromCharCode.apply(String,t)))}catch(e){n(e)}})).then((function(e){return n._decodeBase64(e,r)}))},t.prototype._activeXDecodeHandle=function(t,r){var n=this;return new e.Promise((function(e){r=r||"",e()})).then((function(){return n._innerDecode(4001,t,r)}))},t.prototype._decode=t.prototype.decode=function(t,r){return n._activeXInstance?"string"==typeof t||t instanceof String?this._activeXDecodeHandle(t,r):e.Promise.reject(TypeError("'_decode(source, templateName)' in activeX: Type of 'source' should be 'String(partUrl)'.")):self.Blob&&t instanceof Blob?this._decodeBlob(t,r):self.ArrayBuffer&&t instanceof ArrayBuffer?this._decodeArrayBuffer(t,r):self.Uint8Array&&t instanceof Uint8Array||self.Uint8ClampedArray&&t instanceof Uint8ClampedArray?this._decodeUint8Array(t,r):t instanceof Array?this._activeXDecodeArray(t,r):self.HTMLImageElement&&t instanceof HTMLImageElement?this._decodeImage(t,r):self.HTMLCanvasElement&&t instanceof HTMLCanvasElement?this._decodeCanvas(t,r):self.HTMLVideoElement&&t instanceof HTMLVideoElement?this._decodeVideo(t,r):isNaN(t)?"string"==typeof t||t instanceof String?"data:image/"==t.substring(0,11)?this._decodeBase64(t,r):this._decodeUrl(t,r):e.Promise.reject(TypeError("'_decode(source, templateName)' in H5: Type of 'source' should be 'Blob', 'ArrayBuffer', 'Uint8Array', 'HTMLImageElement', 'HTMLCanvasElement', 'HTMLVideoElement', 'String(base64 with image mime)' or 'String(url)'.")):this._activeXDecodeHandle(t,r)},t.prototype._innerServiceCmd=function(t,r){var o=this._stwain;return new e.Promise((function(s,u){var c,l={method:"ReadBarcode",parameter:[a.Lib.product.refProductKey,4002,"",""],updateSettings:t,initSettingsContent:r};n._activeXInstance?s(n._activeXInstance.Process(e.stringify(l),location.protocol+"//"+location.host)):(o._blts?(c="",o&&o._bRemoteMode&&o._dmService&&o._dmService.attrs&&o._dmService.attrs.UUID&&(c=o._dmService.attrs.UUID),a.DWT.lglic(a.DWT.EnumInstance.dwt_desktop,c).then((function(t){return l.parameter.push(t.ar),l.parameter.push(t.cu),l.parameter.push(0),l.parameter.push(""),e.stringify(l)}))):e.Promise.resolve(e.stringify(l))).then((function(t){return e.fetch(o._dbrUrlRoot+"ReadBarcode",{mode:"cors",method:"post",body:t,dataType:"arrayBuffer"})})).then((function(e){i(e)?s(String.fromCharCode.apply(null,new Uint8Array(e))):s(e)}),(function(e){var t="Init template & runtimeSettings failed.";e&&(t=[t," Http info: ",e.errorString," (",e.httpCode,")"].join("")),u(t)}))}))},t.prototype._innerDecode=function(t,o,s,u){var c=this;return c._runtimeSettings&&0==c._runtimeSettings.expectedBarcodesCount&&(c._runtimeSettings.expectedBarcodesCount=512),new e.Promise((function(l,d){function f(t,i,o){try{var s,u,c,f,h=r&&r(t);for(h&&h.textResults||d(new n.BarcodeReaderException(h.exception,h.description)),e.product.bHTML5Edition&&o&&o.config.data&&(s=e.parse(o.config.data),e.isArray(s.parameter))&&2<s.parameter.length&&4e3==s.parameter[1]&&(4<s.parameter.length&&s.parameter[4]?h.textResults.imageid=s.parameter[4]:0<=(f=(c=s.parameter[2]).indexOf("&index="))&&(h.textResults.imageid=c.substring(f+7,c.indexOf("&t=")))),u=0;u<h.textResults.length;u++){var g=h.textResults[u];g.BarcodeText=g.barcodeText,h.exception!=a.DBR.EnumErrorCode.DBR_SUCCESS&&(g.exception=h.exception)}h.exception!=a.DBR.EnumErrorCode.DBR_SUCCESS&&(h.textResults.exception=h.exception,h.textResults.description=h.description),n._activeXInstance&&h.records&&(a.Lib.each(h.records,(function(e,t){a.DWT.lavrf(t,e,a.DWT.EnumInstance.dwt_desktop)})),a.DWT.lavrf_(1,a.DWT.EnumInstance.dwt_desktop)),l(h.textResults)}catch(t){d(t)}}var h,g,p={method:"ReadBarcode",parameter:[a.Lib.product.refProductKey,t,0!=t?o:null,s||""],updateSettings:c._runtimeSettings,conflictMode:1==c.conflictMode?"ignore":"overwrite",initSettingsContent:c._initSettingsContent,tplContent:function(){if(s)for(var t=0;t<c._tplContentArr.length;++t)if(s==c._tplContentArr[t].ImageParameter.Name)return e.stringify(c._tplContentArr[t]);return null}()},_=c._stwain;n._activeXInstance?_._blts?a.DWT.lglic(a.DWT.EnumInstance.dwt_desktop,"").then((function(t){p.parameter.push(t.ar),p.parameter.push(t.cu),p.parameter.push(0),p.parameter.push(""),f(n._activeXInstance.Process(e.stringify(p),location.protocol+"//"+location.host))})):f(n._activeXInstance.Process(e.stringify(p),location.protocol+"//"+location.host)):(h=_._dbrUrlRoot+"ReadBarcode",0==t&&(h+="/LoadZipFromBytes?cmd="+encodeURIComponent(e.stringify(p))),(0==t?e.Promise.resolve(o):_._blts?(g="",_&&_._bRemoteMode&&_._dmService&&_._dmService.attrs&&_._dmService.attrs.UUID&&(g=_._dmService.attrs.UUID),a.DWT.lglic(a.DWT.EnumInstance.dwt_desktop,g).then((function(t){return p.parameter.push(t.ar),p.parameter.push(t.cu),p.parameter.push(0),p.parameter.push([e.product.getDWTPrefix(),e.product.getServerVersionInfo(),"/verify?id=",u,"&t=",e.getRandom()].join("")),e.stringify(p)}))):e.Promise.resolve(e.stringify(p))).then((function(t){return e.fetch(h,{mode:"cors",method:"post",body:t,dataType:"arrayBuffer"})})).then((function(e,t,r){i(e)?f(String.fromCharCode.apply(null,new Uint8Array(e)),0,r):f(e,0,r)}),(function(e){var t="ReadBarcode request fail.";e&&(t=[t," Http info: ",e.errorString," (",e.httpCode,")"].join("")),d(Error(t))})))}))},r=n._handleRetJsonString=function(r){var i;if("string"==typeof r||"object"==typeof r&&r instanceof String)try{i=e.parse(r)}catch(t){i=e.parse(n.RemoveNonPrintableChar(r))}else i=r;if(!i)throw n.BarcodeReaderException(a.DBR.EnumErrorCode.DBR_UNKNOWN,n.errors.decodeResultEmpty);if("textResults"in i&&e.isArray(i.textResults)||i.exception==a.DBR.EnumErrorCode.DBR_SUCCESS)return i;throw n.BarcodeReaderException(i.exception,i.description)},t.prototype.getAllParameterTemplateNames=function(){for(var e=[],t=0;t<this._tplContentArr.length;++t)e.push(this._tplContentArr[t].ImageParameter.Name);return e},t.prototype.getRuntimeSettings=function(){return this._runtimeSettings||(this._runtimeSettings=e.parse(n._defaultRuntimeSettingsStr)),e.Promise.resolve(this._runtimeSettings)},t.prototype.updateRuntimeSettings=function(t){var r,i=this;if("string"==typeof t||"object"==typeof t&&t instanceof String){if("speed"==t||"balance"==t||"coverage"==t||"default"==t)return i.initRuntimeSettingsWithString("speed"==t?'{"ImageParameter":{"AccompanyingTextRecognitionModes":[{"Mode":"ATRM_SKIP"}],"BarcodeColourModes":[{"LightReflection":1,"Mode":"BICM_DARK_ON_LIGHT"}],"BarcodeComplementModes":[{"Mode":"BCM_SKIP"}],"BarcodeFormatIds":["BF_ALL"],"BarcodeFormatIds_2":["BF2_POSTALCODE","BF2_DOTCODE"],"BinarizationModes":[{"BlockSizeX":0,"BlockSizeY":0,"EnableFillBinaryVacancy":1,"ImagePreprocessingModesIndex":-1,"Mode":"BM_LOCAL_BLOCK","ThreshValueCoefficient":10}],"ColourClusteringModes":[{"Mode":"CCM_SKIP"}],"ColourConversionModes":[{"BlueChannelWeight":-1,"GreenChannelWeight":-1,"Mode":"CICM_GENERAL","RedChannelWeight":-1}],"DPMCodeReadingModes":[{"Mode":"DPMCRM_SKIP"}],"DeblurLevel":3,"DeformationResistingModes":[{"Mode":"DRM_SKIP"}],"Description":"","ExpectedBarcodesCount":512,"FormatSpecificationNameArray":null,"GrayscaleTransformationModes":[{"Mode":"GTM_ORIGINAL"}],"ImagePreprocessingModes":[{"Mode":"IPM_GENERAL"}],"IntermediateResultSavingMode":{"Mode":"IRSM_MEMORY"},"IntermediateResultTypes":["IRT_NO_RESULT"],"LocalizationModes":[{"Mode":"LM_CONNECTED_BLOCKS"},{"Mode":"LM_STATISTICS_MARKS"},{"Mode":"LM_STATISTICS_POSTAL_CODE"}],"MaxAlgorithmThreadCount":4,"Name":"bestSpeed","PDFRasterDPI":300,"PDFReadingMode":{"Mode":"PDFRM_AUTO"},"Pages":"","RegionDefinitionNameArray":null,"RegionPredetectionModes":[{"Mode":"RPM_GENERAL"}],"ResultCoordinateType":"RCT_PIXEL","ReturnBarcodeZoneClarity":0,"ScaleDownThreshold":2300,"ScaleUpModes":[{"Mode":"SUM_AUTO"}],"TerminatePhase":"TP_BARCODE_RECOGNIZED","TextAssistedCorrectionMode":{"BottomTextPercentageSize":0,"LeftTextPercentageSize":0,"Mode":"TACM_VERIFYING","RightTextPercentageSize":0,"TopTextPercentageSize":0},"TextFilterModes":[{"Mode":"TFM_SKIP"}],"TextResultOrderModes":[{"Mode":"TROM_CONFIDENCE"},{"Mode":"TROM_POSITION"},{"Mode":"TROM_FORMAT"}],"TextureDetectionModes":[{"Mode":"TDM_GENERAL_WIDTH_CONCENTRATION","Sensitivity":5}],"Timeout":10000},"Version":"3.0"}':"balance"==t?'{"ImageParameter":{"AccompanyingTextRecognitionModes":[{"Mode":"ATRM_SKIP"}],"BarcodeColourModes":[{"LightReflection":1,"Mode":"BICM_DARK_ON_LIGHT"}],"BarcodeComplementModes":[{"Mode":"BCM_SKIP"}],"BarcodeFormatIds":["BF_ALL"],"BarcodeFormatIds_2":["BF2_POSTALCODE","BF2_DOTCODE"],"BinarizationModes":[{"BlockSizeX":0,"BlockSizeY":0,"EnableFillBinaryVacancy":1,"ImagePreprocessingModesIndex":-1,"Mode":"BM_LOCAL_BLOCK","ThreshValueCoefficient":10}],"ColourClusteringModes":[{"Mode":"CCM_SKIP"}],"ColourConversionModes":[{"BlueChannelWeight":-1,"GreenChannelWeight":-1,"Mode":"CICM_GENERAL","RedChannelWeight":-1}],"DPMCodeReadingModes":[{"Mode":"DPMCRM_SKIP"}],"DeblurLevel":5,"DeformationResistingModes":[{"Mode":"DRM_SKIP"}],"Description":"","ExpectedBarcodesCount":512,"FormatSpecificationNameArray":null,"GrayscaleTransformationModes":[{"Mode":"GTM_ORIGINAL"}],"ImagePreprocessingModes":[{"Mode":"IPM_GENERAL"}],"IntermediateResultSavingMode":{"Mode":"IRSM_MEMORY"},"IntermediateResultTypes":["IRT_NO_RESULT"],"LocalizationModes":[{"Mode":"LM_CONNECTED_BLOCKS"},{"Mode":"LM_STATISTICS"},{"Mode":"LM_STATISTICS_MARKS"},{"Mode":"LM_STATISTICS_POSTAL_CODE"}],"MaxAlgorithmThreadCount":4,"Name":"balance","PDFRasterDPI":300,"PDFReadingMode":{"Mode":"PDFRM_AUTO"},"Pages":"","RegionDefinitionNameArray":null,"RegionPredetectionModes":[{"Mode":"RPM_GENERAL"}],"ResultCoordinateType":"RCT_PIXEL","ReturnBarcodeZoneClarity":0,"ScaleDownThreshold":2300,"ScaleUpModes":[{"Mode":"SUM_AUTO"}],"TerminatePhase":"TP_BARCODE_RECOGNIZED","TextAssistedCorrectionMode":{"BottomTextPercentageSize":0,"LeftTextPercentageSize":0,"Mode":"TACM_VERIFYING","RightTextPercentageSize":0,"TopTextPercentageSize":0},"TextFilterModes":[{"MinImageDimension":65536,"Mode":"TFM_GENERAL_CONTOUR","Sensitivity":0}],"TextResultOrderModes":[{"Mode":"TROM_CONFIDENCE"},{"Mode":"TROM_POSITION"},{"Mode":"TROM_FORMAT"}],"TextureDetectionModes":[{"Mode":"TDM_GENERAL_WIDTH_CONCENTRATION","Sensitivity":5}],"Timeout":10000},"Version":"3.0"}':"coverage"==t?'{"ImageParameter":{"AccompanyingTextRecognitionModes":[{"Mode":"ATRM_SKIP"}],"BarcodeColourModes":[{"LightReflection":1,"Mode":"BICM_DARK_ON_LIGHT"}],"BarcodeComplementModes":[{"Mode":"BCM_SKIP"}],"BarcodeFormatIds":["BF_ALL"],"BarcodeFormatIds_2":["BF2_POSTALCODE","BF2_DOTCODE"],"BinarizationModes":[{"BlockSizeX":0,"BlockSizeY":0,"EnableFillBinaryVacancy":1,"ImagePreprocessingModesIndex":-1,"Mode":"BM_LOCAL_BLOCK","ThreshValueCoefficient":10}],"ColourClusteringModes":[{"Mode":"CCM_SKIP"}],"ColourConversionModes":[{"BlueChannelWeight":-1,"GreenChannelWeight":-1,"Mode":"CICM_GENERAL","RedChannelWeight":-1}],"DPMCodeReadingModes":[{"Mode":"DPMCRM_SKIP"}],"DeblurLevel":9,"DeformationResistingModes":[{"Mode":"DRM_SKIP"}],"Description":"","ExpectedBarcodesCount":512,"FormatSpecificationNameArray":null,"GrayscaleTransformationModes":[{"Mode":"GTM_ORIGINAL"},{"Mode":"GTM_INVERTED"}],"ImagePreprocessingModes":[{"Mode":"IPM_GENERAL"}],"IntermediateResultSavingMode":{"Mode":"IRSM_MEMORY"},"IntermediateResultTypes":["IRT_NO_RESULT"],"LocalizationModes":[{"Mode":"LM_CONNECTED_BLOCKS"},{"Mode":"LM_SCAN_DIRECTLY","ScanDirection":0,"ScanStride":0},{"Mode":"LM_STATISTICS"},{"Mode":"LM_LINES"},{"Mode":"LM_STATISTICS_MARKS"},{"Mode":"LM_STATISTICS_POSTAL_CODE"}],"MaxAlgorithmThreadCount":4,"Name":"coverage","PDFRasterDPI":300,"PDFReadingMode":{"Mode":"PDFRM_AUTO"},"Pages":"","RegionDefinitionNameArray":null,"RegionPredetectionModes":[{"Mode":"RPM_GENERAL"}],"ResultCoordinateType":"RCT_PIXEL","ReturnBarcodeZoneClarity":0,"ScaleDownThreshold":214748347,"ScaleUpModes":[{"Mode":"SUM_AUTO"}],"TerminatePhase":"TP_BARCODE_RECOGNIZED","TextAssistedCorrectionMode":{"BottomTextPercentageSize":0,"LeftTextPercentageSize":0,"Mode":"TACM_VERIFYING","RightTextPercentageSize":0,"TopTextPercentageSize":0},"TextFilterModes":[{"MinImageDimension":65536,"Mode":"TFM_GENERAL_CONTOUR","Sensitivity":0}],"TextResultOrderModes":[{"Mode":"TROM_CONFIDENCE"},{"Mode":"TROM_POSITION"},{"Mode":"TROM_FORMAT"}],"TextureDetectionModes":[{"Mode":"TDM_GENERAL_WIDTH_CONCENTRATION","Sensitivity":5}],"Timeout":10000},"Version":"3.0"}':'{"ImageParameter":{"AccompanyingTextRecognitionModes":[{"Mode":"ATRM_SKIP"}],"BarcodeColourModes":[{"LightReflection":1,"Mode":"BICM_DARK_ON_LIGHT"}],"BarcodeComplementModes":[{"Mode":"BCM_SKIP"}],"BarcodeFormatIds":["BF_ALL"],"BarcodeFormatIds_2":null,"BinarizationModes":[{"BlockSizeX":0,"BlockSizeY":0,"EnableFillBinaryVacancy":1,"ImagePreprocessingModesIndex":-1,"Mode":"BM_LOCAL_BLOCK","ThreshValueCoefficient":10}],"ColourClusteringModes":[{"Mode":"CCM_SKIP"}],"ColourConversionModes":[{"BlueChannelWeight":-1,"GreenChannelWeight":-1,"Mode":"CICM_GENERAL","RedChannelWeight":-1}],"DPMCodeReadingModes":[{"Mode":"DPMCRM_SKIP"}],"DeblurLevel":9,"DeformationResistingModes":[{"Mode":"DRM_SKIP"}],"Description":"","ExpectedBarcodesCount":512,"FormatSpecificationNameArray":null,"GrayscaleTransformationModes":[{"Mode":"GTM_ORIGINAL"}],"ImagePreprocessingModes":[{"Mode":"IPM_GENERAL"}],"IntermediateResultSavingMode":{"Mode":"IRSM_MEMORY"},"IntermediateResultTypes":["IRT_NO_RESULT"],"LocalizationModes":[{"Mode":"LM_CONNECTED_BLOCKS"},{"Mode":"LM_SCAN_DIRECTLY","ScanDirection":0,"ScanStride":0},{"Mode":"LM_STATISTICS"},{"Mode":"LM_LINES"}],"MaxAlgorithmThreadCount":4,"Name":"default","PDFRasterDPI":300,"PDFReadingMode":{"Mode":"PDFRM_AUTO"},"Pages":"","RegionDefinitionNameArray":null,"RegionPredetectionModes":[{"Mode":"RPM_GENERAL"}],"ResultCoordinateType":"RCT_PIXEL","ReturnBarcodeZoneClarity":0,"ScaleDownThreshold":2300,"ScaleUpModes":[{"Mode":"SUM_AUTO"}],"TerminatePhase":"TP_BARCODE_RECOGNIZED","TextAssistedCorrectionMode":{"BottomTextPercentageSize":0,"LeftTextPercentageSize":0,"Mode":"TACM_VERIFYING","RightTextPercentageSize":0,"TopTextPercentageSize":0},"TextFilterModes":[{"MinImageDimension":65536,"Mode":"TFM_GENERAL_CONTOUR","Sensitivity":0}],"TextResultOrderModes":[{"Mode":"TROM_CONFIDENCE"},{"Mode":"TROM_POSITION"},{"Mode":"TROM_FORMAT"}],"TextureDetectionModes":[{"Mode":"TDM_GENERAL_WIDTH_CONCENTRATION","Sensitivity":5}],"Timeout":10000},"Version":"3.0"}');r=t}else{if("object"!=typeof t)throw TypeError("'setTemplateSettings(settings)': Type of 'settings' should be 'String' or 'PlainObject'.");r=e.stringify(t)}return t=e.parse(r),i._runtimeSettings=t,i._initSettingsContent=null,i._innerServiceCmd(i._runtimeSettings,null).then((function(t){return t=n._handleRetJsonString(t),i._runtimeSettings=t.settings,i._runtimeSettings||(i._runtimeSettings=e.parse(n._defaultRuntimeSettingsStr)),t.settings}))},t.prototype.resetRuntimeSettings=function(){var t=this;return t._runtimeSettings=e.parse(n._defaultRuntimeSettingsStr),t._initSettingsContent=null,t._innerServiceCmd(t._runtimeSettings,null).then((function(r){return r=n._handleRetJsonString(r),t._runtimeSettings=r.settings,t._runtimeSettings||(t._runtimeSettings=e.parse(n._defaultRuntimeSettingsStr)),r.settings}))},t.prototype.outputSettingsToString=function(t){if(!t)return n._defaultTemplateStr;for(var r=0;r<this._tplContentArr.length;++r)if(t==this._tplContentArr[r].ImageParameter.Name)return e.stringify(this._tplContentArr[r])},t.prototype.initRuntimeSettingsWithString=function(t){var r=this;if(e.isString(t))return r._runtimeSettings=null,r._initSettingsContent=e.parse(t),r._innerServiceCmd(null,r._initSettingsContent).then((function(t){return t=n._handleRetJsonString(t),r._runtimeSettings=t.settings,r._runtimeSettings||(r._runtimeSettings=e.parse(n._defaultRuntimeSettingsStr)),t.settings}));throw TypeError("'initRuntimeSettingsWithString(settings)': Type of 'settings' should be 'String'.")},t}(),n._dbr_ax=!1,n._dbr=!1,n._initH5=function(t,r,i){return new e.Promise((function(r,i){t._bRemoteMode&&t._dmService&&t._dmService.attrs&&t._dmService.attrs.url&&(t._dbrUrlRoot=t._dmService.attrs.url+"dcp/dbr_"+n.Version.replace(/\./g,"")+"/"),t._dbrUrlRoot||(t._dbrUrlRoot=a.DWT.NetManager.getModuleUrl("dcp/dbr_"+n.Version.replace(/\./g,"")+"/"));var o=5,s={method:"POST",url:t._dbrUrlRoot+"VersionInfo?t="+e.getRandom(),data:'{"method":"VersionInfo"}',onSuccess:function(){r()},onError:function(){if(--o<=0)return i("Failed to connect to the Barcode Reader Add-on, the library may be missing in the Dynamsoft Service directory.");setTimeout((function(){e.ajax(s)}),300)},dataType:"json",async:!0,timeout:800};e.ajax(s)})).then((function(){return n._dbr=new n.Class(t),n._dbr._innerServiceCmd(null,null)})).then((function(t){try{var o=n._handleRetJsonString(t);n._dbr._runtimeSettings=o.settings,n._defaultRuntimeSettingsStr=e.stringify(o.settings),n._defaultTemplateStr=e.stringify(o.outputSettings),r(n._dbr)}catch(t){i(Error("Init template & runtimeSettings failed: "+t.message)||t)}}),(function(e){i(e)}))},n.dbrInitPromiseFun=function(t){return new e.Promise((function(e,r){n.innerDbrInit(t,e,r)}))},n.innerDbrInit=function(t,r,n){var i=!1,o=!1,s=(e.product.bHTML5Edition?i=!0:o=!0,a.BarcodeReaderAddon);if(i){if(s._dbr)return void r(s._dbr)}else if(o&&s._dbr_ax)return void r(s._dbr_ax);if(i&&s._initH5(t,r,n),o){if(i=a.navInfoSync,o={method:"ReadBarcode",parameter:[a.Lib.product.refProductKey,4002,"",""]},!i.bIE)return n(Error("The DBR init error."));try{s._activeXInstance=new ActiveXObject("DBRModule.AtlDBR");var u,c=s._activeXInstance.Process(e.stringify(o),location.protocol+"//"+location.host),l=e.parse(c);return l?"settings"in l?(s._dbr_ax=new s.Class(t),s._dbr_ax._runtimeSettings=l.settings,s._defaultRuntimeSettingsStr=e.stringify(l.settings),"outputSettings"in l&&(s._defaultTemplateStr=e.stringify(l.outputSettings)),void r(s._dbr_ax)):(u=l.description||"The DBR init error.",n(Error(u))):n(Error("The DBR init error."))}catch(t){return n(Error("The DBR .dll is missing or not accessible: "+(t.message||t)))}}},e.DynamicLoadAddonFuns&&e.DynamicLoadAddonFuns.push((function(t){if(r=t._b64bit?"dbrx64_"+a.BarcodeReaderAddon.Version+".dll":"dbr_"+a.BarcodeReaderAddon.Version+".dll",e.product.bHTML5Edition)try{t._innerSend("GetAddOnVersion",e.html5.Funs.makeParams("barcodereader",r),!0,!1,!1).catch((function(){}))}catch(o){}function i(t){return!e.License.checkProductKey(t,{Core:!0})||!!(a.navInfoSync.bMac||a.navInfoSync.bLinux||a.Lib.env.bMobile)&&(t._errorCode=a.DBR.EnumErrorCode.DBR_UNKNOWN,t._errorString=n.errors.ServiceEditionNotSupportDbr,!0)}var o={BarcodeReader:{decode:function(r){return i(t)?e.Promise.reject(n.BarcodeReaderException(t._errorCode,t._errorString)):!e.isNumber(r)||r<0||r>=t.HowManyImagesInBuffer?(e.Errors.IndexOutOfRange(t),e.Promise.reject(n.BarcodeReaderException(t._errorCode,t._errorString))):new e.Promise((function(e){n._decoding?n._decodeQueue.push({method:e,args:[r]}):(n._decoding=!0,e(r))})).then((function(r){var i;if(e.product.bHTML5Edition){if(-1==(i=t._ImgManager.convertClientIndexToServerId(r)))throw e.Errors.IndexOutOfRange(t),setTimeout(n._decodeNext,0),n.BarcodeReaderException(t._errorCode,t._errorString)}else i=r;return new e.Promise((function(r,o){n.dbrInitPromiseFun(t).then((function(s){var u;if(!e.product.bHTML5Edition)return u=i,c=t.GetImagePartURL(u,-1,-1),s._innerDecode(4001,c,"").then((function(e){e.imageid=t.IndexToImageID(u),setTimeout(n._decodeNext,0),r(e)}),(function(e){setTimeout(n._decodeNext,0),o(e)}));u=t._ImgManager.convertServerIdToClientIndex(i);var c=t.GetImagePartURL(u,-1,-1);return s._innerDecode(4e3,c,"",t._clientId).then((function(e){e.imageid=t.IndexToImageID(u),setTimeout(n._decodeNext,0),r(e),t._blts&&a.DWT.lcvrf(t)}),(function(e){setTimeout(n._decodeNext,0),o(e)}))}),(function(e){setTimeout(n._decodeNext,0),o(e)}))}))}))},resetRuntimeSettings:function(){return i(t)?e.Promise.reject(n.BarcodeReaderException(t._errorCode,t._errorString)):n.dbrInitPromiseFun(t).then((function(e){return e.resetRuntimeSettings()}))},getRuntimeSettings:function(r){return i(t)?e.Promise.reject(n.BarcodeReaderException(t._errorCode,t._errorString)):!e.isString(r)||"speed"!=r&&"balance"!=r&&"coverage"!=r&&"default"!=r?n.dbrInitPromiseFun(t).then((function(e){return e.getRuntimeSettings()})):this.updateRuntimeSettings(r)},updateRuntimeSettings:function(r){return i(t)?e.Promise.reject(n.BarcodeReaderException(t._errorCode,t._errorString)):n.dbrInitPromiseFun(t).then((function(e){return e.updateRuntimeSettings(r)}))},initRuntimeSettingsWithString:function(r){return i(t)?e.Promise.reject(n.BarcodeReaderException(t._errorCode,t._errorString)):n.dbrInitPromiseFun(t).then((function(e){return e.initRuntimeSettingsWithString(r)}))}}};e.product.bHTML5Edition?(t.__addon=t.__addon||{},e.mix(t.__addon,o)):(t.Addon=t.Addon||{},e.mix(t.Addon,o))}))})),(a=self.Dynamsoft||{}).DWT=a.DWT||{},a.aryAddonReadyFun=a.aryAddonReadyFun||[],a.AddonReady=a.AddonReady||function(e){a.aryAddonReadyFun.push(e)},a.DWT.EnumDWT_ConvertMode={CM_RENDERALL:1,CM_IMAGEONLY:2,CM_AUTO:3,CM_RENDERALLWITHANNOTATION:4},a.DWT.EnumDWT_PDFCompressionType={PDF_AUTO:0,PDF_FAX3:1,PDF_FAX4:2,PDF_LZW:3,PDF_RLE:4,PDF_JPEG:5,PDF_JP2000:6,PDF_JBIG2:7},a.AddonReady((function(e,t){var r,n;e.product.bHTML5Edition&&(r={code:-2830,message:"The PDF resolution must be a positive number."},e.DynamicLoadAddonFuns)&&e.DynamicLoadAddonFuns.push((function(t){var i,o=e.html5.Funs;n=t.__serverPlatform==a.DWT.EnumDWT_PlatformType.enumMac?t._b64bit?"libDynamicPdfCorex64_"+a.DWT.PdfVersion+".dylib":"libDynamicPdfCore_"+a.DWT.PdfVersion+".dylib":t.__serverPlatform==a.DWT.EnumDWT_PlatformType.enumLinux||t.__serverPlatform==a.DWT.EnumDWT_PlatformType.enumEmbed||t.__serverPlatform==a.DWT.EnumDWT_PlatformType.enumChromeOS?"libDynamicPdfCore_"+a.DWT.PdfVersion+".so":t._b64bit?"DynamicPdfCorex64_"+a.DWT.PdfVersion+".dll":"DynamicPdfCore_"+a.DWT.PdfVersion+".dll";try{t._innerSend("GetAddOnVersion",o.makeParams("pdf",n),!0,!1,!1).catch((function(){}))}catch(i){}i={PDF:{IsModuleInstalled:function(){var e=t;return e._resetErr(),""!=e._innerFun("GetAddOnVersion",o.makeParams("pdf",n))},IsModuleInstalledAsync:function(){var e=t;return e._resetErr(),e._innerFunV2("GetAddOnVersion",o.makeParams("pdf",n)).then((function(e){return""!=e}))},ConvertToImage:function(e,r,n,i){e=o.replaceLocalFilename(e);var a="ConvertPDFToImage",s=t;return s._resetErr(),o.showMask(a),s._innerSend(a,o.makeParams(e,r),!0,(function(e){return o.hideMask(a),n&&n(),!0}),(function(e){return o.hideMask(a),i&&i(),!1})),!0},SetPassword:function(e){var r=t,n=e||"";return r._resetErr(),!!r._checkPDFPasswordValue(n)&&(n=r._mixSavedPdfReaderOptions({password:n}),(n=r._setReaderOptions(n,!1))&&(r._pdfOptions.password=e),n)},SetConvertMode:function(e){return t._setConvertMode(e)},SetConvertModeAsync:function(e){return t._setConvertModeAsync(e)},GetConvertMode:function(){var e=t;return e._resetErr(),e._pdfConvertMode},SetResolution:function(e){var r=t,n=e;return r._resetErr(),n=r._mixSavedPdfReaderOptions({renderOptions:{resolution:n}}),(n=r._setReaderOptions(n,!1))&&(r._pdfOptions.renderOptions.resolution=e),n},SetResolutionAsync:function(e){var n=t;return n._resetErr(),!a.Lib.isNumber(e)||e<=0?a.Lib.Promise.reject(r):n._innerFunV2("SetPDFResolution",o.makeParams(e)).then((function(t){t&&(n._pdfOptions.renderOptions.resolution=e)}))},SetReaderOptions:function(e){return t._setReaderOptions(e,!0)},GetReaderOptions:function(){var e,r=t;return r._resetErr(),e=t._innerFun("GetPDFReaderOptions"),e=a.Lib.parse(e),r._pdfOptions=r._mixSavedPdfReaderOptions(e),a.Lib.clone(r._pdfOptions)},IsTextBasedPDF:function(r,n,i){var a=t;a._resetErr(),r=o.replaceLocalFilename(r),r=t._innerFun("IsTextBasedPDF",o.makeParams(r));return 0==a.ErrorCode?e.isFunction(n)&&n(r):e.isFunction(i)&&i(a.ErrorCode,a.ErrorString),r},Write:{Setup:function(r){r=r||{version:15};var n=(2<e.stringify(r).length&&(e.isNumber(r.version)?1<=r.version&&r.version<2&&(r.version=parseInt(10*r.version)):r.version=15),e.isNumber(r.compression)&&r.compression==a.DWT.EnumDWT_PDFCompressionType.PDF_FAX3&&(r.compression=a.DWT.EnumDWT_PDFCompressionType.PDF_FAX4),t);return n._resetErr(),!(r.password&&(e.isNumber(r.password)&&(r.password=r.password.toString()),!n._checkPDFPasswordValue(r.password)))&&(r=e.stringify(r),r=e.replaceAll(r,'"','\\"'),n._innerFun("SetPDFSettings",['["',r,'"]'].join("")))}}}},t.__addon=t.__addon||{},e.mix(t.__addon,i)}))})),a.AddonReady((function(e,t){e.product.bActiveXEdition&&e.DynamicLoadAddonFuns&&e.DynamicLoadAddonFuns.push((function(t){var r,n,i;if(!t.getSWebTwain()||!t.getSWebTwain().Addon)return!1;a.navInfoSync.bWin&&(i=!a.navInfo.bOSx64||a.navInfo.bWOW64?"DynamicPdfCore_"+a.DWT.PdfVersion+".dll":"DynamicPdfCorex64_"+a.DWT.PdfVersion+".dll"),n=t.getSWebTwain(),r={PDF:{IsModuleInstalled:function(){var r=n.GetAddOnVersion("pdf",i);return e.setErrorString(t),""!=r},IsModuleInstalledAsync:function(){var r=n.GetAddOnVersion("pdf",i);return e.setErrorString(t),e.Promise.resolve(""!=r)},ConvertToImage:function(r,i,o,a){return r=n.ConvertPDFToImage(r,i),e.wrapperRet(t,r,o,a)},SetPassword:function(r){return r=n.SetPDFPassword(r),e.wrapperRet(t,r)},SetConvertMode:function(e){return t._setConvertMode(e)},SetConvertModeAsync:function(e){return Promise.resolve(t._setConvertMode(e))},GetConvertMode:function(){return t._resetErr(),t._pdfConvertMode},SetResolution:function(r){return r=n.SetPDFResolution(r),e.wrapperRet(t,r)},SetResolutionAsync:function(r){return r=n.SetPDFResolution(r),e.Promise.resolve(e.wrapperRet(t,r))},SetReaderOptions:function(){return!1},GetReaderOptions:function(){return{}},IsTextBasedPDF:function(r){return r=n.IsTextBasedPDF(r),e.wrapperRet(t,r)}}},t.Addon=t.Addon||{},e.mix(t.Addon,r)}))})),(a=self.Dynamsoft||{}).DWT=a.DWT||{},a.aryAddonReadyFun=a.aryAddonReadyFun||[],a.AddonReady=a.AddonReady||function(e){a.aryAddonReadyFun.push(e)},a.DWT.OCRVerInName="10.0.0.0618",function(){for(var e=[a.DWT],t=0;t<1;t++){var r=e[t];r.EnumDWT_OCRLanguage={OCRL_ENG:"eng",OCRL_ARA:"ara",OCRL_CHI_SIM:"chi_sim",OCRL_CHI_TRA:"chi_tra",OCRL_HIN:"hin",OCRL_URD:"urd",OCRL_SPA:"spa",OCRL_FRA:"fra",OCRL_MSA:"msa",OCRL_IND:"ind",OCRL_RUS:"rus",OCRL_BEN:"ben",OCRL_POR:"por",OCRL_PAN:"pan",OCRL_DEU:"deu",OCRL_JPN:"jpn",OCRL_FAS:"fas",OCRL_SWA:"swa",OCRL_JAV:"jav",OCRL_TEL:"tel",OCRL_TUR:"tur",OCRL_KOR:"kor",OCRL_MAR:"mar",OCRL_TAM:"tam",OCRL_VIE:"vie",OCRL_ITA:"ita",OCRL_THA:"tha"},r.EnumDWT_OCRPageSetMode={OCRPSM_OSD_ONLY:0,PSM_AUTO_OSD:1,PSM_AUTO_ONLY:2,PSM_AUTO:3,PSM_SINGLE_COLUMN:4,PSM_SINGLE_BLOCK_VERT_TEXT:5,PSM_SINGLE_BLOCK:6,PSM_SINGLE_LINE:7,PSM_SINGLE_WORD:8,PSM_CIRCLE_WORD:9,PSM_SINGLE_CHAR:10},r.EnumDWT_OCROutputFormat={OCROF_TEXT:0,OCROF_PDFPLAINTEXT:1,OCROF_PDFIMAGEOVERTEXT:2,OCROF_PDFPLAINTEXT_PDFX:3,OCROF_PDFIMAGEOVERTEXT_PDFX:4},r.EnumDWT_OCRDownloadType={OCRDT_Dll:0,OCRDT_LANGUAGE:1}}}(),a.DWT.OCRLanguageData_eng="4113088",a.DWT.OCRLanguageData_ara="1432056",a.DWT.OCRLanguageData_chi_sim="2469156",a.DWT.OCRLanguageData_chi_tra="2366642",a.DWT.OCRLanguageData_hin="1122751",a.DWT.OCRLanguageData_urd="1398718",a.DWT.OCRLanguageData_spa="2294433",a.DWT.OCRLanguageData_fra="1130365",a.DWT.OCRLanguageData_msa="1747801",a.DWT.OCRLanguageData_ind="1122661",a.DWT.OCRLanguageData_rus="3861738",a.DWT.OCRLanguageData_ben="855841",a.DWT.OCRLanguageData_por="1982756",a.DWT.OCRLanguageData_pan="497721",a.DWT.OCRLanguageData_deu="1525436",a.DWT.OCRLanguageData_jpn="2471260",a.DWT.OCRLanguageData_fas="431500",a.DWT.OCRLanguageData_swa="2167651",a.DWT.OCRLanguageData_jav="2982741",a.DWT.OCRLanguageData_tel="2769654",a.DWT.OCRLanguageData_tur="4550554",a.DWT.OCRLanguageData_kor="1677415",a.DWT.OCRLanguageData_mar="2118233",a.DWT.OCRLanguageData_tam="3237963",a.DWT.OCRLanguageData_vie="531275",a.DWT.OCRLanguageData_ita="2701314",a.DWT.OCRLanguageData_tha="1072600",a.DWT.OCRLanguageData={},a.DWT.OCRLanguageData[a.DWT.EnumDWT_OCRLanguage.OCRL_ENG]=a.DWT.OCRLanguageData_eng,a.DWT.OCRLanguageData[a.DWT.EnumDWT_OCRLanguage.OCRL_ARA]=a.DWT.OCRLanguageData_ara,a.DWT.OCRLanguageData[a.DWT.EnumDWT_OCRLanguage.OCRL_CHI_TRA]=a.DWT.OCRLanguageData_chi_tra,a.DWT.OCRLanguageData[a.DWT.EnumDWT_OCRLanguage.OCRL_CHI_SIM]=a.DWT.OCRLanguageData_chi_sim,a.DWT.OCRLanguageData[a.DWT.EnumDWT_OCRLanguage.OCRL_HIN]=a.DWT.OCRLanguageData_hin,a.DWT.OCRLanguageData[a.DWT.EnumDWT_OCRLanguage.OCRL_URD]=a.DWT.OCRLanguageData_urd,a.DWT.OCRLanguageData[a.DWT.EnumDWT_OCRLanguage.OCRL_SPA]=a.DWT.OCRLanguageData_spa,a.DWT.OCRLanguageData[a.DWT.EnumDWT_OCRLanguage.OCRL_FRA]=a.DWT.OCRLanguageData_fra,a.DWT.OCRLanguageData[a.DWT.EnumDWT_OCRLanguage.OCRL_MSA]=a.DWT.OCRLanguageData_msa,a.DWT.OCRLanguageData[a.DWT.EnumDWT_OCRLanguage.OCRL_IND]=a.DWT.OCRLanguageData_ind,a.DWT.OCRLanguageData[a.DWT.EnumDWT_OCRLanguage.OCRL_RUS]=a.DWT.OCRLanguageData_rus,a.DWT.OCRLanguageData[a.DWT.EnumDWT_OCRLanguage.OCRL_BEN]=a.DWT.OCRLanguageData_ben,a.DWT.OCRLanguageData[a.DWT.EnumDWT_OCRLanguage.OCRL_POR]=a.DWT.OCRLanguageData_por,a.DWT.OCRLanguageData[a.DWT.EnumDWT_OCRLanguage.OCRL_PAN]=a.DWT.OCRLanguageData_pan,a.DWT.OCRLanguageData[a.DWT.EnumDWT_OCRLanguage.OCRL_DEU]=a.DWT.OCRLanguageData_deu,a.DWT.OCRLanguageData[a.DWT.EnumDWT_OCRLanguage.OCRL_JPN]=a.DWT.OCRLanguageData_jpn,a.DWT.OCRLanguageData[a.DWT.EnumDWT_OCRLanguage.OCRL_FAS]=a.DWT.OCRLanguageData_fas,a.DWT.OCRLanguageData[a.DWT.EnumDWT_OCRLanguage.OCRL_SWA]=a.DWT.OCRLanguageData_swa,a.DWT.OCRLanguageData[a.DWT.EnumDWT_OCRLanguage.OCRL_JAV]=a.DWT.OCRLanguageData_jav,a.DWT.OCRLanguageData[a.DWT.EnumDWT_OCRLanguage.OCRL_TEL]=a.DWT.OCRLanguageData_tel,a.DWT.OCRLanguageData[a.DWT.EnumDWT_OCRLanguage.OCRL_TUR]=a.DWT.OCRLanguageData_tur,a.DWT.OCRLanguageData[a.DWT.EnumDWT_OCRLanguage.OCRL_KOR]=a.DWT.OCRLanguageData_kor,a.DWT.OCRLanguageData[a.DWT.EnumDWT_OCRLanguage.OCRL_MAR]=a.DWT.OCRLanguageData_mar,a.DWT.OCRLanguageData[a.DWT.EnumDWT_OCRLanguage.OCRL_TAM]=a.DWT.OCRLanguageData_tam,a.DWT.OCRLanguageData[a.DWT.EnumDWT_OCRLanguage.OCRL_VIE]=a.DWT.OCRLanguageData_vie,a.DWT.OCRLanguageData[a.DWT.EnumDWT_OCRLanguage.OCRL_ITA]=a.DWT.OCRLanguageData_ita,a.DWT.OCRLanguageData[a.DWT.EnumDWT_OCRLanguage.OCRL_THA]=a.DWT.OCRLanguageData_tha,function(e){function t(){var e=this;e._text="",e._fontName="",e._fontSize="",e._left=0,e._top=0,e._right=0,e._bottom=0}t.prototype.GetText=function(){return this._text},t.prototype.GetFontName=function(){return this._fontName},t.prototype.GetFontSize=function(){return this._fontSize},t.prototype.GetWordRect=function(){var e=this;return e._left+","+e._top+","+e._right+","+e._bottom},e.NewWordBasicResult=function(){return new t}}(a.Lib),function(e){function t(){var e=this;e._count=0,e._left=0,e._top=0,e._right=0,e._bottom=0,e._wordlist=[]}t.prototype.GetWordCount=function(){return this._count},t.prototype.GetLineRect=function(){var e=this;return e._left+","+e._top+","+e._right+","+e._bottom},t.prototype.GetWordContent=function(e){var t=this,r=t._wordlist.length;return t._errorCode<0?"":null==e||r<=e||e<0?(a.Lib.Errors.OCR_InvalidIndex(t,"GetWordContent"),""):((r=a.Lib.NewWordBasicResult())._text=t._wordlist[e].text,r._fontName=t._wordlist[e].fontname,r._fontSize=t._wordlist[e].fontsize,r._left=t._wordlist[e].rect[0],r._top=t._wordlist[e].rect[1],r._right=t._wordlist[e].rect[2],r._bottom=t._wordlist[e].rect[3],r)},e.NewLineBasicResult=function(){return new t}}(a.Lib),function(e){function t(){this._count=0,this._linelist=[]}t.prototype.GetLineCount=function(){return this._count},t.prototype.GetLineContent=function(e){var t=this,r=t._linelist.length;return t._errorCode<0?"":null==e||r<=e||e<0?(a.Lib.Errors.OCR_InvalidIndex(t,"GetLineContent"),""):((r=a.Lib.NewLineBasicResult())._count=t._linelist[e].words.length,r._left=t._linelist[e].rect[0],r._top=t._linelist[e].rect[1],r._right=t._linelist[e].rect[2],r._bottom=t._linelist[e].rect[3],r._wordlist=t._linelist[e].words,r)},e.NewPageBasicResult=function(){return new t}}(a.Lib),function(e){function t(){this._count=0,this._pagelist=[]}t.prototype.GetPageCount=function(){return this._count},t.prototype.GetPageContent=function(e){var t=this,r=t._pagelist.length;return t._errorCode<0?"":null==e||r<=e||e<0?(a.Lib.Errors.OCR_InvalidIndex(t,"GetPageContent"),""):((r=a.Lib.NewPageBasicResult())._count=t._pagelist[e].lines.length,r._linelist=t._pagelist[e].lines,r)},e.NewPageSetBasicResult=function(){return new t}}(a.Lib),function(e){function t(e){var t=this;t._errorCode=0,t._errorString="",t._resultlist=[],t._stwain=e}t.prototype.GetErrorCode=function(){return this._errorCode},t.prototype.GetErrorString=function(){return this._errorString},t.prototype.GetFormat=function(){return this._resultlist[0].format},t.prototype.GetInput=function(){var e=this._resultlist[0].input;if(e){var t=Number(e);if(!isNaN(t))return this._stwain._ImgManager.convertServerIdToClientIndex(t)}return e},t.prototype.GetPageSetCount=function(){return this._resultlist[0].pagesets.length},t.prototype.GetPageSetContent=function(e){var t=this,r=t._resultlist[0].pagesets.length;return t._errorCode<0?"":null==e||r<=e||e<0?(a.Lib.Errors.OCR_InvalidIndex(t,"GetPageSetContent"),""):((r=a.Lib.NewPageSetBasicResult())._count=t._resultlist[0].pagesets[e].pages.length,r._pagelist=t._resultlist[0].pagesets[e].pages,r)},t.prototype.Get=function(){return this._stwain._innerFun("GetOCRRestult")},t.prototype.Save=function(t){return t=e.html5.Funs.replaceLocalFilename(t),this._stwain._innerFun("SaveOCRRestult",e.html5.Funs.makeParams(t))},e.NewOCRBasicResult=function(e){return new t(e)}}(a.Lib),function(e){function t(){var e=this;e.UnicodeFontName="",e.UseDetectedFont=!0,e.MinFontSizeforMoreAccurateResult=0,e.OCRLanguage=a.DWT.EnumDWT_OCRLanguage.OCRL_ENG,e.PageSetMode=a.DWT.EnumDWT_OCRPageSetMode.PSM_AUTO,e.OutputFormat=a.DWT.EnumDWT_OCROutputFormat.OCROF_PDFIMAGEOVERTEXT}t.prototype.GetUnicodeFontName=function(){return this.UnicodeFontName},t.prototype.SetUnicodeFontName=function(t){return e.isString(t)||(t=""),this.UnicodeFontName=t,!0},t.prototype.GetUseDetectedFont=function(){return!!this.UseDetectedFont},t.prototype.SetUseDetectedFont=function(e){return this.UseDetectedFont=!!e,!0},t.prototype.GetMinFontSizeforMoreAccurateResult=function(){return this.MinFontSizeforMoreAccurateResult},t.prototype.SetMinFontSizeforMoreAccurateResult=function(e){return e=+e,this.MinFontSizeforMoreAccurateResult=e=e<0?0:e,!0},t.prototype.GetOCRLanguage=function(){return this.OCRLanguage},t.prototype.SetOCRLanguage=function(t){return e.isString(t)||(t=""),this.OCRLanguage=t,!0},t.prototype.GetPageSetMode=function(){return this.PageSetMode},t.prototype.SetPageSetMode=function(e){return((e=+e)<0||e>a.DWT.EnumDWT_OCRPageSetMode.PSM_SINGLE_CHAR)&&(e=a.DWT.EnumDWT_OCRPageSetMode.PSM_AUTO),this.PageSetMode=e,!0},t.prototype.GetOutputFormat=function(){return this.OutputFormat},t.prototype.SetOutputFormat=function(e){return((e=+e)<0||e>a.DWT.EnumDWT_OCROutputFormat.OCROF_PDFIMAGEOVERTEXT_PDFX)&&(e=a.DWT.EnumDWT_OCROutputFormat.OCROF_PDFIMAGEOVERTEXT),this.OutputFormat=e,!0},e.NewOptions=function(){return new t}}(a.Lib),a.AddonReady((function(e,t){var r;e.product.bHTML5Edition&&e.DynamicLoadAddonFuns&&e.DynamicLoadAddonFuns.push((function(t){var n,i,o,s=e.html5.Funs,u=e.NewOptions();i=t,o=e.html5.Funs,r=e.env.bMac?"DynamicOCR_"+a.DWT.OCRVerInName+".dylib":e.env.bLinux?"DynamicOCR_"+a.DWT.OCRVerInName+".so":a.dcp.b64bit?"DynamicOCRx64_"+a.DWT.OCRVerInName+".dll":"DynamicOCR_"+a.DWT.OCRVerInName+".dll",i._isMobileMode()||i._innerSend("GetAddOnVersion",o.makeParams("ocr",r),!0,!1,!1),i.__innerOCRBasicReadFunction=function(t,r,n,i,o,a,s,u,c,l,d){return e.isFunction(l)?this.__innerOCRBasicAsyncReadFunction(t,r,n,i,o,a,s,u,c,l,d):this.__innerOCRSyncReadFunction(t,c)},i.__innerGetOCRBasicResultAsyncFunction=function(e){var t=a.Lib.NewOCRBasicResult(this);return e&&(t._errorCode=e.exception,t._errorString=e.description,t._resultlist=e.result),t},i.__innerOCRBasicAsyncReadFunction=function(t,r,n,s,u,c,l,d,f,h,g){var p=this;return o.showMask(t),p._innerSend(t,f,!0,(function(f){var _;0==f.exception?(e.isFunction(h)&&(-1!=r?(_=p._convertServerIdToGuid(r),1==s?h(_,u,c,l,d,p.__innerGetOCRBasicResultAsyncFunction(f)):h(_,p.__innerGetOCRBasicResultAsyncFunction(f))):""!=n?h(n,p.__innerGetOCRBasicResultAsyncFunction(f)):h(p.__innerGetOCRBasicResultAsyncFunction(f))),e.License.isLTS()&&a.DWT.lcvrf(i)):e.isFunction(g)&&g(f.exception,f.description),o.hideMask(t)}),(function(e){o.hideMask(t)})),!0},i.__innerOCRSyncReadFunction=function(t,r){return t=this._innerFunRaw(t,r,!1,!1),(r=e.NewOCRBasicResult())._errorCode=this._errorCode,r._errorString=this._errorString,t&&e.isArray(t)&&(r._resultlist=t,r._Count=t.length,e.License.isLTS())&&a.DWT.lcvrf(i),r},i.__IsOCRBasicModuleInstalled=function(){return""!=i._innerFun("GetAddOnVersion",o.makeParams("ocr",r)).split("|")[0]},i.__innerBasicDownload=function(t,n,s,u,c){function l(){return f.IfShowProgressBar&&e.closeProgress(null,"Download"),e.isFunction(u)&&u(),!0}function d(){return f.IfShowProgressBar&&e.closeProgress(null,"Download"),e.isFunction(c)&&c(f.ErrorCode,f.ErrorString),!1}var f=i;if(e.cancelFrome=2,t=t.toString(),!e.License.checkProductKey(f,{Core:!0}))return d();if(!e.License.checkProductKey(f,{OCR:!0},!0))return d();n!=a.DWT.EnumDWT_OCRDownloadType.OCRDT_Dll&&f._innerFun("SetOCRLanguage",o.makeParams(s));var h=f._innerFun("GetAddOnVersion",o.makeParams("ocr",r)).split("|");if(n==a.DWT.EnumDWT_OCRDownloadType.OCRDT_Dll){if(""!=h[0])return l(),!0}else if((s=a.DWT.OCRLanguageData[s])&&h[1]==s)return l(),!0;if(!t||""==t)return e.Errors.OCR_InvalidRemoteFilename(f),d(),!1;if(o.isServerInvalid(f))return d(),!1;f.IfShowProgressBar&&e.showProgress(f,"Download",!0);var g=!0;n==a.DWT.EnumDWT_OCRDownloadType.OCRDT_Dll?f._OnPercentDone([0,-1,"Downloading OCR Module...","http"]):f._OnPercentDone([0,-1,"Downloading OCR Language Data...","http"]),e.isFunction(u)||(g=!1),o.loadHttpBlob(f,"get",t,g,(function(e){f._OnPercentDone([0,-1,"Loading..."]);var t=100;n==a.DWT.EnumDWT_OCRDownloadType.OCRDT_LANGUAGE&&(t=101),f.__LoadImageFromBytes(e,t,"",g,l,d)}),(function(){f.IfShowProgressBar&&e.closeProgress(null,"Download"),d()}),(function(e){var t=0===e.total?100:Math.round(100*e.loaded/e.total);[e.loaded," / ",e.total].join(""),f._OnPercentDone([0,t,"","http"])}))},n={OCR:{SetUnicodeFontName:function(e){var r=t;return r._resetErr(),r._isMobileMode()?r._mobileNotSupport("Addon.OCR.SetUnicodeFontName"):u.SetUnicodeFontName(e)},GetUnicodeFontName:function(){var e=t;return e._resetErr(),e._isMobileMode()?e._mobileNotSupport("Addon.OCR.GetUnicodeFontName"):u.GetUnicodeFontName()},SetIfUseDetectedFont:function(e){var r=t;return r._resetErr(),r._isMobileMode()?r._mobileNotSupport("Addon.OCR.SetIfUseDetectedFont"):u.SetUseDetectedFont(e)},GetIfUseDetectedFont:function(){var e=t;return e._resetErr(),e._isMobileMode()?e._mobileNotSupport("Addon.OCR.GetIfUseDetectedFont"):u.GetUseDetectedFont()},SetMinFontSizeforMoreAccurateResult:function(e){var r=t;return r._resetErr(),r._isMobileMode()?r._mobileNotSupport("Addon.OCR.SetMinFontSizeforMoreAccurateResult"):u.SetMinFontSizeforMoreAccurateResult(e)},GetMinFontSizeforMoreAccurateResult:function(){var e=t;return e._resetErr(),e._isMobileMode()?e._mobileNotSupport("Addon.OCR.GetMinFontSizeforMoreAccurateResult"):u.GetMinFontSizeforMoreAccurateResult()},SetLanguage:function(e){var r=t;return r._resetErr(),r._isMobileMode()?r._mobileNotSupport("Addon.OCR.SetLanguage"):u.SetOCRLanguage(e)},IsModuleInstalled:function(){var e=t;return e._resetErr(),e._isMobileMode()?e._mobileNotSupport("Addon.OCR.IsModuleInstalled"):e.__IsOCRBasicModuleInstalled()},SetPageSetMode:function(e){var r=t;return r._resetErr(),r._isMobileMode()?r._mobileNotSupport("Addon.OCR.SetPageSetMode"):(e=+e)==a.DWT.EnumDWT_OCRPageSetMode.OCRPSM_OSD_ONLY||e==a.DWT.EnumDWT_OCRPageSetMode.PSM_AUTO_OSD||e==a.DWT.EnumDWT_OCRPageSetMode.PSM_AUTO_ONLY||e==a.DWT.EnumDWT_OCRPageSetMode.PSM_AUTO||e==a.DWT.EnumDWT_OCRPageSetMode.PSM_SINGLE_COLUMN||e==a.DWT.EnumDWT_OCRPageSetMode.PSM_SINGLE_BLOCK_VERT_TEXT||e==a.DWT.EnumDWT_OCRPageSetMode.PSM_SINGLE_BLOCK||e==a.DWT.EnumDWT_OCRPageSetMode.PSM_SINGLE_LINE||e==a.DWT.EnumDWT_OCRPageSetMode.PSM_SINGLE_WORD||e==a.DWT.EnumDWT_OCRPageSetMode.PSM_CIRCLE_WORD||e==a.DWT.EnumDWT_OCRPageSetMode.PSM_SINGLE_CHAR?u.SetPageSetMode(e):(a.Lib.Errors.OCR_InvalidPageSetMode(r),!1)},SetOutputFormat:function(e){var r=t;return r._resetErr(),r._isMobileMode()?r._mobileNotSupport("Addon.OCR.SetOutputFormat"):(e=+e)==a.DWT.EnumDWT_OCROutputFormat.OCROF_TEXT||e==a.DWT.EnumDWT_OCROutputFormat.OCROF_PDFPLAINTEXT||e==a.DWT.EnumDWT_OCROutputFormat.OCROF_PDFIMAGEOVERTEXT||e==a.DWT.EnumDWT_OCROutputFormat.OCROF_PDFPLAINTEXT_PDFX||e==a.DWT.EnumDWT_OCROutputFormat.OCROF_PDFIMAGEOVERTEXT_PDFX?u.SetOutputFormat(e):(a.Lib.Errors.OCR_InvalidOutputFormat(r),!1)},Recognize:function(r,n,i){var o=t;return o._resetErr(),o._isMobileMode()?o._mobileNotSupport("Addon.OCR.Recognize"):e.License.checkProductKey(o,{OCR:!0},!0)?(r=o._ImgManager.convertClientIndexToServerId(r),o.__innerOCRBasicReadFunction("OCRRecognize",r,"",0,0,0,0,0,s.makeParams(0,r,"",0,0,0,0,u.GetUnicodeFontName(),u.GetUseDetectedFont(),u.GetMinFontSizeforMoreAccurateResult(),u.GetOCRLanguage(),u.GetPageSetMode(),u.GetOutputFormat(),""),n,i)):(e.isFunction(i)&&i(o._errorCode,o._errorString),!1)},RecognizeRect:function(r,n,i,o,c,l,d){var f,h=t;return h._resetErr(),h._isMobileMode()?h._mobileNotSupport("Addon.OCR.RecognizeRect"):!n&&0!=n||!i&&0!=i||!o&&0!=o||!c&&0!=c?(f=a.Lib.NewOCRBasicResult(h),a.Lib.Errors.OCR_InvalidLeftOrTopOrRightOrBottom(f,"RecognizeRect"),void d(f.GetErrorCode(),f.GetErrorString())):e.License.checkProductKey(h,{OCR:!0},!0)?(f=h._ImgManager.convertClientIndexToServerId(r),h.__innerOCRBasicReadFunction("OCRRecognize",f,"",1,n,i,o,c,s.makeParams(0,f,"",n,i,o,c,u.GetUnicodeFontName(),u.GetUseDetectedFont(),u.GetMinFontSizeforMoreAccurateResult(),u.GetOCRLanguage(),u.GetPageSetMode(),u.GetOutputFormat(),""),l,d)):(e.isFunction(d)&&d(h._errorCode,h._errorString),!1)},RecognizeFile:function(r,n,i){var o=t;return o._resetErr(),o._isMobileMode()?o._mobileNotSupport("Addon.OCR.RecognizeFile"):(r=s.replaceLocalFilename(r),e.License.checkProductKey(o,{OCR:!0},!0)?o.__innerOCRBasicReadFunction("OCRRecognize",-1,r,0,0,0,0,0,s.makeParams(1,-1,r,0,0,0,0,u.GetUnicodeFontName(),u.GetUseDetectedFont(),u.GetMinFontSizeforMoreAccurateResult(),u.GetOCRLanguage(),u.GetPageSetMode(),u.GetOutputFormat(),""),n,i):(e.isFunction(i)&&i(o._errorCode,o._errorString),!1))},RecognizeSelectedImages:function(r,n){var i,o,a,c=t;return c._resetErr(),c._isMobileMode()?c._mobileNotSupport("Addon.OCR.RecognizeSelectedImages"):e.License.checkProductKey(c,{OCR:!0},!0)?(a=[],(i=c)._ImgManager.count()<=0||(o=i._ImgManager.getCurrentImageIndex(),i._ImgManager.convertClientIndexToServerId(o),o=i._ImgManager.getSelectedClientIndexArray(),e.isArray(o)&&e.each(o,(function(e){e=i._ImgManager.convertClientIndexToServerId(e),a.push(e)}))),o=a,c.__innerOCRBasicReadFunction("OCRRecognize",-1,"",0,0,0,0,0,s.makeParams(2,-1,"",0,0,0,0,u.GetUnicodeFontName(),u.GetUseDetectedFont(),u.GetMinFontSizeforMoreAccurateResult(),u.GetOCRLanguage(),u.GetPageSetMode(),u.GetOutputFormat(),o.join(",")),r,n)):(e.isFunction(n)&&n(c._errorCode,c._errorString),!1)},Download:function(e,r,n){var i=t;return i._resetErr(),i._isMobileMode()?i._mobileNotSupport("Addon.OCR.Download"):i.__innerBasicDownload(e,a.DWT.EnumDWT_OCRDownloadType.OCRDT_Dll,u.GetOCRLanguage(),r,n)},DownloadLangData:function(e,r,n){var i=t;return i._resetErr(),i._isMobileMode()?i._mobileNotSupport("Addon.OCR.DownloadLangData"):i.__innerBasicDownload(e,a.DWT.EnumDWT_OCRDownloadType.OCRDT_LANGUAGE,u.GetOCRLanguage(),r,n)}}},t.__addon=t.__addon||{},e.mix(t.__addon,n)}))})),(a=self.Dynamsoft||{}).DWT=a.DWT||{},a.aryAddonReadyFun=a.aryAddonReadyFun||[],a.AddonReady=a.AddonReady||function(e){a.aryAddonReadyFun.push(e)},a.ProOCRVerInName="1.2.0.0806",function(e){function t(){var e=this;e._text="",e._left=0,e._top=0,e._right=0,e._bottom=0}t.prototype.GetText=function(){return this._text},t.prototype.GetLetterRect=function(){var e=this;return e._left+","+e._top+","+e._right+","+e._bottom},e.NewLetterResult=function(){return new t}}(a.Lib),function(e){function t(){var e=this;e._count=0,e._letterlist=[],e._zoneCount=0,e._zoneWords=[]}t.prototype.GetLettersCount=function(){return this._count},t.prototype.GetZoneCount=function(){return this._zoneCount},t.prototype.GetLetterContent=function(e){var t=this,r=t._count;if(t._errorCode<0)return"";if(null==e||e>=r||e<0)return a.Lib.Errors.OCR_InvalidIndex(t,"GetLetterContent"),"";var n=a.Lib.NewLetterResult();return n._text=t._letterlist[e].letter,n._left=t._letterlist[e].boundary[0],n._top=t._letterlist[e].boundary[1],n._right=t._letterlist[e].boundary[2],n._bottom=t._letterlist[e].boundary[3],n},t.prototype.GetZoneContent=function(e){var t=this,r=t._zoneCount;return t._errorCode<0?"":null==e||e>=r||e<0?(a.Lib.Errors.OCR_InvalidIndex(t,"GetZoneContent"),""):t._zoneWords[e]},e.NewPageResult=function(){return new t}}(a.Lib),function(e){function t(){var e=this;e._input=0,e._message="",e._page=-1}t.prototype.GetInput=function(){return this._input},t.prototype.GetMessage=function(){return this._message},t.prototype.GetPage=function(){return this._page},e.NewErrorInfo=function(){return new t}}(a.Lib),function(e){function t(e){var t=this;t._errorCode=0,t._errorString="",t._errorlist=[],t._request="",t._ocrTotalCount=0,t._alreadyOCRCount=0,t._resultlist=[],t._resultZoneDetail=[],t._stwain=e}t.prototype.GetErrorCode=function(){return this._errorCode},t.prototype.GetErrorString=function(){return this._errorString},t.prototype.GetInput=function(){var e=this;if(e._request&&e._request.input){var t=e._request.input;if(t){var r=Number(t);if(!isNaN(r))return e._stwain._ImgManager.convertServerIdToClientIndex(r)}return t}return""},t.prototype.GetErrorDetailList=function(){var e=this,t=0;e._errorlist&&(t=e._errorlist.length);for(var r=[],n=0;n<t;n++){var i=a.Lib.NewErrorInfo();i._input=e._errorlist[n].input,i._message=e._errorlist[n].message,i._page=e._errorlist[n].page,r.push(i)}return r},t.prototype.GetOCRTotalCount=function(){return this._ocrTotalCount?this._ocrTotalCount:0},t.prototype.GetAlreadyOCRCount=function(){return this._alreadyOCRCount?this._alreadyOCRCount:0},t.prototype.GetPageCount=function(){var e=this;return e._resultlist&&e._resultlist.length?e._resultlist.length:0},t.prototype.GetPageContent=function(e){var t=this,r=0;if(t._resultlist&&(r=t._resultlist.length),null==e||e>=r||e<0)return a.Lib.Errors.OCR_InvalidIndex(t,"GetPageContent"),"";var n=a.Lib.NewPageResult();return t._resultlist?(n._count=t._resultlist[e].length,n._letterlist=t._resultlist[e]):n._count=0,t._resultZoneDetail?(n._zoneCount=t._resultZoneDetail[e].length,n._zoneWords=t._resultZoneDetail[e]):n._zoneCount=0,n},t.prototype.Get=function(){return this._stwain._innerFun("GetOCRRestult")},t.prototype.Save=function(t){var r=e.html5.Funs.replaceLocalFilename(t);return this._stwain._innerFun("SaveOCRRestult",e.html5.Funs.makeParams(r))},e.NewOCRProResult=function(e){return new t(e)}}(a.Lib),function(e){for(var t=[a.DWT],r=0;r<1;r++){var n=t[r];n.EnumDWT_OCRProRecognitionModule={OCRPM_AUTO:"AUTO",OCRPM_MOSTACCURATE:"MOSTACCURATE",OCRPM_BALANCED:"BALANCED",OCRPM_FASTEST:"FASTEST"},n.EnumDWT_OCRProOutputFormat={OCRPFT_TXTS:"TXTS",OCRPFT_TXTCSV:"TXTCSV",OCRPFT_TXTF:"TXTF",OCRPFT_XML:"XML",OCRPFT_IOTPDF:"IOTPDF",OCRPFT_IOTPDF_MRC:"IOTPDF_MRC"},n.EnumDWT_OCRProPDFVersion={OCRPPDFV_0:"1.0",OCRPPDFV_1:"1.1",OCRPPDFV_2:"1.2",OCRPPDFV_3:"1.3",OCRPPDFV_4:"1.4",OCRPPDFV_5:"1.5",OCRPPDFV_6:"1.6",OCRPPDFV_7:"1.7"},n.EnumDWT_OCRProPDFAVersion={OCRPPDFAV_1A:"pdf/a-1a",OCRPPDFAV_1B:"pdf/a-1b",OCRPPDFAV_2A:"pdf/a-2a",OCRPPDFAV_2B:"pdf/a-2b",OCRPPDFAV_2U:"pdf/a-2u",OCRPPDFAV_3A:"pdf/a-3a",OCRPPDFAV_3B:"pdf/a-3b",OCRPPDFAV_3U:"pdf/a-3u"},n.EnumDWT_OCRProType={OCRDT_File:0,OCRDT_Index:1},n.EnumDWT_OCRFindTextFlags={OCRFT_WHOLEWORD:1,OCRFT_MATCHCASE:2,OCRFT_FUZZYMATCH:4},n.EnumDWT_OCRFindTextAction={OCRFT_HIGHLIGHT:0,OCRFT_STRIKEOUT:1,OCRFT_MARKFORREDACT:2}}}("undefined"!==typeof window&&window),function(e){function t(){var e=this;e.FindText="",e.FindTextFlags=a.DWT.EnumDWT_OCRFindTextFlags.OCRFT_WHOLEWORD,e.FindTextAction=a.DWT.EnumDWT_OCRFindTextAction.OCRFT_MARKFORREDACT}e.NewRedaction=function(){return new t}}(a.Lib),a.WebTwain={Addon:{OCRPro:{}}},function(e){function t(){var e=this;e.RecognitionModule="",e.Languages="eng",e.OutputFormat="",e.PDFVersion="",e.PDFAVersion="",e.LicenseChecker="",e.Redaction=a.Lib.NewRedaction()}e.NewSettings=function(){return new t}}(a.WebTwain.Addon.OCRPro),function(){function e(e,t,r,n){var i=this;i.left=e,i.top=t,i.right=r,i.bottom=n}a.WebTwain.Addon.OCRPro.NewOCRZone=function(t,r,n,i){return new e(t,r,n,i)}}(),a.AddonReady((function(e,t){if(e.product.bHTML5Edition){var r=function(t,r,n,i){var o=e.NewOCRProResult(t);o._errorCode=r,o._errorString=n;var a=e.NewErrorInfo();return a.input=i,a.message=o._errorString,a.page=0,o._errorlist=[a],o};e.DynamicLoadAddonFuns&&e.DynamicLoadAddonFuns.push((function(t){var n,i,o=e.html5.Funs;i=e.env.bMac?"DynamicOCRPro_"+a.ProOCRVerInName+".dylib":e.env.bLinux?"DynamicOCRPro_"+a.ProOCRVerInName+".so":a.dcp.b64bit?"DynamicOCRProx64_"+a.ProOCRVerInName+".dll":"DynamicOCRPro_"+a.ProOCRVerInName+".dll",function(t){var r=e.html5.Funs;t.__innerGetOCRProResultAsyncFunction=function(e){var t=a.Lib.NewOCRProResult(this);return e&&(t._errorCode=e.code,t._errorString=e.message,t._request=e.request,t._errorlist=e.errorList,t._ocrTotalCount=e.ocrTotalCount,t._alreadyOCRCount=e.alreadyOCRCount,t._resultlist=e.resultDetail,t._resultZoneDetail=e.resultZoneDetail),t},t.__innerIsOCRTrial=function(e,t){var r=this,n=function(){var t=!1;if(r.__licenseInfo.Detail)for(var n=0;n<r.__licenseInfo.Detail.length;n++)"10"==r.__licenseInfo.Detail[n].EnumLicenseType&&"TRUE"==r.__licenseInfo.Detail[n].Trial&&(t=!0);return e(t)};return r.__licenseInfo&&r.__licenseInfo.Detail?n():r.GetLicenseInfo(n,t)},t.__innerOCRReadFunction=function(e,t,r,n,i,o,a,s){return this.__innerOCRAsyncReadFunction(e,t,r,n,i,o,a,s)},t.__innerOCRAsyncReadFunction=function(n,i,o,s,u,c,l,d){var f=this;return r.showMask(n),f._innerSend(n,c,!0,(function(c){0==c.code?(e.isFunction(l)&&(-1!=i?1==s?l(i,u,f.__innerGetOCRProResultAsyncFunction(c)):l(i,f.__innerGetOCRProResultAsyncFunction(c)):""!=o?l(o,f.__innerGetOCRProResultAsyncFunction(c)):l(f.__innerGetOCRProResultAsyncFunction(c))),e.License.isLTS()&&a.DWT.lcvrf(t)):e.isFunction(d)&&d(c.code,c.message,f.__innerGetOCRProResultAsyncFunction(c)),r.hideMask(n)}),(function(e){r.hideMask(n)})),!0},t.__innerGetRequestJson=function(e,r,n,i,o){var s,u="[{";for(u+='"id":"'+t.clientId+'",',u+='"method":"OCRProRecognize",',u+='"dllName":"'+o+'",',u+='"productkey":"'+a.DWT.ProductKey+'",',e==a.DWT.EnumDWT_OCRProType.OCRDT_File?u+='"inputType":"file",':u+='"inputType":"index",',u+='"input":[',s=0;s<r.length;s++)e==a.DWT.EnumDWT_OCRProType.OCRDT_File?u+='"'+r[s]+'"':u+=r[s],s+1<r.length&&(u+="|");if(u+="],",u+='"settings":{',u+='"recognitionMethod": "Page"',n&&(n.RecognitionModule&&n.RecognitionModule.length>0&&(u+=',"recognitionModule":"'+n.RecognitionModule+'"'),n.Languages&&n.Languages.length>0&&(u+=',"languages":"'+n.Languages+'"'),n.OutputFormat&&n.OutputFormat.length>0&&(u+=',"outputFormat":"'+n.OutputFormat+'"'),n.PDFVersion&&n.PDFVersion.length>0&&(u+=',"pdfVersion":"'+n.PDFVersion+'"'),n.PDFAVersion&&n.PDFAVersion.length>0&&(u+=',"pdfAVersion":"'+n.PDFAVersion+'"'),n.Redaction&&n.Redaction.FindText&&n.Redaction.FindText.length>0)){var c=parseInt(n.Redaction.FindTextFlags),l=parseInt(n.Redaction.FindTextAction);if(!isNaN(c)&&!isNaN(l)){u+=',"redaction":{';var d=n.Redaction.FindText;u+='"findText":"'+(d=d.replace(/\"/g,'\\"'))+'"',u+=',"findTextFlags":'+c,u+=',"findTextAction":'+l,u+="}"}}for(u+="},",u+='"zones":[',s=0;s<i.length;s++)u+="["+i[s].left+","+i[s].top+","+i[s].right+","+i[s].bottom+"]",s+1<i.length&&(u+=",");return u+="],",(u+='"outputFile":""')+"}]"},t.__LoadImageFromBytesForDownloadInner=function(e,r,n,i,o,s,u,c,l){var d,f,h,g=t;e>=i?(d=s*i,h=r.slice(d,o)):(d=e*s,f=(e+1)*s,h=r.slice(d,f)),g.__LoadImageFromBytes(h,n,"",u,(function(){e>=i?a.Lib.isFunction(c)&&c():(e+=1,g.__LoadImageFromBytesForDownloadInner(e,r,n,i,o,s,u,c,l))}),(function(){a.Lib.isFunction(l)&&l()}),d,o)},t.__LoadImageFromBytesForDownload=function(e,r,n,i,o,a){var s=t,u=2e6,c=e.size||e.length,l=parseInt(c/u);0==c%u&&(l-=1),s.__LoadImageFromBytesForDownloadInner(0,e,r,l,c,u,i,o,a)}}(t),n={OCRPro:{Settings:!1,Recognize:function(n,o,s){var c,l,d=[],f=t;if(f._resetErr(),f._isMobileMode())return f._mobileNotSupport("Addon.OCRPro.Recognize");if(c=parseInt(n),e.isNaN(c)||!e.isNumber(c))return l=r(t,-2201,"Invalid parameter type.",n),e.isFunction(s)?s(l._errorCode,l._errorString,l):e.Errors.WebviewerError(t,l._errorString,l._errorCode),!1;var h=t._ImgManager.convertClientIndexToServerId(c);if(-1==h)return e.isFunction(s)&&(e.Errors.IndexOutOfRange(t),l=r(t,t._errorCode,t._errorString,n),s(l._errorCode,l._errorString,l)),!1;if(!e.License.checkProductKey(t,{OCRPro:!0},!0))return e.isFunction(s)&&(l=r(t,t._errorCode,t._errorString,n),s(l._errorCode,l._errorString,l)),!1;d.push(h);var g=[],p=this.Settings,_=t.__innerGetRequestJson(a.DWT.EnumDWT_OCRProType.OCRDT_Index,d,p,g,i);return t.__innerIsOCRTrial((function(r){return r||e.License.isLTS()?t.__innerOCRReadFunction("OCRProRecognize",n,"",0,g,_,o,s):u(p.LicenseChecker,t,"OCRProRecognize",n,"",0,g,_,o,s)}),s)},RecognizeRect:function(n,o,s,c){var l,d,f=[],h=t;if(h._resetErr(),h._isMobileMode())return h._mobileNotSupport("Addon.OCRPro.RecognizeRect");if(l=parseInt(n),e.isNaN(l)||!e.isNumber(l))return d=r(t,-2201,"Invalid parameter type.",n),e.isFunction(c)?c(d._errorCode,d._errorString,d):e.Errors.WebviewerError(t,d._errorString,d._errorCode),!1;var g=t._ImgManager.convertClientIndexToServerId(l),p=t._ImgManager.GetImageWidth(l),_=t.GetImageHeight(l);if(-1==g)return e.isFunction(c)&&(e.Errors.IndexOutOfRange(t),d=r(t,t._errorCode,t._errorString,n),c(d._errorCode,d._errorString,d)),!1;if(!e.License.checkProductKey(t,{OCRPro:!0},!0))return e.isFunction(c)&&(d=r(t,t._errorCode,t._errorString,n),c(d._errorCode,d._errorString,d)),!1;if(p>0&&_>0)for(var m,v,y,S,T,I,b=0;b<o.length;b++)(v=(m=o[b]).left)<0&&(v=0),(y=m.top)<0&&(y=0),(S=m.right)<0&&(S=0),(T=m.bottom)<0&&(T=0),v>S&&(I=v,v=S,S=I),y>T&&(I=y,y=T,T=I),S>p&&(S=p),T>_&&(T=_),m.left=v,m.top=y,m.right=S,m.bottom=T;f.push(g);var C=this.Settings,w=t.__innerGetRequestJson(a.DWT.EnumDWT_OCRProType.OCRDT_Index,f,C,o,i);return t.__innerIsOCRTrial((function(r){return r||e.License.isLTS()?t.__innerOCRReadFunction("OCRProRecognize",n,"",1,o,w,s,c):u(C.LicenseChecker,t,"OCRProRecognize",n,"",1,o,w,s,c)}),c)},RecognizeFile:function(r,n,s){var c,l,d,f=t;if(f._resetErr(),f._isMobileMode())return f._mobileNotSupport("Addon.OCRPro.RecognizeFile");if(0==r.length)return e.isFunction(s)&&((c=a.Lib.NewOCRProResult(t))._errorCode=-2201,c._errorString="File name cannot be empty.",d=[],(l=a.Lib.NewErrorInfo()).input=r,l.message=c._errorString,l.page=0,d.push(l),c._errorlist=d,s(c._errorCode,c._errorString,c)),!1;if(!e.License.checkProductKey(t,{OCRPro:!0},!0))return e.isFunction(s)&&((c=a.Lib.NewOCRProResult(t))._errorCode=t._errorCode,c._errorString=t._errorString,d=[],(l=a.Lib.NewErrorInfo()).input=r,l.message=c._errorString,l.page=0,d.push(l),c._errorlist=d,s(c._errorCode,c._errorString,c)),!1;var h=o.replaceLocalFilename(r),g=[];h.indexOf("|")>0?g=h.split("|"):h.indexOf(";")>0?g=h.split(";"):h.indexOf(",")>0&&(g=h.split(","));var p=[];if(g.length>0)for(var _=0;_<g.length;_++)p.push(g[_]);else p.push(h);var m=[],v=this.Settings,y=t.__innerGetRequestJson(a.DWT.EnumDWT_OCRProType.OCRDT_File,p,v,m,i);t.__innerIsOCRTrial((function(i){return i||e.License.isLTS()?t.__innerOCRReadFunction("OCRProRecognize",-1,r,0,m,y,n,s):u(v.LicenseChecker,t,"OCRProRecognize",-1,r,0,m,y,n,s)}),s)},RecognizeSelectedImages:function(r,n){var o,s,c,l=t;if(l._resetErr(),l._isMobileMode())return l._mobileNotSupport("Addon.OCRPro.RecognizeSelectedImages");if(!e.License.checkProductKey(t,{OCRPro:!0},!0)){if(e.isFunction(n)){var d=a.Lib.NewOCRProResult(t);d._errorCode=t._errorCode,d._errorString=t._errorString,s=[],(c=a.Lib.NewErrorInfo()).input="",c.message=d._errorString,c.page=0,s.push(c),d._errorlist=s,n(d._errorCode,d._errorString,d)}return!1}var f=[],h=this.Settings,g=function(t){var r,n,i=[];return t._ImgManager.count()<=0||(r=t._ImgManager.getCurrentImageIndex(),t._ImgManager.convertClientIndexToServerId(r),n=t._ImgManager.getSelectedClientIndexArray(),e.isArray(n)&&e.each(n,(function(e){var r=t._ImgManager.convertClientIndexToServerId(e);i.push(r)}))),i}(t),p=t.__innerGetRequestJson(a.DWT.EnumDWT_OCRProType.OCRDT_Index,g,h,f,i);return t.__innerIsOCRTrial((function(i){o=i||e.License.isLTS()?t.__innerOCRReadFunction("OCRProRecognize",-1,"",0,f,p,r,n):u(h.LicenseChecker,t,"OCRProRecognize",-1,"",0,f,p,r,n)}),n),o},IsModuleInstalled:function(){var e=t;return e._resetErr(),e._isMobileMode()?e._mobileNotSupport("Addon.OCRPro.IsModuleInstalled"):""!=e._innerFun("GetAddOnVersion",o.makeParams("proocr",i))},Download:function(r,n,i){var a=t;if(a._resetErr(),a._isMobileMode())return a._mobileNotSupport("Addon.OCRPro.Download");var s=function(){return e.isFunction(n)&&n(),!0},u=function(){return e.isFunction(i)&&i(a.ErrorCode,a.ErrorString),!1};if(!e.License.checkProductKey(a,{Core:!0}))return u();if(!e.License.checkProductKey(a,{OCRPro:!0},!0))return u();if(this.IsModuleInstalled())return s(),!0;if(!r||""==r||!e.isString(r))return e.Errors.OCR_InvalidRemoteFilename(a),u(),!1;if(o.isServerInvalid(a))return u(),!1;e.cancelFrome=2,e.showProgress(a,"Download",!0);var c=!0;return a._OnPercentDone([0,-1,"Downloading OCR Resources...","http"]),e.isFunction(n)||(c=!1),o.loadHttpBlob(a,"get",r,c,(function(e){a._OnPercentDone([0,-1,"Loading..."]),a.__LoadImageFromBytesForDownload(e,102,"",c,s,u)}),(function(){e.closeProgress("Download"),u()}),(function(e){var t=0===e.total?100:Math.round(100*e.loaded/e.total);[e.loaded," / ",e.total].join(""),a._OnPercentDone([0,t,"","http"])}))}}},t.__addon=t.__addon||{},e.mix(t.__addon,n)})),a.WebTwain.Addon.OCRPro.NewOCRReadPara=function(e,t,r,n,i,a,s,u,c,l){return new o(e,t,r,n,i,a,s,u,c,l)},a.WebTwain.Addon.OCRPro.NewOCRError=function(){return new d},a.Lib.mix(a.Lib.Errors,{OCR_LicenseCheckerEmpty:function(e){var t="LicenseChecker cannot be empty.";e.errorString=t,e.responseText=h("false;-2601;"+t+";")},OCR_LicenseCheckerNotConnect:function(e){var t="Cannot connect to the LicenseChecker, please check and make sure it's set correctly.";e.errorString=t,e.responseText=h("false;-2602;"+t+";")},OCR_AccessDenied:function(e){var t="Access denied.";e.errorString=t,e.responseText=h("false;-2603;"+t+";")},OCR_LicenseCheckerError:function(e,t){var r="Error occured in '"+t+"'.";e.errorString=r,e.responseText=h("false;-2604;"+r+";")},OCR_HTTPError:function(e,t){var r="HTTP Error "+t+".";e.errorString=r,e.responseText=h("false;-2605;"+r+";")},OCR_LicenseCheckerUnauthorized:function(e,t){var r="You do not have permission to view this directory or page using the credentials you supplied (access denied due to Access Control Lists). Ask the Web server's administrator to give you access to '"+t+"'.";e.errorString=r,e.responseText=h("false;-2606;"+r+";")},__last:!1});var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=new Array(-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1)}function o(e,t,r,n,i,o,a,s,u,c){var l=this;l.STWAIN=t,l.AjaxFunctionUrl=e,l.FunctionName=r,l.ImageIndex=n,l.FileNames=i,l.Type=o,l.AryZone=a,l.JsonString=s,l.OnSuccess=u,l.OnFailure=c}function s(e,t){var r="",n=e.responseText;if(0==n.length){var o=a.WebTwain.Addon.OCRPro.NewOCRError();a.Lib.Errors.OCR_LicenseCheckerError(o,t.AjaxFunctionUrl),n=o.responseText}r=function(e){return function(e){var t,r,n,i,o,a;t="",n=e.length,r=0;for(;r<n;)switch((i=e.charCodeAt(r++))>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:t+=e.charAt(r-1);break;case 12:case 13:o=e.charCodeAt(r++),t+=String.fromCharCode((31&i)<<6|63&o);break;case 14:o=e.charCodeAt(r++),a=e.charCodeAt(r++),t+=String.fromCharCode((15&i)<<12|(63&o)<<6|(63&a)<<0)}return t}(function(e){var t,r,n,o,a,s,u;s=e.length,a=0,u="";for(;a<s;){do{t=i[255&e.charCodeAt(a++)]}while(a<s&&-1==t);if(-1==t)break;do{r=i[255&e.charCodeAt(a++)]}while(a<s&&-1==r);if(-1==r)break;u+=String.fromCharCode(t<<2|(48&r)>>4);do{if(61==(n=255&e.charCodeAt(a++)))return u;n=i[n]}while(a<s&&-1==n);if(-1==n)break;u+=String.fromCharCode((15&r)<<4|(60&n)>>2);do{if(61==(o=255&e.charCodeAt(a++)))return u;o=i[o]}while(a<s&&-1==o);if(-1==o)break;u+=String.fromCharCode((3&n)<<6|o)}return u}(e))}(n);var s=r.split(";");if(1==s.length)t.OnFailure(-1,n,a.Lib.NewOCRProResult());else if("true"==s[0]){t.STWAIN.__innerOCRReadFunction(t.FunctionName,t.ImageIndex,t.FileNames,t.Type,t.AryZone,t.JsonString,(function(e,r,n){a.Lib.isUndefined(n)?a.Lib.isUndefined(r)?(t.OnSuccess(e),c(t.AjaxFunctionUrl,e.GetPageCount())):(t.OnSuccess(e,r),c(t.AjaxFunctionUrl,r.GetPageCount())):(t.OnSuccess(e,r,n),c(t.AjaxFunctionUrl,n.GetPageCount()))}),t.OnFailure)}else t.OnFailure(s[1],s[2],a.Lib.NewOCRProResult())}function u(e,t,r,n,i,o,u,c,l,d){return f(e,"DTW_AjaxMethod=CheckLicense&Productkey="+h(a.DWT.ProductKey),s,a.WebTwain.Addon.OCRPro.NewOCRReadPara(e,t,r,n,i,o,u,c,l,d))}function c(e,t){f(e,"DTW_AjaxMethod=WriteOCRCount&OCRCount="+h(t+""),l,null)}function l(e,t){}function d(){this.responseText="",this.errorString=""}function f(e,t,r,n){var i=a.WebTwain.Addon.OCRPro.NewOCRError();if(""==e)return a.Lib.Errors.OCR_LicenseCheckerEmpty(i),alert(i.errorString),r(i,n),!1;var o=function(){var t=null,r=window;try{t=new r.ActiveXObject("Msxml2.XMLHTTP")}catch(e){try{t=new r.ActiveXObject("Microsoft.XMLHTTP")}catch(e){t=new XMLHttpRequest}}return t}();return o.open("POST",e,!0),o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),o.onreadystatechange=function(){if(4==o.readyState){if(200!=o.status)return 401==o.status?(a.Lib.Errors.OCR_LicenseCheckerUnauthorized(i,n.AjaxFunctionUrl),r(i,n),!1):404==o.status?(a.Lib.Errors.OCR_LicenseCheckerNotConnect(i),alert(i.errorString),r(i,n),!1):403==o.status?(a.Lib.Errors.OCR_AccessDenied(i),r(i,n),!1):(a.Lib.Errors.OCR_HTTPError(i,o.status),r(i,n),!1);null!=r&&"function"==typeof r&&r(o,n)}},o&&t&&o.send(t),!0}function h(e){return function(e){var t,r,i,o,a,s;for(i=e.length,r=0,t="";r<i;){if(o=255&e.charCodeAt(r++),r==i){t+=n.charAt(o>>2),t+=n.charAt((3&o)<<4),t+="==";break}if(a=e.charCodeAt(r++),r==i){t+=n.charAt(o>>2),t+=n.charAt((3&o)<<4|(240&a)>>4),t+=n.charAt((15&a)<<2),t+="=";break}s=e.charCodeAt(r++),t+=n.charAt(o>>2),t+=n.charAt((3&o)<<4|(240&a)>>4),t+=n.charAt((15&a)<<2|(192&s)>>6),t+=n.charAt(63&s)}return t}(function(e){var t,r,n,i;for(t="",n=e.length,r=0;r<n;r++)(i=e.charCodeAt(r))>=1&&i<=127?t+=e.charAt(r):i>2047?(t+=String.fromCharCode(224|i>>12&15),t+=String.fromCharCode(128|i>>6&63),t+=String.fromCharCode(128|i>>0&63)):(t+=String.fromCharCode(192|i>>6&31),t+=String.fromCharCode(128|i>>0&63));return t}(e))}})),(a=self.Dynamsoft||{}).DWT=a.DWT||{},a.aryAddonReadyFun=a.aryAddonReadyFun||[],a.AddonReady=a.AddonReady||function(e){a.aryAddonReadyFun.push(e)},a.WebcamVerForActiveX="15.0.0.0625",a.WebcamVerInName="15.0.0.0625",function(){for(var e=[a.DWT],t=0;t<1;t++){var r=e[t];r.EnumDWT_VideoRotateMode={VRM_NONE:0,VRM_90_DEGREES_CLOCKWISE:1,VRM_180_DEGREES_CLOCKWISE:2,VRM_270_DEGREES_CLOCKWISE:3,VRM_FLIP_VERTICAL:4,VRM_FLIP_HORIZONTAL:5},r.EnumDWT_VideoProperty={VP_BRIGHTNESS:0,VP_CONTRAST:1,VP_HUE:2,VP_SATURATION:3,VP_SHARPNESS:4,VP_GAMMA:5,VP_COLORENABLE:6,VP_WHITEBALANCE:7,VP_BACKLIGHTCOMPENSATION:8,VP_GAIN:9},r.EnumDWT_CameraControlProperty={CCP_PAN:0,CCP_TILT:1,CCP_ROLL:2,CCP_ZOOM:3,CCP_EXPOSURE:4,CCP_IRIS:5,CCP_FOCUS:6}}}(),a.Lib.WebcamErrors={InvalidParameter:function(e){e._errorCode=-10001,e._errorString="The parameter is invalid."},VideoNotPlayingWhenCapture:function(e){e._errorCode=-10002,e._errorString="To capture an image, the video must be playing."},VideoNotPlayingWhenGetURL:function(e){e._errorCode=-10003,e._errorString="To get the url for the current frame, the video must be playing."},Success:function(e){e._errorCode=0,e._errorString="Successful."}},function(e){function t(e){var t=this;t._Count=0,t._resultlist=[],t._stwain=e}t.prototype.GetCount=function(){return e.WebcamErrors.Success(this._stwain),this._Count-1},t.prototype.Get=function(t){var r=this;return r._resultlist.length-1<=t||t<0?(a.Lib.Errors.Webcam_InvalidIndex(r._stwain,"Get"),""):(e.WebcamErrors.Success(r._stwain),r._resultlist[t])},t.prototype.GetCurrent=function(){var t=this,r=t._resultlist.length;return 0==r?(a.Lib.Errors.Webcam_InvalidIndex(t._stwain,"GetCurrent"),""):(e.WebcamErrors.Success(t._stwain),t._resultlist[r-1])},e.NewWebcamValue=function(e){return new t(e)}}(a.Lib),function(e){function t(e){var t=this;t._Count=0,t._resultlist=[],t._stwain=e}t.prototype.GetValue=function(){var t=this;return 0==t._resultlist.length?(a.Lib.Errors.Webcam_InvalidIndex(t._stwain,""),""):(e.WebcamErrors.Success(t._stwain),t._resultlist[0].current)},t.prototype.GetIfAuto=function(){var t=this;return 0==t._resultlist.length?(a.Lib.Errors.Webcam_InvalidIndex(t._stwain,""),!1):(e.WebcamErrors.Success(t._stwain),"true"==t._resultlist[0].auto)},e.NewWebcamSetting=function(e){return new t(e)}}(a.Lib),function(e){function t(e){var t=this;t._Count=0,t._resultlist=[],t._stwain=e}t.prototype.GetMinValue=function(){var e=this;return 0==e._resultlist.length?(a.Lib.Errors.Webcam_InvalidIndex(e._stwain,""),""):e._resultlist[0].min},t.prototype.GetMaxValue=function(){var e=this;return 0==e._resultlist.length?(a.Lib.Errors.Webcam_InvalidIndex(e._stwain,""),""):e._resultlist[0].max},t.prototype.GetSteppingDelta=function(){var e=this;return 0==e._resultlist.length?(a.Lib.Errors.Webcam_InvalidIndex(e._stwain,""),0):e._resultlist[0].step},t.prototype.GetDefaultValue=function(){var e=this;return 0==e._resultlist.length?(a.Lib.Errors.Webcam_InvalidIndex(e._stwain,""),0):e._resultlist[0].defaultValue},t.prototype.GetIfAuto=function(){var e=this;return 0==e._resultlist.length?(a.Lib.Errors.Webcam_InvalidIndex(e._stwain,""),!1):"true"==e._resultlist[0].auto},e.NewWebcamMoreSetting=function(e){return new t(e)}}(a.Lib),a.AddonReady((function(e,t){e.DynamicLoadAddonFuns&&e.DynamicLoadAddonFuns.push((function(t){t._innerSetWebcamValue=function(r){var n=e.NewWebcamValue(t);return r&&e.isArray(r)&&(n._resultlist=r,n._Count=r.length),n},t._innerSetWebcamSetting=function(r){var n=e.NewWebcamSetting(t);return r&&e.isArray(r)&&(n._resultlist=r,n._Count=r.length),n},t._innerSetWebcamMoreSetting=function(r){var n=e.NewWebcamMoreSetting(t);return r&&e.isArray(r)&&(n._resultlist=r,n._Count=r.length),n}})),e.Addon_Events.push("OnFrameCaptured"),e.Addon_Events.push("OnCaptureSuccess"),e.Addon_Events.push("OnCaptureError")})),a.AddonReady((function(e,t){e.product.bHTML5Edition&&e.DynamicLoadAddonFuns&&e.DynamicLoadAddonFuns.push((function(t){var r,n=e.html5.Funs,i=e.env.bMac?"DynamicWebcam_"+a.WebcamVerInName+".dylib":e.env.bLinux?"DynamicWebcam_"+a.WebcamVerInName+".so":t._b64bit?"DynamicWebcamx64_"+a.WebcamVerInName+".dll":"DynamicWebcam_"+a.WebcamVerInName+".dll";try{t._innerSend("GetAddOnVersion",n.makeParams("webcam",i),!0,!1,!1)}catch(r){}(r=t)._innerWebcamValueFunction=function(e,t){return e=this._innerFunRaw(e,t,!1,!1),this._innerSetWebcamValue(e)},r._innerWebcamSettingFunction=function(e,t){return e=this._innerFunRaw(e,t,!1,!1),this._innerSetWebcamSetting(e)},r._innerWebcamMoreSettingFunction=function(e,t){return e=this._innerFunRaw(e,t,!1,!1),this._innerSetWebcamMoreSetting(e)},r._OnCaptureSuccess=function(e){a.Lib.isFunction(this.__OnCaptureSuccess)&&this.__OnCaptureSuccess()},r._OnCaptureError=function(e){var t=e[1];e=e[2];a.Lib.isFunction(this.__OnCaptureError)&&this.__OnCaptureError(t,e)},r._OnFrameCaptured=function(e){var t,r=this,n=a.Lib;r.__videoPause||(t=(t=r.__videoQuality)||60,r.__videoDest&&r.__videoDest.UpdateVideoContainer(r.GetImageURL(-1,-1,-1,0,t))),n.isFunction(r.__OnFrameCaptured)&&r.__OnFrameCaptured(e)},r={Webcam:{IsModuleInstalled:function(){var e=t;return e._resetErr(),""!=e._innerFun("GetAddOnVersion",n.makeParams("webcam",i))},Download:function(r,i,o){function s(){return t.IfShowProgressBar&&e.closeProgress(null,"Download"),a.Lib.isFunction(i)&&i(),!0}function u(){return t.IfShowProgressBar&&e.closeProgress(null,"Download"),a.Lib.isFunction(o)&&o(t._errorCode,t._errorString),!1}var c=t;if(c._resetErr(),a.Lib.cancelFrome=2,!e.License.checkProductKey(t,{Webcam:!0},!0))return u();if(this.IsModuleInstalled())return s();if(!r||""==r)return a.Lib.Errors.Webcam_InvalidRemoteFilename(c),u();if(n.isServerInvalid(c))return u(),!1;t.IfShowProgressBar&&e.showProgress(c,"Download",!0);var l=!0;return c._OnPercentDone([0,-1,"Downloading Webcam Module...","http"]),a.Lib.isFunction(i)||(l=!1),n.loadHttpBlob(c,"get",r,l,(function(e){c._OnPercentDone([0,-1,"Loading..."]),c.__LoadImageFromBytesV1(e,100,"",0,l,s,u)}),(function(){u()}),(function(e){var t=0===e.total?100:Math.round(100*e.loaded/e.total);[e.loaded," / ",e.total].join(""),c._OnPercentDone([0,t,"","http"])}))},GetSourceList:function(){var r,n=t;return n._resetErr(),e.License.checkProductKey(n,{Webcam:!0},!0)?(r=n._innerFunRaw("GetWebcamSourceList"),0==n.ErrorCode&&r&&1<r.length&&r.splice(r.length-1,1),r):[]},SelectSource:function(r){var i=t;return i._resetErr(),!!e.License.checkProductKey(i,{Webcam:!0},!0)&&i._innerFun("SelectWebcam",n.makeParams(r))},CloseSource:function(){var e=t;return e._resetErr(),this._clear(),e._innerFun("StopCapture")},GetFramePartURL:function(){var r=t;return r._resetErr(),this._isPlaying()?r.GetImageURL(-1,-1,-1,!0,r.__videoQuality):(e.WebcamErrors.VideoNotPlayingWhenGetURL(r),"")},GetFrameURL:function(){var r=t;return r._resetErr(),this._isPlaying()?r.GetImageURL(-1,-1,-1,0,r.__videoQuality):(e.WebcamErrors.VideoNotPlayingWhenGetURL(r),"")},PlayVideo:function(r,i,o,s,u){function c(){return f._clear(),a.Lib.isFunction(u)&&u(t._errorCode,t._errorString),!1}var l=t,d=(l._resetErr(),60),f=this;return a.DWT.UseDefaultViewer?r?e.License.checkProductKey(t,{Webcam:!0},!0)?(l.__videoDest=r,l.__videoDest.ShowVideoContainer(!0),a.Lib.isFunction(o)&&(t.__OnFrameCaptured=o),t.__videoPause?(t.__videoPause=!1,e.isFunction(s)&&s()):(t.__videoPause=!1,t.__videoQuality=i?d=(d=+i)<1?60:d:d,t._innerSend("PlayVideo",n.makeParams(!0),!0,s,c)),!0):c():(a.Lib.Errors.ParameterCannotEmpty(t),c()):(a.Lib.Errors.CannotDoWhenNoViewerJS(t),!1)},PauseVideo:function(){var e=t;return e._resetErr(),this._isPlaying()&&(e.__videoPause=!0),!0},_clear:function(){var e=t;e.__videoPause=!1,e.__OnFrameCaptured=!1,e.__videoQuality=60,e.__videoDest&&e.__videoDest.ShowVideoContainer(!1),e.__videoDest=!1},_isPlaying:function(){return t.GetIfShowVideoContainer()},StopVideo:function(){var e=t,r=(e._resetErr(),this._clear(),e._innerFun("PlayVideo",n.makeParams(!1,0)));return e._innerFun("StopCapture"),r},CaptureImage:function(r,i){var o=t;if(o._resetErr(),!e.License.checkProductKey(o,{Webcam:!0},!0))return e.isFunction(i)&&i(o._errorCode,o._errorString),!1;function s(){n.hideMask(u),e.isFunction(i)&&i(o._errorCode,o._errorString)}var u="CaptureImage";n.showMask(u),o.__OnCaptureError=s,o._innerSend(u,n.makeParams(!1),!0,(function(){n.hideMask(),0==o.ErrorCode?(n.hideMask(u),e.isFunction(r)&&setTimeout(r,0),e.License.isLTS()&&a.DWT.lcvrf(t)):s(o.ErrorCode,o.ErrorString)}),s)},GetMediaType:function(){var e=t;return e._resetErr(),e._innerWebcamValueFunction("GetMediaType")},SetMediaType:function(r){var i=t;return i._resetErr(),e.isString(r)?i._innerFun("SetMediaType",n.makeParams(r)):(e.Errors.InvalidValue(i),!1)},GetResolution:function(){var e;if((e=((e=t)._resetErr(),e._innerWebcamValueFunction("GetResolution")))&&e._resultlist){var r,n,i=e._resultlist,o=[],a=[];for(""==(n=0<i.length?i[i.length-1]:n)&&0<i.length&&(n=i[0]),r=0;r<i.length-1;r++){for(var s,u=(s=i[r]).toLowerCase().split("x"),c=(d=l=c=void 0,{value:s,p1:parseInt(u[0]),p2:parseInt(u[1])}),l=o,d=l.length-1;0<=d&&l[d].p1>=c.p1&&!(l[d].p1==c.p1&&l[d].p2<c.p2);)l[d+1]=l[d],d--;l[d+1]=c}for(r=0;r<o.length;r++)s=o[r].value,a.push(s);n&&a.push(n),e._resultlist=a,a=o=null}return e},SetResolution:function(r){var i=t;return i._resetErr(),e.isNumber(r)||e.isString(r)?i._innerFun("SetResolution",n.makeParams(r)):(e.Errors.InvalidValue(i),!1)},GetFrameRate:function(){var e=t;return e._resetErr(),e._innerWebcamValueFunction("GetFrameRate")},SetFrameRate:function(r){var i=t;return i._resetErr(),e.isNumber(r)?t._innerFun("SetFrameRate",n.makeParams(r)):(e.Errors.InvalidValue(i),!1)},GetVideoPropertySetting:function(e){var r=t;return r._resetErr(),r._innerWebcamSettingFunction("GetWebcamVideoPropertySetting",n.makeParams(e))},GetVideoPropertyMoreSetting:function(e){var r=t;return r._resetErr(),r._innerWebcamMoreSettingFunction("GetWebcamVideoPropertyMoreSetting",n.makeParams(e))},SetVideoPropertySetting:function(e,r,i){var o=t;return o._resetErr(),o._innerFun("SetWebcamVideoPropertySetting",n.makeParams(e,r,i))},SetVideoRotateMode:function(e){var r=t;return r._resetErr(),r._innerFun("SetVideoRotateMode",n.makeParams(e))},GetCameraControlPropertySetting:function(e){var r=t;return r._resetErr(),r._innerWebcamSettingFunction("GetWebcamCameraControlSetting",n.makeParams(e))},GetCameraControlPropertyMoreSetting:function(e){var r=t;return r._resetErr(),r._innerWebcamMoreSettingFunction("GetWebcamCameraControlMoreSetting",n.makeParams(e))},SetCameraControlPropertySetting:function(e,r,i){var o=t;return o._resetErr(),o._innerFun("SetWebcamCameraControlPropertySetting",n.makeParams(e,r,i))}}},t.__addon=t.__addon||{},e.mix(t.__addon,r)}))})),a.AddonReady((function(e,t){var r;e.product.bActiveXEdition&&e.DynamicLoadAddonFuns&&e.DynamicLoadAddonFuns.push((function(t){var n,i,o;if(!t.getSWebTwain()||!t.getSWebTwain().Addon)return!1;a.navInfoSync.bWin&&(o=!a.navInfo.bOSx64||a.navInfo.bWOW64,r=o?"DynamicWebcam_"+a.WebcamVerForActiveX+".dll":"DynamicWebcamx64_"+a.WebcamVerForActiveX+".dll"),n=t.getSWebTwain();try{n.GetAddOnVersion("webcam",r)}catch(i){}(o=t)._innerRead=function(e){var t;try{t=a.Lib.parse(e)}catch(e){}return t.result},o._innerWebcamValueFunctionPlugin=function(e){return e=this._innerRead(e),this._innerSetWebcamValue(e)},o._innerWebcamSettingFunctionPlugin=function(e){return e=this._innerRead(e),this._innerSetWebcamSetting(e)},o._innerWebcamMoreSettingFunctionPlugin=function(e){return e=this._innerRead(e),this._innerSetWebcamMoreSetting(e)},i={Webcam:{IsModuleInstalled:function(){var i=n.GetAddOnVersion("webcam",r);return e.setErrorString(t),""!=i},Download:function(r,i,o){function s(){return a.Lib.isFunction(i)&&i(),!0}function u(){return a.Lib.isFunction(o)&&o(t._errorCode,t._errorString),!1}return e.License.checkProductKey(t,{Webcam:!0},!0)?this.IsModuleInstalled()?s():r&&""!=r?(r=n.DownloadAddon(r),e.wrapperRet(t,r,s,u)):(a.Lib.Errors.Webcam_InvalidRemoteFilename(t),u()):u()},GetSourceList:function(){var r,i;return e.License.checkProductKey(t,{Webcam:!0},!0)?(r=n.GetWebcamSourceList(),i=[],e.setErrorString(t),0==t._errorCode&&(i=t._innerRead(r))&&1<i.length&&i.splice(i.length-1,1),i):[]},SelectSource:function(r){return!!e.License.checkProductKey(t,{Webcam:!0},!0)&&(r=n.SelectWebcam(r),e.setErrorString(t),r)},CloseSource:function(){t._playVideoDWT=null;var r=n.StopCapture();return e.setErrorString(t),r},GetFramePartURL:function(){var r;return this._isPlaying()?(r=n.GetDIB(-1),e.setErrorString(t),r):(e.WebcamErrors.VideoNotPlayingWhenGetURL(t),"")},GetFrameURL:function(){return""},PlayVideo:function(r,i,o,s,u){function c(){return t._playVideoDWT=null,a.Lib.isFunction(u)&&u(t.ErrorCode,t.ErrorString),!1}var l;return r&&r.getSWebTwain()?e.License.checkProductKey(t,{Webcam:!0},!0)?(l=r.getSWebTwain().CurrentHWND)?(t._playVideoDWT=r,setTimeout((function(){var r=n.RunWebcamCmd("PlayVideo",l,null,null,o);e.wrapperRet(t,r,s,c)}),0),!0):(e.WebcamErrors.InvalidParameter(t),c()):c():(a.Lib.WebcamErrors.InvalidParameter(t),c())},PauseVideo:function(){return!0},StopVideo:function(){t._playVideoDWT=null;var r=n.RunWebcamCmd("StopVideo",0,null,null,null);return e.setErrorString(t),n.StopCapture(),r},CaptureImage:function(r,i){function o(){return a.Lib.isFunction(i)&&i(t.ErrorCode,t.ErrorString),!1}var s;return e.License.checkProductKey(t,{Webcam:!0},!0)?(s=n.RunWebcamCmd("Capture",0,(function(){e.isFunction(r)&&setTimeout(r,0),e.License.isLTS()&&a.DWT.lcvrf(t)}),o,null),e.setErrorString(t),s):o()},GetMediaType:function(){var r=t._innerWebcamValueFunctionPlugin(n.GetMediaType());return e.setErrorString(t),r},SetMediaType:function(r){return e.isString(r)?(r=n.SetMediaType(r),e.setErrorString(t),r):(e.Errors.InvalidValue(t),!1)},GetResolution:function(){var r=t._innerWebcamValueFunctionPlugin(n.GetResolution());if(e.setErrorString(t),r&&r._resultlist){var i,o,a=r._resultlist,s=[],u=[];for(0<a.length&&(o=a[a.length-1]),i=0;i<a.length-1;i++){for(var c,l=(c=a[i]).toLowerCase().split("x"),d=(h=f=d=void 0,{value:c,p1:parseInt(l[0]),p2:parseInt(l[1])}),f=s,h=f.length-1;0<=h&&f[h].p1>=d.p1&&!(f[h].p1==d.p1&&f[h].p2<d.p2);)f[h+1]=f[h],h--;f[h+1]=d}for(i=0;i<s.length;i++)c=s[i].value,u.push(c);o&&u.push(o),r._resultlist=u,u=s=null}return r},SetResolution:function(r){return e.isNumber(r)||e.isString(r)?(r=n.SetResolution(r),e.setErrorString(t),r):(e.Errors.InvalidValue(t),!1)},GetFrameRate:function(){var r=t._innerWebcamValueFunctionPlugin(n.GetFrameRate());return e.setErrorString(t),r},SetFrameRate:function(r){return e.isNumber(r)?(r=n.SetFrameRate(r),e.setErrorString(t),r):(e.Errors.InvalidValue(t),!1)},GetVideoPropertySetting:function(r){return r=n.GetWebcamVideoPropertySetting(r),e.setErrorString(t),t._innerWebcamSettingFunctionPlugin(r)},GetVideoPropertyMoreSetting:function(r){return r=n.GetWebcamVideoPropertyMoreSetting(r),e.setErrorString(t),t._innerWebcamMoreSettingFunctionPlugin(r)},SetVideoPropertySetting:function(r,i,o){return r=n.SetWebcamVideoPropertySetting(r,i,o),e.setErrorString(t),r},SetVideoRotateMode:function(r){return r=n.SetVideoRotateMode(r),e.setErrorString(t),r},GetCameraControlPropertySetting:function(r){return r=n.GetWebcamCameraControlSetting(r),e.setErrorString(t),t._innerWebcamSettingFunctionPlugin(r)},GetCameraControlPropertyMoreSetting:function(r){return r=n.GetWebcamCameraControlMoreSetting(r),e.setErrorString(t),t._innerWebcamMoreSettingFunctionPlugin(r)},SetCameraControlPropertySetting:function(r,i,o){return r=n.SetWebcamCameraControlPropertySetting(r,i,o),e.setErrorString(t),r},_isPlaying:function(){return!!t._playVideoDWT}}},t.Addon=t.Addon||{},e.mix(t.Addon,i)}))}));var s;a=window.Dynamsoft||{};(s=a).DWT||(s.DWT={}),s.Lib||(s.Lib={}),a.aryAddonReadyFun=a.aryAddonReadyFun||[],a.AddonReady=a.AddonReady||function(e){a.aryAddonReadyFun.push(e)},a.AddonReady((function(e,t){a.DWT.EnumTransferErrorCode={TRANS_OK:0,TRANS_URL_MALFFORMAT:1,TRANS_FAILED_RESOLVE_PROXY:2,TRANS_FAILED_RESOLVE_HOST:3,TRANS_FAILED_CONNECT:4,TRANS_REMOTE_ACCESS_DENIED:5,TRANS_PARTIAL_FILE:6,TRANS_UPLOAD_FAILED:7,TRANS_READ_FAILED:8,TRANS_OUT_OF_MEMORY:9,TRANS_REMOTE_FULL_DISK:10,TRANS_OPERATION_TIMEOUT:11,TRANS_SERVICE_ERROR_404:12,TRANS_SERVICE_ERROR_500:13,TRANS_SERVICE_ERROR_503:14,TRANS_SERVICE_ERROR:15,TRANS_NOT_SEND:16,TRANS_WAITFOR_SEND:17,TRANS_SENDING:18,TRANS_PAUSE:19,TRANS_FINISHED:20,TRANS_NULL_POINTER:21,TRANS_INVALID_ID:22,TRANS_Failed:23,TRANS_SERVICE_ERROR_MORE_THAN_500:24,TRANS_SERVICE_ERROR_LESS_THAN_200:25,TRANS_SERVICE_ERROR_MORE_THAN_300:26,TRANS_CANNOT_FINDFILE:27,TRANS_ABORT:28,TRANS_NOT_FINISHED:29,TRANS_TASK_PREPARE_INIT:30,TRANS_TASK_INIT:31,TRANS_BEYOND_MAXSIZE:32};var r=a,n=e.guid(),i=5,o=a.dcp,s=[1,8,4,"0926"],u="upload_"+s.join(""),c={Version:"1.0",HttpVersion:"1.1",ServerUrl:"",FileName:"",VERIFYPEER:!1,VERIFYHOST:!1,BlockSize:10240,ThreadNum:1,OnUploadTransferPercentage:function(e,t){},OnRunSuccess:function(e){},OnRunFailure:function(e,t,r){}},l=0,d="",f=function(){l=-2,d="Upload failed because the url to upload to is invalid."},h=function(e,t,r){l=-3,e?d="Upload cancelled.":(d=t&&""!=t?"Upload failed with error: "+t:"Upload failed.",t&&""!=t&&(d=d+"("+r+")"))},g=function(){l=-7,d="The file name is incorrect in the upload job."},p=function(){l=0,d=""};function _(){}function m(e){this.job=e}function v(e){this.job=e}_.prototype={runWaiting:0,CreateJob:function(){var t={HttpHeader:{},documents:[],formFields:[],bEvent:!1};return e.mix(t,c),t.SourceValue=new m(t),t.FormField=new v(t),t},Run:function(t){var i,o=this,s='""',c=t.ServerUrl,h="";if(!e.isString(c)||""==c)return t.id=-1,f(),!t.bEvent&&e.isFunction(t.OnRunFailure)&&(t.bEvent=!0,t.OnRunFailure(t,l,d),t.bEvent=!1),!1;if(!t.documents||!e.isArray(t.documents)||t.documents.length<=0)return t.id=-1,l=-4,d="Upload failed because the file to upload has invalid content.",!t.bEvent&&e.isFunction(t.OnRunFailure)&&(t.bEvent=!0,t.OnRunFailure(t,l,d),t.bEvent=!1),!1;if(!t.ar||!t.cu){if(a.Lib.License.isLicenseMixed(null,!0)||a.Lib.License.reparseProductKey(),0!=(_=a.DWT.licenseException).code)return t.id=-1,l=_.code,d=_.message,!t.bEvent&&e.isFunction(t.OnRunFailure)&&(t.bEvent=!0,t.OnRunFailure(t,l,d),t.bEvent=!1),!1;if(a.Lib.License.isLTS())return a.DWT.lglic(a.DWT.EnumInstance.dwt_desktop,"").then((function(e){t.ar=e.ar,t.cu=e.cu,o.Run(t)})),!0;e.product.refProductKey&&(s='"'+e.product.refProductKey+'"')}for(t.Url=c,delete t.ServerUrl,i=0;i<t.documents;i++){var p=t.documents[i];if(!e.isString(p.files)||""==p.files)return t.id=-1,g(),!t.bEvent&&e.isFunction(t.OnRunFailure)&&(t.bEvent=!0,t.OnRunFailure(t,l,d),t.bEvent=!1),!1;e.isString(p.remoteName)&&""!=p.remoteName||(p.remoteName="RemoteFile")}var _=t.SourceValue,m=(delete t.SourceValue,t.FormField),v=(delete t.FormField,e.stringify(t));v=e.replaceAll(v,'"',"'");return t.ServerUrl=c,delete t.Url,t.SourceValue=_,t.FormField=m,c=['{"id":"',n,'","method":"RunUploadFile","version":"',u,'","parameter":[',s,',"',v,'"'],t.ar&&t.cu?(h=[',"',t.ar,'","',t.cu,'",0]}'].join(""),delete t.ar,delete t.cu,c.push(h)):c.push("]}"),_=c.join(""),o.runWaiting++,a.FileUploader._sendCmd("RunUploadFile",_,(function(n){var i;o.runWaiting--,n&&((i=n.UploadId)&&0<i?(t.id=i,r.FileUploader.map[t.id]=t,r.FileUploader.ids.push(n.UploadId),t.OnUploadTransferPercentage&&t.OnUploadTransferPercentage(t,0)):(i=n.errorcode,n=n.errorstring,i&&n?(l=i,d=n):(l=-6,d="Cannot create an upload job."),!t.bEvent&&e.isFunction(t.OnRunFailure)&&(t.bEvent=!0,t.OnRunFailure(t,l,d),t.bEvent=!1)))}),(function(n,i,a){o.runWaiting--,r.FileUploader.parseHttpErrors(n,i,a),!t.bEvent&&e.isFunction(t.OnRunFailure)&&(t.bEvent=!0,t.OnRunFailure(t,l,d),t.bEvent=!1)})),!0},Cancel:function(t){var i;return!t.id||t.id<0?(l=-5,d="Invalid upload job id.",!t.bEvent&&e.isFunction(t.OnRunFailure)&&(t.bEvent=!0,t.OnRunFailure(t,l,d),t.bEvent=!1),!1):(i='{"id":"'+n+'","method":"DeleteUploadTask","version":"'+u+'","parameter":["'+t.id+'"]}',a.FileUploader._sendCmd("DeleteUploadTask",i,(function(e){r.FileUploader.deleteJobById(t.id)}),(function(n,i,o){r.FileUploader.parseHttpErrors(n,i,o),!t.bEvent&&e.isFunction(t.OnRunFailure)&&(t.bEvent=!0,t.OnRunFailure(t,l,d),t.bEvent=!1)})),!0)},CancelAllUpload:function(){var e=r.FileUploader.ids,t='{"id":"'+n+'","method":"DeleteUploadTask","version":"'+u+'","parameter":["'+e.join(",")+'"]}';return 0<this.runWaiting?(l=-8,d="Can not cancel all jobs when at least one job is still being created.",!1):(this.runWaiting<0&&(this.runWaiting=0),e.length<=0||a.FileUploader._sendCmd("DeleteUploadTask",t,(function(t){for(var n=0;n<e.length;n++)r.FileUploader.deleteJobById(e[n]);r.FileUploader.ids=[],r.FileUploader.map=[]}),(function(e,t,n){r.FileUploader.parseHttpErrors(e,t,n)})),!0)},OnUploadTransferPercentage:function(e,t){},OnRunSuccess:function(e){},OnRunFailure:function(e,t,r){}},(r.SourceValue=m).prototype.Add=function(t,r,n){var i=this.job;e.isString(t)&&""!=t?(n=n||"RemoteFile",t=a.Lib.replaceAll(t,"\\\\","\\\\"),i.documents.push({files:[t],fileName:r,remoteName:n})):(g(),!i.bEvent&&e.isFunction(i.OnRunFailure)&&(i.bEvent=!0,i.OnRunFailure(i,l,d),i.bEvent=!1))},r.FormField=v,r.FileUploader={ids:[],map:{},port:18625,protocol:"https://",ip:"127.0.0.1",wsUrl:"",running:!(v.prototype.Add=function(t,r){var n,i,o=r,a=t;if(null==o&&(o=""),!e.isString(a)||""==a||!e.isString(o))return!1;if(o=encodeURI(o),-1<(a=encodeURI(a)).indexOf("'")||-1<o.indexOf("'"))return!1;for(n=0;n<this.job.formFields.length;n++)if((i=this.job.formFields[n]).name==a)return i.value=o,!0;return this.job.formFields.push({name:a,value:o}),!0}),ws:null,nextLoopTime:600,deleteJobById:function(e){var t;if(p(),e){for(t=0;t<r.FileUploader.ids.length;t++)if(e==r.FileUploader.ids[t]){r.FileUploader.ids.splice(t,1);break}var i=r.FileUploader.map[e];for(i.SourceValue.job=null,delete i.SourceValue,i.FormField.job=null,delete i.FormField,delete r.FileUploader.map[e],t=i.documents.length-1;0<=t;t--)i.documents.splice(t,1);for(t=i.formFields.length-1;0<=t;t--)i.formFields.splice(t,1);var o='{"id":"'+n+'","method":"DeleteUploadTask","version":"'+u+'","parameter":["'+e+'"]}';a.FileUploader._sendCmd("DeleteUploadTask",o)}},_sendCmdByWS:function(t,n,i){var o=r.FileUploader.ws;return o&&o.readyState!=a.DWT.EnumDWT_WebsocketReadyState.CLOSING&&o.readyState!=a.DWT.EnumDWT_WebsocketReadyState.CLOSED||(o=a.DWT.NetManager.newWebsocket(r.FileUploader.wsUrl),r.FileUploader.ws=o),a.DWT.NetManager.postStringDataByWS(o,t).then((function(t){(t=e.parse(t))&&"result"in t?e.isFunction(n)&&n(t.result):e.isFunction(i)&&i()}),i),!0},_sendCmd:function(t,n,i,o){return a.DWT.ConnectWithSocket?r.FileUploader._sendCmdByWS(n,i,o):(t=[r.FileUploader.protocol,r.FileUploader.ip,":",r.FileUploader.port,"/dcp/",u,"/",t,"?type=1&dsver=",s.join(""),"&ts=",e.now()].join(""),e.ajax({url:t,method:"post",dataType:"json",processData:!1,data:n,onSuccess:i,onError:o}))},parseHttpErrors:function(t,r,n){var i;2==(t=t&&e.isArray(t)&&2<t.length?(i=t[1],t[2]):(i=r,n)).state&&0==t.status?"abort"===t.statusText?h(!0):f():h(!1,i,t.status)},loadHttpBlob:function(t,n,i,o,a,s,u){t={method:t,url:n,dataType:"blob",async:i,onSuccess:o,onError:function(t,n,i){r.FileUploader.parseHttpErrors(t,n,i),e.isFunction(a)&&a()}},e.isFunction(s)&&(t.beforeSend=function(e){e.addEventListener("progress",(function(e){delete e.totalSize,delete e.position,s(e)}),!1)}),e.ajax(t)},_OnPercentDone:function(){},Download:function(t,n,i){var a;return e.isString(t)?r.FileUploader.loadHttpBlob("get",t,!!(a=function(){return l=-9,d="The zip file that contains the upload library (.dll) download failed.",e.isFunction(i)&&i(l,d),!1}),(function(e){o.loadZip(e,100,n,a)}),a,!1):(l=-1,d="The zip file that contains the upload library (.dll) is invalid.",e.isFunction(i)&&i(l,d),!1)},Init:function(t,n,o){if(p(),!a.Lib.detect.bOK)return--i<=0?(e.isFunction(o)&&o(),void(i=5)):void setTimeout((function(){a.FileUploader.Init(t,n,o)}),300);function s(){var t,i=a.navInfoSync.bSSL?(t="https://",a.dcp.SSLPort):(t="http://",a.dcp.Port);r.FileUploader.port=i,r.FileUploader.protocol=t,r.FileUploader.ip=a.DWT.Host,r.FileUploader.wsUrl=a.DWT.NetManager.getWsUrl(a.DWT.Host,i),r.FileUploader.running=!0,e.isFunction(n)&&n(new _),setTimeout(r.FileUploader.StatusLoop,500)}a.dcp.detect.bConnected?s():a.DWT.NetManager.checkModuleManager(s,(function(){--i<=0?(e.isFunction(o)&&o(),i=5):setTimeout((function(){a.FileUploader.Init(t,n,o)}),500)}))},Close:function(){var e;a.DWT.ConnectWithSocket&&(e=a.FileUploader.ws)&&(e.readyState!=a.DWT.EnumDWT_WebsocketReadyState.CLOSED&&e.readyState!=a.DWT.EnumDWT_WebsocketReadyState.CLOSING&&e.close(),a.FileUploader.ws=null),a.FileUploader.running=!1},VersionInfo:function(t,i){p();var o='{"id":"'+n+'","method":"VersionInfo","version":"'+u+'","parameter":[]}';return a.FileUploader._sendCmd("VersionInfo",o,t,(function(t,n,o){r.FileUploader.parseHttpErrors(t,n,o),e.isFunction(i)&&i(l,d)})),!0},StatusLoop:function(){return p(),r.FileUploader.GetUploadStatus(),r.FileUploader.running&&setTimeout(r.FileUploader.StatusLoop,r.FileUploader.nextLoopTime),!0},GetUploadStatus:function(){var t;return p(),r.FileUploader.ids.length<=0||(t='{"id":"'+n+'","method":"GetUploadStatus","version":"'+u+'","parameter":["'+r.FileUploader.ids.join(",")+'"]}',a.FileUploader._sendCmd("GetUploadStatus",t,(function(t){if(e.isArray(t))for(var n=0;n<t.length;n++){var i=(l=t[n]).id,o=r.FileUploader.map[i],s=l.percentage,u=l.errorcode,c=l.response,l=l.errorstring;o&&(u==a.DWT.EnumTransferErrorCode.TRANS_FINISHED?(o.OnUploadTransferPercentage(o,100,S(c)),!o.bEvent&&e.isFunction(o.OnRunSuccess)&&(o.bEvent=!0,o.OnRunSuccess(o,S(c)),o.bEvent=!1),r.FileUploader.deleteJobById(i)):u==a.DWT.EnumTransferErrorCode.TRANS_OK||u==a.DWT.EnumTransferErrorCode.TRANS_NOT_SEND||u==a.DWT.EnumTransferErrorCode.TRANS_WAITFOR_SEND||u==a.DWT.EnumTransferErrorCode.TRANS_SENDING||u==a.DWT.EnumTransferErrorCode.TRANS_PAUSE||u==a.DWT.EnumTransferErrorCode.TRANS_TASK_PREPARE_INIT||u==a.DWT.EnumTransferErrorCode.TRANS_TASK_INIT?o.OnUploadTransferPercentage(o,s,S(c)):(!o.bEvent&&e.isFunction(o.OnRunFailure)&&(o.bEvent=!0,o.OnRunFailure(o,u,l,S(c)),o.bEvent=!1),r.FileUploader.deleteJobById(i)))}}),(function(e,t,r){}))),!0}};var y=new Array(-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1);function S(e){for(var t,r,n,i,o=e.length,a=0,s="";a<o;){for(;t=y[255&e.charCodeAt(a++)],a<o&&-1==t;);if(-1==t)break;for(;r=y[255&e.charCodeAt(a++)],a<o&&-1==r;);if(-1==r)break;s+=String.fromCharCode(t<<2|(48&r)>>4);do{if(61==(n=255&e.charCodeAt(a++)))return s}while(n=y[n],a<o&&-1==n);if(-1==n)break;s+=String.fromCharCode((15&r)<<4|(60&n)>>2);do{if(61==(i=255&e.charCodeAt(a++)))return s}while(i=y[i],a<o&&-1==i);if(-1==i)break;s+=String.fromCharCode((3&n)<<6|i)}return s}})),function(){var e=620;a.OnWebTwainNotFoundOnWindowsCallback=function(e,t,r,n,i,o,s){var u={default:t};a._show_install_dialog(e,u,r,a.DWT.EnumDWT_PlatformType.enumWindow,n,i,o,s,!1)},a.OnWebTwainNotFoundOnLinuxCallback=function(e,t,r,n,i,o,s,u,c){var l=a,d={default:t,deb:t,rpm:r};c||(c=a.DWT.EnumDWT_PlatformType.enumLinux),l._show_install_dialog(e,d,n,c,i,o,s,u,!1)},a.OnWebTwainNotFoundOnMacCallback=function(e,t,r,n,i,o,s){var u={default:t};a._show_install_dialog(e,u,r,a.DWT.EnumDWT_PlatformType.enumMac,n,i,o,s,!1)},a.OnWebTwainNotFoundOnAndroidCallback=function(e,t,r,n){var i={default:"https://demo.dynamsoft.com/DWT/Resources/dist/DynamsoftServiceSetup.apk"},o=Math.random(),s=a.DWT.ServiceInstallerLocation;if(a.Lib.isString(s)&&s.length>0){var u="";"/"!=s[s.length-1]&&(u="/"),i.default=[s,u,"DynamsoftServiceSetup.apk"].join("")}i.openService="intent://dynamsoft.com/#Intent;scheme=http;package=com.dynamsoft.mobilescan;S.timestamp="+o+";end",a.DWT.Host="local.dynamsoft.com",a._show_android_install_dialog(i,n)},a.OnMobileNotSupportCallback=function(){var e=[];a.DWT?(e.push('<div class="ds-dwt-ui-dlg-android" style="padding-bottom:30px">'),e.push("Service Mode does not support your Operating System, please contact the site administrator."),e.push("</div>"),a.DWT.ShowMessage(e.join(""),{width:335,headerStyle:1,backgroundStyle:1})):console.log("The Dynamsoft namespace is missing")},a.OnHTTPCorsError=function(t){var r=["<div>",t,"</div>",'<div style="margin-top:10px">To fix the issue, please update your website to HTTPS or refer to <br /><a target="_blank" href="https://www.dynamsoft.com/web-twain/docs/faq/http-insecure-websites-in-chromium-browser.html?ver=latest">this article</a> for other workarounds.</div>'].join("");a.DWT.ShowMessage(r,{width:e,headerStyle:2})},a._show_install_dialog=function(e,t,r,n,i,o,s,u,c){var l,d,f=a,h=a.DWT.EnumDWT_PlatformType,g=n==h.enumLinux||n==h.enumEmbed||n==h.enumChromeOS||n==h.enumHarmonyOS,p="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAABHNCSVQICAgIfAhkiAAABqxJREFUaEPlm01y2zYUxwHJe6cniHMCU7K7tnoCK8uuYp+gzglsn8DOCapuuo1ygsjr2hKz6jLKtpvY61pA/g8ARZDiBwiCnMyYM5omKQnih/fw8L7I2Qu7eNe8o9GvJ/QOKUU0GPBX+s9swrl8ZIzH9Hch5JrzwVrK/59iXF3OKThwFEUHjA1PBgM21WAa0vWSkuDZQgg+Z+z5DvxYmHBXMOAoOnoHuAtMNrKnB4AvkOQjJArJcTV5IdgCcn4Fiat7cQ8WieMnDzDG6yyenAP+Qxzf45n2V2tggE4BeYOJYsL6AsAn/CAhsYCE1k2mCQ2B6g8mUvIzjHmYjskWUj6/b6vy3sBRdAx1ZZf4TQzkN0BexfFy1gSw6l6wQwv2LrCE+PF9s5wzITbXTRcyeY8X8Hh8fIMBMAmF+gSjcxESNL8IKTi7NIv7iMWFtJsvbiNg/eLhn1jtqZnUtRDPt6ENS5nUySByPryFqp+ae66Wy/vrJhrlDKxftvdRGyWSKp+GMiRNJkz3jsdjaNeAtIw0jFSc9raTNXcCJkOClf1MRwxZXSk3Z22NR1PIXTU/muLog73g+zj+Yhi031yga4GNGq00LLvDwJCs22q2hap73ghiTkcZQa9W96O6ZyqBac9CjSFZFhEsBlQW+We6jF1ZaysuZ8vlw3nV/CqBx+Ojj2SgjBpPfhbJFlhxnN3DhYYW75fL5W0ZdCkwYPEQ/0MbqA3BdurjttWaKBqfwWHBCaJ887dx/ADHZ/cqBCanAgbhs36YwRiEcevaQtU9D//gCvdcQiNxTm/eFGlkIfBodEz7lvbrNc45GiToNRodxRQgYL8Z5yXc8Jj7AmNThFY49x1g8o3h1GPvKlU+6GLfQhKSELGYtadE06VItNNIeZR3QXdeiNX/SoGAEOLcx3VzmWCXwPR+MMzA8A7Qf61WD2f2nDLAycbHjd9w44HL5H3u6RqYfAcEHV+1DXqmvbxO5pkBhv7DwWBRl9KlF3cNbEsZW/ODbSu2wPaqdLG3bE3oAzjdy1kPzALW5xgF71DnJBry0djaZ/oA1pp0RHmzfVutt8DY6OSTnnatzn2pdFatU+/LBv5OAUJ+k9eKy+OGviRsGeGt1ipg6+z6AnXOJOE8eGof6Q9YpYi+22d+DrifiKgv4KLto4DTDELWhNeKyvOGPoG1G8sPsVXJ64oNsHa68evEd86vS7/A2rdOgqCXCZxEGH2Fgn1KOAkZE+1VEk7P4PLA2XO7Fj7WL3CSyNBn8ctU6bzYfaSpffHhjSmDVKaDXCWsHQd+UpeYq5pvfruac3jrR+/Ej67wydFmAm/KEZdCuwBnc1T6SHGdi31fGt/rMDGo42EF3pRTKoWuA87CtktE5N9lgKlEubeiYjRcyzc+K5k84wJdBRwSNg155RO2hSrM28EDKu/8deKRdAldBhwS1vYg7VSPDazyQHWJbNeFqJJ0EXBo2Oxxm24LKwGgs5WuNRoX8DLoPHAXsKamrCIlaO0vSfbVTvFsQyn7Bhew6mNhm0HcGjIbuAtYmk+SbqYykR3y5pJ4OusROojIS5oMpF55cZ6WR9pZ4/yip8WEbK0pl6bVJZaqUoWvxG1ojKEtJsKYBDxkDjwtFe0WEwoS8dWlCl9gY0SUYYRkGSTbCax+T3mpqKDUos9ks9kzSew2sNY5/Tegf+9Csnrvbr1GdBVtonypqKSYpg0NkthzHNhvQ4DaY4xG4/+wbf6N45VqSwx16QL+kLoVSktFhcAmEKDOudoCc6jJhhjHLuCXJSNLq3euBeYQEw0xhmsBvxSYJpErMFdGQCEm7TtGVjjVBfxKYNuyNmkN8p24z3N2S5VL1aQW2BgCZP74oUus6zNp32dsyRbVgovGrQXWpl5ZPwvar8/RF6zoObvf0xWWxnECts5Qc1ypf2nc5xgCON/v6aLG9nsbAWtDlvY5Yl+jh5mhlbefLh/dhM6udG+2X79nY2Ct4mmfo1491eDp3cNcJ/mC3mzvfk8v4GRfFzVvSzmYrVb/3NVB1P1/Ul3G9k4gUfqsYKKWFb0nbZvQvYGTCZvmU1IzuKJG3mgMwyTxrQJ927D55Nr6ZD4QOUVcAcBtTzahPuHvtyF6s1sD2+DIS19gT+MbiPyHGurTHUqzqp5makrDf6g719Si1ccd2JfZi4J3fByC7SJmrotWpznBgO0XaV98gKZUTp/xJN3rdXNRksQizAGKBRHzUJD2izsBLiIjjwh7UgX+WmXFoxADk1x/Xvt+tOGwiplbegNuOrGu7v8BEbL8eSr8LDEAAAAASUVORK5CYII=",_="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAABHNCSVQICAgIfAhkiAAAB51JREFUaEPtW91V20gU1sje5yQVhK0AY3iPUwGkgiUVhFQQqCBQQZwKAhXEvIPtrSDeCgLPizX7ffPjGY1lz0iWDQ+rc3zg6Gd0v/s/916JbItHr3d0nOdZj6+QMhuYV70WYnFuinMPPI9zI/4timw6nd7dbIss0ebCvV5vL8s67wDyBBDw2+SQ1wB/nWXzW3BgtslK/rOtAIYkB5DQF/ysFNU7pJR/CyFAtJKckmCWPT0AACWbgUGQfvc1/weT1LN45gTP7PtEQjtG+F1A8maN5vA3ArwMVD5q4iRAFtfApdS17gE+gAk5geNHRohXmhlc++mzZVjddXl/I8BU3TzvfMHjp/ql8hH/X47Hd+dNiIg90+8fYV15ZoHj/2FRzCHx+qpeG3Cvd0iufwP3IQUNtCieLptKMwbWXqfU87wL0BkYrVT/ARL/OJ3eK5NJPWoBBthPeS4uzQtvpJyfNeFyKnFV91G7hOhcguHHvF4UEjTcX6WumQy43z/85lS4+DwejxXw5zr6/T6knX81JjUcj+8/ptASBUxVEqL7U8dO+Qhve1pXjVIIaXIPzQvefUjbhnpP4dDex0xrLWAfLGzmH6jwySYesgmo2DMMbVDxa6j4W4KeTO4O1j2zFrBVYwO2F+NejLhtXdeC6UwJmh58nXqvBOxshGo8H7w0yYbMo6QRKkc6dK32MZWAtW2IH8YLfngpNhvTkBS6lwAbtz/RcXb33thmb1BN2CZpsBmWHILx32OgrWbqOD0/CMPmEuCDg8MhXvQXHriZTO433ADEyHPXdWLRYehb+U7E3CRtAwY6sWNg+A4Mpz4VJcDkLtz8Tx1+5nRSs3SSm98Zhj68/7woCmZQDzYkciMCidGXRPNznfp2f2mTfKKU1WaFRwnwwcER4+0A5y+2lRdXscXTKoJi6JsFIXEBlnaKNd7Gsiudf2dfuOFAqHq/BDiQ7l4KJ5vLtKTKldIA8+FHsp4v2V6vf5rnOdR+WXIhLcZEoKHiFZIlJCR6a7mQ8HNJ10mibG84Lw2wN2S+D5bnq+wzBF0lZQXY6bx8RNBWnnFXh1XnMCJYwDAt4YM1RYV9qOotVJXmt/ZA8gSbp5Sf/qSpGMBaVXbtmUmpBQwnha3eeGipt4B9NJSqlGJIx5qSRpr1lce26yvA1o2HL41xr43rVu2wVslRwsRGsOF37h3yCtp3ZpMLShohBxua9YfVDitMBTi0l9gibV03iT8iQ3qSAxVFBshYnZYUmcLBb9JM84B96DQylWPbAJvigPheZ8sqT0iOJNBgbiz2mbiIVSrVFrCqdXzJpoIFnSztnHO9uqbnY/QAp6nIpoyIgXUpJt8kkCFJxOKMefVeE7DGZMkoMuxCWOfgB+dNQa16PgWsq66EqzTfptqkiqFsZ4DrgNXZlbxEqNyD+s6gxKNN8voA8OEvqosNzNuQbn2waZuEVFp1caA7YeymDasUji47dYE69z03WEurxblVwC8FrHFcSrCw4cMZi19tq/RLAutUGs29Nrw0Nx+mTToAE7H5EKgRyzNmUFVxdtVet46p1Lm3VS8N22D1nz2fpeMlgCVRJcDITdEyEZ9Sc1OLKqxBMTkXQo6KQsx0r1c8hFWTXUvWc1gu8WiaWrokPi0heC6wxmE5wG7zEG9TOOnaunVase85wZJmWy5SmwffZcNTq3JKzCHY/XOqGXhl0+TKY4yG1OtL20PNAV3HTd2F+PtnFdsW3UVNRlgpdJEgra6cCiblvsoCQHgytpAPeFWy72duTf1EjI6U66EwS0U8tidQNnkTW8gCVrlpUEqtSlWbRoIYHSnXAfg384FSEc8Ytq0hRYvwzob1aJLtCPjVRV/CuN9sUFx9OIXYTe/xyrSLCudiw+CCs2pCsaS50nl5JlAJFmxQBTftEPVoAnvM0J69TUGkPq8jQ4eMhnQrCvF1pUwgcHLo6JWL5H52Ve4U7NZhVUlXOVifY16SXdlqrOKua9Eo78w5iw+YrtuHbSOX1tN1qd4/VXqx+5KbaVrKul0K8q+hliB+/VGepgnvZWLCsSJXYI+t18Z1mwVG26V8meZOB8Wz9aMDZc3grKU8xTOYoWLRTcB7FxgO1SrfBojUNYJRjaWW7/8jD5aTwegA558WTeVUbu/yvtQuxto6lteonpl5iZ2qZyrDTAjiXMperLAfLdzZNgUWImjMWLwsSRvJ/jBgow22KGDDPWRhAj3ZZhOsqZKqe58/2Zs6AxIFbIlw4ar+BGtdICn3B5O9S9M6q9ZIBswFgglWhJ05p9NnKQS2dY8Jm6ij2fGmej2xWoB1nHYTrAYERoyerrYdb81GHrU33UFsOtlbG7BNTpCYn+uMTE+n439+AnDRliT9ddgqtWVf8z6MPszPm2hXI8CWGO0hu5hO16MJGniGyqX6/OamqdQpTdS5+c3TCb938kYQb5GrI1VtHik2AuyAq894IHF/JkNvJnBOfZOAdHOk//77aAnWDPtDfbGClHSgr2f8pqI0u8E2J36Q6DN/xhOqr+5A5JQIP8FR3yQ0PVjnxg/M2qxVGr6/FQmvAmVKwEpa7lM8iY25/hCLsZMFey1h+ymehALU+1KlDlP/Axl/TQ2HYDZNAAAAAElFTkSuQmCC",m="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAABHNCSVQICAgIfAhkiAAACBBJREFUaEPNW7tuG0cU3VkynQHbVdJF/gJTtLsEsIw06SQB7i0XqW1/gekuqSL3AUx/gaUvMAUknUXRboRUpj8gsNQEBkLu5Jx57ItLzswO9ViAEMXdmbln7p37XpFc4NXr3d9O06THJaRMtsxSt4TIf5vgtzP+jt9G/JtlyWQyeX94UWSJdU7c6/U2kqTzACB3AAGfmEseAPxBksyPsAPTmJnKY9cCGJzcAode4GO5qNaQUn4QQoBoxTnFwSSZnQEAOZtgg8D97i1+xyapsRizgzF3y0RCOkb4vATnzRzt4UcBXgQqzzVxEiCzA+BS4hp6YR+wCSmB48ONEDf1ZnDu2XO7YaHz8vlWgCm6adp5geF7elF5ju/74/H7QRsiXGP6/fuYVz6zwPF9mGVzcDxc1IMB93r3uOuvsfvgggaaZbP9ttx0gbX3yfU07QJ0go1Won8Gjj+ZTI7VkfG9ggAD7NM0FftmwUMp58/a7LIvcU3PUbqE6Oxjw7d5P8skaDh+5TunN+B+/97rQoSz5+PxWAG/qqvf74Pb6e/mSA3H4+MnPrQ4AVOUhOi+07ZTnkPb7oWKkQ8hbZ7h8YJ2H/JsQ7wnUGgPXUdrJeAyWJyZzxDhnRgN2QaUawxNG0T8ACL+PUGfnLzfXDVmJWArxgZsz7V7LuIu6r5mTGdC0NTgq8R7KeDijFCM51vXjbP1zSOnYSpH2nQt1zGNgPXZEG+NFty9LmfWJSE+dC8ANmr/RNvZMG1sRItjN1zE2fs4LvmjUIzwn+ewre08NE5kJVPb6flm3WwuAN7cvDcEwY8x4PDk5DgoAKCrCa35zhds03O+2nbVGsBAJbYNDG+AYa/8bAVwQbA6t1RS0xDi7XgQfQRtueUzVruNyQsQ9xv+/szAIRa0dn27n/SRnJHLKljhVQG8uXmf9paEvmzjF8cA5pp0UaFtR+sAXWxkMsLmP1wAXOPuRptzFAuYm2z0QA7aZVeXSZH2vTuQUHETzhIcEh1a5hyO5S4niwMsh1KmQ84jZXYDkvYHvn4npciJ9Tki5WeauKwAFzIvz2G0VUDe5tK2sHsSdobLPvHiqrPZ7JePHycE3+qC84SYnFye3aFOMoD7e2mavm6jmetUYAGEi8nI13YbMzgAURvVuSQ3/sbXr//+dHp6+rkVWgyyGjvLMpi78VABrv/oM7nOSnSZv1JJusu6mORDmuiDrwXp9arMVIAh68r6g+23fZRVNQlwWVCLdbRTIZHqGQ9dq5vEwRc+B6UohHXHmHCDkfbiFiTiE70pBhX0jiCOrXJXLmIX78tb0A/MdSEyUp4Uz6VzbdDLwOIukgW7wmoyTO5le61iYmxMBWcU3mMjIW98RS0cbDECAKYEXTY3q+YrYywB9vOby6YHATd2u0NuK80esusxgKkYIVVPfX39CmDYXxj55IHvblUBZ0Ot3ZMjwEWuyX/X4wBrd9RfKrWPTzpFHGC5zzCSnCUAcrruu8YAWzY2/BhWAGsFZA2zi8C6N2WjKz1OvsK5Zir1Qq9wwLlDNOEZViaJKtuHyib3UdeUElbBpj5zxD4TCpjrWZxrARwLIHR8FOBCxWtf07W4K0AwGQdVC4q9YDdReFtMsocCLnx8FPdilFY9yC9sdCzUYnyT9QgHvCYtvQjYTkwPTAxjYEPz7y0zc1GAQ414IdJyClf0ThmUS9xDNmCV5OEeEoVJz9d3WOJp+bmWWuPpGFOXLQUTZsoOI3BHPMxqovwLZ+9HXRX4Jug8S/nfOXNQ8PH/xFw/sFgmRKpyUuA6shgSiUVdpvU1pRXARfDgLlNYDpUmqDCNGVfsPAn7B5mKR20zmIxdUSj7FeO/tXMuSoe/zS8kAsFD2Ub5hocco8VX7gBYHmFpDqio5G/0ZiAD2aHPG5hBUVEQuKrqRZyLbRN5RCSEnAQmGFhXLsJDEt8mAdB0Hi/rDIfogsYEQP3HkAmvQmmF0NeY4rFJPAYB0Ly3QyZcBhihI8USee4wkdYhptiFLhiERHHLaAbgLyaoKZJ4Wqx1mIivXokAl0gTcFHNC9lCVj1U90404FKaNq+E5AFDyb56p07qMK7TGTYJfZWcaEzEr4PL1wlwE3eJsVZMs3Fjc6nRJZjXBbB3Mc2YKFUuhftwgGB+1wWyqrR01Q6KZwrHYS9k7OKzGelgYqJS/fOZE54givkCPoKjXKodCtVlB1dudevACq2oUqI+hLmeYRoYVmPD9Vz5fq1VY6Hku/aWB71hKXY3DSqm10EJkaEbQPVrQlr8rlYtD3bqWusA+5/yorLf8pf7lGlfMnY/sKnFklpqf5iafglnlv9yYerVyr0lTee2TJMzcWfLFFREAI2OnuvFacPZt6b04ywXOQFXK/LtOlgviuvloh5rY2AI+8lWSqETcF28+X9oB+tFAK519i506yxb0xswJ6h1sLKnit3p3lp0HcCN2UQXrX2nwq8mZtcOAqwVRNHBaiYZwDl45RKlWLCmzosCWjLQc7Xr7A0GbLQim7QRzdAj01VDfOcrAC9jgTWNh1/MPi6Em3mV8g3O66CNdLUCbInSGrKL3ioVVhrgyci8fnPYluu6naLDd57gwCR4Y8YCTY4YdsZYiijABXD1Go+KX8scYked7hDgZoiR/quzkkZS8qwmclVb+j4r/NW+EZY58QFHr/g1nrr46aJaSo6wLUG9k9D2YkcRPtisDB1B61OMa+HwMlDGt1VZzeJVPIlmbh1c0Hba/pDiVTwJfGFvqoRs6v/IOTkNXX2kbQAAAABJRU5ErkJggg==";if(l=['<div class="dynamsoft-dwt-dlg-title">',c?"Please update your document scanning service":"Please download and install the Dynamic Web TWAIN service",'</div><div class="dynamsoft-dwt-dlg-title-error" style="display:none"></div>'],f.DWT){var v=a.navInfoSync.bFirefox;d=g||v?"RESTART":"REFRESH",l.push('<div class="dynamsoft-dwt-installdlg-iconholder"> ');l.push('<div class="dynamsoft-dwt-installdlg-splitline" style="left: 134px"></div>'),l.push('<div class="dynamsoft-dwt-installdlg-splitline" style="left: 328px"></div>');if(l.push('<img style="margin: 0px 133px 0px 0px" src='+p+' alt="download">'),l.push('<img style="margin: 2px 133px 2px 0px" src='+_+' alt="install">'),l.push("<img src="+m+' alt="scan">'),l.push('<div><span class="dynamsoft-dwt-installdlg-text" style="right: 160px">Download</span>'),l.push('<span class="dynamsoft-dwt-installdlg-text" style="right: 18px">Install</span>'),l.push('<span class="dynamsoft-dwt-installdlg-text" style="left: 140px">Scan</span>'),l.push("</div>"),l.push("</div>"),r&&g){l.push('<div style="margin:10px 0 0 60px;">'),l.push('<div id="dwt-install-url-div">');var y=a.navInfo.bArm64,S=a.navInfo.bMips64,T=a.navInfoSync.bChromeOS,I=a.navInfoSync.bHarmonyOS;y||S||T||I||(l.push('<div><input id="dwt-install-url-deb" name="dwt-install-url" type="radio" onclick="Dynamsoft._dwt_change_install_url(\''+t.deb+'\')" checked="checked" /><label for="dwt-install-url-deb">64 bit .deb (For Ubuntu/Debian)</label></div>'),l.push('<div><input id="dwt-install-url-rpm" name="dwt-install-url" type="radio" onclick="Dynamsoft._dwt_change_install_url(\''+t.rpm+'\')" /><label for="dwt-install-url-rpm">64 bit .rpm (For Fedora)</label></div>')),l.push("</div></div>")}l.push('<div><a id="dwt-btn-install" target="_blank" href="'),l.push(t.default),l.push('"'),r?l.push(' html5="1"'):l.push(' html5="0"'),l.push(' onclick="Dynamsoft._dcp_dwt_onclickDownloadButton()"><div class="dynamsoft-dwt-dlg-button">Download</div></a></div>'),r?i?(l.push('<div class="dynamsoft-dwt-dlg-tail" style="text-align:left; padding-left: 80px">'),l.push("If you still see the dialog after installing the Dynamsoft Service, please<br />"),l.push("1. Add the website to the zone of trusted sites.<br />"),l.push("IE | Tools | Internet Options | Security | Trusted Sites.<br />"),l.push("2. Refresh your browser."),l.push("</div>")):g?(l.push('<div class="dynamsoft-dwt-dlg-tail">'),l.push('<div class="dynamsoft-dwt-dlg-red">After the installation, please <strong>'+d+"</strong>  your browser.</div>"),l.push("</div>")):l.push("<div><br /></div>"):(l.push('<div class="dynamsoft-dwt-dlg-tail" style="text-align:left; padding-left: 80px">'),l.push("After the installation, please<br />"),l.push("1. Restart the browser<br />"),l.push('2. Allow "DynamicWebTWAIN" add-on to run by right clicking on the Information Bar in the browser.'),l.push("</div>")),f.DWT.ShowMessage(l.join(""),{width:620,headerStyle:1})}else console.log("The Dynamsoft namespace is missing");a.DWT&&a.DWT.OnWebTwainNotFound&&a.DWT.OnWebTwainNotFound()},a._dwt_change_install_url=function(e){var t=document.getElementById("dwt-btn-install");t&&(t.href=e)};var t=0;a._dcp_dwt_onclickDownloadButton=function(){var e=document.getElementById("dwt-install-url-div");e&&(e.style.display="none");var t=document.getElementById("dwt-btn-install");if(t)if("1"==t.getAttribute("html5")){var r=t.parentNode,n=document.createElement("div");n.id="dwt-btn-install",n.style.textAlign="center",n.style.paddingBottom="15px",n.style.fontSize="14px",n.innerHTML='Please proceed with the installation. Once done, <a href="javascript:void(0)" onclick="Dynamsoft._dcp_dwt_onclickInstallButton()">click here to verify completion.</a>',n.setAttribute("html5","1"),r.removeChild(t),r.appendChild(n)}else{(r=t.parentNode).removeChild(t)}return!0},a._dcp_dwt_onclickInstallButton=function(){var e=document.getElementById("dwt-install-url-div");e&&(e.style.display="none");var r=a.Lib.one(".dynamsoft-dwt-dlg-title");r&&r.style("display","");var n=a.Lib.one(".dynamsoft-dwt-dlg-title-error");n&&n.style("display","none");var i=document.getElementById("dwt-btn-install");return i&&setTimeout((function(){if("1"==i.getAttribute("html5")){var e=i.parentNode,r=document.createElement("div");r.id="dwt-btn-install",r.style.textAlign="center",r.style.paddingBottom="15px",r.style.fontSize="14px",r.innerHTML="Connecting to the service...",r.setAttribute("html5","1"),e.removeChild(i),e.appendChild(r),t=new Date,setTimeout(a._dwt_Reconnect,10)}else{(e=i.parentNode).removeChild(i)}}),10),!0},a._dwt_Reconnect=function(){var e=a;if((new Date-t)/1e3>10){var r=document.getElementById("dwt-btn-install");r&&(r.innerHTML='Please make sure your installation is successful. <a href="javascript:void(0)" onclick="Dynamsoft._dcp_dwt_onclickInstallButton()">Click here to try reconnecting</a>.');var n=a.Lib.one(".dynamsoft-dwt-dlg-title");n&&n.style("display","none");var i=a.Lib.one(".dynamsoft-dwt-dlg-title-error");i&&(i.html("Failed to connect to the service!"),i.style("display",""))}else if(e.DWT){var o=500;navigator.userAgent.indexOf("Safari")>-1&&(o=2e3),e.DWT.CheckConnectToTheService((function(){a.DWT.CloseDialog(),a.DWT.ConnectToTheService()}),(function(){a.DWT.NeedCheckWebTwainBySocket()?a.DWT.CheckWebTwainBySocket((function(){a.OnHTTPCorsError()}),(function(){setTimeout(a._dwt_Reconnect,o)}),(function(){setTimeout(a._dwt_Reconnect,o)})):setTimeout(a._dwt_Reconnect,o)}))}else console.log("The Dynamsoft namespace is missing")},a._show_android_install_dialog=function(e,t){var r;if(a.DWT.bNpm&&a.navInfoSync.bFileSystem)return a._show_online_download_dialog(e,bHTML5,iPlatform);r=[],a.DWT?(r.push('<div class="ds-dwt-ui-dlg-android">'),r.push("<div>Please download and "),t?r.push("update"):r.push("install"),r.push(" the <strong>DYNAMSOFT SERVICE</strong> app via the </div>"),r.push('<div><a target="_blank" href="'),r.push(e.default),r.push('" onclick="Dynamsoft._dwt_ReconnectForAndroid()">direct APK download link</a>.</div>'),r.push("</div>"),r.push('<div class="dynamsoft-dwt-dlg-tail" style="text-align:left">'),r.push("If you have "),t?r.push("updated"):r.push("installed"),r.push(" it, please click on the button below to initiate the connection."),r.push('<a target="_blank" href="'),r.push(e.openService),r.push('" onclick="Dynamsoft._dwt_ReconnectForAndroid()"><div class="dynamsoft-dwt-dlg-button-android">Open Service</div></a>'),r.push("</div>"),r.push("</div>"),a.DWT.ShowMessage(r.join(""),{width:335,headerStyle:1,backgroundStyle:1})):console.log("The Dynamsoft namespace is missing"),a.DWT&&a.DWT.OnWebTwainNotFound&&a.DWT.OnWebTwainNotFound()},a._dwt_ReconnectForAndroid=function(){a.DWT.CheckConnectToTheService((function(e){e?(a.DWT.CloseDialog(),a.DWT.ConnectToTheService()):setTimeout(a._dwt_ReconnectForAndroid,500)}),(function(){setTimeout(a._dwt_ReconnectForAndroid,500)}))},a.OnWebTwainNeedUpgradeCallback=function(e,t,r,n,i,o,s,u){a._show_install_dialog(e,t,r,n,i,o,s,u,!0,!0)},a.OnWebTwainNeedUpgradeOnAndroidCallback=function(e,t,r){a.OnWebTwainNotFoundOnAndroidCallback(e,t,r,!0)},a.OnLTSLicenseError=function(t,r){var n,i="";if(-2440==r||-2441==r||-2443==r||-2446==r||t.indexOf("Internet connection")>-1||t.indexOf("Storage")>-1){i='<div>You can register for a free 30-day trial <a href="https://www.dynamsoft.com/customer/license/trialLicense?product=dwt&deploymenttype=js" target="_blank" class="dynamsoft-major-color">here</a>. Make sure to select the product Dynamic Web TWAIN.</div>'}n=[t,i],a.DWT.ShowMessage(n.join(""),{width:e,headerStyle:2})},a.OnLTSConnectionWarning=function(){var t=["Warning: You are seeing this dialog because Dynamic Web TWAIN has failed to connect to the License Tracking Server. ","A cached authorization is being used, and you can continue to use the software as usual. ","Please get connected to the network as soon as possible. ",a.DWT.isPublicLicense()?'<a class="dynamsoft-major-color" href="https://www.dynamsoft.com/company/contact/">Contact Dynamsoft</a> ':"Contact the site administrator ","for more information."].join("");a.DWT.ShowMessage(t,{width:e,caption:"Warning",headerStyle:2})},a.OnLTSPublicLicenseWarning=function(t){a.DWT.ShowMessage(t,{width:e,caption:"Warning",headerStyle:2})},a.OnLicenseExpiredWarning=function(t,r,n){var i,o,s='<a target="_blank" href="https://www.dynamsoft.com/store/dynamic-web-twain/#DynamicWebTWAIN">online store</a>',u="https://www.dynamsoft.com/customer/license/trialLicense?product=dwt&utm_source=in-product";if(r>5||!n);else{if(r>0)o="Warning",i=['<div style="padding:0 0 10px 0">Kindly note your trial key is expiring in ',r<=1?"1 day":parseInt(r)+" days",". Two quick steps to extend your trial:</div>",'<div style="margin:0 0 0 10px">1. <a target="_blank" href="',u,'">Request a new trial key</a> and follow the instructions to set the new key</div>','<div style="margin:0 0 0 10px">2. Refresh your scan page and try again</div>','<div style="padding:0">If you are ready to purchase a full license, please go to the ',s,".</div>"].join("");else i=['<div style="padding:0">Sorry. Your product key has expired on ',t,". You can purchase a full license at the ",s,".</div>",'<div style="padding:0">Or, you can try requesting a new product key at <a target="_blank" href="',u,'">this page</a>.</div>'].join("");i&&a.DWT.ShowMessage(i,{width:e,caption:o,headerStyle:2})}},a.OnLicenseError=a.OnLicenseError||function(t,r){a.DWT.ShowMessage(t,{width:e,headerStyle:2})},a.OnCorsConfigError=function(t){var r=[t," Please contact the Administrator to configure 'Access-Control-Allow-Origin'."].join("");a.DWT.ShowMessage(r,{width:e,headerStyle:2})},a._show_online_download_dialog=function(e,t,r){var n,i,o,s,u=a.DWT.JSVersion.split(","),c=u[0]+"."+u[1],l=location.pathname;l=l.substring(0,l.lastIndexOf("/")+1),r==a.DWT.EnumDWT_PlatformType.enumLinux&&(arm64||mips64)&&(arm64?e.default=getDebPath("arm64"):mips64&&(e.default=getDebPath("mips64el"))),i=["https://www.dynamsoft.com/web-twain/install-dynamsoft-service/?productId=1000001","&downloadLink=https://demo.dynamsoft.com/DWT/Resources/dist/DynamsoftServiceSetup_",c,".",s=e.default.substr(e.default.length-3)].join(""),o=a.Lib.Path.normalize([l,e.default].join("")),r==a.DWT.EnumDWT_PlatformType.enumWindow&&0==o.indexOf("/")&&(o=o.substr(1)),n=['<div class="dynamsoft-dwt-ltsdlg-body" style="padding:0 20px 20px 20px">',"<div>To support document scanning, please complete one-time installation of the DynamsoftServiceSetup.",s," on this machine.</div>","<div>You can download the file via this trust site:</div>",'<div><a id="dwt-btn-install" target="_blank" href="',i,'"><div class="dynamsoft-dwt-dlg-button">Open Site</div></a></div>','<div style="word-break: break-word;">Or, go to <br />',o," if the file exists.</div>","<div>After the installation, please <strong>REFRESH</strong>  your browser.<br /></div>","</div>"],a.DWT.ShowMessage(n.join(""),{width:620,headerStyle:1,closeButton:!1})}}(),a.DWT.AutoLoad=!1,a.DWT.IfAddMD5InUploadHeader=!1,a.DWT.IfConfineMaskWithinTheViewer=!1,t.Z=a}}]);